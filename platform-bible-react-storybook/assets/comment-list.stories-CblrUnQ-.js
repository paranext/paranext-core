import{j as e}from"./jsx-runtime-fMGamsoY.js";import{T as We}from"./theme-provider.component-PYdeKJC7.js";import{r as n}from"./iframe-DQ9l5HFh.js";import{c as B}from"./shadcn-ui.util-DMJ19wEV.js";import{f as Me,e as ee,h as Be,E as te,a as O,b as Ie}from"./editor-utils-BUM6sZQk.js";import{B as Se}from"./badge-DmVVxC2J.js";import{B as W}from"./button-B-_n_mrf.js";import{C as Le,d as Ge}from"./card-BGQ-eizm.js";import{S as le}from"./separator-B7pb0WFW.js";import{Z as He,v as $,a as Ke,b as me,c as Ve}from"./index-CmLeGMp1.js";import{P as $e,a as Fe,b as ze}from"./popover-Dcgbqk-R.js";import{C as Je,c as Ze,e as Xe}from"./command-DaFNp7sN.js";import{A as Ye,b as Qe}from"./avatar-Bv9U9U6Q.js";import{c as ce,D as et,a as tt,b as st}from"./dropdown-menu-Gih4IR4d.js";import{c as Ce}from"./createLucideIcon-CeJWC9Yg.js";import{T as nt}from"./trash-2-pz7vtb-m.js";import{X as rt}from"./x-nz3ive0r.js";import{A as ke}from"./arrow-up-zfWTfltn.js";import{C as at}from"./check-CuxYxbHA.js";import{E as ot}from"./ellipsis-DwcBzUnc.js";import{C as ue}from"./chevron-up-DnJbOhW2.js";import{C as he}from"./chevron-down-TP-EHvH0.js";import"./LexicalTable.prod-B9yqd5k8.js";import"./index-Cx0HaM2D.js";import"./index-Dz94m_TO.js";import"./tooltip-B_VcW19q.js";import"./index-DTAXz6r9.js";import"./index-BgrH4b44.js";import"./index-JH5ghPXM.js";import"./index-Di04y14V.js";import"./index-dtbm5Fq5.js";import"./index-DQKrz_cm.js";import"./index-Cp6IaKnt.js";import"./floating-ui.react-dom-CfPozojY.js";import"./index-BdA-xH4O.js";import"./index-C8ye2EKl.js";import"./index-J3IE41Xt.js";import"./index-B9cQntjC.js";import"./index-CGBuitDy.js";import"./index-BnP88T-Y.js";import"./dialog-pfnrDYXy.js";import"./index-Czfav6j7.js";import"./index-CVT0YeQh.js";import"./toggle-group-Dco9VIG6.js";import"./index-A5ET9CB9.js";import"./index-lSJfgKCj.js";import"./index-C0KezFTM.js";import"./index-BPbCuWFR.js";import"./underline-B_nONCF2.js";import"./index-D2w9gCAG.js";import"./index-jxW7lNtl.js";import"./index-BephRXNg.js";import"./index-BGmpIyQS.js";import"./index-Bjk03Htc.js";import"./search-C-tqFqw4.js";import"./index-B6HK1zCy.js";import"./circle-BhX6vaqR.js";import"./chevron-right-72VzNJmN.js";const it=["input","select","textarea","button"],dt=["button","textbox"],lt=({options:r,onFocusChange:l,onOptionSelect:d,onCharacterPress:b})=>{const S=n.useRef(null),[I,P]=n.useState(void 0),[g,h]=n.useState(void 0),v=n.useCallback(t=>{P(t);const o=r.find(u=>u.id===t);o&&(l==null||l(o));const i=document.getElementById(t);i&&(i.scrollIntoView({block:"center"}),i.focus()),S.current&&S.current.setAttribute("aria-activedescendant",t)},[l,r]),j=n.useCallback(t=>{const o=r.find(i=>i.id===t);o&&(h(i=>i===t?void 0:t),d==null||d(o))},[d,r]),p=t=>{if(!t)return!1;const o=t.tagName.toLowerCase();if(t.isContentEditable||it.includes(o))return!0;const i=t.getAttribute("role");if(i&&dt.includes(i))return!0;const u=t.getAttribute("tabindex");return u!==void 0&&u!=="-1"},c=n.useCallback(t=>{var R;const o=t.target,i=f=>f?document.getElementById(f):void 0,u=i(g),w=i(I);if(!!(u&&o&&u.contains(o)&&o!==u)&&p(o)){if(t.key==="Escape"||t.key==="ArrowLeft"&&!o.isContentEditable){if(g){t.preventDefault(),t.stopPropagation();const f=r.find(a=>a.id===g);f&&v(f.id)}return}if(t.key==="ArrowDown"||t.key==="ArrowUp"){if(!u)return;const f=Array.from(u.querySelectorAll('button:not([disabled]), input:not([disabled]):not([type="hidden"]), textarea:not([disabled]), select:not([disabled]), [href], [tabindex]:not([tabindex="-1"])'));if(f.length===0)return;const a=f.findIndex(A=>A===o);if(a===-1)return;let C;t.key==="ArrowDown"?C=Math.min(a+1,f.length-1):C=Math.max(a-1,0),C!==a&&(t.preventDefault(),t.stopPropagation(),(R=f[C])==null||R.focus());return}return}const N=r.findIndex(f=>f.id===I);let U=N;switch(t.key){case"ArrowDown":U=Math.min(N+1,r.length-1),t.preventDefault();break;case"ArrowUp":U=Math.max(N-1,0),t.preventDefault();break;case"Home":U=0,t.preventDefault();break;case"End":U=r.length-1,t.preventDefault();break;case" ":case"Enter":I&&j(I),t.preventDefault(),t.stopPropagation();return;case"ArrowRight":{const f=w;if(f){const a=f.querySelector('input:not([disabled]):not([type="hidden"]), textarea:not([disabled]), select:not([disabled])'),C=f.querySelector('button:not([disabled]), [href], [tabindex]:not([tabindex="-1"]), [contenteditable="true"]'),A=a??C;if(A){t.preventDefault(),A.focus();return}}break}default:t.key.length===1&&!t.metaKey&&!t.ctrlKey&&!t.altKey&&(p(o)||(b==null||b(t.key),t.preventDefault()));return}const m=r[U];m&&v(m.id)},[r,v,I,g,j,b]);return{listboxRef:S,activeId:I,selectedId:g,handleKeyDown:c,focusOption:v}};/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]],ct=Ce("AtSign",mt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],ht=Ce("Pencil",ut);function Y(r,l){return r===""?l["%comment_assign_unassigned%"]??"Unassigned":r==="Team"?l["%comment_assign_team%"]??"Team":r}function se({comment:r,isReply:l=!1,localizedStrings:d,isThreadExpanded:b=!1,threadStatus:S="Unspecified",handleAddCommentToThread:I,handleUpdateComment:P,handleDeleteComment:g,onEditingChange:h,canUserEditOrDeleteCommentCallback:v,canUserResolveThread:j=!1}){const[p,c]=n.useState(!1),[t,o]=n.useState(),[i,u]=n.useState(!1),w=n.useRef(null);n.useEffect(()=>{let a=!0;if(!b){u(!1);return}return(async()=>{const A=v?await v(r.id):!1;a&&u(A)})(),()=>{a=!1}},[v,r.id,b]),n.useEffect(()=>{if(!p)return;let a=!0;const C=w.current;if(!C)return;const A=setTimeout(()=>{a&&Me(C)},300);return()=>{a=!1,clearTimeout(A)}},[p]);const x=n.useCallback(()=>{c(!1),o(void 0),h==null||h(!1)},[h]),T=n.useCallback(async()=>{if(!t||!P)return;await P(r.id,ee(t))&&(c(!1),o(void 0),h==null||h(!1))},[t,P,r.id,h]),N=n.useMemo(()=>{const a=new Date(r.date),C=He(a,d["%comment_date_today%"],d["%comment_date_yesterday%"]),A=a.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"});return $(d["%comment_dateAtTime%"],{date:C,time:A})},[r.date,d]),U=n.useMemo(()=>r.user,[r.user]),m=n.useMemo(()=>r.user.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2),[r.user]),R=n.useMemo(()=>Ke(me(r.contents)),[r.contents]),f=n.useMemo(()=>{if(b&&i)return e.jsxs(e.Fragment,{children:[!Ve(r.contents)&&e.jsxs(ce,{onClick:()=>{c(!0),o(Be(me(r.contents))),h==null||h(!0)},children:[e.jsx(ht,{className:"tw-me-2 tw-h-4 tw-w-4"}),d["%comment_editComment%"]]}),e.jsxs(ce,{onClick:async()=>{g&&await g(r.id)},children:[e.jsx(nt,{className:"tw-me-2 tw-h-4 tw-w-4"}),d["%comment_deleteComment%"]]})]})},[i,b,d,r.contents,r.id,g,h]);return e.jsxs("div",{className:B("tw-flex tw-w-full tw-flex-row tw-items-baseline tw-gap-3 tw-space-y-3",{"tw-text-sm":l}),children:[e.jsx(Ye,{className:"tw-h-8 tw-w-8",children:e.jsx(Qe,{className:"tw-text-xs tw-font-medium",children:m})}),e.jsxs("div",{className:"tw-flex tw-flex-1 tw-flex-col tw-gap-2",children:[e.jsxs("div",{className:"tw-flex tw-w-full tw-flex-row tw-flex-wrap tw-items-baseline tw-gap-x-2",children:[e.jsx("p",{className:"tw-text-sm tw-font-medium",children:U}),e.jsx("p",{className:"tw-text-xs tw-font-normal tw-text-muted-foreground",children:N}),e.jsx("div",{className:"tw-flex-1"}),l&&r.assignedUser!==void 0&&e.jsxs(Se,{variant:"secondary",className:"tw-text-xs tw-font-normal",children:["→ ",Y(r.assignedUser,d)]})]}),p&&e.jsxs("div",{role:"textbox",tabIndex:-1,className:"tw-flex tw-flex-col tw-gap-2",ref:w,onKeyDownCapture:a=>{a.key==="Escape"?(a.preventDefault(),a.stopPropagation(),x()):a.key==="Enter"&&a.shiftKey&&(a.preventDefault(),a.stopPropagation(),O(t)&&T())},onKeyDown:a=>{Ie(a),(a.key==="Enter"||a.key===" ")&&a.stopPropagation()},children:[e.jsx(te,{editorSerializedState:t,onSerializedChange:a=>o(a)}),e.jsxs("div",{className:"tw-flex tw-flex-row tw-items-start tw-justify-end tw-gap-2",children:[e.jsx(W,{size:"icon",onClick:x,variant:"outline",className:"tw-flex tw-items-center tw-justify-center tw-rounded-md",children:e.jsx(rt,{})}),e.jsx(W,{size:"icon",onClick:T,className:"tw-flex tw-items-center tw-justify-center tw-rounded-md",disabled:!O(t),children:e.jsx(ke,{})})]})]}),!p&&e.jsxs(e.Fragment,{children:[r.status==="Resolved"&&e.jsx("div",{className:"tw-text-sm tw-italic",children:d["%comment_status_resolved%"]}),r.status==="Todo"&&e.jsx("div",{className:"tw-text-sm tw-italic",children:d["%comment_status_todo%"]}),e.jsx("div",{className:B("tw-prose tw-items-start tw-gap-2 tw-break-words tw-text-sm tw-font-normal tw-text-foreground","tw-max-w-none",{"tw-line-clamp-3":!b}),dangerouslySetInnerHTML:{__html:R}})]})]}),b&&j&&!l&&S!=="Resolved"&&I&&e.jsx(W,{variant:"ghost",size:"icon",className:"tw-shrink-0",onClick:a=>{a.stopPropagation(),I({threadId:r.thread,status:"Resolved"})},children:e.jsx(at,{})}),f&&e.jsxs(et,{children:[e.jsx(tt,{asChild:!0,children:e.jsx(W,{variant:"ghost",size:"icon",children:e.jsx(ot,{})})}),e.jsx(st,{align:"end",children:f})]})]})}se.__docgenInfo={description:`A single comment item in the comment list.

@param CommentItemProps The properties for the CommentItem component`,methods:[],displayName:"CommentItem",props:{comment:{required:!0,tsType:{name:"LegacyComment"},description:"Comment to render"},isReply:{required:!1,tsType:{name:"boolean"},description:"Whether the comment is a reply or a top-level comment",defaultValue:{value:"false",computed:!1}},localizedStrings:{required:!0,tsType:{name:"LanguageStrings"},description:"Localized strings for the component"},isThreadExpanded:{required:!1,tsType:{name:"boolean"},description:"Whether the thread is expanded",defaultValue:{value:"false",computed:!1}},threadStatus:{required:!1,tsType:{name:"CommentStatus"},description:"Current status of the thread",defaultValue:{value:"'Unspecified'",computed:!1}},handleAddCommentToThread:{required:!1,tsType:{name:"signature",type:"function",raw:"(options: AddCommentToThreadOptions) => Promise<string | undefined>",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  /** The ID of the thread to add the comment to */
  threadId: string;
  /** The content of the comment (optional - can be omitted when only changing status or assignment) */
  contents?: string;
  /** Status to set on the thread ('Resolved' or 'Todo') */
  status?: CommentStatus;
  /** User to assign to the thread. Use "" for unassigned, "Team" for team assignment. */
  assignedUser?: string;
}`,signature:{properties:[{key:"threadId",value:{name:"string",required:!0},description:"The ID of the thread to add the comment to"},{key:"contents",value:{name:"string",required:!1},description:"The content of the comment (optional - can be omitted when only changing status or assignment)"},{key:"status",value:{name:"CommentStatus",required:!1},description:"Status to set on the thread ('Resolved' or 'Todo')"},{key:"assignedUser",value:{name:"string",required:!1},description:'User to assign to the thread. Use "" for unassigned, "Team" for team assignment.'}]}},name:"options"}],return:{name:"Promise",elements:[{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}],raw:"Promise<string | undefined>"}}},description:`Handler for adding a comment to a thread (used for resolving). If successful, returns the
auto-generated comment ID. Otherwise, returns undefined.`},handleUpdateComment:{required:!1,tsType:{name:"signature",type:"function",raw:"(commentId: string, contents: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"commentId"},{type:{name:"string"},name:"contents"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:"Handler for updating a comment's content"},handleDeleteComment:{required:!1,tsType:{name:"signature",type:"function",raw:"(commentId: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"commentId"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:"Handler for deleting a comment"},onEditingChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(isEditing: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isEditing"}],return:{name:"void"}}},description:"Callback when editing state changes"},canUserEditOrDeleteCommentCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(commentId: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"commentId"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:`Callback to check if the current user can edit or delete a specific comment. Returns a promise
that resolves to true if the user can edit or delete the comment, false otherwise.`},canUserResolveThread:{required:!1,tsType:{name:"boolean"},description:"Whether the current user can resolve or re-open this thread.",defaultValue:{value:"false",computed:!1}}}};const fe={root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:"",type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1,textFormat:0,textStyle:""}],direction:"ltr",format:"",indent:0,type:"root",version:1}};function Pe({comments:r,localizedStrings:l,isSelected:d=!1,verseRef:b,assignedUser:S,currentUser:I,handleSelectThread:P,threadId:g,threadStatus:h,handleAddCommentToThread:v,handleUpdateComment:j,handleDeleteComment:p,assignableUsers:c,canUserAddCommentToThread:t,canUserAssignThreadCallback:o,canUserResolveThreadCallback:i,canUserEditOrDeleteCommentCallback:u}){const[w,x]=n.useState(fe),[T,N]=n.useState(!1),[U,m]=n.useState(!1),[R,f]=n.useState(!1),[a,C]=n.useState(!1),[A,Q]=n.useState(!1),[D,F]=n.useState(void 0),[Ae,re]=n.useState(!1),[je,ae]=n.useState(!1);n.useEffect(()=>{let s=!0;if(!d){re(!1),ae(!1);return}return(async()=>{const K=o?await o(g):!1;if(!s)return;const Oe=i?await i(g):!1;s&&(re(K),ae(Oe))})(),()=>{s=!1}},[d,g,o,i]);const z=n.useMemo(()=>r.filter(s=>!s.deleted),[r]),L=n.useMemo(()=>z[0],[z]),oe=n.useRef(null),J=n.useRef(void 0),G=n.useCallback(()=>{var s;(s=J.current)==null||s.call(J),x(fe)},[]);n.useEffect(()=>{const s=oe.current;if(!s)return;const q=()=>{m(s.scrollWidth>s.clientWidth)};return q(),window.addEventListener("resize",q),()=>window.removeEventListener("resize",q)},[L==null?void 0:L.verse]),n.useEffect(()=>{f(!1)},[d]);const M=n.useMemo(()=>({singleReply:l["%comment_thread_single_reply%"],multipleReplies:l["%comment_thread_multiple_replies%"]}),[l]),ie=n.useMemo(()=>{if(S===void 0)return;if(S==="")return l["%comment_assign_unassigned%"]??"Unassigned";const s=Y(S,l);return $(l["%comment_assigned_to%"],{assignedUser:s})},[S,l]),H=n.useMemo(()=>z.slice(1),[z]),_=n.useMemo(()=>H.length??0,[H.length]),Ue=n.useMemo(()=>_>0,[_]),Ee=n.useMemo(()=>R||_<=2?H:H.slice(-2),[H,_,R]),Z=n.useMemo(()=>R||_<=2?0:_-2,[_,R]),De=n.useMemo(()=>_===1?M.singleReply:$(M.multipleReplies,{count:_}),[_,M]),_e=n.useMemo(()=>Z===1?M.singleReply:$(M.multipleReplies,{count:Z}),[Z,M]),de=n.useCallback(async()=>{const s=O(w)?ee(w):void 0;if(D!==void 0){await v({threadId:g,contents:s,assignedUser:D})&&(F(void 0),s&&G());return}s&&await v({threadId:g,contents:s})&&G()},[G,w,v,D,g]),qe=n.useCallback(async s=>{const q=O(w)?ee(w):void 0,K=await v({...s,contents:q,assignedUser:D??s.assignedUser});return K&&q&&G(),K&&D!==void 0&&F(void 0),K},[G,w,v,D]);return e.jsx(Le,{role:"option","aria-selected":d,id:g,className:B("tw-w-full tw-rounded-none tw-border-none tw-p-4 tw-outline-none tw-transition-all tw-duration-200 focus:tw-ring-2 focus:tw-ring-ring focus:tw-ring-offset-1 focus:tw-ring-offset-background",{"tw-cursor-pointer hover:tw-shadow-md":!d},{"tw-bg-primary-foreground":!d&&h!=="Resolved","tw-bg-background":d&&h!=="Resolved","tw-bg-muted":h==="Resolved"}),onClick:()=>{P(g)},tabIndex:-1,children:e.jsxs(Ge,{className:"tw-flex tw-flex-col tw-gap-2 tw-p-0",children:[e.jsxs("div",{className:"tw-flex tw-flex-col tw-content-center tw-items-start tw-gap-4",children:[ie&&e.jsx(Se,{className:"tw-rounded-sm tw-bg-input tw-text-sm tw-font-normal tw-text-primary hover:tw-bg-input",children:ie}),e.jsxs("div",{className:"tw-flex tw-max-w-full tw-flex-wrap tw-items-baseline tw-gap-2",children:[e.jsxs("p",{ref:oe,className:B("tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-text-sm tw-font-normal tw-text-muted-foreground",{"tw-overflow-visible tw-text-clip tw-whitespace-normal tw-break-words":T},{"tw-whitespace-nowrap":!T}),children:[b," ",L.verse]}),U&&e.jsx(W,{variant:"ghost",size:"icon",onClick:s=>{s.stopPropagation(),N(!T)},className:"tw-text-muted-foreground tw-transition hover:tw-text-foreground","aria-label":T?"Collapse text":"Expand text",children:T?e.jsx(ue,{}):e.jsx(he,{})})]}),e.jsx(se,{comment:L,localizedStrings:l,isThreadExpanded:d,threadStatus:h,handleAddCommentToThread:qe,handleUpdateComment:j,handleDeleteComment:p,onEditingChange:C,canUserEditOrDeleteCommentCallback:u,canUserResolveThread:je})]}),e.jsxs(e.Fragment,{children:[Ue&&!d&&e.jsxs("div",{className:"tw-flex tw-items-center tw-gap-5",children:[e.jsx("div",{className:"tw-w-8",children:e.jsx(le,{})}),e.jsx("p",{className:"tw-text-sm tw-text-muted-foreground",children:De})]}),!d&&O(w)&&e.jsx(te,{editorSerializedState:w,onSerializedChange:s=>x(s),placeholder:l["%comment_replyOrAssign%"]}),d&&e.jsxs(e.Fragment,{children:[Z>0&&e.jsxs("div",{className:"tw-flex tw-cursor-pointer tw-items-center tw-gap-5 tw-py-2",onClick:s=>{s.stopPropagation(),f(!0)},role:"button",tabIndex:0,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),s.stopPropagation(),f(!0))},children:[e.jsx("div",{className:"tw-w-8",children:e.jsx(le,{})}),e.jsxs("div",{className:"tw-flex tw-items-center tw-gap-2",children:[e.jsx("p",{className:"tw-text-sm tw-text-muted-foreground",children:_e}),R?e.jsx(ue,{}):e.jsx(he,{})]})]}),Ee.map(s=>e.jsx("div",{children:e.jsx(se,{comment:s,localizedStrings:l,isReply:!0,isThreadExpanded:d,handleUpdateComment:j,handleDeleteComment:p,onEditingChange:C,canUserEditOrDeleteCommentCallback:u})},s.id)),t!==!1&&(!a||O(w))&&e.jsxs("div",{role:"textbox",tabIndex:-1,className:"tw-w-full tw-space-y-2",onClick:s=>s.stopPropagation(),onKeyDownCapture:s=>{s.key==="Enter"&&s.shiftKey&&(s.preventDefault(),s.stopPropagation(),(O(w)||D!==void 0)&&de())},onKeyDown:s=>{Ie(s),(s.key==="Enter"||s.key===" ")&&s.stopPropagation()},children:[e.jsx(te,{editorSerializedState:w,onSerializedChange:s=>x(s),placeholder:h==="Resolved"?l["%comment_reopenResolved%"]:l["%comment_replyOrAssign%"],autoFocus:!0,onClear:s=>{J.current=s}}),e.jsxs("div",{className:"tw-flex tw-flex-row tw-items-center tw-justify-end tw-gap-2",children:[D!==void 0&&e.jsx("span",{className:"tw-flex-1 tw-text-sm tw-text-muted-foreground",children:$(l["%comment_assigning_to%"]??"Assigning to: {assignedUser}",{assignedUser:Y(D,l)})}),e.jsxs($e,{open:A,onOpenChange:Q,children:[e.jsx(Fe,{asChild:!0,children:e.jsx(W,{size:"icon",variant:"outline",className:"tw-flex tw-items-center tw-justify-center tw-rounded-md",disabled:!Ae||!c||c.length===0||!c.includes(I),"aria-label":"Assign user",children:e.jsx(ct,{})})}),e.jsx(ze,{className:"tw-w-auto tw-p-0",align:"end",onKeyDown:s=>{s.key==="Escape"&&(s.stopPropagation(),Q(!1))},children:e.jsx(Je,{children:e.jsx(Ze,{children:c==null?void 0:c.map(s=>e.jsx(Xe,{onSelect:()=>{F(s!==S?s:void 0),Q(!1)},className:"tw-flex tw-items-center",children:e.jsx("span",{children:Y(s,l)})},s||"unassigned"))})})})]}),e.jsx(W,{size:"icon",onClick:de,className:"tw-flex tw-items-center tw-justify-center tw-rounded-md",disabled:!O(w)&&D===void 0,"aria-label":"Submit comment",children:e.jsx(ke,{})})]})]})]})]})]})})}Pe.__docgenInfo={description:`Represents a thread of comments

@props CommentThreadProps`,methods:[],displayName:"CommentThread",props:{comments:{required:!0,tsType:{name:"Array",elements:[{name:"LegacyComment"}],raw:"LegacyComment[]"},description:"Comments in the thread"},localizedStrings:{required:!0,tsType:{name:"LanguageStrings"},description:"Localized strings for the component"},isSelected:{required:!1,tsType:{name:"boolean"},description:"Whether the thread is selected",defaultValue:{value:"false",computed:!1}},verseRef:{required:!1,tsType:{name:"string"},description:"Verse reference for the thread"},currentUser:{required:!0,tsType:{name:"string"},description:"Name of the current user, retrieved from the current user's Paratext Registry user information"},assignedUser:{required:!1,tsType:{name:"string"},description:"User assigned to the thread"},handleSelectThread:{required:!0,tsType:{name:"signature",type:"function",raw:"(threadId: string) => void",signature:{arguments:[{type:{name:"string"},name:"threadId"}],return:{name:"void"}}},description:"Handler for selecting the thread"},threadId:{required:!0,tsType:{name:"string"},description:"ID of the thread"},threadStatus:{required:!1,tsType:{name:"CommentStatus"},description:"Status of the thread"},handleAddCommentToThread:{required:!0,tsType:{name:"signature",type:"function",raw:"(options: AddCommentToThreadOptions) => Promise<string | undefined>",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  /** The ID of the thread to add the comment to */
  threadId: string;
  /** The content of the comment (optional - can be omitted when only changing status or assignment) */
  contents?: string;
  /** Status to set on the thread ('Resolved' or 'Todo') */
  status?: CommentStatus;
  /** User to assign to the thread. Use "" for unassigned, "Team" for team assignment. */
  assignedUser?: string;
}`,signature:{properties:[{key:"threadId",value:{name:"string",required:!0},description:"The ID of the thread to add the comment to"},{key:"contents",value:{name:"string",required:!1},description:"The content of the comment (optional - can be omitted when only changing status or assignment)"},{key:"status",value:{name:"CommentStatus",required:!1},description:"Status to set on the thread ('Resolved' or 'Todo')"},{key:"assignedUser",value:{name:"string",required:!1},description:'User to assign to the thread. Use "" for unassigned, "Team" for team assignment.'}]}},name:"options"}],return:{name:"Promise",elements:[{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}],raw:"Promise<string | undefined>"}}},description:`Handler for adding a comment to a thread. This unified handler supports:

- Adding a comment (provide contents)
- Resolving/unresolving a thread (provide status: 'Resolved' or 'Todo')
- Assigning a user (provide assignedUser)
- Any combination of the above

If successful, returns the auto-generated comment ID (format: "threadId/userName/date").
Otherwise, returns undefined.`},handleUpdateComment:{required:!0,tsType:{name:"signature",type:"function",raw:"(commentId: string, contents: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"commentId"},{type:{name:"string"},name:"contents"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:"Handler for updating a comment's content"},handleDeleteComment:{required:!0,tsType:{name:"signature",type:"function",raw:"(commentId: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"commentId"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:"Handler for deleting a comment"},assignableUsers:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:`Users that can be assigned to threads. Includes special values: "Team" for team assignment, ""
(empty string) for unassigned.`},canUserAddCommentToThread:{required:!1,tsType:{name:"boolean"},description:`Whether the current user can add comments to existing threads in this project. When false, UI
elements for adding comments to threads should be hidden or disabled.`},canUserAssignThreadCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(threadId: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"threadId"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:`Callback to check if the current user can assign a specific thread. Returns a promise that
resolves to true if the user can assign the thread, false otherwise.`},canUserResolveThreadCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(threadId: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"threadId"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:`Callback to check if the current user can resolve or re-open a specific thread. Returns a
promise that resolves to true if the user can resolve the thread, false otherwise.`},canUserEditOrDeleteCommentCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(commentId: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"commentId"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:`Callback to check if the current user can edit or delete a specific comment. Returns a promise
that resolves to true if the user can edit or delete the comment, false otherwise.`}}};function ne({className:r="",threads:l,currentUser:d,localizedStrings:b,handleAddCommentToThread:S,handleUpdateComment:I,handleDeleteComment:P,assignableUsers:g,canUserAddCommentToThread:h,canUserAssignThreadCallback:v,canUserResolveThreadCallback:j,canUserEditOrDeleteCommentCallback:p}){const[c,t]=n.useState(),o=l.filter(m=>m.comments.some(R=>!R.deleted)),i=o.map(m=>({id:m.id})),u=n.useCallback(m=>{t(m.id)},[]),w=n.useCallback(m=>{t(m)},[]),{listboxRef:x,activeId:T,handleKeyDown:N}=lt({options:i,onOptionSelect:u}),U=n.useCallback(m=>{m.key==="Escape"?(t(void 0),m.preventDefault(),m.stopPropagation()):N(m)},[N]);return e.jsx("div",{id:"comment-list",role:"listbox",tabIndex:0,ref:x,"aria-activedescendant":T??void 0,"aria-label":"Comments",className:B("tw-flex tw-w-full tw-flex-col tw-space-y-3 tw-outline-none focus:tw-ring-2 focus:tw-ring-ring focus:tw-ring-offset-1 focus:tw-ring-offset-background",r),onKeyDown:U,children:o.map(m=>e.jsx("div",{className:B({"tw-opacity-60":m.status==="Resolved"}),children:e.jsx(Pe,{comments:m.comments,localizedStrings:b,verseRef:m.verseRef,handleSelectThread:w,threadId:m.id,isSelected:c===m.id,currentUser:d,assignedUser:m.assignedUser,threadStatus:m.status,handleAddCommentToThread:S,handleUpdateComment:I,handleDeleteComment:P,assignableUsers:g,canUserAddCommentToThread:h,canUserAssignThreadCallback:v,canUserResolveThreadCallback:j,canUserEditOrDeleteCommentCallback:p})},m.id))})}ne.__docgenInfo={description:`Component for rendering a list of comment threads

@param CommentListProps Props for the CommentList component`,methods:[],displayName:"CommentList",props:{className:{required:!1,tsType:{name:"string"},description:"Additional class name for the component",defaultValue:{value:"''",computed:!1}},threads:{required:!0,tsType:{name:"Array",elements:[{name:"LegacyCommentThread"}],raw:"LegacyCommentThread[]"},description:"Comment threads to render"},currentUser:{required:!0,tsType:{name:"string"},description:"Name of the current user, retrieved from the current user's Paratext Registry user information"},localizedStrings:{required:!0,tsType:{name:"LanguageStrings"},description:"Localized strings for the component"},handleAddCommentToThread:{required:!0,tsType:{name:"signature",type:"function",raw:"(options: AddCommentToThreadOptions) => Promise<string | undefined>",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  /** The ID of the thread to add the comment to */
  threadId: string;
  /** The content of the comment (optional - can be omitted when only changing status or assignment) */
  contents?: string;
  /** Status to set on the thread ('Resolved' or 'Todo') */
  status?: CommentStatus;
  /** User to assign to the thread. Use "" for unassigned, "Team" for team assignment. */
  assignedUser?: string;
}`,signature:{properties:[{key:"threadId",value:{name:"string",required:!0},description:"The ID of the thread to add the comment to"},{key:"contents",value:{name:"string",required:!1},description:"The content of the comment (optional - can be omitted when only changing status or assignment)"},{key:"status",value:{name:"CommentStatus",required:!1},description:"Status to set on the thread ('Resolved' or 'Todo')"},{key:"assignedUser",value:{name:"string",required:!1},description:'User to assign to the thread. Use "" for unassigned, "Team" for team assignment.'}]}},name:"options"}],return:{name:"Promise",elements:[{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}],raw:"Promise<string | undefined>"}}},description:`Handler for adding a comment to a thread. This unified handler supports:

- Adding a comment (provide contents)
- Resolving/unresolving a thread (provide status: 'Resolved' or 'Todo')
- Assigning a user (provide assignedUser)
- Any combination of the above

If successful, returns the auto-generated comment ID (format: "threadId/userName/date").
Otherwise, returns undefined.`},handleUpdateComment:{required:!0,tsType:{name:"signature",type:"function",raw:"(commentId: string, contents: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"commentId"},{type:{name:"string"},name:"contents"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:"Handler for updating a comment's content"},handleDeleteComment:{required:!0,tsType:{name:"signature",type:"function",raw:"(commentId: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"commentId"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:"Handler for deleting a comment"},assignableUsers:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:`Users that can be assigned to threads. Includes special values: "Team" for team assignment, ""
(empty string) for unassigned.`},canUserAddCommentToThread:{required:!1,tsType:{name:"boolean"},description:`Whether the current user can add comments to existing threads in this project. When false, UI
elements for adding comments to threads should be hidden or disabled.`},canUserAssignThreadCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(threadId: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"threadId"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:`Callback to check if the current user can assign a specific thread. Returns a promise that
resolves to true if the user can assign the thread, false otherwise.`},canUserResolveThreadCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(threadId: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"threadId"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:`Callback to check if the current user can resolve or re-open a specific thread. Returns a
promise that resolves to true if the user can resolve the thread, false otherwise.`},canUserEditOrDeleteCommentCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(commentId: string) => Promise<boolean>",signature:{arguments:[{type:{name:"string"},name:"commentId"}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:`Callback to check if the current user can edit or delete a specific comment. Returns a promise
that resolves to true if the user can edit or delete the comment, false otherwise.`}}};const y=new Date,E=new Date(y);E.setDate(E.getDate()-1);const k=new Date(y);k.setDate(k.getDate()-2);const Ne=[{id:"thread-1",comments:[{id:"1",user:"Charlie Delta",contents:"<p>Consider revising this portion for clarity:</p><blockquote>God is our refuge</blockquote><p>Maybe we could expand on what &ldquo;refuge&rdquo; means in this context? Some target languages might need a more explicit description.</p>",date:E.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-1",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:"God is our refuge"},{id:"2",user:"Beth Bee",contents:'<p>I agree with Charlie. In some languages, the word for "refuge" might not exist, so we may need to use a descriptive phrase like <strong>safe place</strong> or <em>shelter from danger</em>.</p>',date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-1",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:""},{id:"3",user:"David Echo",contents:'<p>Good points! Let&apos;s make sure to add a note for translators about this. Also, should we clarify what "trouble" means in this context?</p>',date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-1",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:""}],status:"Unspecified",type:"Normal",assignedUser:"",replyToUser:"",modifiedDate:E.toISOString(),verseRef:"PSA 46:1",contextScrTextName:"WEB",isSpellingNote:!1,isBTNote:!1,isConsultantNote:!1},{id:"thread-2",comments:[{id:"4",user:"Eve Fox",contents:'<h1>Translation Workshop Notes</h1><h2>1. Key terms identified:</h2><ul><li>refuge (<span dir="rtl">מַחֲסֶה</span>)</li><li>strength (<span dir="rtl">עֹז</span>)</li><li>trouble (<span dir="rtl">צָרָה</span>)</li></ul><h2>2. Alternative renderings to consider:</h2><ul><li>&ldquo;safe place&rdquo; for &ldquo;refuge&rdquo;</li><li>&ldquo;power&rdquo; for &ldquo;strength&rdquo;</li><li>&ldquo;difficult times&rdquo; for &ldquo;trouble&rdquo;</li></ul><h2>3. Cultural considerations:</h2><ul><li>Military imagery</li><li>Ancient city fortifications</li><li>Divine protection metaphors</li></ul>',date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-2",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:""},{id:"5",user:"Charlie Delta",contents:"<p>Thanks for the summary, Eve! I think the cultural notes are especially helpful for teams working in different regions.</p>",date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-2",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:""},{id:"6",user:"Beth Bee",contents:"<p>One more suggestion: should we add a note about the poetic structure of this Psalms? It might help translators preserve the literary feel.</p>",date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-2",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:""}],status:"Todo",type:"Normal",assignedUser:"Frank Graham",replyToUser:"",modifiedDate:y.toISOString(),verseRef:"PSA 46:1",contextScrTextName:"WEB",isSpellingNote:!1,isBTNote:!0,isConsultantNote:!1},{id:"thread-3",comments:[{id:"7",user:"Frank Graham",contents:"<p>This verse is a great encouragement. No changes needed from my side.</p>",date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-3",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:""}],status:"Todo",type:"Normal",assignedUser:"",replyToUser:"",modifiedDate:y.toISOString(),verseRef:"PSA 46:1",contextScrTextName:"WEB",isSpellingNote:!1,isBTNote:!1,isConsultantNote:!1},{id:"thread-4",comments:[{id:"8",user:"Allison Park",contents:"<p>Thanks for the summary, Eve! I think the cultural notes are especially helpful for teams working in different regions.</p>",date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-4",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:""}],status:"Todo",type:"Normal",assignedUser:"",replyToUser:"",modifiedDate:y.toISOString(),verseRef:"PSA 46:1",contextScrTextName:"WEB",isSpellingNote:!1,isBTNote:!1,isConsultantNote:!1},{id:"thread-5",comments:[{id:"9a",user:"Jane Doe",contents:"<p>This verse is a great encouragement. No changes needed from my side.</p>",date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-5",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:""},{id:"9b",user:"Checker One",contents:"Agreed, resolving this thread.",date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-5",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:"",status:"Resolved"},{id:"9c",user:"Checker Two",contents:"I believe we should reconsider",date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-5",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:"",status:"Todo"},{id:"9d",user:"Checker One",contents:"As discussed offline, we can resolve this thread",date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-5",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:"",status:"Resolved"},{id:"9e",user:"Checker Two",date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-5",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:"",status:"Todo",contents:""},{id:"9f",user:"Checker One",date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-5",verse:"God is our refuge and strength, an ever-present help in trouble.",verseRef:"PSA 46:1",selectedText:"",status:"Resolved",contents:""}],status:"Resolved",type:"Normal",assignedUser:"",replyToUser:"",modifiedDate:y.toISOString(),verseRef:"PSA 46:1",contextScrTextName:"WEB",isSpellingNote:!1,isBTNote:!1,isConsultantNote:!1},{id:"thread-6",comments:[{id:"10",user:"Grace Hill",contents:`<p>This verse presents some interesting translation challenges. The phrase "will not fear" is an emphatic statement in Hebrew. How should we handle this in languages that don't have this kind of emphatic negation?</p>`,date:E.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-6",verse:"Therefore we will not fear, though the earth be removed, and though the mountains be carried into the midst of the sea;",verseRef:"PSA 46:2",selectedText:"will not fear"},{id:"11",user:"Allison Park",contents:`<p>Great question! I think we need to consider the emotional intensity here. The Hebrew (<span dir="rtl">לֹא נִירָא</span>) is more than just "we will not be afraid" - it's almost defiant in its confidence.</p>`,date:E.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-6",verse:"Therefore we will not fear, though the earth be removed, and though the mountains be carried into the midst of the sea;",verseRef:"PSA 46:2",selectedText:""},{id:"12",user:"David Echo",contents:'<p>The apocalyptic imagery here is also striking - "earth be removed" and "mountains carried into the sea." These are cosmic upheavals that represent the most extreme circumstances possible. Should we maintain this hyperbolic language or adapt it for cultures unfamiliar with such imagery?</p>',date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-6",verse:"Therefore we will not fear, though the earth be removed, and though the mountains be carried into the midst of the sea;",verseRef:"PSA 46:2",selectedText:"earth be removed, and though the mountains be carried into the midst of the sea"}],status:"Todo",type:"Normal",assignedUser:"Grace Hill",replyToUser:"",modifiedDate:y.toISOString(),verseRef:"PSA 46:2",contextScrTextName:"WEB",isSpellingNote:!1,isBTNote:!1,isConsultantNote:!1},{id:"thread-7",comments:[{id:"13",user:"Henry Kim",contents:"<p>The river imagery in this verse is beautiful, but I'm wondering about the cultural context. In ancient Jerusalem, there wasn't a major river. This seems to be referring to something beyond the literal geography.</p>",date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-7",verse:"There is a river, the streams of which make glad the city of God, the holy place of the tabernacles of the Most High.",verseRef:"PSA 46:4",selectedText:"There is a river, the streams of which"},{id:"14",user:"Beth Bee",contents:`<p>You're absolutely right, Henry. This is likely referencing the river of life or divine blessing - perhaps drawing on Eden imagery or eschatological themes. The Hebrew word for "streams" (<span dir="rtl">פְּלָגָיו</span>) suggests channels or divisions of water that bring life and prosperity.</p>`,date:E.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-7",verse:"There is a river, the streams of which make glad the city of God, the holy place of the tabernacles of the Most High.",verseRef:"PSA 46:4",selectedText:""},{id:"15",user:"Eve Fox",contents:`<p>This connects beautifully with the temple imagery - "the holy place of the tabernacles of the Most High." Should we add a note explaining that this isn't referring to temporary structures but to God's eternal dwelling place?</p>`,date:E.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-7",verse:"There is a river, the streams of which make glad the city of God, the holy place of the tabernacles of the Most High.",verseRef:"PSA 46:4",selectedText:"the holy place of the tabernacles of the Most High"},{id:"16",user:"Charlie Delta",contents:`<p>I think we should also consider how to translate "make glad" (<span dir="rtl">יְשַׂמְּחוּ</span>). It's more than just happiness - it's a deep joy and celebration. Some languages might need a stronger expression than just "make happy."</p>`,date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-7",verse:"There is a river, the streams of which make glad the city of God, the holy place of the tabernacles of the Most High.",verseRef:"PSA 46:4",selectedText:"make glad"}],status:"Unspecified",type:"Normal",assignedUser:"Henry Kim",replyToUser:"",modifiedDate:y.toISOString(),verseRef:"PSA 46:4",contextScrTextName:"WEB",isSpellingNote:!1,isBTNote:!1,isConsultantNote:!0},{id:"thread-8",comments:[{id:"17",user:"Tim Steenwyk",contents:"This is a note with <b>bold text</b> and <i>italic text</i>.</p><p>It also has <u>underlined</u> and <s>strikethrough</s> text.",date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-8",verse:"\\v 1 When people had spread all over the world...",verseRef:"GEN 6:1",selectedText:""},{id:"18",user:"Beth Bee",contents:"<p>This is a reply with <b>bold</b> and <i><b>bold italic</b></i> formatting.</p>",date:E.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-8",verse:"",verseRef:"GEN 6:1",selectedText:""},{id:"19",user:"Charlie Delta",contents:"<p>Another reply with <u>underline</u> and <s>strikethrough</s> combined: <u><s>both</s></u>.</p>",date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-8",verse:"",verseRef:"GEN 6:1",selectedText:""},{id:"100",user:"Charlie Delta",contents:"<p>Another reply with <u>underline</u> and <s>strikethrough</s> combined: <u><s>both</s></u>.</p>",date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-8",verse:"",verseRef:"GEN 6:1",selectedText:""},{id:"101",user:"Charlie Delta",contents:"<p>Another reply with <u>underline</u> and <s>strikethrough</s> combined: <u><s>both</s></u>.</p>",date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-8",verse:"",verseRef:"GEN 6:1",selectedText:""},{id:"102",user:"Charlie Delta",contents:"<p>Another reply with <u>underline</u> and <s>strikethrough</s> combined: <u><s>both</s></u>.</p>",date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-8",verse:"",verseRef:"GEN 6:1",selectedText:""},{id:"103",user:"Charlie Delta",contents:"<p>Another reply with <u>underline</u> and <s>strikethrough</s> combined: <u><s>both</s></u>.</p>",date:y.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-8",verse:"",verseRef:"GEN 6:1",selectedText:""}],status:"Todo",type:"Normal",assignedUser:"",replyToUser:"",modifiedDate:y.toISOString(),verseRef:"GEN 6:1",contextScrTextName:"WEB",isSpellingNote:!1,isBTNote:!1,isConsultantNote:!1},{id:"thread-9",comments:[{id:"20",user:"Tim Steenwyk",contents:`Two different people made conflicting changes in this verse.<p><language name="es-015-vaidika"><p>\\v 9 Moses said to the <s><color name="red">large group of </color></s>people, "While we were still at Mount Sinai, I told you, 'The responsibility for leading you is too much for me. I can't do it alone. </p></language></p>This <color name="green">is</color> <color name="blue">a</color> <strikethrough>new</strikethrough> paragraph</p>`,date:k.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-9",verse:'\\v 9 Moses said to the people, "While we were still at Mount Sinai..."',verseRef:"DEU 1:9",selectedText:""}],status:"Todo",type:"Normal",assignedUser:"",replyToUser:"",modifiedDate:k.toISOString(),verseRef:"DEU 1:9",contextScrTextName:"WEB",isSpellingNote:!1,isBTNote:!1,isConsultantNote:!1},{id:"thread-10",comments:[{id:"21",user:"Eve Fox",contents:'<p>This is my note with <language name="es-015-vaidika">Spanish text</language> embedded.</p>',date:E.toISOString(),deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,thread:"thread-10",verse:"\\v 18 and cried out as they saw the smoke from the flames...",verseRef:"REV 18:18",selectedText:""}],status:"Resolved",type:"Normal",assignedUser:"",replyToUser:"",modifiedDate:E.toISOString(),verseRef:"REV 18:18",contextScrTextName:"WEB",isSpellingNote:!1,isBTNote:!1,isConsultantNote:!1}],ft={"%comment_assign_team%":"Team","%comment_assign_unassigned%":"Unassigned","%comment_assigned_to%":"Assigned to {assignedUser}","%comment_assigning_to%":"Assigning to: {assignedUser}","%comment_dateAtTime%":"{date} at {time}","%comment_date_today%":"today","%comment_date_yesterday%":"yesterday","%comment_deleteComment%":"Delete Comment","%comment_editComment%":"Edit Comment","%comment_reopenResolved%":"Adding a comment will re-open this discussion...","%comment_replyOrAssign%":"Reply or assign with @","%comment_status_resolved%":"Marked as resolved","%comment_status_todo%":"Re-opened","%comment_thread_multiple_replies%":"{count} replies","%comment_thread_single_reply%":"1 reply","%no_comments%":"No comments yet"},pt=["","Team","Alice","Bob","Charlie","Current User"];function Re({initialThreads:r,canUserAddCommentToThread:l=!0,canUserAssignThreadCallback:d,canUserResolveThreadCallback:b,canUserEditOrDeleteCommentCallback:S}){const[I,P]=n.useState(r),g=async p=>{const{threadId:c,contents:t,status:o,assignedUser:i}=p;console.log(`Adding comment to thread ${c}`,{contents:t,status:o,assignedUser:i});let u;return P(w=>w.map(x=>{if(x.id===c){u=`${x.id}-${Date.now()}`;let T=o;!T&&x.status==="Resolved"&&(T="Todo");const N={id:u,user:"Current User",date:new Date().toISOString(),contents:t??"",deleted:!1,hideInTextWindow:!1,language:"en",startPosition:0,selectedText:"",contextBefore:"",contextAfter:"",thread:x.id,verseRef:x.verseRef,...T&&{status:T},...i!==void 0&&{assignedUser:i}};return{...x,comments:[...x.comments,N],...T&&{status:T},...i!==void 0&&{assignedUser:i}}}return x})),u},h=async(p,c)=>{console.log(`Updating comment id ${p} with contents: ${c}`);let t=!1;return P(o=>o.map(i=>({...i,comments:i.comments.map(u=>u.id===p?(t=!0,{...u,contents:c}):u)}))),t},v=async p=>{console.log(`Deleting comment id ${p}`);let c=!1;return P(t=>t.map(o=>({...o,comments:o.comments.map(i=>i.id===p?(c=!0,{...i,deleted:!0}):i)}))),c},j=n.useMemo(()=>async p=>{console.log(`Checking if user can edit/delete comment ${p}`);const c=I.flatMap(t=>t.comments).find(t=>t.id===p&&!t.deleted);return(c==null?void 0:c.user)==="Current User"},[I]);return e.jsx(ne,{threads:I,localizedStrings:ft,currentUser:"Current User",handleAddCommentToThread:g,handleUpdateComment:h,handleDeleteComment:v,assignableUsers:pt,canUserAddCommentToThread:l,canUserAssignThreadCallback:d,canUserResolveThreadCallback:b,canUserEditOrDeleteCommentCallback:S??j})}const xs={title:"Advanced/CommentList",component:ne,tags:["autodocs"],decorators:[r=>e.jsx(We,{children:e.jsx(r,{})})],argTypes:{threads:{control:"object"},className:{control:"text"}}},X={render:()=>e.jsx(Re,{initialThreads:Ne,canUserAssignThreadCallback:async r=>(console.log(`Checking if user can assign thread ${r}`),!0),canUserResolveThreadCallback:async r=>(console.log(`Checking if user can resolve thread ${r}`),!0)})},V={render:()=>e.jsx(Re,{initialThreads:Ne,canUserAddCommentToThread:!1,canUserAssignThreadCallback:async()=>!1,canUserResolveThreadCallback:async()=>!1,canUserEditOrDeleteCommentCallback:async()=>!1})};var pe,ge,we;X.parameters={...X.parameters,docs:{...(pe=X.parameters)==null?void 0:pe.docs,source:{originalSource:`{
  render: () => <CommentListStory initialThreads={sampleComments} canUserAssignThreadCallback={async threadId => {
    console.log(\`Checking if user can assign thread \${threadId}\`);
    return true;
  }} canUserResolveThreadCallback={async threadId => {
    console.log(\`Checking if user can resolve thread \${threadId}\`);
    return true;
  }} />
}`,...(we=(ge=X.parameters)==null?void 0:ge.docs)==null?void 0:we.source}}};var ye,ve,xe,Te,be;V.parameters={...V.parameters,docs:{...(ye=V.parameters)==null?void 0:ye.docs,source:{originalSource:`{
  render: () => <CommentListStory initialThreads={sampleComments} canUserAddCommentToThread={false} canUserAssignThreadCallback={async () => false} canUserResolveThreadCallback={async () => false} canUserEditOrDeleteCommentCallback={async () => false} />
}`,...(xe=(ve=V.parameters)==null?void 0:ve.docs)==null?void 0:xe.source},description:{story:"Story demonstrating restricted permissions - user cannot add comments, assign, or resolve",...(be=(Te=V.parameters)==null?void 0:Te.docs)==null?void 0:be.description}}};const Ts=["Default","RestrictedPermissions"];export{X as Default,V as RestrictedPermissions,Ts as __namedExportsOrder,xs as default};
