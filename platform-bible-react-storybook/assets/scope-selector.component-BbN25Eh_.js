import{j as n}from"./jsx-runtime-CoJcBlqr.js";import{g as z,d as ee,a as te,B as ne,b as oe,c as se}from"./book-item.utils-B3g7WYdO.js";import{B as M}from"./badge-CK0yIiXb.js";import{B as N}from"./button-BOi5X0CC.js";import{C as re,a as ae,c as ie,b as ce,e as le,f as ue}from"./command-CVOFFHX5.js";import{P as me,a as pe,b as de}from"./popover-Ctsr1WcE.js";import{m as C}from"./index.es-D4jfZzAn.js";import{I as S,V as p}from"./index-BYC3xje7.js";import{r as h}from"./iframe-ChjBVkNN.js";import{c as he}from"./shadcn-ui.util-DMJ19wEV.js";import{C as fe}from"./chevrons-up-down-kNT_6Df3.js";import{L as D}from"./label-DboBKY13.js";import{R as we,a as ge}from"./radio-group-DQUaKhOG.js";const R=(r,t)=>r.filter(i=>{try{return S(i)===t}catch{return!1}}),F=(r,t,i)=>R(r,t).every(o=>i.includes(o));function $({section:r,availableBookIds:t,selectedBookIds:i,onToggle:o,localizedStrings:l}){const w=R(t,r).length===0,u=l["%scripture_section_ot_short%"],_=l["%scripture_section_nt_short%"],x=l["%scripture_section_dc_short%"],y=l["%scripture_section_extra_short%"];return n.jsx(N,{variant:"outline",size:"sm",onClick:()=>o(r),className:he(F(t,r,i)&&!w&&"tw-bg-primary tw-text-primary-foreground hover:tw-bg-primary/70 hover:tw-text-primary-foreground"),disabled:w,children:z(r,u,_,x,y)})}$.__docgenInfo={description:`A button component that represents a scripture section (testament) in the book selector. The
button shows a different state when all books in its section are selected and becomes disabled
when no books are available in its section.`,methods:[],displayName:"SectionButton",props:{section:{required:!0,tsType:{name:"Section"},description:""},availableBookIds:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},selectedBookIds:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},onToggle:{required:!0,tsType:{name:"signature",type:"function",raw:"(section: Section) => void",signature:{arguments:[{type:{name:"Section"},name:"section"}],return:{name:"void"}}},description:""},localizedStrings:{required:!0,tsType:{name:"LanguageStrings"},description:""}}};const G=5,I=6;function Y({availableBookInfo:r,selectedBookIds:t,onChangeSelectedBookIds:i,localizedStrings:o,localizedBookNames:l}){const w=o["%webView_book_selector_books_selected%"],u=o["%webView_book_selector_select_books%"],_=o["%webView_book_selector_search_books%"],x=o["%webView_book_selector_select_all%"],y=o["%webView_book_selector_clear_all%"],B=o["%webView_book_selector_no_book_found%"],E=o["%webView_book_selector_more%"],{otLong:V,ntLong:O,dcLong:q,extraLong:T}={otLong:o==null?void 0:o["%scripture_section_ot_long%"],ntLong:o==null?void 0:o["%scripture_section_nt_long%"],dcLong:o==null?void 0:o["%scripture_section_dc_long%"],extraLong:o==null?void 0:o["%scripture_section_extra_long%"]},[j,v]=h.useState(!1),[g,b]=h.useState(""),L=h.useRef(void 0),A=h.useRef(!1);if(r.length!==C.allBookIds.length)throw new Error("availableBookInfo length must match Canon.allBookIds length");const m=h.useMemo(()=>C.allBookIds.filter((e,c)=>r[c]==="1"&&!C.isObsolete(C.bookIdToNumber(e))),[r]),Q=h.useMemo(()=>{if(!g.trim()){const s={[p.OT]:[],[p.NT]:[],[p.DC]:[],[p.Extra]:[]};return m.forEach(a=>{const k=S(a);s[k].push(a)}),s}const e=m.filter(s=>ee(s,g,l)),c={[p.OT]:[],[p.NT]:[],[p.DC]:[],[p.Extra]:[]};return e.forEach(s=>{const a=S(s);c[a].push(s)}),c},[m,g,l]),P=h.useCallback((e,c=!1)=>{if(!c||!L.current){i(t.includes(e)?t.filter(d=>d!==e):[...t,e]),L.current=e;return}const s=m.findIndex(d=>d===L.current),a=m.findIndex(d=>d===e);if(s===-1||a===-1)return;const[k,Z]=[Math.min(s,a),Math.max(s,a)],K=m.slice(k,Z+1).map(d=>d);i(t.includes(e)?t.filter(d=>!K.includes(d)):[...new Set([...t,...K])])},[t,i,m]),U=e=>{P(e,A.current),A.current=!1},W=(e,c)=>{e.preventDefault(),P(c,e.shiftKey)},X=h.useCallback(e=>{const c=R(m,e).map(s=>s);i(F(m,e,t)?t.filter(s=>!c.includes(s)):[...new Set([...t,...c])])},[t,i,m]),H=()=>{i(m.map(e=>e))},J=()=>{i([])};return n.jsxs("div",{className:"tw-space-y-2",children:[n.jsx("div",{className:"tw-flex tw-flex-wrap tw-gap-2",children:Object.values(p).map(e=>n.jsx($,{section:e,availableBookIds:m,selectedBookIds:t,onToggle:X,localizedStrings:o},e))}),n.jsxs(me,{open:j,onOpenChange:e=>{v(e),e||b("")},children:[n.jsx(pe,{asChild:!0,children:n.jsxs(N,{variant:"outline",role:"combobox","aria-expanded":j,className:"tw-max-w-64 tw-justify-between",children:[t.length>0?`${w}: ${t.length}`:u,n.jsx(fe,{className:"tw-ml-2 tw-h-4 tw-w-4 tw-shrink-0 tw-opacity-50"})]})}),n.jsx(de,{className:"tw-w-full tw-p-0",align:"start",children:n.jsxs(re,{shouldFilter:!1,onKeyDown:e=>{e.key==="Enter"&&(A.current=e.shiftKey)},children:[n.jsx(ae,{placeholder:_,value:g,onValueChange:b}),n.jsxs("div",{className:"tw-flex tw-justify-between tw-border-b tw-p-2",children:[n.jsx(N,{variant:"ghost",size:"sm",onClick:H,children:x}),n.jsx(N,{variant:"ghost",size:"sm",onClick:J,children:y})]}),n.jsxs(ie,{children:[n.jsx(ce,{children:B}),Object.values(p).map((e,c)=>{const s=Q[e];if(s.length!==0)return n.jsxs(h.Fragment,{children:[n.jsx(le,{heading:te(e,V,O,q,T),children:s.map(a=>n.jsx(ne,{bookId:a,isSelected:t.includes(a),onSelect:()=>U(a),onMouseDown:k=>W(k,a),section:S(a),showCheck:!0,localizedBookNames:l,commandValue:oe(a,l),className:"tw-flex tw-items-center"},a))}),c<Object.values(p).length-1&&n.jsx(ue,{})]},e)})]})]})})]}),t.length>0&&n.jsxs("div",{className:"tw-mt-2 tw-flex tw-flex-wrap tw-gap-1",children:[t.slice(0,t.length===I?I:G).map(e=>n.jsx(M,{className:"hover:tw-bg-secondary",variant:"secondary",children:se(e,l)},e)),t.length>I&&n.jsx(M,{className:"hover:tw-bg-secondary",variant:"secondary",children:`+${t.length-G} ${E}`})]})]})}Y.__docgenInfo={description:`A component for selecting multiple books from the Bible canon. It provides:

- Quick selection buttons for major sections (OT, NT, DC, Extra)
- A searchable dropdown with all available books
- Support for shift-click range selection
- Visual feedback with badges showing selected books`,methods:[],displayName:"BookSelector",props:{availableBookInfo:{required:!0,tsType:{name:"string"},description:`Information about available books, formatted as a 123 character long string as defined in a
projects BooksPresent setting`},selectedBookIds:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Array of currently selected book IDs"},onChangeSelectedBookIds:{required:!0,tsType:{name:"signature",type:"function",raw:"(books: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"books"}],return:{name:"void"}}},description:"Callback function that is executed when the book selection changes"},localizedStrings:{required:!0,tsType:{name:"LanguageStrings"},description:"Object containing the localized strings for the component"},localizedBookNames:{required:!1,tsType:{name:"Map",elements:[{name:"string"},{name:"signature",type:"object",raw:"{ localizedId: string; localizedName: string }",signature:{properties:[{key:"localizedId",value:{name:"string",required:!0}},{key:"localizedName",value:{name:"string",required:!0}}]}}],raw:"Map<string, { localizedId: string; localizedName: string }>"},description:`Optional map of localized book IDs/short names and full names. Key is the (English) book ID,
value contains localized versions of the ID and full book name`}}};const f=(r,t)=>r[t]??t;function be({scope:r,availableScopes:t,onScopeChange:i,availableBookInfo:o,selectedBookIds:l,onSelectedBookIdsChange:w,localizedStrings:u,localizedBookNames:_}){const x=f(u,"%webView_scope_selector_selected_text%"),y=f(u,"%webView_scope_selector_current_verse%"),B=f(u,"%webView_scope_selector_current_chapter%"),E=f(u,"%webView_scope_selector_current_book%"),V=f(u,"%webView_scope_selector_choose_books%"),O=f(u,"%webView_scope_selector_scope%"),q=f(u,"%webView_scope_selector_select_books%"),T=[{value:"selectedText",label:x,id:"scope-selected-text"},{value:"verse",label:y,id:"scope-verse"},{value:"chapter",label:B,id:"scope-chapter"},{value:"book",label:E,id:"scope-book"},{value:"selectedBooks",label:V,id:"scope-selected"}],j=t?T.filter(v=>t.includes(v.value)):T;return n.jsxs("div",{className:"tw-grid tw-gap-4",children:[n.jsxs("div",{className:"tw-grid tw-gap-2",children:[n.jsx(D,{children:O}),n.jsx(we,{value:r,onValueChange:i,className:"tw-flex tw-flex-col tw-space-y-1",children:j.map(({value:v,label:g,id:b})=>n.jsxs("div",{className:"tw-flex tw-items-center",children:[n.jsx(ge,{className:"tw-me-2",value:v,id:b}),n.jsx(D,{htmlFor:b,children:g})]},b))})]}),r==="selectedBooks"&&n.jsxs("div",{className:"tw-grid tw-gap-2",children:[n.jsx(D,{children:q}),n.jsx(Y,{availableBookInfo:o,selectedBookIds:l,onChangeSelectedBookIds:w,localizedStrings:u,localizedBookNames:_})]})]})}be.__docgenInfo={description:`A component that allows users to select the scope of their search or operation. Available scopes
are defined in the Scope type. When 'selectedBooks' is chosen as the scope, a BookSelector
component is displayed to allow users to choose specific books.`,methods:[],displayName:"ScopeSelector",props:{scope:{required:!0,tsType:{name:"union",raw:"'selectedText' | 'verse' | 'chapter' | 'book' | 'selectedBooks'",elements:[{name:"literal",value:"'selectedText'"},{name:"literal",value:"'verse'"},{name:"literal",value:"'chapter'"},{name:"literal",value:"'book'"},{name:"literal",value:"'selectedBooks'"}]},description:"The current scope selection"},availableScopes:{required:!1,tsType:{name:"Array",elements:[{name:"union",raw:"'selectedText' | 'verse' | 'chapter' | 'book' | 'selectedBooks'",elements:[{name:"literal",value:"'selectedText'"},{name:"literal",value:"'verse'"},{name:"literal",value:"'chapter'"},{name:"literal",value:"'book'"},{name:"literal",value:"'selectedBooks'"}]}],raw:"Scope[]"},description:`Optional array of scopes that should be available in the selector. If not provided, all scopes
will be shown as defined in the Scope type`},onScopeChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(scope: Scope) => void",signature:{arguments:[{type:{name:"union",raw:"'selectedText' | 'verse' | 'chapter' | 'book' | 'selectedBooks'",elements:[{name:"literal",value:"'selectedText'"},{name:"literal",value:"'verse'"},{name:"literal",value:"'chapter'"},{name:"literal",value:"'book'"},{name:"literal",value:"'selectedBooks'"}]},name:"scope"}],return:{name:"void"}}},description:"Callback function that is executed when the user changes the scope selection"},availableBookInfo:{required:!0,tsType:{name:"string"},description:`Information about available books, formatted as a 123 character long string as defined in a
projects BooksPresent setting`},selectedBookIds:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Array of currently selected book IDs"},onSelectedBookIdsChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(books: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"books"}],return:{name:"void"}}},description:"Callback function that is executed when the user changes the book selection"},localizedStrings:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  [localizedInventoryKey in (typeof SCOPE_SELECTOR_STRING_KEYS)[number]]?: LocalizedStringValue;
}`,signature:{properties:[{key:{name:"unknown[number]",raw:"(typeof SCOPE_SELECTOR_STRING_KEYS)[number]",required:!1},value:{name:"LocalizedStringValue"}}]}},description:`Object with all localized strings that the component needs to work well across multiple
languages. When using this component with Platform.Bible, you can import
\`SCOPE_SELECTOR_STRING_KEYS\` from this library, pass it in to the Platform's localization hook,
and pass the localized keys that are returned by the hook into this prop.`},localizedBookNames:{required:!1,tsType:{name:"Map",elements:[{name:"string"},{name:"signature",type:"object",raw:"{ localizedId: string; localizedName: string }",signature:{properties:[{key:"localizedId",value:{name:"string",required:!0}},{key:"localizedName",value:{name:"string",required:!0}}]}}],raw:"Map<string, { localizedId: string; localizedName: string }>"},description:`Optional map of localized book IDs/short names and full names. Key is the (English) book ID,
value contains localized versions of the ID and full book name`}}};export{be as S};
