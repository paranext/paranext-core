import{j as e}from"./jsx-runtime-OC_yph0f.js";import{T as z}from"./theme-provider.component-CWGtQUya.js";import{f as M,a as l,e as G,E as H,b as Y}from"./editor-utils-WZzluS32.js";import{B as p}from"./button-2Q6aW_9a.js";import{C as F,c as V,e as X}from"./command-ChsrnxHP.js";import{P as J,a as Q,b as W}from"./popover-BR0vmTNe.js";import{a as w,T as v,b as y,c as E}from"./tooltip-B5EMq53r.js";import{r}from"./iframe-Dn3862X1.js";import{X as Z}from"./x-BY_nSEsc.js";import{C as $}from"./check-mwtt6bMQ.js";import{A as ee}from"./at-sign-bbMXUZYi.js";import"./LexicalTable.prod-Bx8kQc-9.js";import"./index-D5O37xxx.js";import"./index-CuccKubN.js";import"./dialog-CKB44IkA.js";import"./index-0PSTLMI2.js";import"./index-lrwRjhGk.js";import"./index-D7x_8tUn.js";import"./index-1otjnLda.js";import"./index-B97dyP38.js";import"./index-Ds8hqRul.js";import"./index-CdJf_JjT.js";import"./index-BnwTJjkD.js";import"./index-Dr1TR8Sj.js";import"./shadcn-ui.util-DMJ19wEV.js";import"./toggle-group-C-8eXwYj.js";import"./index-BogT6mma.js";import"./index-evTXTta6.js";import"./index-DTAXz6r9.js";import"./index-6uKBdhrz.js";import"./index-C8bfH76m.js";import"./index-BPbCuWFR.js";import"./underline-VuLT2DlV.js";import"./createLucideIcon-B5zlVdyv.js";import"./index-BDIuYoBs.js";import"./search-BcEqID32.js";import"./index-XtPmYU_4.js";import"./floating-ui.react-dom-BijFbX0N.js";import"./index-BDRRccMN.js";import"./index-CgIT46Lx.js";import"./index-DLhIgdNs.js";import"./index-ComHJoDe.js";import"./index-BAabsZi0.js";import"./preload-helper-CTOgD26E.js";const te={root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:"",type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1,textFormat:0,textStyle:""}],direction:"ltr",format:"",indent:0,type:"root",version:1}};function u(o,n){return o===""?n["%commentEditor_unassigned%"]??"Unassigned":o==="Team"?n["%commentEditor_team%"]??"Team":o}function A({assignableUsers:o,onSave:n,onClose:g,localizedStrings:s}){const[i,P]=r.useState(te),[m,D]=r.useState(void 0),[I,d]=r.useState(!1),O=r.useRef(void 0),h=r.useRef(null);r.useEffect(()=>{let t=!0;const x=h.current;if(!x)return;const q=setTimeout(()=>{t&&M(x)},300);return()=>{t=!1,clearTimeout(q)}},[]);const f=r.useCallback(()=>{if(!l(i))return;const t=G(i);n(t,m)},[i,n,m]),R=s["%commentEditor_placeholder%"]??"Type your comment here...",B=s["%commentEditor_saveButton_tooltip%"]??"Save comment",K=s["%commentEditor_cancelButton_tooltip%"]??"Cancel",L=s["%commentEditor_assignTo_label%"]??"Assign to";return e.jsxs("div",{className:"pr-twp tw-grid tw-gap-3",children:[e.jsxs("div",{className:"tw-flex tw-items-center tw-justify-between",children:[e.jsx("span",{className:"tw-text-sm tw-font-medium",children:L}),e.jsxs("div",{className:"tw-flex tw-gap-2",children:[e.jsx(w,{children:e.jsxs(v,{children:[e.jsx(y,{asChild:!0,children:e.jsx(p,{onClick:g,className:"tw-h-6 tw-w-6",size:"icon",variant:"secondary",children:e.jsx(Z,{})})}),e.jsx(E,{children:e.jsx("p",{children:K})})]})}),e.jsx(w,{children:e.jsxs(v,{children:[e.jsx(y,{asChild:!0,children:e.jsx(p,{onClick:f,className:"tw-h-6 tw-w-6",size:"icon",variant:"default",disabled:!l(i),children:e.jsx($,{})})}),e.jsx(E,{children:e.jsx("p",{children:B})})]})})]})]}),e.jsx("div",{className:"tw-flex tw-items-center tw-gap-2",children:e.jsxs(J,{open:I,onOpenChange:d,children:[e.jsx(Q,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"tw-flex tw-w-full tw-items-center tw-justify-start tw-gap-2",disabled:o.length===0,children:[e.jsx(ee,{className:"tw-h-4 tw-w-4"}),e.jsx("span",{children:u(m!==void 0?m:"",s)})]})}),e.jsx(W,{className:"tw-w-auto tw-p-0",align:"start",onKeyDown:t=>{t.key==="Escape"&&(t.stopPropagation(),d(!1))},children:e.jsx(F,{children:e.jsx(V,{children:o.map(t=>e.jsx(X,{onSelect:()=>{D(t===""?void 0:t),d(!1)},className:"tw-flex tw-items-center",children:e.jsx("span",{children:u(t,s)})},t||"unassigned"))})})})]})}),e.jsx("div",{ref:h,role:"textbox",tabIndex:-1,className:"tw-outline-none",onKeyDownCapture:t=>{t.key==="Escape"?(t.preventDefault(),t.stopPropagation(),g()):t.key==="Enter"&&t.shiftKey&&(t.preventDefault(),t.stopPropagation(),l(i)&&f())},onKeyDown:t=>{Y(t),(t.key==="Enter"||t.key===" ")&&t.stopPropagation()},children:e.jsx(H,{editorSerializedState:i,onSerializedChange:t=>P(t),placeholder:R,onClear:t=>{O.current=t}})})]})}A.__docgenInfo={description:`Component to create a new project comment from within the scripture editor

@param CommentEditorProps - The properties for the comment editor component`,methods:[],displayName:"CommentEditor",props:{assignableUsers:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"List of users that can be assigned to the new comment thread"},onSave:{required:!0,tsType:{name:"signature",type:"function",raw:"(contents: string, assignedUser?: string) => void",signature:{arguments:[{type:{name:"string"},name:"contents"},{type:{name:"string"},name:"assignedUser"}],return:{name:"void"}}},description:`External function to handle saving the new comment

@param contents HTML content of the comment
@param assignedUser Optional user to assign the comment to`},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:`External function to handle closing the comment editor. Gets called when the editor is closed
without saving changes`},localizedStrings:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  [localizedKey in (typeof COMMENT_EDITOR_STRING_KEYS)[number]]?: string;
}`,signature:{properties:[{key:{name:"unknown[number]",raw:"(typeof COMMENT_EDITOR_STRING_KEYS)[number]",required:!1},value:{name:"string"}}]}},description:"Localized strings to be passed to the comment editor component"}}};const k={"%commentEditor_placeholder%":"Type your comment here...","%commentEditor_saveButton_tooltip%":"Save comment","%commentEditor_cancelButton_tooltip%":"Cancel","%commentEditor_assignTo_label%":"Assign to","%commentEditor_unassigned%":"Unassigned","%commentEditor_team%":"Team"},oe=["","Team","Alice","Bob","Charlie"],Ve={title:"Advanced/CommentEditor",component:A,tags:["autodocs"],decorators:[o=>e.jsx(z,{children:e.jsx("div",{className:"tw-w-80",children:e.jsx(o,{})})})],argTypes:{assignableUsers:{control:"object"}}},c={args:{assignableUsers:oe,localizedStrings:k,onSave:(o,n)=>{console.log("Comment saved:",{contents:o,assignedUser:n})},onClose:()=>{console.log("Editor closed")}}},a={args:{assignableUsers:[],localizedStrings:k,onSave:(o,n)=>{console.log("Comment saved:",{contents:o,assignedUser:n})},onClose:()=>{console.log("Editor closed")}}};var j,C,T;c.parameters={...c.parameters,docs:{...(j=c.parameters)==null?void 0:j.docs,source:{originalSource:`{
  args: {
    assignableUsers: mockAssignableUsers,
    localizedStrings: commentEditorLocalizedStrings,
    onSave: (contents, assignedUser) => {
      console.log('Comment saved:', {
        contents,
        assignedUser
      });
    },
    onClose: () => {
      console.log('Editor closed');
    }
  }
}`,...(T=(C=c.parameters)==null?void 0:C.docs)==null?void 0:T.source}}};var b,S,_,N,U;a.parameters={...a.parameters,docs:{...(b=a.parameters)==null?void 0:b.docs,source:{originalSource:`{
  args: {
    assignableUsers: [],
    localizedStrings: commentEditorLocalizedStrings,
    onSave: (contents, assignedUser) => {
      console.log('Comment saved:', {
        contents,
        assignedUser
      });
    },
    onClose: () => {
      console.log('Editor closed');
    }
  }
}`,...(_=(S=a.parameters)==null?void 0:S.docs)==null?void 0:_.source},description:{story:"Story demonstrating the editor when no users are available for assignment",...(U=(N=a.parameters)==null?void 0:N.docs)==null?void 0:U.description}}};const Xe=["Default","NoAssignableUsers"];export{c as Default,a as NoAssignableUsers,Xe as __namedExportsOrder,Ve as default};
