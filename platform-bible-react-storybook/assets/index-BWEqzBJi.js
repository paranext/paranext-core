import{r as i}from"./iframe-bGuH-Abg.js";import{u as x}from"./index-z4Q_vUym.js";import{P as I}from"./index-Cum9p26y.js";import{u as S}from"./index-9OUeuJVn.js";import{j as g}from"./jsx-runtime-Dp1lb1Uf.js";import{v as _}from"./index-BkoBbs9Y.js";import{u as w}from"./index-DDdVzcAn.js";var F="focusScope.autoFocusOnMount",T="focusScope.autoFocusOnUnmount",C={bubbles:!1,cancelable:!0},K="FocusScope",k=i.forwardRef((e,n)=>{const{loop:t=!1,trapped:s=!1,onMountAutoFocus:l,onUnmountAutoFocus:v,...E}=e,[o,R]=i.useState(null),b=S(l),h=S(v),y=i.useRef(null),M=x(n,r=>R(r)),d=i.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;i.useEffect(()=>{if(s){let r=function(a){if(d.paused||!o)return;const c=a.target;o.contains(c)?y.current=c:f(y.current,{select:!0})},m=function(a){if(d.paused||!o)return;const c=a.relatedTarget;c!==null&&(o.contains(c)||f(y.current,{select:!0}))},u=function(a){if(document.activeElement===document.body)for(const N of a)N.removedNodes.length>0&&f(o)};document.addEventListener("focusin",r),document.addEventListener("focusout",m);const p=new MutationObserver(u);return o&&p.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",r),document.removeEventListener("focusout",m),p.disconnect()}}},[s,o,d.paused]),i.useEffect(()=>{if(o){P.add(d);const r=document.activeElement;if(!o.contains(r)){const u=new CustomEvent(F,C);o.addEventListener(F,b),o.dispatchEvent(u),u.defaultPrevented||(j(W(A(o)),{select:!0}),document.activeElement===r&&f(o))}return()=>{o.removeEventListener(F,b),setTimeout(()=>{const u=new CustomEvent(T,C);o.addEventListener(T,h),o.dispatchEvent(u),u.defaultPrevented||f(r??document.body,{select:!0}),o.removeEventListener(T,h),P.remove(d)},0)}}},[o,b,h,d]);const U=i.useCallback(r=>{if(!t&&!s||d.paused)return;const m=r.key==="Tab"&&!r.altKey&&!r.ctrlKey&&!r.metaKey,u=document.activeElement;if(m&&u){const p=r.currentTarget,[a,c]=D(p);a&&c?!r.shiftKey&&u===c?(r.preventDefault(),t&&f(a,{select:!0})):r.shiftKey&&u===a&&(r.preventDefault(),t&&f(c,{select:!0})):u===p&&r.preventDefault()}},[t,s,d.paused]);return g.jsx(I.div,{tabIndex:-1,...E,ref:M,onKeyDown:U})});k.displayName=K;function j(e,{select:n=!1}={}){const t=document.activeElement;for(const s of e)if(f(s,{select:n}),document.activeElement!==t)return}function D(e){const n=A(e),t=O(n,e),s=O(n.reverse(),e);return[t,s]}function A(e){const n=[],t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const l=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||l?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)n.push(t.currentNode);return n}function O(e,n){for(const t of e)if(!H(t,{upTo:n}))return t}function H(e,{upTo:n}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(n!==void 0&&e===n)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function q(e){return e instanceof HTMLInputElement&&"select"in e}function f(e,{select:n=!1}={}){if(e&&e.focus){const t=document.activeElement;e.focus({preventScroll:!0}),e!==t&&q(e)&&n&&e.select()}}var P=V();function V(){let e=[];return{add(n){const t=e[0];n!==t&&(t==null||t.pause()),e=L(e,n),e.unshift(n)},remove(n){var t;e=L(e,n),(t=e[0])==null||t.resume()}}}function L(e,n){const t=[...e],s=t.indexOf(n);return s!==-1&&t.splice(s,1),t}function W(e){return e.filter(n=>n.tagName!=="A")}var B="Portal",z=i.forwardRef((e,n)=>{var o;const{container:t,...s}=e,[l,v]=i.useState(!1);w(()=>v(!0),[]);const E=t||l&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return E?_.createPortal(g.jsx(I.div,{...s,ref:n}),E):null});z.displayName=B;export{k as F,z as P};
