var F0=Object.defineProperty;var B0=(n,e,t)=>e in n?F0(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Tn=(n,e,t)=>B0(n,typeof e!="symbol"?e+"":e,t);import{j as I}from"./jsx-runtime-IXTnZ0W_.js";import{r as T,c as Hr,g as q0}from"./iframe-DS1O8H8K.js";import{r as En}from"./index-Dr3uUfF9.js";import{d as j0,c as U0,s as W0,f as z0}from"./floating-ui.dom-DCpBEVSC.js";import{M as H0}from"./markdown-renderer.component-COw4P_PZ.js";import{C as K0,a as V0,b as J0,d as G0}from"./card-HBL63stz.js";import"./index-BgJ7c1xJ.js";import"./shadcn-ui.util-DMJ19wEV.js";var Y0=Object.getOwnPropertyNames,X0=Object.getOwnPropertySymbols,Q0=Object.prototype.hasOwnProperty;function Pf(n,e){return function(r,i,s){return n(r,i,s)&&e(r,i,s)}}function da(n){return function(t,r,i){if(!t||!r||typeof t!="object"||typeof r!="object")return n(t,r,i);var s=i.cache,o=s.get(t),a=s.get(r);if(o&&a)return o===r&&a===t;s.set(t,r),s.set(r,t);var l=n(t,r,i);return s.delete(t),s.delete(r),l}}function Lf(n){return Y0(n).concat(X0(n))}var Z0=Object.hasOwn||function(n,e){return Q0.call(n,e)};function Ki(n,e){return n===e||!n&&!e&&n!==n&&e!==e}var ev="__v",tv="__o",nv="_owner",$f=Object.getOwnPropertyDescriptor,Ff=Object.keys;function rv(n,e,t){var r=n.length;if(e.length!==r)return!1;for(;r-- >0;)if(!t.equals(n[r],e[r],r,r,n,e,t))return!1;return!0}function iv(n,e){return Ki(n.getTime(),e.getTime())}function sv(n,e){return n.name===e.name&&n.message===e.message&&n.cause===e.cause&&n.stack===e.stack}function ov(n,e){return n===e}function Bf(n,e,t){var r=n.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(r),s=n.entries(),o,a,l=0;(o=s.next())&&!o.done;){for(var u=e.entries(),c=!1,f=0;(a=u.next())&&!a.done;){if(i[f]){f++;continue}var d=o.value,h=a.value;if(t.equals(d[0],h[0],l,f,n,e,t)&&t.equals(d[1],h[1],d[0],h[0],n,e,t)){c=i[f]=!0;break}f++}if(!c)return!1;l++}return!0}var av=Ki;function lv(n,e,t){var r=Ff(n),i=r.length;if(Ff(e).length!==i)return!1;for(;i-- >0;)if(!Cm(n,e,t,r[i]))return!1;return!0}function to(n,e,t){var r=Lf(n),i=r.length;if(Lf(e).length!==i)return!1;for(var s,o,a;i-- >0;)if(s=r[i],!Cm(n,e,t,s)||(o=$f(n,s),a=$f(e,s),(o||a)&&(!o||!a||o.configurable!==a.configurable||o.enumerable!==a.enumerable||o.writable!==a.writable)))return!1;return!0}function uv(n,e){return Ki(n.valueOf(),e.valueOf())}function cv(n,e){return n.source===e.source&&n.flags===e.flags}function qf(n,e,t){var r=n.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(r),s=n.values(),o,a;(o=s.next())&&!o.done;){for(var l=e.values(),u=!1,c=0;(a=l.next())&&!a.done;){if(!i[c]&&t.equals(o.value,a.value,o.value,a.value,n,e,t)){u=i[c]=!0;break}c++}if(!u)return!1}return!0}function dv(n,e){var t=n.length;if(e.length!==t)return!1;for(;t-- >0;)if(n[t]!==e[t])return!1;return!0}function fv(n,e){return n.hostname===e.hostname&&n.pathname===e.pathname&&n.protocol===e.protocol&&n.port===e.port&&n.hash===e.hash&&n.username===e.username&&n.password===e.password}function Cm(n,e,t,r){return(r===nv||r===tv||r===ev)&&(n.$$typeof||e.$$typeof)?!0:Z0(e,r)&&t.equals(n[r],e[r],r,r,n,e,t)}var hv="[object Arguments]",pv="[object Boolean]",gv="[object Date]",mv="[object Error]",yv="[object Map]",_v="[object Number]",bv="[object Object]",vv="[object RegExp]",Cv="[object Set]",Ev="[object String]",wv="[object URL]",xv=Array.isArray,jf=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Uf=Object.assign,kv=Object.prototype.toString.call.bind(Object.prototype.toString);function Sv(n){var e=n.areArraysEqual,t=n.areDatesEqual,r=n.areErrorsEqual,i=n.areFunctionsEqual,s=n.areMapsEqual,o=n.areNumbersEqual,a=n.areObjectsEqual,l=n.arePrimitiveWrappersEqual,u=n.areRegExpsEqual,c=n.areSetsEqual,f=n.areTypedArraysEqual,d=n.areUrlsEqual;return function(p,m,_){if(p===m)return!0;if(p==null||m==null)return!1;var C=typeof p;if(C!==typeof m)return!1;if(C!=="object")return C==="number"?o(p,m,_):C==="function"?i(p,m,_):!1;var v=p.constructor;if(v!==m.constructor)return!1;if(v===Object)return a(p,m,_);if(xv(p))return e(p,m,_);if(jf!=null&&jf(p))return f(p,m,_);if(v===Date)return t(p,m,_);if(v===RegExp)return u(p,m,_);if(v===Map)return s(p,m,_);if(v===Set)return c(p,m,_);var x=kv(p);return x===gv?t(p,m,_):x===vv?u(p,m,_):x===yv?s(p,m,_):x===Cv?c(p,m,_):x===bv?typeof p.then!="function"&&typeof m.then!="function"&&a(p,m,_):x===wv?d(p,m,_):x===mv?r(p,m,_):x===hv?a(p,m,_):x===pv||x===_v||x===Ev?l(p,m,_):!1}}function Tv(n){var e=n.circular,t=n.createCustomConfig,r=n.strict,i={areArraysEqual:r?to:rv,areDatesEqual:iv,areErrorsEqual:sv,areFunctionsEqual:ov,areMapsEqual:r?Pf(Bf,to):Bf,areNumbersEqual:av,areObjectsEqual:r?to:lv,arePrimitiveWrappersEqual:uv,areRegExpsEqual:cv,areSetsEqual:r?Pf(qf,to):qf,areTypedArraysEqual:r?to:dv,areUrlsEqual:fv};if(t&&(i=Uf({},i,t(i))),e){var s=da(i.areArraysEqual),o=da(i.areMapsEqual),a=da(i.areObjectsEqual),l=da(i.areSetsEqual);i=Uf({},i,{areArraysEqual:s,areMapsEqual:o,areObjectsEqual:a,areSetsEqual:l})}return i}function Av(n){return function(e,t,r,i,s,o,a){return n(e,t,a)}}function Dv(n){var e=n.circular,t=n.comparator,r=n.createState,i=n.equals,s=n.strict;if(r)return function(l,u){var c=r(),f=c.cache,d=f===void 0?e?new WeakMap:void 0:f,h=c.meta;return t(l,u,{cache:d,equals:i,meta:h,strict:s})};if(e)return function(l,u){return t(l,u,{cache:new WeakMap,equals:i,meta:void 0,strict:s})};var o={cache:void 0,equals:i,meta:void 0,strict:s};return function(l,u){return t(l,u,o)}}var Wr=li();li({strict:!0});li({circular:!0});li({circular:!0,strict:!0});li({createInternalComparator:function(){return Ki}});li({strict:!0,createInternalComparator:function(){return Ki}});li({circular:!0,createInternalComparator:function(){return Ki}});li({circular:!0,createInternalComparator:function(){return Ki},strict:!0});function li(n){n===void 0&&(n={});var e=n.circular,t=e===void 0?!1:e,r=n.createInternalComparator,i=n.createState,s=n.strict,o=s===void 0?!1:s,a=Tv(n),l=Sv(a),u=r?r(l):Av(l);return Dv({circular:t,comparator:l,createState:i,equals:u,strict:o})}const Em=T.createContext(null);function Nv(n,e){return{getTheme:function(){return e??null}}}function ke(){const n=T.useContext(Em);return n==null&&function(e,...t){const r=new URL("https://lexical.dev/docs/error"),i=new URLSearchParams;i.append("code",e);for(const s of t)i.append("v",s);throw r.search=i.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(8),n}function se(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const Yn=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Mv=Yn&&"documentMode"in document?document.documentMode:null,or=Yn&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Oi=Yn&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),tl=!(!Yn||!("InputEvent"in window)||Mv)&&"getTargetRanges"in new window.InputEvent("input"),Co=Yn&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),_s=Yn&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Ov=Yn&&/Android/.test(navigator.userAgent),wm=Yn&&/^(?=.*Chrome).*/i.test(navigator.userAgent),Wf=Yn&&Ov&&wm,nl=Yn&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!wm;function rl(...n){const e=[];for(const t of n)if(t&&typeof t=="string")for(const[r]of t.matchAll(/\S+/g))e.push(r);return e}const Iv=1,Rv=3,Pv=9,Lv=11,Ii=0,xm=1,bs=2,$v=0,Fv=1,Bv=2,il=4,sl=8,dd=128,qv=1792|(112|(3|il|sl)|dd),fd=1,hd=2,pd=3,gd=4,md=5,yd=6,Pl=Co||_s||nl?" ":"​",Nr=`

`,jv=Oi?" ":Pl,km="֑-߿יִ-﷽ﹰ-ﻼ",Sm="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",Uv=new RegExp("^[^"+Sm+"]*["+km+"]"),Wv=new RegExp("^[^"+km+"]*["+Sm+"]"),Zr={bold:1,capitalize:1024,code:16,highlight:dd,italic:2,lowercase:256,strikethrough:il,subscript:32,superscript:64,underline:sl,uppercase:512},zv={directionless:1,unmergeable:2},zf={center:hd,end:yd,justify:gd,left:fd,right:pd,start:md},Hv={[hd]:"center",[yd]:"end",[gd]:"justify",[fd]:"left",[pd]:"right",[md]:"start"},Kv={normal:0,segmented:2,token:1},Vv={[$v]:"normal",[Bv]:"segmented",[Fv]:"token"},Hf="$config";function Tm(n,e,t,r,i,s){let o=n.getFirstChild();for(;o!==null;){const a=o.__key;o.__parent===e&&(V(o)&&Tm(o,a,t,r,i,s),t.has(a)||s.delete(a),i.push(a)),o=o.getNextSibling()}}const Jv=100;let sc=!1,_d=0;function Gv(n){_d=n.timeStamp}function Su(n,e,t){const r=n.nodeName==="BR",i=e.__lexicalLineBreak;return i&&(n===i||r&&n.previousSibling===i)||r&&Hl(n,t)!==void 0}function Yv(n,e,t){const r=Vn(On(t));let i=null,s=null;r!==null&&r.anchorNode===n&&(i=r.anchorOffset,s=r.focusOffset);const o=n.nodeValue;o!==null&&Ud(e,o,i,s,!1)}function Xv(n,e,t){if(G(n)){const r=n.anchor.getNode();if(r.is(t)&&n.format!==r.getFormat())return!1}return Pr(e)&&t.isAttached()}function Qv(n,e,t,r){for(let i=n;i&&!Y2(i);i=Wo(i)){const s=Hl(i,e);if(s!==void 0){const o=xe(s,t);if(o)return Pe(o)||!je(i)?void 0:[i,o]}else if(i===r)return[r,Ay(t)]}}function Am(n,e,t){sc=!0;const r=performance.now()-_d>Jv;try{Cn(n,()=>{const i=ne()||function(d){return d.getEditorState().read(()=>{const h=ne();return h!==null?h.clone():null})}(n),s=new Map,o=n.getRootElement(),a=n._editorState,l=n._blockCursorElement;let u=!1,c="";for(let d=0;d<e.length;d++){const h=e[d],p=h.type,m=h.target,_=Qv(m,n,a,o);if(!_)continue;const[C,v]=_;if(p==="characterData")r&&Z(v)&&Pr(m)&&Xv(i,m,v)&&Yv(m,v,n);else if(p==="childList"){u=!0;const x=h.addedNodes;for(let k=0;k<x.length;k++){const P=x[k],D=Sy(P),O=P.parentNode;if(O!=null&&P!==l&&D===null&&!Su(P,O,n)){if(Oi){const z=(je(P)?P.innerText:null)||P.nodeValue;z&&(c+=z)}O.removeChild(P)}}const M=h.removedNodes,$=M.length;if($>0){let k=0;for(let P=0;P<$;P++){const D=M[P];(Su(D,m,n)||l===D)&&(m.appendChild(D),k++)}$!==k&&s.set(C,v)}}}if(s.size>0)for(const[d,h]of s)h.reconcileObservedMutation(d,n);const f=t.takeRecords();if(f.length>0){for(let d=0;d<f.length;d++){const h=f[d],p=h.addedNodes,m=h.target;for(let _=0;_<p.length;_++){const C=p[_],v=C.parentNode;v==null||C.nodeName!=="BR"||Su(C,m,n)||v.removeChild(C)}}t.takeRecords()}i!==null&&(u&&Ot(i),Oi&&Iy(n)&&i.insertRawText(c))})}finally{sc=!1}}function Dm(n){const e=n._observer;e!==null&&Am(n,e.takeRecords(),e)}function Nm(n){(function(e){_d===0&&On(e).addEventListener("textInput",Gv,!0)})(n),n._observer=new MutationObserver((e,t)=>{Am(n,e,t)})}let Zv=class{constructor(e,t){this.key=e,this.parse=t.parse.bind(t),this.unparse=(t.unparse||n2).bind(t),this.isEqual=(t.isEqual||Object.is).bind(t),this.defaultValue=this.parse(void 0)}};function Mm(n,e){return new Zv(n,e)}function vs(n,e,t="latest"){const r=(t==="latest"?n.getLatest():n).__state;return r?r.getValue(e):e.defaultValue}function Tr(n,e,t){let r;if(St(),typeof t=="function"){const s=n.getLatest(),o=vs(s,e);if(r=t(o),e.isEqual(o,r))return s}else r=t;const i=n.getWritable();return Im(i).updateFromKnown(e,r),i}function e2(n){const e=new Map,t=new Set;for(let r=typeof n=="function"?n:n.replace;r.prototype&&r.prototype.getType!==void 0;r=Object.getPrototypeOf(r)){const{ownNodeConfig:i}=Kd(r);if(i&&i.stateConfigs)for(const s of i.stateConfigs){let o;"stateConfig"in s?(o=s.stateConfig,s.flat&&t.add(o.key)):o=s,e.set(o.key,o)}}return{flatKeys:t,sharedConfigMap:e}}let t2=class Om{constructor(e,t,r=void 0,i=new Map,s=void 0){this.node=e,this.sharedNodeState=t,this.unknownState=r,this.knownState=i;const{sharedConfigMap:o}=this.sharedNodeState,a=s!==void 0?s:function(l,u,c){let f=c.size;if(u)for(const d in u){const h=l.get(d);h&&c.has(h)||f++}return f}(o,r,i);this.size=a}getValue(e){const t=this.knownState.get(e);if(t!==void 0)return t;this.sharedNodeState.sharedConfigMap.set(e.key,e);let r=e.defaultValue;if(this.unknownState&&e.key in this.unknownState){const i=this.unknownState[e.key];i!==void 0&&(r=e.parse(i)),this.updateFromKnown(e,r)}return r}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const e={...this.unknownState},t={};for(const[r,i]of this.knownState)r.isEqual(i,r.defaultValue)?delete e[r.key]:e[r.key]=r.unparse(i);for(const r of this.sharedNodeState.flatKeys)r in e&&(t[r]=e[r],delete e[r]);return Kf(e)&&(t.$=e),t}getWritable(e){if(this.node===e)return this;const{sharedNodeState:t,unknownState:r}=this,i=new Map(this.knownState);return new Om(e,t,function(s,o,a){let l;if(a)for(const[u,c]of Object.entries(a)){const f=s.get(u);f?o.has(f)||o.set(f,f.parse(c)):(l=l||{},l[u]=c)}return l}(t.sharedConfigMap,i,r),i,this.size)}updateFromKnown(e,t){const r=e.key;this.sharedNodeState.sharedConfigMap.set(r,e);const{knownState:i,unknownState:s}=this;i.has(e)||s&&r in s||(s&&(delete s[r],this.unknownState=Kf(s)),this.size++),i.set(e,t)}updateFromUnknown(e,t){const r=this.sharedNodeState.sharedConfigMap.get(e);r?this.updateFromKnown(r,r.parse(t)):(this.unknownState=this.unknownState||{},e in this.unknownState||this.size++,this.unknownState[e]=t)}updateFromJSON(e){const{knownState:t}=this;for(const r of t.keys())t.set(r,r.defaultValue);if(this.size=t.size,this.unknownState=void 0,e)for(const[r,i]of Object.entries(e))this.updateFromUnknown(r,i)}};function Im(n){const e=n.getWritable(),t=e.__state?e.__state.getWritable(e):new t2(e,Rm(e));return e.__state=t,t}function Rm(n){return n.__state?n.__state.sharedNodeState:xy(Vl(),n.getType()).sharedNodeState}function Kf(n){if(n)for(const e in n)return n}function n2(n){return n}function Vf(n,e,t){for(const[r,i]of e.knownState){if(n.has(r.key))continue;n.add(r.key);const s=t?t.getValue(r):r.defaultValue;if(s!==i&&!r.isEqual(s,i))return!0}return!1}function Jf(n,e,t){const{unknownState:r}=e,i=t?t.unknownState:void 0;if(r){for(const[s,o]of Object.entries(r))if(!n.has(s)&&(n.add(s),o!==(i?i[s]:void 0)))return!0}return!1}function Gf(n,e){const t=n.__state;return t&&t.node===n?t.getWritable(e):t}function Yf(n,e){const t=n.__mode,r=n.__format,i=n.__style,s=e.__mode,o=e.__format,a=e.__style,l=n.__state,u=e.__state;return(t===null||t===s)&&(r===null||r===o)&&(i===null||i===a)&&(n.__state===null||l===u||function(c,f){if(c===f)return!0;if(c&&f&&c.size!==f.size)return!1;const d=new Set;return!(c&&Vf(d,c,f)||f&&Vf(d,f,c)||c&&Jf(d,c,f)||f&&Jf(d,f,c))}(l,u))}function Xf(n,e){const t=n.mergeWithSibling(e),r=Ge()._normalizedNodes;return r.add(n.__key),r.add(e.__key),t}function Qf(n){let e,t,r=n;if(r.__text!==""||!r.isSimpleText()||r.isUnmergeable()){for(;(e=r.getPreviousSibling())!==null&&Z(e)&&e.isSimpleText()&&!e.isUnmergeable();){if(e.__text!==""){if(Yf(e,r)){r=Xf(e,r);break}break}e.remove()}for(;(t=r.getNextSibling())!==null&&Z(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(t.__text!==""){if(Yf(r,t)){r=Xf(r,t);break}break}t.remove()}}else r.remove()}function Eo(n){return Zf(n.anchor),Zf(n.focus),n}function Zf(n){for(;n.type==="element";){const e=n.getNode(),t=n.offset;let r,i;if(t===e.getChildrenSize()?(r=e.getChildAtIndex(t-1),i=!0):(r=e.getChildAtIndex(t),i=!1),Z(r)){n.set(r.__key,i?r.getTextContentSize():0,"text",!0);break}if(!V(r))break;n.set(r.__key,i?r.getChildrenSize():0,"element",!0)}}let ei,Gt,wo,Ll,oc,ac,Ri,Wn,lc,xo,ct="",Jt="",ir=null,sr="",xr="",Pm=!1,ko=!1,ja=null;function ol(n,e){const t=Ri.get(n);if(e!==null){const r=dc(n);r.parentNode===e&&e.removeChild(r)}if(Wn.has(n)||Gt._keyToDOMMap.delete(n),V(t)){const r=ll(t,Ri);uc(r,0,r.length-1,null)}t!==void 0&&Wd(xo,wo,Ll,t,"destroyed")}function uc(n,e,t,r){let i=e;for(;i<=t;++i){const s=n[i];s!==void 0&&ol(s,r)}}function Ci(n,e){n.setProperty("text-align",e)}const r2="40px";function Lm(n,e){const t=ei.theme.indent;if(typeof t=="string"){const i=n.classList.contains(t);e>0&&!i?n.classList.add(t):e<1&&i&&n.classList.remove(t)}const r=getComputedStyle(n).getPropertyValue("--lexical-indent-base-value")||r2;n.style.setProperty("padding-inline-start",e===0?"":`calc(${e} * ${r})`)}function $m(n,e){const t=n.style;e===0?Ci(t,""):e===fd?Ci(t,"left"):e===hd?Ci(t,"center"):e===pd?Ci(t,"right"):e===gd?Ci(t,"justify"):e===md?Ci(t,"start"):e===yd&&Ci(t,"end")}function al(n,e){const t=Wn.get(n);t===void 0&&se(60);const r=t.createDOM(ei,Gt);if(function(i,s,o){const a=o._keyToDOMMap;(function(l,u,c){const f=`__lexicalKey_${u._key}`;l[f]=c})(s,o,i),a.set(i,s)}(n,r,Gt),Z(t)?r.setAttribute("data-lexical-text","true"):Pe(t)&&r.setAttribute("data-lexical-decorator","true"),V(t)){const i=t.__indent,s=t.__size;if(i!==0&&Lm(r,i),s!==0){const a=s-1;(function(l,u,c,f){const d=Jt;Jt="",cc(l,c,0,u,c.getDOMSlot(f)),Bm(c,f),Jt=d})(ll(t,Wn),a,t,r)}const o=t.__format;o!==0&&$m(r,o),t.isInline()||Fm(null,t,r),Kl(t)&&(ct+=Nr,xr+=Nr)}else{const i=t.getTextContent();if(Pe(t)){const s=t.decorate(Gt,ei);s!==null&&qm(n,s),r.contentEditable="false"}else Z(t)&&(t.isDirectionless()||(Jt+=i));ct+=i,xr+=i}return e!==null&&e.insertChild(r),Wd(xo,wo,Ll,t,"created"),r}function cc(n,e,t,r,i){const s=ct;ct="";let o=t;for(;o<=r;++o){al(n[o],i);const a=Wn.get(n[o]);a!==null&&Z(a)&&(ir===null&&(ir=a.getFormat()),sr===""&&(sr=a.getStyle()))}Kl(e)&&(ct+=Nr),i.element.__lexicalTextContent=ct,ct=s+ct}function eh(n,e){if(n){const t=n.__last;if(t){const r=e.get(t);if(r)return Si(r)?"line-break":Pe(r)&&r.isInline()?"decorator":null}return"empty"}return null}function Fm(n,e,t){const r=eh(n,Ri),i=eh(e,Wn);r!==i&&e.getDOMSlot(t).setManagedLineBreak(i)}function Bm(n,e){const t=e.__lexicalDirTextContent||"",r=e.__lexicalDir||"";if(t!==Jt||r!==ja){const i=Jt==="",s=i?ja:function(o){return Uv.test(o)?"rtl":Wv.test(o)?"ltr":null}(Jt);if(s!==r){const o=e.classList,a=ei.theme;let l=r!==null?a[r]:void 0,u=s!==null?a[s]:void 0;if(l!==void 0){if(typeof l=="string"){const c=rl(l);l=a[r]=c}o.remove(...l)}if(s===null||i&&s==="ltr")e.removeAttribute("dir");else{if(u!==void 0){if(typeof u=="string"){const c=rl(u);u=a[s]=c}u!==void 0&&o.add(...u)}e.dir=s}ko||(n.getWritable().__dir=s)}ja=s,e.__lexicalDirTextContent=Jt,e.__lexicalDir=s}}function i2(n,e,t){const r=Jt;var i;Jt="",ir=null,sr="",function(s,o,a){const l=ct,u=s.__size,c=o.__size;ct="";const f=a.element;if(u===1&&c===1){const d=s.__first,h=o.__first;if(d===h)ao(d,f);else{const m=dc(d),_=al(h,null);try{f.replaceChild(_,m)}catch(C){if(typeof C=="object"&&C!=null){const v=`${C.toString()} Parent: ${f.tagName}, new child: {tag: ${_.tagName} key: ${h}}, old child: {tag: ${m.tagName}, key: ${d}}.`;throw new Error(v)}throw C}ol(d,null)}const p=Wn.get(h);Z(p)&&(ir===null&&(ir=p.getFormat()),sr===""&&(sr=p.getStyle()))}else{const d=ll(s,Ri),h=ll(o,Wn);if(d.length!==u&&se(227),h.length!==c&&se(228),u===0)c!==0&&cc(h,o,0,c-1,a);else if(c===0){if(u!==0){const p=a.after==null&&a.before==null&&a.element.__lexicalLineBreak==null;uc(d,0,u-1,p?null:f),p&&(f.textContent="")}}else(function(p,m,_,C,v,x){const M=C-1,$=v-1;let k,P,D=x.getFirstChild(),O=0,z=0;for(;O<=M&&z<=$;){const S=m[O],H=_[z];if(S===H)D=Tu(ao(H,x.element)),O++,z++;else{k===void 0&&(k=new Set(m)),P===void 0&&(P=new Set(_));const L=P.has(S),j=k.has(H);if(L)if(j){const K=ks(Gt,H);K===D?D=Tu(ao(H,x.element)):(x.withBefore(D).insertChild(K),ao(H,x.element)),O++,z++}else al(H,x.withBefore(D)),z++;else D=Tu(dc(S)),ol(S,x.element),O++}const A=Wn.get(H);A!==null&&Z(A)&&(ir===null&&(ir=A.getFormat()),sr===""&&(sr=A.getStyle()))}const w=O>M,q=z>$;if(w&&!q){const S=_[$+1],H=S===void 0?null:Gt.getElementByKey(S);cc(_,p,z,$,x.withBefore(H))}else q&&!w&&uc(m,O,M,x.element)})(o,d,h,u,c,a)}Kl(o)&&(ct+=Nr),f.__lexicalTextContent=ct,ct=l+ct}(n,e,e.getDOMSlot(t)),Bm(e,t),i=e,ir==null||ir===i.__textFormat||ko||i.setTextFormat(ir),function(s){sr===""||sr===s.__textStyle||ko||s.setTextStyle(sr)}(e),Jt=r}function ll(n,e){const t=[];let r=n.__first;for(;r!==null;){const i=e.get(r);i===void 0&&se(101),t.push(r),r=i.__next}return t}function ao(n,e){const t=Ri.get(n);let r=Wn.get(n);t!==void 0&&r!==void 0||se(61);const i=Pm||ac.has(n)||oc.has(n),s=ks(Gt,n);if(t===r&&!i){if(V(t)){const o=s.__lexicalTextContent;o!==void 0&&(ct+=o,xr+=o);const a=s.__lexicalDirTextContent;a!==void 0&&(Jt+=a)}else{const o=t.getTextContent();Z(t)&&!t.isDirectionless()&&(Jt+=o),xr+=o,ct+=o}return s}if(t!==r&&i&&Wd(xo,wo,Ll,r,"updated"),r.updateDOM(t,s,ei)){const o=al(n,null);return e===null&&se(62),e.replaceChild(o,s),ol(n,null),o}if(V(t)&&V(r)){const o=r.__indent;o!==t.__indent&&Lm(s,o);const a=r.__format;a!==t.__format&&$m(s,a),i&&(i2(t,r,s),At(r)||r.isInline()||Fm(t,r,s)),Kl(r)&&(ct+=Nr,xr+=Nr)}else{const o=r.getTextContent();if(Pe(r)){const a=r.decorate(Gt,ei);a!==null&&qm(n,a)}else Z(r)&&!r.isDirectionless()&&(Jt+=o);ct+=o,xr+=o}if(!ko&&At(r)&&r.__cachedText!==xr){const o=r.getWritable();o.__cachedText=xr,r=o}return s}function qm(n,e){let t=Gt._pendingDecorators;const r=Gt._decorators;if(t===null){if(r[n]===e)return;t=Ty(Gt)}t[n]=e}function Tu(n){let e=n.nextSibling;return e!==null&&e===Gt._blockCursorElement&&(e=e.nextSibling),e}function s2(n,e,t,r,i,s){ct="",xr="",Jt="",Pm=r===bs,ja=null,Gt=t,ei=t._config,wo=t._nodes,Ll=Gt._listeners.mutation,oc=i,ac=s,Ri=n._nodeMap,Wn=e._nodeMap,ko=e._readOnly,lc=new Map(t._keyToDOMMap);const o=new Map;return xo=o,ao("root",null),Gt=void 0,wo=void 0,oc=void 0,ac=void 0,Ri=void 0,Wn=void 0,ei=void 0,lc=void 0,xo=void 0,o}function dc(n){const e=lc.get(n);return e===void 0&&se(75,n),e}function be(n){return{type:n}}const Vi=be("SELECTION_CHANGE_COMMAND"),o2=be("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),jm=be("CLICK_COMMAND"),ur=be("DELETE_CHARACTER_COMMAND"),Yr=be("INSERT_LINE_BREAK_COMMAND"),So=be("INSERT_PARAGRAPH_COMMAND"),ki=be("CONTROLLED_TEXT_INSERTION_COMMAND"),Ji=be("PASTE_COMMAND"),ul=be("REMOVE_TEXT_COMMAND"),Cs=be("DELETE_WORD_COMMAND"),Es=be("DELETE_LINE_COMMAND"),Kr=be("FORMAT_TEXT_COMMAND"),$l=be("UNDO_COMMAND"),Fl=be("REDO_COMMAND"),Ps=be("KEYDOWN_COMMAND"),bd=be("KEY_ARROW_RIGHT_COMMAND"),a2=be("MOVE_TO_END"),vd=be("KEY_ARROW_LEFT_COMMAND"),l2=be("MOVE_TO_START"),Cd=be("KEY_ARROW_UP_COMMAND"),Ed=be("KEY_ARROW_DOWN_COMMAND"),ws=be("KEY_ENTER_COMMAND"),Um=be("KEY_SPACE_COMMAND"),wd=be("KEY_BACKSPACE_COMMAND"),Bl=be("KEY_ESCAPE_COMMAND"),xd=be("KEY_DELETE_COMMAND"),kd=be("KEY_TAB_COMMAND"),u2=be("INSERT_TAB_COMMAND"),c2=be("INDENT_CONTENT_COMMAND"),th=be("OUTDENT_CONTENT_COMMAND"),ql=be("DROP_COMMAND"),d2=be("FORMAT_ELEMENT_COMMAND"),Sd=be("DRAGSTART_COMMAND"),Wm=be("DRAGOVER_COMMAND"),f2=be("DRAGEND_COMMAND"),Gi=be("COPY_COMMAND"),Ls=be("CUT_COMMAND"),cl=be("SELECT_ALL_COMMAND"),Td=be("CLEAR_EDITOR_COMMAND"),zm=be("CLEAR_HISTORY_COMMAND"),lo=be("CAN_REDO_COMMAND"),uo=be("CAN_UNDO_COMMAND"),h2=be("FOCUS_COMMAND"),p2=be("BLUR_COMMAND"),g2=be("KEY_MODIFIER_COMMAND"),br=Object.freeze({}),fc=30,hc=[["keydown",function(n,e){if(go=n.timeStamp,Hm=n.key,!e.isComposing()&&!ce(e,Ps,n)&&n.key!=null){if(Au&&Dh(n))return Cn(e,()=>{fa(e,Du)}),Au=!1,void(Du="");if(function(t){return qe(t,"ArrowRight",{shiftKey:"any"})}(n))ce(e,bd,n);else if(function(t){return qe(t,"ArrowRight",Er)}(n))ce(e,a2,n);else if(function(t){return qe(t,"ArrowLeft",{shiftKey:"any"})}(n))ce(e,vd,n);else if(function(t){return qe(t,"ArrowLeft",Er)}(n))ce(e,l2,n);else if(function(t){return qe(t,"ArrowUp",{altKey:"any",shiftKey:"any"})}(n))ce(e,Cd,n);else if(function(t){return qe(t,"ArrowDown",{altKey:"any",shiftKey:"any"})}(n))ce(e,Ed,n);else if(function(t){return qe(t,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})}(n))mo=!0,ce(e,ws,n);else if(function(t){return t.key===" "}(n))ce(e,Um,n);else if(function(t){return or&&qe(t,"o",{ctrlKey:!0})}(n))n.preventDefault(),mo=!0,ce(e,Yr,!0);else if(function(t){return qe(t,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})}(n))mo=!1,ce(e,ws,n);else if(function(t){return qe(t,"Backspace",{shiftKey:"any"})||or&&qe(t,"h",{ctrlKey:!0})}(n))Dh(n)?ce(e,wd,n):(n.preventDefault(),ce(e,ur,!0));else if(function(t){return t.key==="Escape"}(n))ce(e,Bl,n);else if(function(t){return qe(t,"Delete",{})||or&&qe(t,"d",{ctrlKey:!0})}(n))(function(t){return t.key==="Delete"})(n)?ce(e,xd,n):(n.preventDefault(),ce(e,ur,!1));else if(function(t){return qe(t,"Backspace",Ah)}(n))n.preventDefault(),ce(e,Cs,!0);else if(function(t){return qe(t,"Delete",Ah)}(n))n.preventDefault(),ce(e,Cs,!1);else if(function(t){return or&&qe(t,"Backspace",{metaKey:!0})}(n))n.preventDefault(),ce(e,Es,!0);else if(function(t){return or&&(qe(t,"Delete",{metaKey:!0})||qe(t,"k",{ctrlKey:!0}))}(n))n.preventDefault(),ce(e,Es,!1);else if(function(t){return qe(t,"b",Er)}(n))n.preventDefault(),ce(e,Kr,"bold");else if(function(t){return qe(t,"u",Er)}(n))n.preventDefault(),ce(e,Kr,"underline");else if(function(t){return qe(t,"i",Er)}(n))n.preventDefault(),ce(e,Kr,"italic");else if(function(t){return qe(t,"Tab",{shiftKey:"any"})}(n))ce(e,kd,n);else if(function(t){return qe(t,"z",Er)}(n))n.preventDefault(),ce(e,$l,void 0);else if(function(t){return or?qe(t,"z",{metaKey:!0,shiftKey:!0}):qe(t,"y",{ctrlKey:!0})||qe(t,"z",{ctrlKey:!0,shiftKey:!0})}(n))n.preventDefault(),ce(e,Fl,void 0);else{const t=e._editorState._selection;t===null||G(t)?Nh(n)&&(n.preventDefault(),ce(e,cl,n)):function(r){return qe(r,"c",Er)}(n)?(n.preventDefault(),ce(e,Gi,n)):function(r){return qe(r,"x",Er)}(n)?(n.preventDefault(),ce(e,Ls,n)):Nh(n)&&(n.preventDefault(),ce(e,cl,n))}(function(t){return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey})(n)&&ce(e,g2,n)}}],["pointerdown",function(n,e){const t=n.target,r=n.pointerType;Qi(t)&&r!=="touch"&&r!=="pen"&&n.button===0&&Cn(e,()=>{kh(t)||(gc=!0)})}],["compositionstart",function(n,e){Cn(e,()=>{const t=ne();if(G(t)&&!e.isComposing()){const r=t.anchor,i=t.anchor.getNode();Tt(r.key),(n.timeStamp<go+fc||r.type==="element"||!t.isCollapsed()||i.getFormat()!==t.format||Z(i)&&i.getStyle()!==t.style)&&ce(e,ki,jv)}})}],["compositionend",function(n,e){Oi?no=!0:_s||!Co&&!nl?Cn(e,()=>{fa(e,n.data)}):(Au=!0,Du=n.data)}],["input",function(n,e){n.stopPropagation(),Cn(e,()=>{if(je(n.target)&&kh(n.target))return;const t=ne(),r=n.data,i=Ym(n);if(r!=null&&G(t)&&Jm(t,i,r,n.timeStamp,!1)){no&&(fa(e,r),no=!1);const s=t.anchor.getNode(),o=Vn(On(e));if(o===null)return;const a=t.isBackward(),l=a?t.anchor.offset:t.focus.offset,u=a?t.focus.offset:t.anchor.offset;tl&&!t.isCollapsed()&&Z(s)&&o.anchorNode!==null&&s.getTextContent().slice(0,l)+r+s.getTextContent().slice(l+u)===My(o.anchorNode)||ce(e,ki,r);const c=r.length;Oi&&c>1&&n.inputType==="insertCompositionText"&&!e.isComposing()&&(t.anchor.offset-=c),Co||_s||nl||!e.isComposing()||(go=0,Tt(null))}else jd(!1,e,r!==null?r:void 0),no&&(fa(e,r||void 0),no=!1);(function(){St();const s=Ge();Dm(s)})()},{event:n}),us=null}],["click",function(n,e){Cn(e,()=>{const t=ne(),r=Vn(On(e)),i=Fs();if(r){if(G(t)){const s=t.anchor,o=s.getNode();if(s.type==="element"&&s.offset===0&&t.isCollapsed()&&!At(o)&&Ne().getChildrenSize()===1&&o.getTopLevelElementOrThrow().isEmpty()&&i!==null&&t.is(i))r.removeAllRanges(),t.dirty=!0;else if(n.detail===3&&!t.isCollapsed()&&o!==t.focus.getNode()){const a=function(l,u){let c=l;for(;c!==Ne()&&c!=null;){if(u(c))return c;c=c.getParent()}return null}(o,l=>V(l)&&!l.isInline());V(a)&&a.select(0)}}else if(n.pointerType==="touch"||n.pointerType==="pen"){const s=r.anchorNode;(je(s)||Pr(s))&&Ot(Nd(i,r,e,n))}}ce(e,jm,n)})}],["cut",br],["copy",br],["dragstart",br],["dragover",br],["dragend",br],["paste",br],["focus",br],["blur",br],["drop",br]];tl&&hc.push(["beforeinput",(n,e)=>function(t,r){const i=t.inputType,s=Ym(t);i==="deleteCompositionText"||Oi&&Iy(r)||i!=="insertCompositionText"&&Cn(r,()=>{const o=ne();if(i==="deleteContentBackward"){if(o===null){const h=Fs();if(!G(h))return;Ot(h.clone())}if(G(o)){const h=o.anchor.key===o.focus.key;if(a=t.timeStamp,Hm==="MediaLast"&&a<go+fc&&r.isComposing()&&h){if(Tt(null),go=0,setTimeout(()=>{Cn(r,()=>{Tt(null)})},fc),G(o)){const p=o.anchor.getNode();p.markDirty(),Z(p)||se(142),Gm(o,p)}}else{Tt(null),t.preventDefault();const p=o.anchor.getNode(),m=p.getTextContent(),_=p.canInsertTextAfter(),C=o.anchor.offset===0&&o.focus.offset===m.length;let v=Wf&&h&&!C&&_;if(v&&o.isCollapsed()&&(v=!Pe(Cc(o.anchor,!0))),!v){ce(r,ur,!0);const x=ne();Wf&&G(x)&&x.isCollapsed()&&(xi=x,setTimeout(()=>xi=null))}}return}}var a;if(!G(o))return;const l=t.data;us!==null&&jd(!1,r,us),o.dirty&&us===null||!o.isCollapsed()||At(o.anchor.getNode())||s===null||o.applyDOMRange(s),us=null;const u=o.anchor,c=o.focus,f=u.getNode(),d=c.getNode();if(i!=="insertText"&&i!=="insertTranspose")switch(t.preventDefault(),i){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":ce(r,ki,t);break;case"insertFromComposition":Tt(null),ce(r,ki,t);break;case"insertLineBreak":Tt(null),ce(r,Yr,!1);break;case"insertParagraph":Tt(null),mo&&!_s?(mo=!1,ce(r,Yr,!1)):ce(r,So,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":ce(r,Ji,t);break;case"deleteByComposition":(function(h,p){return h!==p||V(h)||V(p)||!Ai(h)||!Ai(p)})(f,d)&&ce(r,ul,t);break;case"deleteByDrag":case"deleteByCut":ce(r,ul,t);break;case"deleteContent":ce(r,ur,!1);break;case"deleteWordBackward":ce(r,Cs,!0);break;case"deleteWordForward":ce(r,Cs,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":ce(r,Es,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":ce(r,Es,!1);break;case"formatStrikeThrough":ce(r,Kr,"strikethrough");break;case"formatBold":ce(r,Kr,"bold");break;case"formatItalic":ce(r,Kr,"italic");break;case"formatUnderline":ce(r,Kr,"underline");break;case"historyUndo":ce(r,$l,void 0);break;case"historyRedo":ce(r,Fl,void 0)}else{if(l===`
`)t.preventDefault(),ce(r,Yr,!1);else if(l===Nr)t.preventDefault(),ce(r,So,void 0);else if(l==null&&t.dataTransfer){const h=t.dataTransfer.getData("text/plain");t.preventDefault(),o.insertRawText(h)}else l!=null&&Jm(o,s,l,t.timeStamp,!0)?(t.preventDefault(),ce(r,ki,l)):us=l;Km=t.timeStamp}})}(n,e)]);let go=0,Hm=null,Km=0,us=null;const dl=new WeakMap;let pc=!1,gc=!1,mo=!1,no=!1,Au=!1,Du="",xi=null,Vm=[0,"",0,"root",0];function Jm(n,e,t,r,i){const s=n.anchor,o=n.focus,a=s.getNode(),l=Ge(),u=Vn(On(l)),c=u!==null?u.anchorNode:null,f=s.key,d=l.getElementByKey(f),h=t.length;return f!==o.key||!Z(a)||(!i&&(!tl||Km<r+50)||a.isDirty()&&h<2||Dy(t))&&s.offset!==o.offset&&!a.isComposing()||wr(a)||a.isDirty()&&h>1||(i||!tl)&&d!==null&&!a.isComposing()&&c!==xs(d)||u!==null&&e!==null&&(!e.collapsed||e.startContainer!==u.anchorNode||e.startOffset!==u.anchorOffset)||a.getFormat()!==n.format||a.getStyle()!==n.style||function(p,m){if(m.isSegmented())return!0;if(!p.isCollapsed())return!1;const _=p.anchor.offset,C=m.getParentOrThrow(),v=Ai(m);return _===0?!m.canInsertTextBefore()||!C.canInsertTextBefore()&&!m.isComposing()||v||function(x){const M=x.getPreviousSibling();return(Z(M)||V(M)&&M.isInline())&&!M.canInsertTextAfter()}(m):_===m.getTextContentSize()&&(!m.canInsertTextAfter()||!C.canInsertTextAfter()&&!m.isComposing()||v)}(n,a)}function nh(n,e){return Pr(n)&&n.nodeValue!==null&&e!==0&&e!==n.nodeValue.length}function rh(n,e,t){const{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}=n;pc&&(pc=!1,nh(r,i)&&nh(s,o)&&!xi)||Cn(e,()=>{if(!t)return void Ot(null);if(!Uo(e,r,s))return;let a=ne();if(xi&&G(a)&&a.isCollapsed()){const l=a.anchor,u=xi.anchor;(l.key===u.key&&l.offset===u.offset+1||l.offset===1&&u.getNode().is(l.getNode().getPreviousSibling()))&&(a=xi.clone(),Ot(a))}if(xi=null,G(a)){const l=a.anchor,u=l.getNode();if(a.isCollapsed()){n.type==="Range"&&n.anchorNode===n.focusNode&&(a.dirty=!0);const c=On(e).event,f=c?c.timeStamp:performance.now(),[d,h,p,m,_]=Vm,C=Ne(),v=e.isComposing()===!1&&C.getTextContent()==="";if(f<_+200&&l.offset===p&&l.key===m)Ua(a,d,h);else if(l.type==="text")Z(u)||se(141),Gm(a,u);else if(l.type==="element"&&!v){V(u)||se(259);const x=l.getNode();x.isEmpty()?function(M,$){const k=$.getTextFormat(),P=$.getTextStyle();Ua(M,k,P)}(a,x):Ua(a,0,"")}}else{const c=l.key,f=a.focus.key,d=a.getNodes(),h=d.length,p=a.isBackward(),m=p?o:i,_=p?i:o,C=p?f:c,v=p?c:f;let x=qv,M=!1;for(let $=0;$<h;$++){const k=d[$],P=k.getTextContentSize();if(Z(k)&&P!==0&&!($===0&&k.__key===C&&m===P||$===h-1&&k.__key===v&&_===0)&&(M=!0,x&=k.getFormat(),x===0))break}a.format=M?x:0}}ce(e,Vi,void 0)})}function Ua(n,e,t){n.format===e&&n.style===t||(n.format=e,n.style=t,n.dirty=!0)}function Gm(n,e){Ua(n,e.getFormat(),e.getStyle())}function Ym(n){if(!n.getTargetRanges)return null;const e=n.getTargetRanges();return e.length===0?null:e[0]}function fa(n,e){const t=n._compositionKey;if(Tt(null),t!==null&&e!=null){if(e===""){const r=xe(t),i=xs(n.getElementByKey(t));return void(i!==null&&i.nodeValue!==null&&Z(r)&&Ud(r,i.nodeValue,null,null,!0))}if(e[e.length-1]===`
`){const r=ne();if(G(r)){const i=r.focus;return r.anchor.set(i.key,i.offset,i.type),void ce(n,ws,null)}}}jd(!0,n,e)}function Xm(n){let e=n.__lexicalEventHandles;return e===void 0&&(e=[],n.__lexicalEventHandles=e),e}const hs=new Map;function Qm(n){const e=K2(n.target);if(e===null)return;const t=ky(e.anchorNode);if(t===null)return;gc&&(gc=!1,Cn(t,()=>{const l=Fs(),u=e.anchorNode;(je(u)||Pr(u))&&Ot(Nd(l,e,t,n))}));const r=qd(t),i=r[r.length-1],s=i._key,o=hs.get(s),a=o||i;a!==t&&rh(e,a,!1),rh(e,t,!0),t!==i?hs.set(s,t):o&&hs.delete(s)}function ih(n){n._lexicalHandled=!0}function sh(n){return n._lexicalHandled===!0}function m2(n){const e=n.ownerDocument,t=dl.get(e);if(t===void 0)return;const r=t-1;r>=0||se(164),dl.set(e,r),r===0&&e.removeEventListener("selectionchange",Qm);const i=zl(n);Bd(i)?(function(o){if(o._parentEditor!==null){const a=qd(o),l=a[a.length-1]._key;hs.get(l)===o&&hs.delete(l)}else hs.delete(o._key)}(i),n.__lexicalEditor=null):i&&se(198);const s=Xm(n);for(let o=0;o<s.length;o++)s[o]();n.__lexicalEventHandles=[]}function mc(n,e,t){St();const r=n.__key,i=n.getParent();if(i===null)return;const s=function(a){const l=ne();if(!G(l)||!V(a))return l;const{anchor:u,focus:c}=l,f=u.getNode(),d=c.getNode();return Ec(f,a)&&u.set(a.__key,0,"element"),Ec(d,a)&&c.set(a.__key,0,"element"),l}(n);let o=!1;if(G(s)&&e){const a=s.anchor,l=s.focus;a.key===r&&(hl(a,n,i,n.getPreviousSibling(),n.getNextSibling()),o=!0),l.key===r&&(hl(l,n,i,n.getPreviousSibling(),n.getNextSibling()),o=!0)}else Vt(s)&&e&&n.isSelected()&&n.selectPrevious();if(G(s)&&e&&!o){const a=n.getIndexWithinParent();Di(n),fl(s,i,a,-1)}else Di(n);t||gr(i)||i.canBeEmpty()||!i.isEmpty()||mc(i,e),e&&s&&At(i)&&i.isEmpty()&&i.selectEnd()}class $s{static getType(){const{ownNodeType:e}=Kd(this);return e===void 0&&se(64,this.name),e}static clone(e){se(65,this.name)}$config(){return{}}config(e,t){const r=t.extends||Object.getPrototypeOf(this.constructor);return Object.assign(t,{extends:r,type:e}),{[e]:t}}afterCloneFrom(e){this.__key===e.__key?(this.__parent=e.__parent,this.__next=e.__next,this.__prev=e.__prev,this.__state=e.__state):e.__state&&(this.__state=e.__state.getWritable(this))}constructor(e){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),B2(this,e)}getType(){return this.__type}isInline(){se(137,this.constructor.name)}isAttached(){let e=this.__key;for(;e!==null;){if(e==="root")return!0;const t=xe(e);if(t===null)break;e=t.__parent}return!1}isSelected(e){const t=e||ne();if(t==null)return!1;const r=t.getNodes().some(i=>i.__key===this.__key);if(Z(this))return r;if(G(t)&&t.anchor.type==="element"&&t.focus.type==="element"){if(t.isCollapsed())return!1;const i=this.getParent();if(Pe(this)&&this.isInline()&&i){const s=t.isBackward()?t.focus:t.anchor;if(i.is(s.getNode())&&s.offset===i.getChildrenSize()&&this.is(i.getLastChild()))return!1}}return r}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();if(e===null)return-1;let t=e.getFirstChild(),r=0;for(;t!==null;){if(this.is(t))return r;r++,t=t.getNextSibling()}return-1}getParent(){const e=this.getLatest().__parent;return e===null?null:xe(e)}getParentOrThrow(){const e=this.getParent();return e===null&&se(66,this.__key),e}getTopLevelElement(){let e=this;for(;e!==null;){const t=e.getParent();if(gr(t))return V(e)||e===this&&Pe(e)||se(194),e;e=t}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();return e===null&&se(67,this.__key),e}getParents(){const e=[];let t=this.getParent();for(;t!==null;)e.push(t),t=t.getParent();return e}getParentKeys(){const e=[];let t=this.getParent();for(;t!==null;)e.push(t.__key),t=t.getParent();return e}getPreviousSibling(){const e=this.getLatest().__prev;return e===null?null:xe(e)}getPreviousSiblings(){const e=[],t=this.getParent();if(t===null)return e;let r=t.getFirstChild();for(;r!==null&&!r.is(this);)e.push(r),r=r.getNextSibling();return e}getNextSibling(){const e=this.getLatest().__next;return e===null?null:xe(e)}getNextSiblings(){const e=[];let t=this.getNextSibling();for(;t!==null;)e.push(t),t=t.getNextSibling();return e}getCommonAncestor(e){const t=V(this)?this:this.getParent(),r=V(e)?e:e.getParent(),i=t&&r?bo(t,r):null;return i?i.commonAncestor:null}is(e){return e!=null&&this.__key===e.__key}isBefore(e){const t=bo(this,e);return t!==null&&(t.type==="descendant"||(t.type==="branch"?qy(t)===-1:(t.type!=="same"&&t.type!=="ancestor"&&se(279),!1)))}isParentOf(e){const t=bo(this,e);return t!==null&&t.type==="ancestor"}getNodesBetween(e){const t=this.isBefore(e),r=[],i=new Set;let s=this;for(;s!==null;){const o=s.__key;if(i.has(o)||(i.add(o),r.push(s)),s===e)break;const a=V(s)?t?s.getFirstChild():s.getLastChild():null;if(a!==null){s=a;continue}const l=t?s.getNextSibling():s.getPreviousSibling();if(l!==null){s=l;continue}const u=s.getParentOrThrow();if(i.has(u.__key)||r.push(u),u===e)break;let c=null,f=u;do{if(f===null&&se(68),c=t?f.getNextSibling():f.getPreviousSibling(),f=f.getParent(),f===null)break;c!==null||i.has(f.__key)||r.push(f)}while(c===null);s=c}return t||r.reverse(),r}isDirty(){const e=Ge()._dirtyLeaves;return e!==null&&e.has(this.__key)}getLatest(){const e=xe(this.__key);return e===null&&se(113),e}getWritable(){St();const e=ui(),t=Ge(),r=e._nodeMap,i=this.__key,s=this.getLatest(),o=t._cloneNotNeeded,a=ne();if(a!==null&&a.setCachedNodes(null),o.has(i))return gl(s),s;const l=Hd(s);return o.add(i),gl(l),r.set(i,l),l}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(e,t){se(70)}updateDOM(e,t,r){se(71)}exportDOM(e){return{element:this.createDOM(e._config,e)}}exportJSON(){const e=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...e}}static importJSON(e){se(18,this.name)}updateFromJSON(e){return function(t,r){const i=t.getWritable(),s=r.$;let o=s;for(const a of Rm(i).flatKeys)a in r&&(o!==void 0&&o!==s||(o={...s}),o[a]=r[a]);return(i.__state||o)&&Im(t).updateFromJSON(o),i}(this,e)}static transform(){return null}remove(e){mc(this,!0,e)}replace(e,t){St();let r=ne();r!==null&&(r=r.clone()),Pu(this,e);const i=this.getLatest(),s=this.__key,o=e.__key,a=e.getWritable(),l=this.getParentOrThrow().getWritable(),u=l.__size;Di(a);const c=i.getPreviousSibling(),f=i.getNextSibling(),d=i.__prev,h=i.__next,p=i.__parent;if(mc(i,!1,!0),c===null?l.__first=o:c.getWritable().__next=o,a.__prev=d,f===null?l.__last=o:f.getWritable().__prev=o,a.__next=h,a.__parent=p,l.__size=u,t&&(V(this)&&V(a)||se(139),this.getChildren().forEach(m=>{a.append(m)})),G(r)){Ot(r);const m=r.anchor,_=r.focus;m.key===s&&uh(m,a),_.key===s&&uh(_,a)}return Vr()===s&&Tt(o),a}insertAfter(e,t=!0){St(),Pu(this,e);const r=this.getWritable(),i=e.getWritable(),s=i.getParent(),o=ne();let a=!1,l=!1;if(s!==null){const h=e.getIndexWithinParent();if(Di(i),G(o)){const p=s.__key,m=o.anchor,_=o.focus;a=m.type==="element"&&m.key===p&&m.offset===h+1,l=_.type==="element"&&_.key===p&&_.offset===h+1}}const u=this.getNextSibling(),c=this.getParentOrThrow().getWritable(),f=i.__key,d=r.__next;if(u===null?c.__last=f:u.getWritable().__prev=f,c.__size++,r.__next=f,i.__next=d,i.__prev=r.__key,i.__parent=r.__parent,t&&G(o)){const h=this.getIndexWithinParent();fl(o,c,h+1);const p=c.__key;a&&o.anchor.set(p,h+2,"element"),l&&o.focus.set(p,h+2,"element")}return e}insertBefore(e,t=!0){St(),Pu(this,e);const r=this.getWritable(),i=e.getWritable(),s=i.__key;Di(i);const o=this.getPreviousSibling(),a=this.getParentOrThrow().getWritable(),l=r.__prev,u=this.getIndexWithinParent();o===null?a.__first=s:o.getWritable().__next=s,a.__size++,r.__prev=s,i.__prev=l,i.__next=r.__key,i.__parent=r.__parent;const c=ne();return t&&G(c)&&fl(c,this.getParentOrThrow(),u),e}isParentRequired(){return!1}createParentElementNode(){return kn()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(e,t){St();const r=this.getPreviousSibling(),i=this.getParentOrThrow();if(r===null)return i.select(0,0);if(V(r))return r.select();if(!Z(r)){const s=r.getIndexWithinParent()+1;return i.select(s,s)}return r.select(e,t)}selectNext(e,t){St();const r=this.getNextSibling(),i=this.getParentOrThrow();if(r===null)return i.select();if(V(r))return r.select(0,0);if(!Z(r)){const s=r.getIndexWithinParent();return i.select(s,s)}return r.select(e,t)}markDirty(){this.getWritable()}reconcileObservedMutation(e,t){this.markDirty()}}class Yi extends $s{static getType(){return"linebreak"}static clone(e){return new Yi(e.__key)}constructor(e){super(e)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:e=>function(t){const r=t.parentElement;if(r!==null&&ml(r)){const i=r.firstChild;if(i===t||i.nextSibling===t&&ha(i)){const s=r.lastChild;if(s===t||s.previousSibling===t&&ha(s))return!0}}return!1}(e)||function(t){const r=t.parentElement;if(r!==null&&ml(r)){const i=r.firstChild;if(i===t||i.nextSibling===t&&ha(i))return!1;const s=r.lastChild;if(s===t||s.previousSibling===t&&ha(s))return!0}return!1}(e)?null:{conversion:y2,priority:0}}}static importJSON(e){return Pi().updateFromJSON(e)}}function y2(n){return{node:Pi()}}function Pi(){return We(new Yi)}function Si(n){return n instanceof Yi}function ha(n){return Pr(n)&&/^( |\t|\r?\n)+$/.test(n.textContent||"")}function Nu(n,e){return 16&e?"code":e&dd?"mark":32&e?"sub":64&e?"sup":null}function Mu(n,e){return 1&e?"strong":2&e?"em":"span"}function Zm(n,e,t,r,i){const s=r.classList;let o=ps(i,"base");o!==void 0&&s.add(...o),o=ps(i,"underlineStrikethrough");let a=!1;const l=e&sl&&e&il;o!==void 0&&(t&sl&&t&il?(a=!0,l||s.add(...o)):l&&s.remove(...o));for(const u in Zr){const c=Zr[u];if(o=ps(i,u),o!==void 0)if(t&c){if(a&&(u==="underline"||u==="strikethrough")){e&c&&s.remove(...o);continue}e&c&&(!l||u!=="underline")&&u!=="strikethrough"||s.add(...o)}else e&c&&s.remove(...o)}}function ey(n,e,t){const r=e.firstChild,i=t.isComposing(),s=n+(i?Pl:"");if(r==null)e.textContent=s;else{const o=r.nodeValue;if(o!==s)if(i||Oi){const[a,l,u]=function(c,f){const d=c.length,h=f.length;let p=0,m=0;for(;p<d&&p<h&&c[p]===f[p];)p++;for(;m+p<d&&m+p<h&&c[d-m-1]===f[h-m-1];)m++;return[p,d-p-m,f.slice(p,h-m)]}(o,s);l!==0&&r.deleteData(a,l),r.insertData(a,u)}else r.nodeValue=s}}function oh(n,e,t,r,i,s){ey(i,n,e);const o=s.theme.text;o!==void 0&&Zm(0,0,r,n,o)}function pa(n,e){const t=document.createElement(e);return t.appendChild(n),t}let xn=class ty extends $s{static getType(){return"text"}static clone(e){return new ty(e.__text,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__text=e.__text,this.__format=e.__format,this.__style=e.__style,this.__mode=e.__mode,this.__detail=e.__detail}constructor(e="",t){super(t),this.__text=e,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const e=this.getLatest();return Vv[e.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===Vr()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(e){const t=Zr[e];return!!(this.getFormat()&t)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(e,t){return pl(this.getLatest().__format,e,t)}canHaveFormat(){return!0}isInline(){return!0}createDOM(e,t){const r=this.__format,i=Nu(0,r),s=Mu(0,r),o=i===null?s:i,a=document.createElement(o);let l=a;this.hasFormat("code")&&a.setAttribute("spellcheck","false"),i!==null&&(l=document.createElement(s),a.appendChild(l)),oh(l,this,0,r,this.__text,e);const u=this.__style;return u!==""&&(a.style.cssText=u),a}updateDOM(e,t,r){const i=this.__text,s=e.__format,o=this.__format,a=Nu(0,s),l=Nu(0,o),u=Mu(0,s),c=Mu(0,o);if((a===null?u:a)!==(l===null?c:l))return!0;if(a===l&&u!==c){const m=t.firstChild;m==null&&se(48);const _=document.createElement(c);return oh(_,this,0,o,i,r),t.replaceChild(_,m),!1}let f=t;l!==null&&a!==null&&(f=t.firstChild,f==null&&se(49)),ey(i,f,this);const d=r.theme.text;d!==void 0&&s!==o&&Zm(0,s,o,f,d);const h=e.__style,p=this.__style;return h!==p&&(t.style.cssText=p),!1}static importDOM(){return{"#text":()=>({conversion:C2,priority:0}),b:()=>({conversion:b2,priority:0}),code:()=>({conversion:vr,priority:0}),em:()=>({conversion:vr,priority:0}),i:()=>({conversion:vr,priority:0}),mark:()=>({conversion:vr,priority:0}),s:()=>({conversion:vr,priority:0}),span:()=>({conversion:_2,priority:0}),strong:()=>({conversion:vr,priority:0}),sub:()=>({conversion:vr,priority:0}),sup:()=>({conversion:vr,priority:0}),u:()=>({conversion:vr,priority:0})}}static importJSON(e){return we().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTextContent(e.text).setFormat(e.format).setDetail(e.detail).setMode(e.mode).setStyle(e.style)}exportDOM(e){let{element:t}=super.exportDOM(e);return je(t)||se(132),t.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?t.style.textTransform="lowercase":this.hasFormat("uppercase")?t.style.textTransform="uppercase":this.hasFormat("capitalize")&&(t.style.textTransform="capitalize"),this.hasFormat("bold")&&(t=pa(t,"b")),this.hasFormat("italic")&&(t=pa(t,"i")),this.hasFormat("strikethrough")&&(t=pa(t,"s")),this.hasFormat("underline")&&(t=pa(t,"u")),{element:t}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(e,t){}setFormat(e){const t=this.getWritable();return t.__format=typeof e=="string"?Zr[e]:e,t}setDetail(e){const t=this.getWritable();return t.__detail=typeof e=="string"?zv[e]:e,t}setStyle(e){const t=this.getWritable();return t.__style=e,t}toggleFormat(e){const t=pl(this.getFormat(),e,null);return this.setFormat(t)}toggleDirectionless(){const e=this.getWritable();return e.__detail^=1,e}toggleUnmergeable(){const e=this.getWritable();return e.__detail^=2,e}setMode(e){const t=Kv[e];if(this.__mode===t)return this;const r=this.getWritable();return r.__mode=t,r}setTextContent(e){if(this.__text===e)return this;const t=this.getWritable();return t.__text=e,t}select(e,t){St();let r=e,i=t;const s=ne(),o=this.getTextContent(),a=this.__key;if(typeof o=="string"){const l=o.length;r===void 0&&(r=l),i===void 0&&(i=l)}else r=0,i=0;if(!G(s))return uy(a,r,a,i,"text","text");{const l=Vr();l!==s.anchor.key&&l!==s.focus.key||Tt(a),s.setTextNodeRange(this,r,this,i)}return s}selectStart(){return this.select(0,0)}selectEnd(){const e=this.getTextContentSize();return this.select(e,e)}spliceText(e,t,r,i){const s=this.getWritable(),o=s.__text,a=r.length;let l=e;l<0&&(l=a+l,l<0&&(l=0));const u=ne();if(i&&G(u)){const f=e+a;u.setTextNodeRange(s,f,s,f)}const c=o.slice(0,l)+r+o.slice(l+t);return s.__text=c,s}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...e){St();const t=this.getLatest(),r=t.getTextContent();if(r==="")return[];const i=t.__key,s=Vr(),o=r.length;e.sort((D,O)=>D-O),e.push(o);const a=[],l=e.length;for(let D=0,O=0;D<o&&O<=l;O++){const z=e[O];z>D&&(a.push(r.slice(D,z)),D=z)}const u=a.length;if(u===1)return[t];const c=a[0],f=t.getParent();let d;const h=t.getFormat(),p=t.getStyle(),m=t.__detail;let _=!1,C=null,v=null;const x=ne();if(G(x)){const[D,O]=x.isBackward()?[x.focus,x.anchor]:[x.anchor,x.focus];D.type==="text"&&D.key===i&&(C=D),O.type==="text"&&O.key===i&&(v=O)}t.isSegmented()?(d=we(c),d.__format=h,d.__style=p,d.__detail=m,d.__state=Gf(t,d),_=!0):d=t.setTextContent(c);const M=[d];for(let D=1;D<u;D++){const O=we(a[D]);O.__format=h,O.__style=p,O.__detail=m,O.__state=Gf(t,O);const z=O.__key;s===i&&Tt(z),M.push(O)}const $=C?C.offset:null,k=v?v.offset:null;let P=0;for(const D of M){if(!C&&!v)break;const O=P+D.getTextContentSize();if(C!==null&&$!==null&&$<=O&&$>=P&&(C.set(D.getKey(),$-P,"text"),$<O&&(C=null)),v!==null&&k!==null&&k<=O&&k>=P){v.set(D.getKey(),k-P,"text");break}P=O}if(f!==null){(function(z){const w=z.getPreviousSibling(),q=z.getNextSibling();w!==null&&gl(w),q!==null&&gl(q)})(this);const D=f.getWritable(),O=this.getIndexWithinParent();_?(D.splice(O,0,M),this.remove()):D.splice(O,1,M),G(x)&&fl(x,f,O,u-1)}return M}mergeWithSibling(e){const t=e===this.getPreviousSibling();t||e===this.getNextSibling()||se(50);const r=this.__key,i=e.__key,s=this.__text,o=s.length;Vr()===i&&Tt(r);const a=ne();if(G(a)){const f=a.anchor,d=a.focus;f!==null&&f.key===i&&mh(f,t,r,e,o),d!==null&&d.key===i&&mh(d,t,r,e,o)}const l=e.__text,u=t?l+s:s+l;this.setTextContent(u);const c=this.getWritable();return e.remove(),c}isTextEntity(){return!1}};function _2(n){return{forChild:Ad(n.style),node:null}}function b2(n){const e=n,t=e.style.fontWeight==="normal";return{forChild:Ad(e.style,t?void 0:"bold"),node:null}}const ah=new WeakMap;function v2(n){if(!je(n))return!1;if(n.nodeName==="PRE")return!0;const e=n.style.whiteSpace;return typeof e=="string"&&e.startsWith("pre")}function C2(n){const e=n;n.parentElement===null&&se(129);let t=e.textContent||"";if(function(r){let i,s=r.parentNode;const o=[r];for(;s!==null&&(i=ah.get(s))===void 0&&!v2(s);)o.push(s),s=s.parentNode;const a=i===void 0?s:i;for(let l=0;l<o.length;l++)ah.set(o[l],a);return a}(e)!==null){const r=t.split(/(\r?\n|\t)/),i=[],s=r.length;for(let o=0;o<s;o++){const a=r[o];a===`
`||a===`\r
`?i.push(Pi()):a==="	"?i.push(Bo()):a!==""&&i.push(we(a))}return{node:i}}if(t=t.replace(/\r/g,"").replace(/[ \t\n]+/g," "),t==="")return{node:null};if(t[0]===" "){let r=e,i=!0;for(;r!==null&&(r=lh(r,!1))!==null;){const s=r.textContent||"";if(s.length>0){/[ \t\n]$/.test(s)&&(t=t.slice(1)),i=!1;break}}i&&(t=t.slice(1))}if(t[t.length-1]===" "){let r=e,i=!0;for(;r!==null&&(r=lh(r,!0))!==null;)if((r.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){i=!1;break}i&&(t=t.slice(0,t.length-1))}return t===""?{node:null}:{node:we(t)}}function lh(n,e){let t=n;for(;;){let r;for(;(r=e?t.nextSibling:t.previousSibling)===null;){const s=t.parentElement;if(s===null)return null;t=s}if(t=r,je(t)){const s=t.style.display;if(s===""&&!kc(t)||s!==""&&!s.startsWith("inline"))return null}let i=t;for(;(i=e?t.firstChild:t.lastChild)!==null;)t=i;if(Pr(t))return t;if(t.nodeName==="BR")return null}}const E2={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function vr(n){const e=E2[n.nodeName.toLowerCase()];return e===void 0?{node:null}:{forChild:Ad(n.style,e),node:null}}function we(n=""){return We(new xn(n))}function Z(n){return n instanceof xn}function Ad(n,e){const t=n.fontWeight,r=n.textDecoration.split(" "),i=t==="700"||t==="bold",s=r.includes("line-through"),o=n.fontStyle==="italic",a=r.includes("underline"),l=n.verticalAlign;return u=>(Z(u)&&(i&&!u.hasFormat("bold")&&u.toggleFormat("bold"),s&&!u.hasFormat("strikethrough")&&u.toggleFormat("strikethrough"),o&&!u.hasFormat("italic")&&u.toggleFormat("italic"),a&&!u.hasFormat("underline")&&u.toggleFormat("underline"),l!=="sub"||u.hasFormat("subscript")||u.toggleFormat("subscript"),l!=="super"||u.hasFormat("superscript")||u.toggleFormat("superscript"),e&&!u.hasFormat(e)&&u.toggleFormat(e)),u)}let Dd=class ny extends xn{static getType(){return"tab"}static clone(e){return new ny(e.__key)}constructor(e){super("	",e),this.__detail=2}static importDOM(){return null}createDOM(e){const t=super.createDOM(e),r=ps(e.theme,"tab");return r!==void 0&&t.classList.add(...r),t}static importJSON(e){return Bo().updateFromJSON(e)}setTextContent(e){return e!=="	"&&e!==""&&se(126),super.setTextContent("	")}spliceText(e,t,r,i){return r===""&&t===0||r==="	"&&t===1||se(286),this}setDetail(e){return e!==2&&se(127),this}setMode(e){return e!=="normal"&&se(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}};function Bo(){return We(new Dd)}function ry(n){return n instanceof Dd}let w2=class{constructor(e,t,r){this._selection=null,this.key=e,this.offset=t,this.type=r}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){return this.key===e.key?this.offset<e.offset:By(lr(Mr(this,"next")),lr(Mr(e,"next")))<0}getNode(){const e=xe(this.key);return e===null&&se(20),e}set(e,t,r,i){const s=this._selection,o=this.key;i&&this.key===e&&this.offset===t&&this.type===r||(this.key=e,this.offset=t,this.type=r,Bs()||(Vr()===o&&Tt(e),s!==null&&(s.setCachedNodes(null),s.dirty=!0)))}};function an(n,e,t){return new w2(n,e,t)}function Ou(n,e){let t=e.__key,r=n.offset,i="element";if(Z(e)){i="text";const s=e.getTextContentSize();r>s&&(r=s)}else if(!V(e)){const s=e.getNextSibling();if(Z(s))t=s.__key,r=0,i="text";else{const o=e.getParent();o&&(t=o.__key,r=e.getIndexWithinParent()+1)}}n.set(t,r,i)}function uh(n,e){if(V(e)){const t=e.getLastDescendant();V(t)||Z(t)?Ou(n,t):Ou(n,e)}else Ou(n,e)}let iy=class sy{constructor(e){this._cachedNodes=null,this._nodes=e,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!Vt(e))return!1;const t=this._nodes,r=e._nodes;return t.size===r.size&&Array.from(t).every(i=>r.has(i))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(e){this.dirty=!0,this._nodes.add(e),this._cachedNodes=null}delete(e){this.dirty=!0,this._nodes.delete(e),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new sy(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const t=this.getNodes(),r=t.length,i=t[r-1];let s;if(Z(i))s=i.select();else{const o=i.getIndexWithinParent()+1;s=i.getParentOrThrow().select(o,o)}s.insertNodes(e);for(let o=0;o<r;o++)t[o].remove()}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const t=this._nodes,r=[];for(const i of t){const s=xe(i);s!==null&&r.push(s)}return Bs()||(this._cachedNodes=r),r}getTextContent(){const e=this.getNodes();let t="";for(let r=0;r<e.length;r++)t+=e[r].getTextContent();return t}deleteNodes(){const e=this.getNodes();if((ne()||Fs())===this&&e[0]){const t=ft(e[0],"next");oC(ni(t,t))}for(const t of e)t.remove()}};function G(n){return n instanceof qo}let qo=class oy{constructor(e,t,r,i){this.anchor=e,this.focus=t,e._selection=this,t._selection=this,this._cachedNodes=null,this.format=r,this.style=i,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return!!G(e)&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const t=function(r){const i=[],[s,o]=r.getTextSlices();s&&i.push(s.caret.origin);const a=new Set,l=new Set;for(const u of r)if(zn(u)){const{origin:c}=u;i.length===0?a.add(c):(l.add(c),i.push(c))}else{const{origin:c}=u;V(c)&&l.has(c)||i.push(c)}if(o&&i.push(o.caret.origin),Li(r.focus)&&V(r.focus.origin)&&r.focus.getNodeAtCaret()===null)for(let u=Jn(r.focus.origin,"previous");zn(u)&&a.has(u.origin)&&!u.origin.isEmpty()&&u.origin.is(i[i.length-1]);u=To(u))a.delete(u.origin),i.pop();for(;i.length>1;){const u=i[i.length-1];if(!V(u)||l.has(u)||u.isEmpty()||a.has(u))break;i.pop()}if(i.length===0&&r.isCollapsed()){const u=lr(r.anchor),c=lr(r.anchor.getFlipped()),f=h=>Xr(h)?h.origin:h.getNodeAtCaret(),d=f(u)||f(c)||(r.anchor.getNodeAtCaret()?u.origin:c.origin);i.push(d)}return i}(Uy(Lh(this),"next"));return Bs()||(this._cachedNodes=t),t}setTextNodeRange(e,t,r,i){this.anchor.set(e.__key,t,"text"),this.focus.set(r.__key,i,"text")}getTextContent(){const e=this.getNodes();if(e.length===0)return"";const t=e[0],r=e[e.length-1],i=this.anchor,s=this.focus,o=i.isBefore(s),[a,l]=yc(this);let u="",c=!0;for(let f=0;f<e.length;f++){const d=e[f];if(V(d)&&!d.isInline())c||(u+=`
`),c=!d.isEmpty();else if(c=!1,Z(d)){let h=d.getTextContent();d===t?d===r?i.type==="element"&&s.type==="element"&&s.offset!==i.offset||(h=a<l?h.slice(a,l):h.slice(l,a)):h=o?h.slice(a):h.slice(l):d===r&&(h=o?h.slice(0,l):h.slice(0,a)),u+=h}else!Pe(d)&&!Si(d)||d===r&&this.isCollapsed()||(u+=d.getTextContent())}return u}applyDOMRange(e){const t=Ge(),r=t.getEditorState()._selection,i=ly(e.startContainer,e.startOffset,e.endContainer,e.endOffset,t,r);if(i===null)return;const[s,o]=i;this.anchor.set(s.key,s.offset,s.type,!0),this.focus.set(o.key,o.offset,o.type,!0),Eo(this)}clone(){const e=this.anchor,t=this.focus;return new oy(an(e.key,e.offset,e.type),an(t.key,t.offset,t.type),this.format,this.style)}toggleFormat(e){this.format=pl(this.format,e,null),this.dirty=!0}setFormat(e){this.format=e,this.dirty=!0}setStyle(e){this.style=e,this.dirty=!0}hasFormat(e){const t=Zr[e];return!!(this.format&t)}insertRawText(e){const t=e.split(/(\r?\n|\t)/),r=[],i=t.length;for(let s=0;s<i;s++){const o=t[s];o===`
`||o===`\r
`?r.push(Pi()):o==="	"?r.push(Bo()):r.push(we(o))}this.insertNodes(r)}insertText(e){const t=this.anchor,r=this.focus,i=this.format,s=this.style;let o=t,a=r;!this.isCollapsed()&&r.isBefore(t)&&(o=r,a=t),o.type==="element"&&function(_,C,v,x){const M=_.getNode(),$=M.getChildAtIndex(_.offset),k=we(),P=At(M)?kn().append(k):k;k.setFormat(v),k.setStyle(x),$===null?M.append(P):$.insertBefore(P),_.is(C)&&C.set(k.__key,0,"text"),_.set(k.__key,0,"text")}(o,a,i,s),a.type==="element"&&Ao(a,lr(Mr(a,"next")));const l=o.offset;let u=a.offset;const c=this.getNodes(),f=c.length;let d=c[0];Z(d)||se(26);const h=d.getTextContent().length,p=d.getParentOrThrow();let m=c[f-1];if(f===1&&a.type==="element"&&(u=h,a.set(o.key,u,"text")),this.isCollapsed()&&l===h&&(wr(d)||!d.canInsertTextAfter()||!p.canInsertTextAfter()&&d.getNextSibling()===null)){let _=d.getNextSibling();if(Z(_)&&_.canInsertTextBefore()&&!wr(_)||(_=we(),_.setFormat(i),_.setStyle(s),p.canInsertTextAfter()?d.insertAfter(_):p.insertAfter(_)),_.select(0,0),d=_,e!=="")return void this.insertText(e)}else if(this.isCollapsed()&&l===0&&(wr(d)||!d.canInsertTextBefore()||!p.canInsertTextBefore()&&d.getPreviousSibling()===null)){let _=d.getPreviousSibling();if(Z(_)&&!wr(_)||(_=we(),_.setFormat(i),p.canInsertTextBefore()?d.insertBefore(_):p.insertBefore(_)),_.select(),d=_,e!=="")return void this.insertText(e)}else if(d.isSegmented()&&l!==h){const _=we(d.getTextContent());_.setFormat(i),d.replace(_),d=_}else if(!this.isCollapsed()&&e!==""){const _=m.getParent();if(!p.canInsertTextBefore()||!p.canInsertTextAfter()||V(_)&&(!_.canInsertTextBefore()||!_.canInsertTextAfter()))return this.insertText(""),ay(this.anchor,this.focus,null),void this.insertText(e)}if(f===1){if(Ai(d)){const x=we(e);return x.select(),void d.replace(x)}const _=d.getFormat(),C=d.getStyle();if(l!==u||_===i&&C===s){if(ry(d)){const x=we(e);return x.setFormat(i),x.setStyle(s),x.select(),void d.replace(x)}}else{if(d.getTextContent()!==""){const x=we(e);if(x.setFormat(i),x.setStyle(s),x.select(),l===0)d.insertBefore(x,!1);else{const[M]=d.splitText(l);M.insertAfter(x,!1)}return void(x.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length))}d.setFormat(i),d.setStyle(s)}const v=u-l;d=d.spliceText(l,v,e,!0),d.getTextContent()===""?d.remove():this.anchor.type==="text"&&(d.isComposing()?this.anchor.offset-=e.length:(this.format=_,this.style=C))}else{const _=new Set([...d.getParentKeys(),...m.getParentKeys()]),C=V(d)?d:d.getParentOrThrow();let v=V(m)?m:m.getParentOrThrow(),x=m;if(!C.is(v)&&v.isInline())do x=v,v=v.getParentOrThrow();while(v.isInline());if(a.type==="text"&&(u!==0||m.getTextContent()==="")||a.type==="element"&&m.getIndexWithinParent()<u)if(Z(m)&&!Ai(m)&&u!==m.getTextContentSize()){if(m.isSegmented()){const D=we(m.getTextContent());m.replace(D),m=D}At(a.getNode())||a.type!=="text"||(m=m.spliceText(0,u,"")),_.add(m.__key)}else{const D=m.getParentOrThrow();D.canBeEmpty()||D.getChildrenSize()!==1?m.remove():D.remove()}else _.add(m.__key);const M=v.getChildren(),$=new Set(c),k=C.is(v),P=C.isInline()&&d.getNextSibling()===null?C:d;for(let D=M.length-1;D>=0;D--){const O=M[D];if(O.is(d)||V(O)&&O.isParentOf(d))break;O.isAttached()&&(!$.has(O)||O.is(x)?k||P.insertAfter(O,!1):O.remove())}if(!k){let D=v,O=null;for(;D!==null;){const z=D.getChildren(),w=z.length;(w===0||z[w-1].is(O))&&(_.delete(D.__key),O=D),D=D.getParent()}}if(Ai(d))if(l===h)d.select();else{const D=we(e);D.select(),d.replace(D)}else d=d.spliceText(l,h-l,e,!0),d.getTextContent()===""?d.remove():d.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length);for(let D=1;D<f;D++){const O=c[D],z=O.__key;_.has(z)||O.remove()}}}removeText(){const e=ne()===this;Ka(this,aC(Lh(this))),e&&ne()!==this&&Ot(this)}formatText(e,t=null){if(this.isCollapsed())return this.toggleFormat(e),void Tt(null);const r=this.getNodes(),i=[];for(const M of r)Z(M)&&i.push(M);const s=M=>{r.forEach($=>{if(V($)){const k=$.getFormatFlags(e,M);$.setTextFormat(k)}})},o=i.length;if(o===0)return this.toggleFormat(e),Tt(null),void s(t);const a=this.anchor,l=this.focus,u=this.isBackward(),c=u?l:a,f=u?a:l;let d=0,h=i[0],p=c.type==="element"?0:c.offset;if(c.type==="text"&&p===h.getTextContentSize()&&(d=1,h=i[1],p=0),h==null)return;const m=h.getFormatFlags(e,t);s(m);const _=o-1;let C=i[_];const v=f.type==="text"?f.offset:C.getTextContentSize();if(h.is(C)){if(p===v)return;if(wr(h)||p===0&&v===h.getTextContentSize())h.setFormat(m);else{const M=h.splitText(p,v),$=p===0?M[0]:M[1];$.setFormat(m),c.type==="text"&&c.set($.__key,0,"text"),f.type==="text"&&f.set($.__key,v-p,"text")}return void(this.format=m)}p===0||wr(h)||([,h]=h.splitText(p),p=0),h.setFormat(m);const x=C.getFormatFlags(e,m);v>0&&(v===C.getTextContentSize()||wr(C)||([C]=C.splitText(v)),C.setFormat(x));for(let M=d+1;M<_;M++){const $=i[M],k=$.getFormatFlags(e,x);$.setFormat(k)}c.type==="text"&&c.set(h.__key,p,"text"),f.type==="text"&&f.set(C.__key,v,"text"),this.format=m|x}insertNodes(e){if(e.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const p=ne();return G(p)||se(134),p.insertNodes(e)}const t=(this.isBackward()?this.focus:this.anchor).getNode(),r=$u(t,Dn),i=e[e.length-1];if(V(r)&&"__language"in r){if("__language"in e[0])this.insertText(e[0].getTextContent());else{const p=Iu(this);r.splice(p,0,e),i.selectEnd()}return}if(!e.some(p=>(V(p)||Pe(p))&&!p.isInline())){V(r)||se(211,t.constructor.name,t.getType());const p=Iu(this);return r.splice(p,0,e),void i.selectEnd()}const s=function(p){const m=kn();let _=null;for(let C=0;C<p.length;C++){const v=p[C],x=Si(v);if(x||Pe(v)&&v.isInline()||V(v)&&v.isInline()||Z(v)||v.isParentRequired()){if(_===null&&(_=v.createParentElementNode(),m.append(_),x))continue;_!==null&&_.append(v)}else m.append(v),_=null}return m}(e),o=s.getLastDescendant(),a=s.getChildren(),l=!V(r)||!r.isEmpty()?this.insertParagraph():null,u=a[a.length-1];let c=a[0];var f;V(f=c)&&Dn(f)&&!f.isEmpty()&&V(r)&&(!r.isEmpty()||r.canMergeWhenEmpty())&&(V(r)||se(211,t.constructor.name,t.getType()),r.append(...c.getChildren()),c=a[1]),c&&(r===null&&se(212,t.constructor.name,t.getType()),function(p,m,_){const C=m.getParentOrThrow().getLastChild();let v=m;const x=[m];for(;v!==C;)v.getNextSibling()||se(140),v=v.getNextSibling(),x.push(v);let M=p;for(const $ of x)M=M.insertAfter($)}(r,c));const d=$u(o,Dn);l&&V(d)&&(l.canMergeWhenEmpty()||Dn(u))&&(d.append(...l.getChildren()),l.remove()),V(r)&&r.isEmpty()&&r.remove(),o.selectEnd();const h=V(r)?r.getLastChild():null;Si(h)&&d!==r&&h.remove()}insertParagraph(){if(this.anchor.key==="root"){const o=kn();return Ne().splice(this.anchor.offset,0,[o]),o.select(),o}const e=Iu(this),t=$u(this.anchor.getNode(),Dn);V(t)||se(213);const r=t.getChildAtIndex(e),i=r?[r,...r.getNextSiblings()]:[],s=t.insertNewAfter(this,!1);return s?(s.append(...i),s.selectStart(),s):null}insertLineBreak(e){const t=Pi();if(this.insertNodes([t]),e){const r=t.getParentOrThrow(),i=t.getIndexWithinParent();r.select(i,i)}}extract(){const e=this.getNodes(),t=e.length,r=t-1,i=this.anchor,s=this.focus;let o=e[0],a=e[r];const[l,u]=yc(this);if(t===0)return[];if(t===1){if(Z(o)&&!this.isCollapsed()){const f=l>u?u:l,d=l>u?l:u,h=o.splitText(f,d),p=f===0?h[0]:h[1];return p!=null?[p]:[]}return[o]}const c=i.isBefore(s);if(Z(o)){const f=c?l:u;f===o.getTextContentSize()?e.shift():f!==0&&([,o]=o.splitText(f),e[0]=o)}if(Z(a)){const f=a.getTextContent().length,d=c?u:l;d===0?e.pop():d!==f&&([a]=a.splitText(d),e[r]=a)}return e}modify(e,t,r){if(yh(this,e,t,r))return;const i=e==="move",s=Ge(),o=Vn(On(s));if(!o)return;const a=s._blockCursorElement,l=s._rootElement,u=this.focus.getNode();if(l===null||a===null||!V(u)||u.isInline()||u.canBeEmpty()||wc(a,s,l),this.dirty){let c=ks(s,this.anchor.key),f=ks(s,this.focus.key);this.anchor.type==="text"&&(c=xs(c)),this.focus.type==="text"&&(f=xs(f)),c&&f&&dy(o,c,this.anchor.offset,f,this.focus.offset)}if(function(c,f,d,h){c.modify(f,d,h)}(o,e,t?"backward":"forward",r),o.rangeCount>0){const c=o.getRangeAt(0),f=this.anchor.getNode(),d=At(f)?f:z2(f);if(this.applyDOMRange(c),this.dirty=!0,!i){const h=this.getNodes(),p=[];let m=!1;for(let _=0;_<h.length;_++){const C=h[_];Ec(C,d)?p.push(C):m=!0}if(m&&p.length>0)if(t){const _=p[0];V(_)?_.selectStart():_.getParentOrThrow().selectStart()}else{const _=p[p.length-1];V(_)?_.selectEnd():_.getParentOrThrow().selectEnd()}o.anchorNode===c.startContainer&&o.anchorOffset===c.startOffset||function(_){const C=_.focus,v=_.anchor,x=v.key,M=v.offset,$=v.type;v.set(C.key,C.offset,C.type,!0),C.set(x,M,$,!0)}(this)}}r==="lineboundary"&&yh(this,e,t,r,"decorators")}forwardDeletion(e,t,r){if(!r&&(e.type==="element"&&V(t)&&e.offset===t.getChildrenSize()||e.type==="text"&&e.offset===t.getTextContentSize())){const i=t.getParent(),s=t.getNextSibling()||(i===null?null:i.getNextSibling());if(V(s)&&s.isShadowRoot())return!0}return!1}deleteCharacter(e){const t=this.isCollapsed();if(this.isCollapsed()){const r=this.anchor;let i=r.getNode();if(this.forwardDeletion(r,i,e))return;const s=Gd(Mr(r,e?"previous":"next"));if(s.getTextSlices().every(a=>a===null||a.distance===0)){let a={type:"initial"};for(const l of s.iterNodeCarets("shadowRoot"))if(zn(l)){if(!l.origin.isInline()){if(l.origin.isShadowRoot()){if(a.type==="merge-block")break;if(V(s.anchor.origin)&&s.anchor.origin.isEmpty()){const u=lr(l);Ka(this,ni(u,u)),s.anchor.origin.remove()}return}a.type!=="merge-next-block"&&a.type!=="merge-block"||(a={block:a.block,caret:l,type:"merge-block"})}}else{if(a.type==="merge-block")break;if(Li(l)){if(V(l.origin)){if(l.origin.isInline()){if(!l.origin.isParentOf(s.anchor.origin))break}else a={block:l.origin,type:"merge-next-block"};continue}if(Pe(l.origin)){if(!l.origin.isIsolated())if(a.type==="merge-next-block"&&(l.origin.isKeyboardSelectable()||!l.origin.isInline())&&V(s.anchor.origin)&&s.anchor.origin.isEmpty()){s.anchor.origin.remove();const u=cy();u.add(l.origin.getKey()),Ot(u)}else l.origin.remove();return}break}}if(a.type==="merge-block"){const{caret:l,block:u}=a;return Ka(this,ni(!l.origin.isEmpty()&&u.isEmpty()?Gl(ft(u,l.direction)):s.anchor,l)),this.removeText()}}const o=this.focus;if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&r.offset===0&&dh(this,r.getNode()))return}else{const a=o.type==="text"?o.getNode():null;if(i=r.type==="text"?r.getNode():null,a!==null&&a.isSegmented()){const l=o.offset,u=a.getTextContentSize();if(a.is(i)||e&&l!==u||!e&&l!==0)return void fh(a,e,l)}else if(i!==null&&i.isSegmented()){const l=r.offset,u=i.getTextContentSize();if(i.is(a)||e&&l!==0||!e&&l!==u)return void fh(i,e,l)}(function(l,u){const c=l.anchor,f=l.focus,d=c.getNode(),h=f.getNode();if(d===h&&c.type==="text"&&f.type==="text"){const p=c.offset,m=f.offset,_=p<m,C=_?p:m,v=_?m:p,x=v-1;C!==x&&function(M){return!(Dy(M)||x2(M))}(d.getTextContent().slice(C,v))&&(u?f.set(f.key,x,f.type):c.set(c.key,x,c.type))}})(this,e)}}if(this.removeText(),e&&!t&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const r=this.anchor.getNode();r.isEmpty()&&At(r.getParent())&&r.getPreviousSibling()===null&&dh(this,r)}}deleteLine(e){this.isCollapsed()&&this.modify("extend",e,"lineboundary"),this.isCollapsed()?this.deleteCharacter(e):this.removeText()}deleteWord(e){if(this.isCollapsed()){const t=this.anchor,r=t.getNode();if(this.forwardDeletion(t,r,e))return;this.modify("extend",e,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}};function Vt(n){return n instanceof iy}function ch(n){const e=n.offset;if(n.type==="text")return e;const t=n.getNode();return e===t.getChildrenSize()?t.getTextContent().length:0}function yc(n){const e=n.getStartEndPoints();if(e===null)return[0,0];const[t,r]=e;return t.type==="element"&&r.type==="element"&&t.key===r.key&&t.offset===r.offset?[0,0]:[ch(t),ch(r)]}function dh(n,e){for(let t=e;t;t=t.getParent()){if(V(t)){if(t.collapseAtStart(n))return!0;if(gr(t))break}if(t.getPreviousSibling())break}return!1}const x2=(()=>{try{const n=new RegExp("\\p{Emoji}","u"),e=n.test.bind(n);if(e("❤️")&&e("#️⃣")&&e("👍"))return e}catch{}return()=>!1})();function fh(n,e,t){const r=n,i=r.getTextContent().split(/(?=\s)/g),s=i.length;let o=0,a=0;for(let u=0;u<s;u++){const c=u===s-1;if(a=o,o+=i[u].length,e&&o===t||o>t||c){i.splice(u,1),c&&(a=void 0);break}}const l=i.join("").trim();l===""?r.remove():(r.setTextContent(l),r.select(a,a))}function hh(n,e,t,r){let i,s=e;if(je(n)){let o=!1;const a=n.childNodes,l=a.length,u=r._blockCursorElement;s===l&&(o=!0,s=l-1);let c=a[s],f=!1;if(c===u)c=a[s+1],f=!0;else if(u!==null){const d=u.parentNode;n===d&&e>Array.prototype.indexOf.call(d.children,u)&&s--}if(i=fs(c),Z(i))s=Qr(i,o?"next":"previous");else{let d=fs(n);if(d===null)return null;if(V(d)){const h=r.getElementByKey(d.getKey());h===null&&se(214),[d,s]=d.getDOMSlot(h).resolveChildIndex(d,h,n,e),V(d)||se(215),o&&s>=d.getChildrenSize()&&(s=Math.max(0,d.getChildrenSize()-1));let m=d.getChildAtIndex(s);if(V(m)&&function(_,C,v){const x=_.getParent();return v===null||x===null||!x.canBeEmpty()||x!==v.getNode()}(m,0,t)){const _=o?m.getLastDescendant():m.getFirstDescendant();_===null?d=m:(m=_,d=V(m)?m:m.getParentOrThrow()),s=0}Z(m)?(i=m,d=null,s=Qr(m,o?"next":"previous")):m!==d&&o&&!f&&(V(d)||se(216),s=Math.min(d.getChildrenSize(),s+1))}else{const h=d.getIndexWithinParent();s=e===0&&Pe(d)&&fs(n)===d?h:h+1,d=d.getParentOrThrow()}if(V(d))return an(d.__key,s,"element")}}else i=fs(n);return Z(i)?an(i.__key,Qr(i,s,"clamp"),"text"):null}function ph(n,e,t){const r=n.offset,i=n.getNode();if(r===0){const s=i.getPreviousSibling(),o=i.getParent();if(e){if((t||!e)&&s===null&&V(o)&&o.isInline()){const a=o.getPreviousSibling();Z(a)&&n.set(a.__key,a.getTextContent().length,"text")}}else V(s)&&!t&&s.isInline()?n.set(s.__key,s.getChildrenSize(),"element"):Z(s)&&n.set(s.__key,s.getTextContent().length,"text")}else if(r===i.getTextContent().length){const s=i.getNextSibling(),o=i.getParent();if(e&&V(s)&&s.isInline())n.set(s.__key,0,"element");else if((t||e)&&s===null&&V(o)&&o.isInline()&&!o.canInsertTextAfter()){const a=o.getNextSibling();Z(a)&&n.set(a.__key,0,"text")}}}function ay(n,e,t){if(n.type==="text"&&e.type==="text"){const r=n.isBefore(e),i=n.is(e);ph(n,r,i),ph(e,!r,i),i&&e.set(n.key,n.offset,n.type);const s=Ge();if(s.isComposing()&&s._compositionKey!==n.key&&G(t)){const o=t.anchor,a=t.focus;n.set(o.key,o.offset,o.type,!0),e.set(a.key,a.offset,a.type,!0)}}}function ly(n,e,t,r,i,s){if(n===null||t===null||!Uo(i,n,t))return null;const o=hh(n,e,G(s)?s.anchor:null,i);if(o===null)return null;const a=hh(t,r,G(s)?s.focus:null,i);if(a===null)return null;if(o.type==="element"&&a.type==="element"){const l=fs(n),u=fs(t);if(Pe(l)&&Pe(u))return null}return ay(o,a,s),[o,a]}function _c(n){return V(n)&&!n.isInline()}function uy(n,e,t,r,i,s){const o=ui(),a=new qo(an(n,e,i),an(t,r,s),0,"");return a.dirty=!0,o._selection=a,a}function jo(){const n=an("root",0,"element"),e=an("root",0,"element");return new qo(n,e,0,"")}function cy(){return new iy(new Set)}function Nd(n,e,t,r){const i=t._window;if(i===null)return null;const s=r||i.event,o=s?s.type:void 0,a=o==="selectionchange",l=!sc&&(a||o==="beforeinput"||o==="compositionstart"||o==="compositionend"||o==="click"&&s&&s.detail===3||o==="drop"||o===void 0);let u,c,f,d;if(G(n)&&!l)return n.clone();if(e===null)return null;if(u=e.anchorNode,c=e.focusNode,f=e.anchorOffset,d=e.focusOffset,a&&G(n)&&!Uo(t,u,c))return n.clone();const h=ly(u,f,c,d,t,n);if(h===null)return null;const[p,m]=h;return new qo(p,m,G(n)?n.format:0,G(n)?n.style:"")}function ne(){return ui()._selection}function Fs(){return Ge()._editorState._selection}function fl(n,e,t,r=1){const i=n.anchor,s=n.focus,o=i.getNode(),a=s.getNode();if(!e.is(o)&&!e.is(a))return;const l=e.__key;if(n.isCollapsed()){const u=i.offset;if(t<=u&&r>0||t<u&&r<0){const c=Math.max(0,u+r);i.set(l,c,"element"),s.set(l,c,"element"),gh(n)}}else{const u=n.isBackward(),c=u?s:i,f=c.getNode(),d=u?i:s,h=d.getNode();if(e.is(f)){const p=c.offset;(t<=p&&r>0||t<p&&r<0)&&c.set(l,Math.max(0,p+r),"element")}if(e.is(h)){const p=d.offset;(t<=p&&r>0||t<p&&r<0)&&d.set(l,Math.max(0,p+r),"element")}}gh(n)}function gh(n){const e=n.anchor,t=e.offset,r=n.focus,i=r.offset,s=e.getNode(),o=r.getNode();if(n.isCollapsed()){if(!V(s))return;const a=s.getChildrenSize(),l=t>=a,u=l?s.getChildAtIndex(a-1):s.getChildAtIndex(t);if(Z(u)){let c=0;l&&(c=u.getTextContentSize()),e.set(u.__key,c,"text"),r.set(u.__key,c,"text")}}else{if(V(s)){const a=s.getChildrenSize(),l=t>=a,u=l?s.getChildAtIndex(a-1):s.getChildAtIndex(t);if(Z(u)){let c=0;l&&(c=u.getTextContentSize()),e.set(u.__key,c,"text")}}if(V(o)){const a=o.getChildrenSize(),l=i>=a,u=l?o.getChildAtIndex(a-1):o.getChildAtIndex(i);if(Z(u)){let c=0;l&&(c=u.getTextContentSize()),r.set(u.__key,c,"text")}}}}function hl(n,e,t,r,i){let s=null,o=0,a=null;r!==null?(s=r.__key,Z(r)?(o=r.getTextContentSize(),a="text"):V(r)&&(o=r.getChildrenSize(),a="element")):i!==null&&(s=i.__key,Z(i)?a="text":V(i)&&(a="element")),s!==null&&a!==null?n.set(s,o,a):(o=e.getIndexWithinParent(),o===-1&&(o=t.getChildrenSize()),n.set(t.__key,o,"element"))}function mh(n,e,t,r,i){n.type==="text"?n.set(t,n.offset+(e?0:i),"text"):n.offset>r.getIndexWithinParent()&&n.set(n.key,n.offset-1,"element")}function dy(n,e,t,r,i){try{n.setBaseAndExtent(e,t,r,i)}catch{}}function k2(n,e,t,r,i,s,o){const a=r.anchorNode,l=r.focusNode,u=r.anchorOffset,c=r.focusOffset,f=document.activeElement;if(i.has(M2)&&f!==s||f!==null&&Fd(f))return;if(!G(e))return void(n!==null&&Uo(t,a,l)&&r.removeAllRanges());const d=e.anchor,h=e.focus,p=d.key,m=h.key,_=ks(t,p),C=ks(t,m),v=d.offset,x=h.offset,M=e.format,$=e.style,k=e.isCollapsed();let P=_,D=C,O=!1;if(d.type==="text"){P=xs(_);const A=d.getNode();O=A.getFormat()!==M||A.getStyle()!==$}else G(n)&&n.anchor.type==="text"&&(O=!0);var z,w,q,S,H;if(h.type==="text"&&(D=xs(C)),P!==null&&D!==null&&(k&&(n===null||O||G(n)&&(n.format!==M||n.style!==$))&&(z=M,w=$,q=v,S=p,H=performance.now(),Vm=[z,w,q,S,H]),u!==v||c!==x||a!==P||l!==D||r.type==="Range"&&k||(f!==null&&s.contains(f)||s.focus({preventScroll:!0}),d.type==="element"))){if(dy(r,P,v,D,x),!i.has(O2)&&e.isCollapsed()&&s!==null&&s===document.activeElement){const A=G(e)&&e.anchor.type==="element"?P.childNodes[v]||null:r.rangeCount>0?r.getRangeAt(0):null;if(A!==null){let L;if(A instanceof Text){const j=document.createRange();j.selectNode(A),L=j.getBoundingClientRect()}else L=A.getBoundingClientRect();(function(j,K,J){const W=Ry(J),Q=zd(W);if(W===null||Q===null)return;let{top:ie,bottom:te}=K,ee=0,Y=0,oe=J;for(;oe!==null;){const ue=oe===W.body;if(ue)ee=0,Y=On(j).innerHeight;else{const pe=oe.getBoundingClientRect();ee=pe.top,Y=pe.bottom}let de=0;if(ie<ee?de=-(ee-ie):te>Y&&(de=te-Y),de!==0)if(ue)Q.scrollBy(0,de);else{const pe=oe.scrollTop;oe.scrollTop+=de;const ge=oe.scrollTop-pe;ie-=ge,te-=ge}if(ue)break;oe=Wo(oe)}})(t,L,s)}}pc=!0}}function S2(n){let e=ne()||Fs();e===null&&(e=Ne().selectEnd()),e.insertNodes(n)}function Iu(n){let e=n;n.isCollapsed()||e.removeText();const t=ne();G(t)&&(e=t),G(e)||se(161);const r=e.anchor;let i=r.getNode(),s=r.offset;for(;!Dn(i);){const o=i;if([i,s]=T2(i,s),o.is(i))break}return s}function T2(n,e){const t=n.getParent();if(!t){const i=kn();return Ne().append(i),i.select(),[Ne(),0]}if(Z(n)){const i=n.splitText(e);if(i.length===0)return[t,n.getIndexWithinParent()];const s=e===0?0:1;return[t,i[0].getIndexWithinParent()+s]}if(!V(n)||e===0)return[t,n.getIndexWithinParent()];const r=n.getChildAtIndex(e);if(r){const i=new qo(an(n.__key,e,"element"),an(n.__key,e,"element"),0,""),s=n.insertNewAfter(i);s&&s.append(r,...r.getNextSiblings())}return[t,n.getIndexWithinParent()+1]}function yh(n,e,t,r,i="decorators-and-blocks"){if(e==="move"&&r==="character"&&!n.isCollapsed()){const[c,f]=t===n.isBackward()?[n.focus,n.anchor]:[n.anchor,n.focus];return f.set(c.key,c.offset,c.type),!0}const s=Mr(n.focus,t?"previous":"next"),o=r==="lineboundary",a=e==="move";let l=s,u=i==="decorators-and-blocks";if(!jy(l)){for(const c of l){u=!1;const{origin:f}=c;if(!Pe(f)||f.isIsolated()||(l=c,!o||!f.isInline()))break}if(u)for(const c of Gd(s).iterNodeCarets(e==="extend"?"shadowRoot":"root")){if(zn(c))c.origin.isInline()||(l=c);else{if(V(c.origin))continue;Pe(c.origin)&&!c.origin.isInline()&&(l=c)}break}}if(l===s)return!1;if(a&&!o&&Pe(l.origin)&&l.origin.isKeyboardSelectable()){const c=cy();return c.add(l.origin.getKey()),Ot(c),!0}return l=lr(l),a&&Ao(n.anchor,l),Ao(n.focus,l),u||!o}let _t=null,bt=null,on=!1,Ru=!1,Wa=0;const _h={characterData:!0,childList:!0,subtree:!0};function Bs(){return on||_t!==null&&_t._readOnly}function St(){on&&se(13)}function fy(){Wa>99&&se(14)}function ui(){return _t===null&&se(195,hy()),_t}function Ge(){return bt===null&&se(196,hy()),bt}function hy(){let n=0;const e=new Set,t=Wl.version;if(typeof window<"u")for(const i of document.querySelectorAll("[contenteditable]")){const s=zl(i);if(Bd(s))n++;else if(s){let o=String(s.constructor.version||"<0.17.1");o===t&&(o+=" (separately built, likely a bundler configuration issue)"),e.add(o)}}let r=` Detected on the page: ${n} compatible editor(s) with version ${t}`;return e.size&&(r+=` and incompatible editors with versions ${Array.from(e).join(", ")}`),r}function A2(){return bt}function bh(n,e,t){const r=e.__type,i=xy(n,r);let s=t.get(r);s===void 0&&(s=Array.from(i.transforms),t.set(r,s));const o=s.length;for(let a=0;a<o&&(s[a](e),e.isAttached());a++);}function vh(n,e){return n!==void 0&&n.__key!==e&&n.isAttached()}function py(n,e){if(!e)return;const t=n._updateTags;let r=e;Array.isArray(e)||(r=[e]);for(const i of r)t.add(i)}function gy(n){return Md(n,Ge()._nodes)}function Md(n,e){const t=n.type,r=e.get(t);r===void 0&&se(17,t);const i=r.klass;n.type!==i.getType()&&se(18,i.name);const s=i.importJSON(n),o=n.children;if(V(s)&&Array.isArray(o))for(let a=0;a<o.length;a++){const l=Md(o[a],e);s.append(l)}return s}function Ch(n,e,t){const r=_t,i=on,s=bt;_t=e,on=!0,bt=n;try{return t()}finally{_t=r,on=i,bt=s}}function kr(n,e){const t=n._pendingEditorState,r=n._rootElement,i=n._headless||r===null;if(t===null)return;const s=n._editorState,o=s._selection,a=t._selection,l=n._dirtyType!==Ii,u=_t,c=on,f=bt,d=n._updating,h=n._observer;let p=null;if(n._pendingEditorState=null,n._editorState=t,!i&&l&&h!==null){bt=n,_t=t,on=!1,n._updating=!0;try{const k=n._dirtyType,P=n._dirtyElements,D=n._dirtyLeaves;h.disconnect(),p=s2(s,t,n,k,P,D)}catch(k){if(k instanceof Error&&n._onError(k),Ru)throw k;return wy(n,null,r,t),Nm(n),n._dirtyType=bs,Ru=!0,kr(n,s),void(Ru=!1)}finally{h.observe(r,_h),n._updating=d,_t=u,on=c,bt=f}}t._readOnly||(t._readOnly=!0);const m=n._dirtyLeaves,_=n._dirtyElements,C=n._normalizedNodes,v=n._updateTags,x=n._deferred;l&&(n._dirtyType=Ii,n._cloneNotNeeded.clear(),n._dirtyLeaves=new Set,n._dirtyElements=new Map,n._normalizedNodes=new Set,n._updateTags=new Set),function(k,P){const D=k._decorators;let O=k._pendingDecorators||D;const z=P._nodeMap;let w;for(w in O)z.has(w)||(O===D&&(O=Ty(k)),delete O[w])}(n,t);const M=i?null:Vn(On(n));if(n._editable&&M!==null&&(l||a===null||a.dirty)&&r!==null&&!v.has(I2)){bt=n,_t=t;try{if(h!==null&&h.disconnect(),l||a===null||a.dirty){const k=n._blockCursorElement;k!==null&&wc(k,n,r),k2(o,a,n,M,v,r)}(function(k,P,D){let O=k._blockCursorElement;if(G(D)&&D.isCollapsed()&&D.anchor.type==="element"&&P.contains(document.activeElement)){const z=D.anchor,w=z.getNode(),q=z.offset;let S=!1,H=null;if(q===w.getChildrenSize())Lu(w.getChildAtIndex(q-1))&&(S=!0);else{const A=w.getChildAtIndex(q);if(A!==null&&Lu(A)){const L=A.getPreviousSibling();(L===null||Lu(L))&&(S=!0,H=k.getElementByKey(A.__key))}}if(S){const A=k.getElementByKey(w.__key);return O===null&&(k._blockCursorElement=O=function(L){const j=L.theme,K=document.createElement("div");K.contentEditable="false",K.setAttribute("data-lexical-cursor","true");let J=j.blockCursor;if(J!==void 0){if(typeof J=="string"){const W=rl(J);J=j.blockCursor=W}J!==void 0&&K.classList.add(...J)}return K}(k._config)),P.style.caretColor="transparent",void(H===null?A.appendChild(O):A.insertBefore(O,H))}}O!==null&&wc(O,k,P)})(n,r,a)}finally{h!==null&&h.observe(r,_h),bt=f,_t=u}}p!==null&&function(k,P,D,O,z){const w=Array.from(k._listeners.mutation),q=w.length;for(let S=0;S<q;S++){const[H,A]=w[S];for(const L of A){const j=P.get(L);j!==void 0&&H(j,{dirtyLeaves:O,prevEditorState:z,updateTags:D})}}}(n,p,v,m,s),G(a)||a===null||o!==null&&o.is(a)||n.dispatchCommand(Vi,void 0);const $=n._pendingDecorators;$!==null&&(n._decorators=$,n._pendingDecorators=null,yo("decorator",n,!0,$)),function(k,P,D){const O=Sh(P),z=Sh(D);O!==z&&yo("textcontent",k,!0,z)}(n,e||s,t),yo("update",n,!0,{dirtyElements:_,dirtyLeaves:m,editorState:t,mutatedNodes:p,normalizedNodes:C,prevEditorState:e||s,tags:v}),function(k,P){if(k._deferred=[],P.length!==0){const D=k._updating;k._updating=!0;try{for(let O=0;O<P.length;O++)P[O]()}finally{k._updating=D}}}(n,x),function(k){const P=k._updates;if(P.length!==0){const D=P.shift();if(D){const[O,z]=D;jl(k,O,z)}}}(n)}function yo(n,e,t,...r){const i=e._updating;e._updating=t;try{const s=Array.from(e._listeners[n]);for(let o=0;o<s.length;o++)s[o].apply(null,r)}finally{e._updating=i}}function Eh(n,e){const t=n._updates;let r=e||!1;for(;t.length!==0;){const i=t.shift();if(i){const[s,o]=i,a=n._pendingEditorState;let l;o!==void 0&&(l=o.onUpdate,o.skipTransforms&&(r=!0),o.discrete&&(a===null&&se(191),a._flushSync=!0),l&&n._deferred.push(l),py(n,o.tag)),a==null?jl(n,s,o):s()}}return r}function jl(n,e,t){const r=n._updateTags;let i,s=!1,o=!1;t!==void 0&&(i=t.onUpdate,py(n,t.tag),s=t.skipTransforms||!1,o=t.discrete||!1),i&&n._deferred.push(i);const a=n._editorState;let l=n._pendingEditorState,u=!1;(l===null||l._readOnly)&&(l=n._pendingEditorState=yy(l||a),u=!0),l._flushSync=o;const c=_t,f=on,d=bt,h=n._updating;_t=l,on=!1,n._updating=!0,bt=n;const p=n._headless||n.getRootElement()===null;Ld(null);try{u&&(p?a._selection!==null&&(l._selection=a._selection.clone()):l._selection=function(v,x){const M=v.getEditorState()._selection,$=Vn(On(v));return G(M)||M==null?Nd(M,$,v,x):M.clone()}(n,t&&t.event||null));const _=n._compositionKey;e(),s=Eh(n,s),function(v,x){const M=x.getEditorState()._selection,$=v._selection;if(G($)){const k=$.anchor,P=$.focus;let D;if(k.type==="text"&&(D=k.getNode(),D.selectionTransform(M,$)),P.type==="text"){const O=P.getNode();D!==O&&O.selectionTransform(M,$)}}}(l,n),n._dirtyType!==Ii&&(s?function(v,x){const M=x._dirtyLeaves,$=v._nodeMap;for(const k of M){const P=$.get(k);Z(P)&&P.isAttached()&&P.isSimpleText()&&!P.isUnmergeable()&&Qf(P)}}(l,n):function(v,x){const M=x._dirtyLeaves,$=x._dirtyElements,k=v._nodeMap,P=Vr(),D=new Map;let O=M,z=O.size,w=$,q=w.size;for(;z>0||q>0;){if(z>0){x._dirtyLeaves=new Set;for(const S of O){const H=k.get(S);Z(H)&&H.isAttached()&&H.isSimpleText()&&!H.isUnmergeable()&&Qf(H),H!==void 0&&vh(H,P)&&bh(x,H,D),M.add(S)}if(O=x._dirtyLeaves,z=O.size,z>0){Wa++;continue}}x._dirtyLeaves=new Set,x._dirtyElements=new Map,w.delete("root")&&w.set("root",!0);for(const S of w){const H=S[0],A=S[1];if($.set(H,A),!A)continue;const L=k.get(H);L!==void 0&&vh(L,P)&&bh(x,L,D)}O=x._dirtyLeaves,z=O.size,w=x._dirtyElements,q=w.size,Wa++}x._dirtyLeaves=M,x._dirtyElements=$}(l,n),Eh(n),function(v,x,M,$){const k=v._nodeMap,P=x._nodeMap,D=[];for(const[O]of $){const z=P.get(O);z!==void 0&&(z.isAttached()||(V(z)&&Tm(z,O,k,P,D,$),k.has(O)||$.delete(O),D.push(O)))}for(const O of D)P.delete(O);for(const O of M){const z=P.get(O);z===void 0||z.isAttached()||(k.has(O)||M.delete(O),P.delete(O))}}(a,l,n._dirtyLeaves,n._dirtyElements)),_!==n._compositionKey&&(l._flushSync=!0);const C=l._selection;if(G(C)){const v=l._nodeMap,x=C.anchor.key,M=C.focus.key;v.get(x)!==void 0&&v.get(M)!==void 0||se(19)}else Vt(C)&&C._nodes.size===0&&(l._selection=null)}catch(_){return _ instanceof Error&&n._onError(_),n._pendingEditorState=a,n._dirtyType=bs,n._cloneNotNeeded.clear(),n._dirtyLeaves=new Set,n._dirtyElements.clear(),void kr(n)}finally{_t=c,on=f,bt=d,n._updating=h,Wa=0}n._dirtyType!==Ii||n._deferred.length>0||function(_,C){const v=C.getEditorState()._selection,x=_._selection;if(x!==null){if(x.dirty||!x.is(v))return!0}else if(v!==null)return!0;return!1}(l,n)?l._flushSync?(l._flushSync=!1,kr(n)):u&&$2(()=>{kr(n)}):(l._flushSync=!1,u&&(r.clear(),n._deferred=[],n._pendingEditorState=null))}function Cn(n,e,t){bt===n&&t===void 0?e():jl(n,e,t)}let D2=class za{constructor(e,t,r){this.element=e,this.before=t||null,this.after=r||null}withBefore(e){return new za(this.element,e,this.after)}withAfter(e){return new za(this.element,this.before,e)}withElement(e){return this.element===e?this:new za(e,this.before,this.after)}insertChild(e){const t=this.before||this.getManagedLineBreak();return t!==null&&t.parentElement!==this.element&&se(222),this.element.insertBefore(e,t),this}removeChild(e){return e.parentElement!==this.element&&se(223),this.element.removeChild(e),this}replaceChild(e,t){return t.parentElement!==this.element&&se(224),this.element.replaceChild(e,t),this}getFirstChild(){const e=this.after?this.after.nextSibling:this.element.firstChild;return e===this.before||e===this.getManagedLineBreak()?null:e}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(e){if(e===null)this.removeManagedLineBreak();else{const t=e==="decorator"&&(_s||Co);this.insertManagedLineBreak(t)}}removeManagedLineBreak(){const e=this.getManagedLineBreak();if(e){const t=this.element,r=e.nodeName==="IMG"?e.nextSibling:null;r&&t.removeChild(r),t.removeChild(e),t.__lexicalLineBreak=void 0}}insertManagedLineBreak(e){const t=this.getManagedLineBreak();if(t){if(e===(t.nodeName==="IMG"))return;this.removeManagedLineBreak()}const r=this.element,i=this.before,s=document.createElement("br");if(r.insertBefore(s,i),e){const o=document.createElement("img");o.setAttribute("data-lexical-linebreak","true"),o.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",o.alt="",r.insertBefore(o,s),r.__lexicalLineBreak=o}else r.__lexicalLineBreak=s}getFirstChildOffset(){let e=0;for(let t=this.after;t!==null;t=t.previousSibling)e++;return e}resolveChildIndex(e,t,r,i){if(r===this.element){const l=this.getFirstChildOffset();return[e,Math.min(l+e.getChildrenSize(),Math.max(l,i))]}const s=wh(t,r);s.push(i);const o=wh(t,this.element);let a=e.getIndexWithinParent();for(let l=0;l<o.length;l++){const u=s[l],c=o[l];if(u===void 0||u<c)break;if(u>c){a+=1;break}}return[e.getParentOrThrow(),a]}};function wh(n,e){const t=[];let r=e;for(;r!==n&&r!==null;r=r.parentNode){let i=0;for(let s=r.previousSibling;s!==null;s=s.previousSibling)i++;t.push(i)}return r!==n&&se(225),t.reverse()}let Ut=class extends $s{constructor(e){super(e),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(e){super.afterCloneFrom(e),this.__key===e.__key&&(this.__first=e.__first,this.__last=e.__last,this.__size=e.__size),this.__indent=e.__indent,this.__format=e.__format,this.__style=e.__style,this.__dir=e.__dir,this.__textFormat=e.__textFormat,this.__textStyle=e.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const e=this.getFormat();return Hv[e]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const e=[];let t=this.getFirstChild();for(;t!==null;)e.push(t),t=t.getNextSibling();return e}getChildrenKeys(){const e=[];let t=this.getFirstChild();for(;t!==null;)e.push(t.__key),t=t.getNextSibling();return e}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const e=Ge()._dirtyElements;return e!==null&&e.has(this.__key)}isLastChild(){const e=this.getLatest(),t=this.getParentOrThrow().getLastChild();return t!==null&&t.is(e)}getAllTextNodes(){const e=[];let t=this.getFirstChild();for(;t!==null;){if(Z(t)&&e.push(t),V(t)){const r=t.getAllTextNodes();e.push(...r)}t=t.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();for(;V(e);){const t=e.getFirstChild();if(t===null)break;e=t}return e}getLastDescendant(){let e=this.getLastChild();for(;V(e);){const t=e.getLastChild();if(t===null)break;e=t}return e}getDescendantByIndex(e){const t=this.getChildren(),r=t.length;if(e>=r){const s=t[r-1];return V(s)&&s.getLastDescendant()||s||null}const i=t[e];return V(i)&&i.getFirstDescendant()||i||null}getFirstChild(){const e=this.getLatest().__first;return e===null?null:xe(e)}getFirstChildOrThrow(){const e=this.getFirstChild();return e===null&&se(45,this.__key),e}getLastChild(){const e=this.getLatest().__last;return e===null?null:xe(e)}getLastChildOrThrow(){const e=this.getLastChild();return e===null&&se(96,this.__key),e}getChildAtIndex(e){const t=this.getChildrenSize();let r,i;if(e<t/2){for(r=this.getFirstChild(),i=0;r!==null&&i<=e;){if(i===e)return r;r=r.getNextSibling(),i++}return null}for(r=this.getLastChild(),i=t-1;r!==null&&i>=e;){if(i===e)return r;r=r.getPreviousSibling(),i--}return null}getTextContent(){let e="";const t=this.getChildren(),r=t.length;for(let i=0;i<r;i++){const s=t[i];e+=s.getTextContent(),V(s)&&i!==r-1&&!s.isInline()&&(e+=Nr)}return e}getTextContentSize(){let e=0;const t=this.getChildren(),r=t.length;for(let i=0;i<r;i++){const s=t[i];e+=s.getTextContentSize(),V(s)&&i!==r-1&&!s.isInline()&&(e+=Nr.length)}return e}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(e){if(e!==""){const t=zf[e];return!!(this.getFormat()&t)}return!1}hasTextFormat(e){const t=Zr[e];return!!(this.getTextFormat()&t)}getFormatFlags(e,t){return pl(this.getLatest().__textFormat,e,t)}getTextStyle(){return this.getLatest().__textStyle}select(e,t){St();const r=ne();let i=e,s=t;const o=this.getChildrenSize();if(!this.canBeEmpty()){if(e===0&&t===0){const l=this.getFirstChild();if(Z(l)||V(l))return l.select(0,0)}else if(!(e!==void 0&&e!==o||t!==void 0&&t!==o)){const l=this.getLastChild();if(Z(l)||V(l))return l.select()}}i===void 0&&(i=o),s===void 0&&(s=o);const a=this.__key;return G(r)?(r.anchor.set(a,i,"element"),r.focus.set(a,s,"element"),r.dirty=!0,r):uy(a,i,a,s,"element","element")}selectStart(){const e=this.getFirstDescendant();return e?e.selectStart():this.select()}selectEnd(){const e=this.getLastDescendant();return e?e.selectEnd():this.select()}clear(){const e=this.getWritable();return this.getChildren().forEach(t=>t.remove()),e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){const t=this.getWritable();return t.__dir=e,t}setFormat(e){return this.getWritable().__format=e!==""?zf[e]:0,this}setStyle(e){return this.getWritable().__style=e||"",this}setTextFormat(e){const t=this.getWritable();return t.__textFormat=e,t}setTextStyle(e){const t=this.getWritable();return t.__textStyle=e,t}setIndent(e){return this.getWritable().__indent=e,this}splice(e,t,r){const i=r.length,s=this.getChildrenSize(),o=this.getWritable();e+t<=s||se(226,String(e),String(t),String(s));const a=o.__key,l=[],u=[],c=this.getChildAtIndex(e+t);let f=null,d=s-t+i;if(e!==0)if(e===s)f=this.getLastChild();else{const p=this.getChildAtIndex(e);p!==null&&(f=p.getPreviousSibling())}if(t>0){let p=f===null?this.getFirstChild():f.getNextSibling();for(let m=0;m<t;m++){p===null&&se(100);const _=p.getNextSibling(),C=p.__key;Di(p.getWritable()),u.push(C),p=_}}let h=f;for(let p=0;p<i;p++){const m=r[p];h!==null&&m.is(h)&&(f=h=h.getPreviousSibling());const _=m.getWritable();_.__parent===a&&d--,Di(_);const C=m.__key;if(h===null)o.__first=C,_.__prev=null;else{const v=h.getWritable();v.__next=C,_.__prev=v.__key}m.__key===a&&se(76),_.__parent=a,l.push(C),h=m}if(e+t===s)h!==null&&(h.getWritable().__next=null,o.__last=h.__key);else if(c!==null){const p=c.getWritable();if(h!==null){const m=h.getWritable();p.__prev=h.__key,m.__next=c.__key}else p.__prev=null}if(o.__size=d,u.length){const p=ne();if(G(p)){const m=new Set(u),_=new Set(l),{anchor:C,focus:v}=p;xh(C,m,_)&&hl(C,C.getNode(),this,f,c),xh(v,m,_)&&hl(v,v.getNode(),this,f,c),d!==0||this.canBeEmpty()||gr(this)||this.remove()}}return o}getDOMSlot(e){return new D2(e)}exportDOM(e){const{element:t}=super.exportDOM(e);if(je(t)){const r=this.getIndent();r>0&&(t.style.paddingInlineStart=40*r+"px");const i=this.getDirection();i&&(t.dir=i)}return{element:t}}exportJSON(){const e={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},t=this.getTextFormat(),r=this.getTextStyle();return t!==0&&(e.textFormat=t),r!==""&&(e.textStyle=r),e}updateFromJSON(e){return super.updateFromJSON(e).setFormat(e.format).setIndent(e.indent).setDirection(e.direction).setTextFormat(e.textFormat||0).setTextStyle(e.textStyle||"")}insertNewAfter(e,t){return null}canIndent(){return!0}collapseAtStart(e){return!1}excludeFromCopy(e){return!1}canReplaceWith(e){return!0}canInsertAfter(e){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(e){return!1}extractWithChild(e,t,r){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(e,t){const r=this.getDOMSlot(e);let i=r.getFirstChild();for(let s=this.getFirstChild();s;s=s.getNextSibling()){const o=t.getElementByKey(s.getKey());o!==null&&(i==null?(r.insertChild(o),i=o):i!==o&&r.replaceChild(o,i),i=i.nextSibling)}}};function V(n){return n instanceof Ut}function xh(n,e,t){let r=n.getNode();for(;r;){const i=r.__key;if(e.has(i)&&!t.has(i))return!0;r=r.getParent()}return!1}let ci=class extends $s{decorate(e,t){se(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}};function Pe(n){return n instanceof ci}let Od=class my extends Ut{static getType(){return"root"}static clone(){return new my}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){se(51)}getTextContent(){const e=this.__cachedText;return!Bs()&&Ge()._dirtyType!==Ii||e===null?super.getTextContent():e}remove(){se(52)}replace(e){se(53)}insertBefore(e){se(54)}insertAfter(e){se(55)}updateDOM(e,t){return!1}splice(e,t,r){for(const i of r)V(i)||Pe(i)||se(282);return super.splice(e,t,r)}static importJSON(e){return Ne().updateFromJSON(e)}collapseAtStart(){return!0}};function At(n){return n instanceof Od}function yy(n){return new by(new Map(n._nodeMap))}function Id(){return new by(new Map([["root",new Od]]))}function _y(n){const e=n.exportJSON(),t=n.constructor;if(e.type!==t.getType()&&se(130,t.name),V(n)){const r=e.children;Array.isArray(r)||se(59,t.name);const i=n.getChildren();for(let s=0;s<i.length;s++){const o=_y(i[s]);r.push(o)}}return e}let by=class vy{constructor(e,t){this._nodeMap=e,this._selection=t||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(e,t){return Ch(t&&t.editor||null,this,e)}clone(e){const t=new vy(this._nodeMap,e===void 0?this._selection:e);return t._readOnly=!0,t}toJSON(){return Ch(null,this,()=>({root:_y(Ne())}))}};const bc="historic",N2="history-push",Ti="history-merge",Cy="paste",M2="collaboration",O2="skip-scroll-into-view",I2="skip-dom-selection";let Rd=class extends Ut{static getType(){return"artificial"}createDOM(e){return document.createElement("div")}},qs=class Ey extends Ut{static getType(){return"paragraph"}static clone(e){return new Ey(e.__key)}createDOM(e){const t=document.createElement("p"),r=ps(e.theme,"paragraph");return r!==void 0&&t.classList.add(...r),t}updateDOM(e,t,r){return!1}static importDOM(){return{p:e=>({conversion:R2,priority:0})}}exportDOM(e){const{element:t}=super.exportDOM(e);if(je(t)){this.isEmpty()&&t.append(document.createElement("br"));const r=this.getFormatType();r&&(t.style.textAlign=r)}return{element:t}}static importJSON(e){return kn().updateFromJSON(e)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(e,t){const r=kn();r.setTextFormat(e.format),r.setTextStyle(e.style);const i=this.getDirection();return r.setDirection(i),r.setFormat(this.getFormatType()),r.setStyle(this.getStyle()),this.insertAfter(r,t),r}collapseAtStart(){const e=this.getChildren();if(e.length===0||Z(e[0])&&e[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}};function R2(n){const e=kn();return n.style&&(e.setFormat(n.style.textAlign),J2(n,e)),{node:e}}function kn(){return We(new qs)}function Pd(n){return n instanceof qs}const ye=0,Xi=1,Ha=2,Ul=3,_o=4;function wy(n,e,t,r){const i=n._keyToDOMMap;i.clear(),n._editorState=Id(),n._pendingEditorState=r,n._compositionKey=null,n._dirtyType=Ii,n._cloneNotNeeded.clear(),n._dirtyLeaves=new Set,n._dirtyElements.clear(),n._normalizedNodes=new Set,n._updateTags=new Set,n._updates=[],n._blockCursorElement=null;const s=n._observer;s!==null&&(s.disconnect(),n._observer=null),e!==null&&(e.textContent=""),t!==null&&(t.textContent="",i.set("root",t))}function P2(n){const e=n||{},t=A2(),r=e.theme||{},i=n===void 0?t:e.parentEditor||null,s=e.disableEvents||!1,o=Id(),a=e.namespace||(i!==null?i._config.namespace:Ny()),l=e.editorState,u=[Od,xn,Yi,Dd,qs,Rd,...e.nodes||[]],{onError:c,html:f}=e,d=e.editable===void 0||e.editable;let h;if(n===void 0&&t!==null)h=t._nodes;else{h=new Map;for(let m=0;m<u.length;m++){let _=u[m],C=null,v=null;if(typeof _!="function"){const P=_;_=P.replace,C=P.with,v=P.withKlass||null}const{ownNodeConfig:x}=Kd(_),M=_.getType(),$=_.transform(),k=new Set;x&&x.$transform&&k.add(x.$transform),$!==null&&k.add($),h.set(M,{exportDOM:f&&f.export?f.export.get(_):void 0,klass:_,replace:C,replaceWithKlass:v,sharedNodeState:e2(u[m]),transforms:k})}}const p=new Wl(o,i,h,{disableEvents:s,namespace:a,theme:r},c||console.error,function(m,_){const C=new Map,v=new Set,x=M=>{Object.keys(M).forEach($=>{let k=C.get($);k===void 0&&(k=[],C.set($,k)),k.push(M[$])})};return m.forEach(M=>{const $=M.klass.importDOM;if($==null||v.has($))return;v.add($);const k=$.call(M.klass);k!==null&&x(k)}),_&&x(_),C}(h,f?f.import:void 0),d,n);return l!==void 0&&(p._pendingEditorState=l,p._dirtyType=bs),p}let Wl=class{constructor(e,t,r,i,s,o,a,l){this._createEditorArgs=l,this._parentEditor=t,this._rootElement=null,this._editorState=e,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=i,this._nodes=r,this._decorators={},this._pendingDecorators=null,this._dirtyType=Ii,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=Ny(),this._onError=s,this._htmlConversions=o,this._editable=a,this._headless=t!==null&&t._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(e){const t=this._listeners.update;return t.add(e),()=>{t.delete(e)}}registerEditableListener(e){const t=this._listeners.editable;return t.add(e),()=>{t.delete(e)}}registerDecoratorListener(e){const t=this._listeners.decorator;return t.add(e),()=>{t.delete(e)}}registerTextContentListener(e){const t=this._listeners.textcontent;return t.add(e),()=>{t.delete(e)}}registerRootListener(e){const t=this._listeners.root;return e(this._rootElement,null),t.add(e),()=>{e(null,this._rootElement),t.delete(e)}}registerCommand(e,t,r){r===void 0&&se(35);const i=this._commands;i.has(e)||i.set(e,[new Set,new Set,new Set,new Set,new Set]);const s=i.get(e);s===void 0&&se(36,String(e));const o=s[r];return o.add(t),()=>{o.delete(t),s.every(a=>a.size===0)&&i.delete(e)}}registerMutationListener(e,t,r){const i=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(e)).klass,s=this._listeners.mutation;let o=s.get(t);o===void 0&&(o=new Set,s.set(t,o)),o.add(i);const a=r&&r.skipInitialization;return a!==void 0&&a||this.initializeMutationListener(t,i),()=>{o.delete(i),o.size===0&&s.delete(t)}}getRegisteredNode(e){const t=this._nodes.get(e.getType());return t===void 0&&se(37,e.name),t}resolveRegisteredNodeAfterReplacements(e){for(;e.replaceWithKlass;)e=this.getRegisteredNode(e.replaceWithKlass);return e}initializeMutationListener(e,t){const r=this._editorState,i=Ih(r).get(t.getType());if(!i)return;const s=new Map;for(const o of i.keys())s.set(o,"created");s.size>0&&e(s,{dirtyLeaves:new Set,prevEditorState:r,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(e,t){const r=this.getRegisteredNode(e);return r.transforms.add(t),r}registerNodeTransform(e,t){const r=this.registerNodeTransformToKlass(e,t),i=[r],s=r.replaceWithKlass;if(s!=null){const o=this.registerNodeTransformToKlass(s,t);i.push(o)}return function(o,a){const l=Ih(o.getEditorState()),u=[];for(const c of a){const f=l.get(c);f&&u.push(f)}u.length!==0&&o.update(()=>{for(const c of u)for(const f of c.keys()){const d=xe(f);d&&d.markDirty()}},o._pendingEditorState===null?{tag:Ti}:void 0)}(this,i.map(o=>o.klass.getType())),()=>{i.forEach(o=>o.transforms.delete(t))}}hasNode(e){return this._nodes.has(e.getType())}hasNodes(e){return e.every(this.hasNode.bind(this))}dispatchCommand(e,t){return ce(this,e,t)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const t=this._rootElement;if(e!==t){const r=ps(this._config.theme,"root"),i=this._pendingEditorState||this._editorState;if(this._rootElement=e,wy(this,t,e,i),t!==null&&(this._config.disableEvents||m2(t),r!=null&&t.classList.remove(...r)),e!==null){const s=zd(e),o=e.style;o.userSelect="text",o.whiteSpace="pre-wrap",o.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._window=s,this._dirtyType=bs,Nm(this),this._updateTags.add(Ti),kr(this),this._config.disableEvents||function(a,l){const u=a.ownerDocument,c=dl.get(u);(c===void 0||c<1)&&u.addEventListener("selectionchange",Qm),dl.set(u,(c||0)+1),a.__lexicalEditor=l;const f=Xm(a);for(let d=0;d<hc.length;d++){const[h,p]=hc[d],m=typeof p=="function"?_=>{sh(_)||(ih(_),(l.isEditable()||h==="click")&&p(_,l))}:_=>{if(sh(_))return;ih(_);const C=l.isEditable();switch(h){case"cut":return C&&ce(l,Ls,_);case"copy":return ce(l,Gi,_);case"paste":return C&&ce(l,Ji,_);case"dragstart":return C&&ce(l,Sd,_);case"dragover":return C&&ce(l,Wm,_);case"dragend":return C&&ce(l,f2,_);case"focus":return C&&ce(l,h2,_);case"blur":return C&&ce(l,p2,_);case"drop":return C&&ce(l,ql,_)}};a.addEventListener(h,m),f.push(()=>{a.removeEventListener(h,m)})}}(e,this),r!=null&&e.classList.add(...r)}else this._window=null,this._updateTags.add(Ti),kr(this);yo("root",this,!1,e,t)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,t){e.isEmpty()&&se(38);let r=e;r._readOnly&&(r=yy(e),r._selection=e._selection?e._selection.clone():null),Dm(this);const i=this._pendingEditorState,s=this._updateTags,o=t!==void 0?t.tag:null;i===null||i.isEmpty()||(o!=null&&s.add(o),kr(this)),this._pendingEditorState=r,this._dirtyType=bs,this._dirtyElements.set("root",!1),this._compositionKey=null,o!=null&&s.add(o),this._updating||kr(this)}parseEditorState(e,t){return function(r,i,s){const o=Id(),a=_t,l=on,u=bt,c=i._dirtyElements,f=i._dirtyLeaves,d=i._cloneNotNeeded,h=i._dirtyType;i._dirtyElements=new Map,i._dirtyLeaves=new Set,i._cloneNotNeeded=new Set,i._dirtyType=0,_t=o,on=!1,bt=i,Ld(null);try{const p=i._nodes;Md(r.root,p),s&&s(),o._readOnly=!0}catch(p){p instanceof Error&&i._onError(p)}finally{i._dirtyElements=c,i._dirtyLeaves=f,i._cloneNotNeeded=d,i._dirtyType=h,_t=a,on=l,bt=u}return o}(typeof e=="string"?JSON.parse(e):e,this,t)}read(e){return kr(this),this.getEditorState().read(e,{editor:this})}update(e,t){(function(r,i,s){r._updating?r._updates.push([i,s]):jl(r,i,s)})(this,e,t)}focus(e,t={}){const r=this._rootElement;r!==null&&(r.setAttribute("autocapitalize","off"),Cn(this,()=>{const i=ne(),s=Ne();i!==null?i.dirty||Ot(i.clone()):s.getChildrenSize()!==0&&(t.defaultSelection==="rootStart"?s.selectStart():s.selectEnd()),Py("focus"),U2(()=>{r.removeAttribute("autocapitalize"),e&&e()})}),this._pendingEditorState===null&&r.removeAttribute("autocapitalize"))}blur(){const e=this._rootElement;e!==null&&e.blur();const t=Vn(this._window);t!==null&&t.removeAllRanges()}isEditable(){return this._editable}setEditable(e){this._editable!==e&&(this._editable=e,yo("editable",this,!0,e))}toJSON(){return{editorState:this._editorState.toJSON()}}};Wl.version="0.34.0+prod.esm";let vc=null;function Ld(n){vc=n}let L2=1;function xy(n,e){const t=$d(n,e);return t===void 0&&se(30,e),t}function $d(n,e){return n._nodes.get(e)}const $2=typeof queueMicrotask=="function"?queueMicrotask:n=>{Promise.resolve().then(n)};function kh(n){return Pe(ti(n))}function Fd(n){const e=document.activeElement;if(!je(e))return!1;const t=e.nodeName;return Pe(ti(n))&&(t==="INPUT"||t==="TEXTAREA"||e.contentEditable==="true"&&zl(e)==null)}function Uo(n,e,t){const r=n.getRootElement();try{return r!==null&&r.contains(e)&&r.contains(t)&&e!==null&&!Fd(e)&&ky(e)===n}catch{return!1}}function Bd(n){return n instanceof Wl}function ky(n){let e=n;for(;e!=null;){const t=zl(e);if(Bd(t))return t;e=Wo(e)}return null}function zl(n){return n?n.__lexicalEditor:null}function Ai(n){return ry(n)||n.isToken()}function wr(n){return Ai(n)||n.isSegmented()}function Pr(n){return Qi(n)&&n.nodeType===Rv}function F2(n){return Qi(n)&&n.nodeType===Pv}function xs(n){let e=n;for(;e!=null;){if(Pr(e))return e;e=e.firstChild}return null}function pl(n,e,t){const r=Zr[e];if(t!==null&&(n&r)==(t&r))return n;let i=n^r;return e==="subscript"?i&=-65:e==="superscript"?i&=-33:e==="lowercase"?(i&=-513,i&=-1025):e==="uppercase"?(i&=-257,i&=-1025):e==="capitalize"&&(i&=-257,i&=-513),i}function B2(n,e){const t=function(){const o=vc;return vc=null,o}();if((e=e||t&&t.__key)!=null)return void(n.__key=e);St(),fy();const r=Ge(),i=ui(),s=""+L2++;i._nodeMap.set(s,n),V(n)?r._dirtyElements.set(s,!0):r._dirtyLeaves.add(s),r._cloneNotNeeded.add(s),r._dirtyType=xm,n.__key=s}function Di(n){const e=n.getParent();if(e!==null){const t=n.getWritable(),r=e.getWritable(),i=n.getPreviousSibling(),s=n.getNextSibling(),o=s!==null?s.__key:null,a=i!==null?i.__key:null,l=i!==null?i.getWritable():null,u=s!==null?s.getWritable():null;i===null&&(r.__first=o),s===null&&(r.__last=a),l!==null&&(l.__next=o),u!==null&&(u.__prev=a),t.__prev=null,t.__next=null,t.__parent=null,r.__size--}}function gl(n){fy();const e=n.getLatest(),t=e.__parent,r=ui(),i=Ge(),s=r._nodeMap,o=i._dirtyElements;t!==null&&function(l,u,c){let f=l;for(;f!==null;){if(c.has(f))return;const d=u.get(f);if(d===void 0)break;c.set(f,!1),f=d.__parent}}(t,s,o);const a=e.__key;i._dirtyType=xm,V(n)?o.set(a,!0):i._dirtyLeaves.add(a)}function Tt(n){St();const e=Ge(),t=e._compositionKey;if(n!==t){if(e._compositionKey=n,t!==null){const r=xe(t);r!==null&&r.getWritable()}if(n!==null){const r=xe(n);r!==null&&r.getWritable()}}}function Vr(){return Bs()?null:Ge()._compositionKey}function xe(n,e){const t=(e||ui())._nodeMap.get(n);return t===void 0?null:t}function Sy(n,e){const t=Hl(n,Ge());return t!==void 0?xe(t,e):null}function Hl(n,e){return n[`__lexicalKey_${e._key}`]}function ti(n,e){let t=n;for(;t!=null;){const r=Sy(t,e);if(r!==null)return r;t=Wo(t)}return null}function Ty(n){const e=n._decorators,t=Object.assign({},e);return n._pendingDecorators=t,t}function Sh(n){return n.read(()=>Ne().getTextContent())}function Ne(){return Ay(ui())}function Ay(n){return n._nodeMap.get("root")}function Ot(n){St();const e=ui();n!==null&&(n.dirty=!0,n.setCachedNodes(null)),e._selection=n}function fs(n){const e=Ge(),t=function(r,i){let s=r;for(;s!=null;){const o=Hl(s,i);if(o!==void 0)return o;s=Wo(s)}return null}(n,e);return t===null?n===e.getRootElement()?xe("root"):null:xe(t)}function Dy(n){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(n)}function qd(n){const e=[];let t=n;for(;t!==null;)e.push(t),t=t._parentEditor;return e}function Ny(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function My(n){return Pr(n)?n.nodeValue:null}function jd(n,e,t){const r=Vn(On(e));if(r===null)return;const i=r.anchorNode;let{anchorOffset:s,focusOffset:o}=r;if(i!==null){let a=My(i);const l=ti(i);if(a!==null&&Z(l)){if(a===Pl&&t){const u=t.length;a=t,s=u,o=u}a!==null&&Ud(l,a,s,o,n)}}}function Ud(n,e,t,r,i){let s=n;if(s.isAttached()&&(i||!s.isDirty())){const o=s.isComposing();let a=e;(o||i)&&e[e.length-1]===Pl&&(a=e.slice(0,-1));const l=s.getTextContent();if(i||a!==l){if(a===""){if(Tt(null),Co||_s||nl)s.remove();else{const m=Ge();setTimeout(()=>{m.update(()=>{s.isAttached()&&s.remove()})},20)}return}const u=s.getParent(),c=Fs(),f=s.getTextContentSize(),d=Vr(),h=s.getKey();if(s.isToken()||d!==null&&h===d&&!o||G(c)&&(u!==null&&!u.canInsertTextBefore()&&c.anchor.offset===0||c.anchor.key===n.__key&&c.anchor.offset===0&&!s.canInsertTextBefore()&&!o||c.focus.key===n.__key&&c.focus.offset===f&&!s.canInsertTextAfter()&&!o))return void s.markDirty();const p=ne();if(!G(p)||t===null||r===null)return void Th(s,a,p);if(p.setTextNodeRange(s,t,s,r),s.isSegmented()){const m=we(s.getTextContent());s.replace(m),s=m}Th(s,a,p)}}}function Th(n,e,t){if(n.setTextContent(e),G(t)){const r=n.getKey();for(const i of["anchor","focus"]){const s=t[i];s.type==="text"&&s.key===r&&(s.offset=Qr(n,s.offset,"clamp"))}}}function ga(n,e,t){const r=e[t]||!1;return r==="any"||r===n[t]}function q2(n,e){return ga(n,e,"altKey")&&ga(n,e,"ctrlKey")&&ga(n,e,"shiftKey")&&ga(n,e,"metaKey")}function qe(n,e,t){return q2(n,t)&&n.key.toLowerCase()===e.toLowerCase()}const Er={ctrlKey:!or,metaKey:or},Ah={altKey:or,ctrlKey:!or};function Dh(n){return n.key==="Backspace"}function Nh(n){return qe(n,"a",Er)}function Oy(n){const e=Ne();if(G(n)){const t=n.anchor,r=n.focus,i=t.getNode().getTopLevelElementOrThrow().getParentOrThrow();return t.set(i.getKey(),0,"element"),r.set(i.getKey(),i.getChildrenSize(),"element"),Eo(n),n}{const t=e.select(0,e.getChildrenSize());return Ot(Eo(t)),t}}function ps(n,e){n.__lexicalClassNameCache===void 0&&(n.__lexicalClassNameCache={});const t=n.__lexicalClassNameCache,r=t[e];if(r!==void 0)return r;const i=n[e];if(typeof i=="string"){const s=rl(i);return t[e]=s,s}return i}function Wd(n,e,t,r,i){if(t.size===0)return;const s=r.__type,o=r.__key,a=e.get(s);a===void 0&&se(33,s);const l=a.klass;let u=n.get(l);u===void 0&&(u=new Map,n.set(l,u));const c=u.get(o),f=c==="destroyed"&&i==="created";(c===void 0||f)&&u.set(o,f?"updated":i)}function Mh(n,e,t){const r=n.getParent();let i=t,s=n;return r!==null&&(e&&t===0?(i=s.getIndexWithinParent(),s=r):e||t!==s.getChildrenSize()||(i=s.getIndexWithinParent()+1,s=r)),s.getChildAtIndex(e?i-1:i)}function Cc(n,e){const t=n.offset;if(n.type==="element")return Mh(n.getNode(),e,t);{const r=n.getNode();if(e&&t===0||!e&&t===r.getTextContentSize()){const i=e?r.getPreviousSibling():r.getNextSibling();return i===null?Mh(r.getParentOrThrow(),e,r.getIndexWithinParent()+(e?0:1)):i}}return null}function Iy(n){const e=On(n).event,t=e&&e.inputType;return t==="insertFromPaste"||t==="insertFromPasteAsQuotation"}function ce(n,e,t){return function(r,i,s){const o=qd(r);for(let a=4;a>=0;a--)for(let l=0;l<o.length;l++){const u=o[l],c=u._commands.get(i);if(c!==void 0){const f=c[a];if(f!==void 0){const d=Array.from(f),h=d.length;let p=!1;if(Cn(u,()=>{for(let m=0;m<h;m++)if(d[m](s,r))return void(p=!0)}),p)return p}}}return!1}(n,e,t)}function Kl(n){return!At(n)&&!n.isLastChild()&&!n.isInline()}function ks(n,e){const t=n._keyToDOMMap.get(e);return t===void 0&&se(75,e),t}function Wo(n){const e=n.assignedSlot||n.parentElement;return xc(e)?e.host:e}function Ry(n){return F2(n)?n:je(n)?n.ownerDocument:null}function j2(n){return Ge()._updateTags.has(n)}function Py(n){St(),Ge()._updateTags.add(n)}function U2(n){St(),Ge()._deferred.push(n)}function Ec(n,e){let t=n.getParent();for(;t!==null;){if(t.is(e))return!0;t=t.getParent()}return!1}function zd(n){const e=Ry(n);return e?e.defaultView:null}function On(n){const e=n._window;return e===null&&se(78),e}function W2(n){return V(n)&&n.isInline()||Pe(n)&&n.isInline()}function z2(n){let e=n.getParentOrThrow();for(;e!==null;){if(gr(e))return e;e=e.getParentOrThrow()}return e}function gr(n){return At(n)||V(n)&&n.isShadowRoot()}function We(n){const e=Ge(),t=n.getType(),r=$d(e,t);r===void 0&&se(200,n.constructor.name,t);const{replace:i,replaceWithKlass:s}=r;if(i!==null){const o=i(n),a=o.constructor;return s!==null?o instanceof s||se(201,s.name,s.getType(),a.name,a.getType(),n.constructor.name,t):o instanceof n.constructor&&a!==n.constructor||se(202,a.name,a.getType(),n.constructor.name,t),o.__key===n.__key&&se(203,n.constructor.name,t,a.name,a.getType()),o}return n}function Pu(n,e){!At(n.getParent())||V(e)||Pe(e)||se(99)}function H2(n){const e=xe(n);return e===null&&se(63,n),e}function Lu(n){return(Pe(n)||V(n)&&!n.canBeEmpty())&&!n.isInline()}function wc(n,e,t){t.style.removeProperty("caret-color"),e._blockCursorElement=null;const r=n.parentElement;r!==null&&r.removeChild(n)}function Vn(n){return Yn?(n||window).getSelection():null}function K2(n){const e=zd(n);return e?e.getSelection():null}function Ly(n){return je(n)&&n.tagName==="A"}function je(n){return Qi(n)&&n.nodeType===Iv}function Qi(n){return typeof n=="object"&&n!==null&&"nodeType"in n&&typeof n.nodeType=="number"}function xc(n){return Qi(n)&&n.nodeType===Lv}function kc(n){const e=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return n.nodeName.match(e)!==null}function ml(n){const e=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return n.nodeName.match(e)!==null}function Dn(n){if(Pe(n)&&!n.isInline())return!0;if(!V(n)||gr(n))return!1;const e=n.getFirstChild(),t=e===null||Si(e)||Z(e)||e.isInline();return!n.isInline()&&n.canBeEmpty()!==!1&&t}function $u(n,e){let t=n;for(;t!==null&&t.getParent()!==null&&!e(t);)t=t.getParentOrThrow();return e(t)?t:null}function Vl(){return Ge()}const Oh=new WeakMap,V2=new Map;function Ih(n){if(!n._readOnly&&n.isEmpty())return V2;n._readOnly||se(192);let e=Oh.get(n);return e||(e=function(t){const r=new Map;for(const[i,s]of t._nodeMap){const o=s.__type;let a=r.get(o);a||(a=new Map,r.set(o,a)),a.set(i,s)}return r}(n),Oh.set(n,e)),e}function Hd(n){const e=n.constructor.clone(n);return e.afterCloneFrom(n),e}function J2(n,e){const t=parseInt(n.style.paddingInlineStart,10)||0,r=Math.round(t/40);e.setIndent(r)}function G2(n){n.__lexicalUnmanaged=!0}function Y2(n){return n.__lexicalUnmanaged===!0}function ro(n,e){return function(t,r){return Object.prototype.hasOwnProperty.call(t,r)}(n,e)&&n[e]!==$s[e]}function Kd(n){const e=Hf in n.prototype?n.prototype[Hf]():void 0,t=function(o){return o===ci||o===Ut||o===$s}(n),r=!t&&ro(n,"getType")?n.getType():void 0;let i,s=r;if(e)if(r)i=e[r];else for(const[o,a]of Object.entries(e))s=o,i=a;if(!t&&s&&(ro(n,"getType")||(n.getType=()=>s),ro(n,"clone")||(n.clone=o=>(Ld(o),new n)),ro(n,"importJSON")||(n.importJSON=i&&i.$importJSON||(o=>new n().updateFromJSON(o))),!ro(n,"importDOM")&&i)){const{importDOM:o}=i;o&&(n.importDOM=()=>o)}return{ownNodeConfig:i,ownNodeType:s}}const X2={next:"previous",previous:"next"};let Vd=class{constructor(e){this.origin=e}[Symbol.iterator](){return Jl({hasNext:Li,initial:this.getAdjacentCaret(),map:e=>e,step:e=>e.getAdjacentCaret()})}getAdjacentCaret(){return ft(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return ft(this.origin,this.direction)}remove(){const e=this.getNodeAtCaret();return e&&e.remove(),this}replaceOrInsert(e,t){const r=this.getNodeAtCaret();return e.is(this.origin)||e.is(r)||(r===null?this.insert(e):r.replace(e,t)),this}splice(e,t,r="next"){const i=r===this.direction?t:Array.from(t).reverse();let s=this;const o=this.getParentAtCaret(),a=new Map;for(let l=s.getAdjacentCaret();l!==null&&a.size<e;l=l.getAdjacentCaret()){const u=l.origin.getWritable();a.set(u.getKey(),u)}for(const l of i){if(a.size>0){const u=s.getNodeAtCaret();if(u){if(a.delete(u.getKey()),a.delete(l.getKey()),!(u.is(l)||s.origin.is(l))){const c=l.getParent();c&&c.is(o)&&l.remove(),u.replace(l)}}else u===null&&se(263,Array.from(a).join(" "))}else s.insert(l);s=ft(l,this.direction)}for(const l of a.values())l.remove();return this}},Sc=class $y extends Vd{constructor(){super(...arguments);Tn(this,"type","child")}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:Jn(t,this.direction)}getParentCaret(t="root"){return ft(Jd(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=js(this.direction);return ft(this.getNodeAtCaret(),t)||Jn(this.origin,t)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(t){return t instanceof $y&&this.direction===t.direction&&this.origin.is(t.origin)}isSamePointCaret(t){return this.isSameNodeCaret(t)}};const Q2={root:At,shadowRoot:gr};function js(n){return X2[n]}function Jd(n,e="root"){return Q2[e](n)?null:n}let yl=class Tc extends Vd{constructor(){super(...arguments);Tn(this,"type","sibling")}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:ft(t,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return V(this.origin)?Jn(this.origin,this.direction):null}getParentCaret(t="root"){return ft(Jd(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=js(this.direction);return ft(this.getNodeAtCaret(),t)||Jn(this.origin.getParentOrThrow(),t)}isSamePointCaret(t){return t instanceof Tc&&this.direction===t.direction&&this.origin.is(t.origin)}isSameNodeCaret(t){return(t instanceof Tc||t instanceof _l)&&this.direction===t.direction&&this.origin.is(t.origin)}},_l=class Ac extends Vd{constructor(t,r){super(t);Tn(this,"type","text");this.offset=r}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:$i(t,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(t="root"){return ft(Jd(this.getParentAtCaret(),t),this.direction)}getFlipped(){return $i(this.origin,js(this.direction),this.offset)}isSamePointCaret(t){return t instanceof Ac&&this.direction===t.direction&&this.origin.is(t.origin)&&this.offset===t.offset}isSameNodeCaret(t){return(t instanceof yl||t instanceof Ac)&&this.direction===t.direction&&this.origin.is(t.origin)}getSiblingCaret(){return ft(this.origin,this.direction)}};function Xr(n){return n instanceof _l}function Li(n){return n instanceof yl}function zn(n){return n instanceof Sc}const Z2={next:class extends _l{constructor(){super(...arguments);Tn(this,"direction","next")}getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends _l{constructor(){super(...arguments);Tn(this,"direction","previous")}getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},eC={next:class extends yl{constructor(){super(...arguments);Tn(this,"direction","next")}getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends yl{constructor(){super(...arguments);Tn(this,"direction","previous")}getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},tC={next:class extends Sc{constructor(){super(...arguments);Tn(this,"direction","next")}getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends Sc{constructor(){super(...arguments);Tn(this,"direction","previous")}getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function ft(n,e){return n?new eC[e](n):null}function $i(n,e,t){return n?new Z2[e](n,Qr(n,t)):null}function Qr(n,e,t="error"){const r=n.getTextContentSize();let i=e==="next"?r:e==="previous"?0:e;return(i<0||i>r)&&(t!=="clamp"&&function(s,...o){const a=new URL("https://lexical.dev/docs/error"),l=new URLSearchParams;l.append("code",s);for(const u of o)l.append("v",u);a.search=l.toString(),console.warn(`Minified Lexical warning #${s}; visit ${a.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(284,String(e),String(r),n.getKey()),i=i<0?0:r),i}function Rh(n,e){return new iC(n,e)}function Jn(n,e){return V(n)?new tC[e](n):null}function nC(n){return n&&n.getChildCaret()||n}function To(n){return n&&nC(n.getAdjacentCaret())}let rC=class Fy{constructor(e,t,r){Tn(this,"type","node-caret-range");this.anchor=e,this.focus=t,this.direction=r}getLatest(){const e=this.anchor.getLatest(),t=this.focus.getLatest();return e===this.anchor&&t===this.focus?this:new Fy(e,t,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const e=i=>{const s=this[i].getLatest();return Xr(s)?function(o,a){const{direction:l,origin:u}=o,c=Qr(u,a==="focus"?js(l):l);return Rh(o,c-o.offset)}(s,i):null},t=e("anchor"),r=e("focus");if(t&&r){const{caret:i}=t,{caret:s}=r;if(i.isSameNodeCaret(s))return[Rh(i,s.offset-i.offset),null]}return[t,r]}iterNodeCarets(e="root"){const t=Xr(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),r=this.focus.getLatest(),i=Xr(r),s=o=>o.isSameNodeCaret(r)?null:To(o)||o.getParentCaret(e);return Jl({hasNext:o=>o!==null&&!(i&&r.isSameNodeCaret(o)),initial:t.isSameNodeCaret(r)?null:s(t),map:o=>o,step:s})}[Symbol.iterator](){return this.iterNodeCarets("root")}},iC=class{constructor(e,t){Tn(this,"type","slice");this.caret=e,this.distance=t}getSliceIndices(){const{distance:e,caret:{offset:t}}=this,r=t+e;return r<t?[r,t]:[t,r]}getTextContent(){const[e,t]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(e,t)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:e,direction:t}}=this,[r,i]=this.getSliceIndices(),s=e.getTextContent();return $i(e.setTextContent(s.slice(0,r)+s.slice(i)),t,r)}};function Gd(n){return ni(n,ft(Ne(),n.direction))}function sC(n){return ni(n,n)}function ni(n,e){return n.direction!==e.direction&&se(265),new rC(n,e,n.direction)}function Jl(n){const{initial:e,hasNext:t,step:r,map:i}=n;let s=e;return{[Symbol.iterator](){return this},next(){if(!t(s))return{done:!0,value:void 0};const o={done:!1,value:i(s)};return s=r(s),o}}}function By(n,e){const t=bo(n.origin,e.origin);switch(t===null&&se(275,n.origin.getKey(),e.origin.getKey()),t.type){case"same":{const r=n.type==="text",i=e.type==="text";return r&&i?function(s,o){return Math.sign(s-o)}(n.offset,e.offset):n.type===e.type?0:r?-1:i?1:n.type==="child"?-1:1}case"ancestor":return n.type==="child"?-1:1;case"descendant":return e.type==="child"?1:-1;case"branch":return qy(t)}}function qy(n){const{a:e,b:t}=n,r=e.__key,i=t.__key;let s=e,o=t;for(;s&&o;s=s.getNextSibling(),o=o.getNextSibling()){if(s.__key===i)return-1;if(o.__key===r)return 1}return s===null?1:-1}function ma(n,e){return e.is(n)}function Ph(n){return V(n)?[n.getLatest(),null]:[n.getParent(),n.getLatest()]}function bo(n,e){if(n.is(e))return{commonAncestor:n,type:"same"};const t=new Map;for(let[r,i]=Ph(n);r;i=r,r=r.getParent())t.set(r,i);for(let[r,i]=Ph(e);r;i=r,r=r.getParent()){const s=t.get(r);if(s!==void 0)return s===null?(ma(n,r)||se(276),{commonAncestor:r,type:"ancestor"}):i===null?(ma(e,r)||se(277),{commonAncestor:r,type:"descendant"}):((V(s)||ma(n,s))&&(V(i)||ma(e,i))&&r.is(s.getParent())&&r.is(i.getParent())||se(278),{a:s,b:i,commonAncestor:r,type:"branch"})}return null}function Mr(n,e){const{type:t,key:r,offset:i}=n,s=H2(n.key);return t==="text"?(Z(s)||se(266,s.getType(),r),$i(s,e,i)):(V(s)||se(267,s.getType(),r),lC(s,n.offset,e))}function Ao(n,e){const{origin:t,direction:r}=e,i=r==="next";Xr(e)?n.set(t.getKey(),e.offset,"text"):Li(e)?Z(t)?n.set(t.getKey(),Qr(t,r),"text"):n.set(t.getParentOrThrow().getKey(),t.getIndexWithinParent()+(i?1:0),"element"):(zn(e)&&V(t)||se(268),n.set(t.getKey(),i?0:t.getChildrenSize(),"element"))}function oC(n){const e=ne(),t=G(e)?e:jo();return Ka(t,n),Ot(t),t}function Ka(n,e){Ao(n.anchor,e.anchor),Ao(n.focus,e.focus)}function Lh(n){const{anchor:e,focus:t}=n,r=Mr(e,"next"),i=Mr(t,"next"),s=By(r,i)<=0?"next":"previous";return ni(Ss(r,s),Ss(i,s))}function Gl(n){const{direction:e,origin:t}=n,r=ft(t,js(e)).getNodeAtCaret();return r?ft(r,e):Jn(t.getParentOrThrow(),e)}function $h(n,e="root"){const t=[n];for(let r=zn(n)?n.getParentCaret(e):n.getSiblingCaret();r!==null;r=r.getParentCaret(e))t.push(Gl(r));return t}function Fu(n){return!!n&&n.origin.isAttached()}function aC(n,e="removeEmptySlices"){if(n.isCollapsed())return n;const t="root",r="next";let i=e;const s=Uy(n,r),o=$h(s.anchor,t),a=$h(s.focus.getFlipped(),t),l=new Set,u=[];for(const p of s.iterNodeCarets(t))if(zn(p))l.add(p.origin.getKey());else if(Li(p)){const{origin:m}=p;V(m)&&!l.has(m.getKey())||u.push(m)}for(const p of u)p.remove();for(const p of s.getTextSlices()){if(!p)continue;const{origin:m}=p.caret,_=m.getTextContentSize(),C=Gl(ft(m,r)),v=m.getMode();if(Math.abs(p.distance)===_&&i==="removeEmptySlices"||v==="token"&&p.distance!==0)C.remove();else if(p.distance!==0){i="removeEmptySlices";let x=p.removeTextSlice();const M=p.caret.origin;if(v==="segmented"){const $=x.origin,k=we($.getTextContent()).setStyle($.getStyle()).setFormat($.getFormat());C.replaceOrInsert(k),x=$i(k,r,x.offset)}M.is(o[0].origin)&&(o[0]=x),M.is(a[0].origin)&&(a[0]=x.getFlipped())}}let c,f;for(const p of o)if(Fu(p)){c=lr(p);break}for(const p of a)if(Fu(p)){f=lr(p);break}const d=function(p,m,_){if(!p||!m)return null;const C=p.getParentAtCaret(),v=m.getParentAtCaret();if(!C||!v)return null;const x=C.getParents().reverse();x.push(C);const M=v.getParents().reverse();M.push(v);const $=Math.min(x.length,M.length);let k;for(k=0;k<$&&x[k]===M[k];k++);const P=(z,w)=>{let q;for(let S=k;S<z.length;S++){const H=z[S];if(gr(H))return;!q&&w(H)&&(q=H)}return q},D=P(x,Dn),O=D&&P(M,z=>_.has(z.getKey())&&Dn(z));return D&&O?[D,O]:null}(c,f,l);if(d){const[p,m]=d;Jn(p,"previous").splice(0,m.getChildren()),m.remove()}const h=[c,f,...o,...a].find(Fu);if(h)return sC(Ss(lr(h),n.direction));se(269,JSON.stringify(o.map(p=>p.origin.__key)))}function lr(n){const e=function(i){let s=i;for(;zn(s);){const o=To(s);if(!zn(o))break;s=o}return s}(n.getLatest()),{direction:t}=e;if(Z(e.origin))return Xr(e)?e:$i(e.origin,t,t);const r=e.getAdjacentCaret();return Li(r)&&Z(r.origin)?$i(r.origin,t,js(t)):e}function jy(n){return Xr(n)&&n.offset!==Qr(n.origin,n.direction)}function Ss(n,e){return n.direction===e?n:n.getFlipped()}function Uy(n,e){return n.direction===e?n:ni(Ss(n.focus,e),Ss(n.anchor,e))}function lC(n,e,t){let r=Jn(n,"next");for(let i=0;i<e;i++){const s=r.getAdjacentCaret();if(s===null)break;r=s}return Ss(r,t)}var Ae={},mt={},Fh;function Us(){if(Fh)return mt;Fh=1;function n(C,v,x){if(x===void 0&&(x=Array.prototype),C&&typeof x.find=="function")return x.find.call(C,v);for(var M=0;M<C.length;M++)if(t(C,M)){var $=C[M];if(v.call(void 0,$,M,C))return $}}function e(C,v){return v===void 0&&(v=Object),v&&typeof v.getOwnPropertyDescriptors=="function"&&(C=v.create(null,v.getOwnPropertyDescriptors(C))),v&&typeof v.freeze=="function"?v.freeze(C):C}function t(C,v){return Object.prototype.hasOwnProperty.call(C,v)}function r(C,v){if(C===null||typeof C!="object")throw new TypeError("target is not an object");for(var x in v)t(v,x)&&(C[x]=v[x]);return C}var i=e({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0});function s(C){return t(i,C.toLowerCase())}var o=e({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function a(C){return t(o,C.toLowerCase())}var l=e({script:!1,style:!1,textarea:!0,title:!0});function u(C){var v=C.toLowerCase();return t(l,v)&&!l[v]}function c(C){var v=C.toLowerCase();return t(l,v)&&l[v]}function f(C){return C===h.HTML}function d(C){return f(C)||C===h.XML_XHTML_APPLICATION}var h=e({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),p=Object.keys(h).map(function(C){return h[C]});function m(C){return p.indexOf(C)>-1}var _=e({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return mt.assign=r,mt.find=n,mt.freeze=e,mt.HTML_BOOLEAN_ATTRIBUTES=i,mt.HTML_RAW_TEXT_ELEMENTS=l,mt.HTML_VOID_ELEMENTS=o,mt.hasDefaultHTMLNamespace=d,mt.hasOwn=t,mt.isHTMLBooleanAttribute=s,mt.isHTMLRawTextElement=u,mt.isHTMLEscapableRawTextElement=c,mt.isHTMLMimeType=f,mt.isHTMLVoidElement=a,mt.isValidMimeType=m,mt.MIME_TYPE=h,mt.NAMESPACE=_,mt}var as={},Bh;function Yl(){if(Bh)return as;Bh=1;var n=Us();function e(d,h){d.prototype=Object.create(Error.prototype,{constructor:{value:d},name:{value:d.name,enumerable:!0,writable:h}})}var t=n.freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),r=Object.keys(t);function i(d){return typeof d=="number"&&d>=1&&d<=25}function s(d){return typeof d=="string"&&d.substring(d.length-t.Error.length)===t.Error}function o(d,h){i(d)?(this.name=r[d],this.message=h||""):(this.message=d,this.name=s(h)?h:t.Error),Error.captureStackTrace&&Error.captureStackTrace(this,o)}e(o,!0),Object.defineProperties(o.prototype,{code:{enumerable:!0,get:function(){var d=r.indexOf(this.name);return i(d)?d:0}}});for(var a={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},l=Object.entries(a),u=0;u<l.length;u++){var c=l[u][0];o[c]=l[u][1]}function f(d,h){this.message=d,this.locator=h,Error.captureStackTrace&&Error.captureStackTrace(this,f)}return e(f),as.DOMException=o,as.DOMExceptionName=t,as.ExceptionCode=a,as.ParseError=f,as}var Qe={},Ee={},qh;function Wy(){if(qh)return Ee;qh=1;function n(Be){try{typeof Be!="function"&&(Be=RegExp);var Ye=new Be("𝌆","u").exec("𝌆");return!!Ye&&Ye[0].length===2}catch{}return!1}var e=n();function t(Be){if(Be.source[0]!=="[")throw new Error(Be+" can not be used with chars");return Be.source.slice(1,Be.source.lastIndexOf("]"))}function r(Be,Ye){if(Be.source[0]!=="[")throw new Error("/"+Be.source+"/ can not be used with chars_without");if(!Ye||typeof Ye!="string")throw new Error(JSON.stringify(Ye)+" is not a valid search");if(Be.source.indexOf(Ye)===-1)throw new Error('"'+Ye+'" is not is /'+Be.source+"/");if(Ye==="-"&&Be.source.indexOf(Ye)!==1)throw new Error('"'+Ye+'" is not at the first postion of /'+Be.source+"/");return new RegExp(Be.source.replace(Ye,""),e?"u":"")}function i(Be){var Ye=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(zt){var Ht=typeof zt=="string";if(Ht&&Ye===void 0&&zt==="|")throw new Error("use regg instead of reg to wrap expressions with `|`!");return Ht?zt:zt.source}).join(""),e?"mu":"m")}function s(Be){if(arguments.length===0)throw new Error("no parameters provided");return i.apply(s,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var o="�",a=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;e&&(a=i("[",t(a),"\\u{10000}-\\u{10FFFF}","]"));var l=/[\x20\x09\x0D\x0A]/,u=t(l),c=i(l,"+"),f=i(l,"*"),d=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;e&&(d=i("[",t(d),"\\u{10000}-\\u{10FFFF}","]"));var h=t(d),p=i("[",h,t(/[-.0-9\xB7]/),t(/[\u0300-\u036F\u203F-\u2040]/),"]"),m=i(d,p,"*"),_=i(p,"+"),C=i("&",m,";"),v=s(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),x=s(C,"|",v),M=i("%",m,";"),$=s(i('"',s(/[^%&"]/,"|",M,"|",x),"*",'"'),"|",i("'",s(/[^%&']/,"|",M,"|",x),"*","'")),k=s('"',s(/[^<&"]/,"|",x),"*",'"',"|","'",s(/[^<&']/,"|",x),"*","'"),P=r(d,":"),D=r(p,":"),O=i(P,D,"*"),z=i(O,s(":",O),"?"),w=i("^",z,"$"),q=i("(",z,")"),S=s(/"[^"]*"|'[^']*'/),H=i(/^<\?/,"(",m,")",s(c,"(",a,"*?)"),"?",/\?>/),A=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,L=s('"',A,'*"',"|","'",r(A,"'"),"*'"),j="<!--",K="-->",J=i(j,s(r(a,"-"),"|",i("-",r(a,"-"))),"*",K),W="#PCDATA",Q=s(i(/\(/,f,W,s(f,/\|/,f,z),"*",f,/\)\*/),"|",i(/\(/,f,W,f,/\)/)),ie=/[?*+]?/,te=i(/\([^>]+\)/,ie),ee=s("EMPTY","|","ANY","|",Q,"|",te),Y="<!ELEMENT",oe=i(Y,c,s(z,"|",M),c,s(ee,"|",M),f,">"),ue=i("NOTATION",c,/\(/,f,m,s(f,/\|/,f,m),"*",f,/\)/),de=i(/\(/,f,_,s(f,/\|/,f,_),"*",f,/\)/),pe=s(ue,"|",de),ge=s(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",pe),_e=s(/#REQUIRED|#IMPLIED/,"|",s(s("#FIXED",c),"?",k)),ae=s(c,m,c,ge,c,_e),Se="<!ATTLIST",Ie=i(Se,c,m,ae,"*",f,">"),De="about:legacy-compat",Qt=s('"'+De+'"',"|","'"+De+"'"),Wt="SYSTEM",It="PUBLIC",un=s(s(Wt,c,S),"|",s(It,c,L,c,S)),Zt=i("^",s(s(Wt,c,"(?<SystemLiteralOnly>",S,")"),"|",s(It,c,"(?<PubidLiteral>",L,")",c,"(?<SystemLiteral>",S,")"))),cn=s(c,"NDATA",c,m),pt=s($,"|",s(un,cn,"?")),Re="<!ENTITY",ot=i(Re,c,m,c,pt,f,">"),ze=s($,"|",un),Pn=i(Re,c,"%",c,m,c,ze,f,">"),dn=s(ot,"|",Pn),en=i(It,c,L),fn=i("<!NOTATION",c,m,c,s(un,"|",en),f,">"),me=i(f,"=",f),Fe=/1[.]\d+/,at=i(c,"version",me,s("'",Fe,"'","|",'"',Fe,'"')),gt=/[A-Za-z][-A-Za-z0-9._]*/,hn=s(c,"encoding",me,s('"',gt,'"',"|","'",gt,"'")),pn=s(c,"standalone",me,s("'",s("yes","|","no"),"'","|",'"',s("yes","|","no"),'"')),Ln=i(/^<\?xml/,at,hn,"?",pn,"?",f,/\?>/),gn="<!DOCTYPE",mn="<![CDATA[",wt="]]>",yn=/<!\[CDATA\[/,_n=/\]\]>/,tn=i(a,"*?",_n),Qn=i(yn,tn);return Ee.chars=t,Ee.chars_without=r,Ee.detectUnicodeSupport=n,Ee.reg=i,Ee.regg=s,Ee.ABOUT_LEGACY_COMPAT=De,Ee.ABOUT_LEGACY_COMPAT_SystemLiteral=Qt,Ee.AttlistDecl=Ie,Ee.CDATA_START=mn,Ee.CDATA_END=wt,Ee.CDSect=Qn,Ee.Char=a,Ee.Comment=J,Ee.COMMENT_START=j,Ee.COMMENT_END=K,Ee.DOCTYPE_DECL_START=gn,Ee.elementdecl=oe,Ee.EntityDecl=dn,Ee.EntityValue=$,Ee.ExternalID=un,Ee.ExternalID_match=Zt,Ee.Name=m,Ee.NotationDecl=fn,Ee.Reference=x,Ee.PEReference=M,Ee.PI=H,Ee.PUBLIC=It,Ee.PubidLiteral=L,Ee.QName=z,Ee.QName_exact=w,Ee.QName_group=q,Ee.S=c,Ee.SChar_s=u,Ee.S_OPT=f,Ee.SYSTEM=Wt,Ee.SystemLiteral=S,Ee.UNICODE_REPLACEMENT_CHARACTER=o,Ee.UNICODE_SUPPORT=e,Ee.XMLDecl=Ln,Ee}var jh;function zy(){if(jh)return Qe;jh=1;var n=Us(),e=n.find,t=n.hasDefaultHTMLNamespace,r=n.hasOwn,i=n.isHTMLMimeType,s=n.isHTMLRawTextElement,o=n.isHTMLVoidElement,a=n.MIME_TYPE,l=n.NAMESPACE,u=Symbol(),c=Yl(),f=c.DOMException,d=c.DOMExceptionName,h=Wy();function p(y){if(y!==u)throw new TypeError("Illegal constructor")}function m(y){return y!==""}function _(y){return y?y.split(/[\t\n\f\r ]+/).filter(m):[]}function C(y,b){return r(y,b)||(y[b]=!0),y}function v(y){if(!y)return[];var b=_(y);return Object.keys(b.reduce(C,{}))}function x(y){return function(b){return y&&y.indexOf(b)!==-1}}function M(y){if(!h.QName_exact.test(y))throw new f(f.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+y+'"')}function $(y,b){M(b),y=y||null;var N=null,U=b;if(b.indexOf(":")>=0){var re=b.split(":");N=re[0],U=re[1]}if(N!==null&&y===null)throw new f(f.NAMESPACE_ERR,"prefix is non-null and namespace is null");if(N==="xml"&&y!==n.NAMESPACE.XML)throw new f(f.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if((N==="xmlns"||b==="xmlns")&&y!==n.NAMESPACE.XMLNS)throw new f(f.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(y===n.NAMESPACE.XMLNS&&N!=="xmlns"&&b!=="xmlns")throw new f(f.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[y,N,U]}function k(y,b){for(var N in y)r(y,N)&&(b[N]=y[N])}function P(y,b){var N=y.prototype;if(!(N instanceof b)){let U=function(){};U.prototype=b.prototype,U=new U,k(N,U),y.prototype=N=U}N.constructor!=y&&(typeof y!="function"&&console.error("unknown Class:"+y),N.constructor=y)}var D={},O=D.ELEMENT_NODE=1,z=D.ATTRIBUTE_NODE=2,w=D.TEXT_NODE=3,q=D.CDATA_SECTION_NODE=4,S=D.ENTITY_REFERENCE_NODE=5,H=D.ENTITY_NODE=6,A=D.PROCESSING_INSTRUCTION_NODE=7,L=D.COMMENT_NODE=8,j=D.DOCUMENT_NODE=9,K=D.DOCUMENT_TYPE_NODE=10,J=D.DOCUMENT_FRAGMENT_NODE=11,W=D.NOTATION_NODE=12,Q=n.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function ie(y,b){if(b.length<y.length)return ie(b,y);var N=null;for(var U in y){if(y[U]!==b[U])return N;N=y[U]}return N}function te(y){return y.guid||(y.guid=Math.random()),y.guid}function ee(){}ee.prototype={length:0,item:function(y){return y>=0&&y<this.length?this[y]:null},toString:function(y){for(var b=[],N=0;N<this.length;N++)Ht(this[N],b,y);return b.join("")},filter:function(y){return Array.prototype.filter.call(this,y)},indexOf:function(y){return Array.prototype.indexOf.call(this,y)}},ee.prototype[Symbol.iterator]=function(){var y=this,b=0;return{next:function(){return b<y.length?{value:y[b++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function Y(y,b){this._node=y,this._refresh=b,oe(this)}function oe(y){var b=y._node._inc||y._node.ownerDocument._inc;if(y._inc!==b){var N=y._refresh(y._node);if(Sn(y,"length",N.length),!y.$$length||N.length<y.$$length)for(var U=N.length;U in y;U++)r(y,U)&&delete y[U];k(N,y),y._inc=b}}Y.prototype.item=function(y){return oe(this),this[y]||null},P(Y,ee);function ue(){}function de(y,b){for(var N=0;N<y.length;){if(y[N]===b)return N;N++}}function pe(y,b,N,U){if(U?b[de(b,U)]=N:(b[b.length]=N,b.length++),y){N.ownerElement=y;var re=y.ownerDocument;re&&(U&&Wt(re,y,U),Qt(re,y,N))}}function ge(y,b,N){var U=de(b,N);if(U>=0){for(var re=b.length-1;U<=re;)b[U]=b[++U];if(b.length=re,y){var le=y.ownerDocument;le&&Wt(le,y,N),N.ownerElement=null}}}ue.prototype={length:0,item:ee.prototype.item,getNamedItem:function(y){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(y=y.toLowerCase());for(var b=0;b<this.length;){var N=this[b];if(N.nodeName===y)return N;b++}return null},setNamedItem:function(y){var b=y.ownerElement;if(b&&b!==this._ownerElement)throw new f(f.INUSE_ATTRIBUTE_ERR);var N=this.getNamedItemNS(y.namespaceURI,y.localName);return N===y?y:(pe(this._ownerElement,this,y,N),N)},setNamedItemNS:function(y){return this.setNamedItem(y)},removeNamedItem:function(y){var b=this.getNamedItem(y);if(!b)throw new f(f.NOT_FOUND_ERR,y);return ge(this._ownerElement,this,b),b},removeNamedItemNS:function(y,b){var N=this.getNamedItemNS(y,b);if(!N)throw new f(f.NOT_FOUND_ERR,y?y+" : "+b:b);return ge(this._ownerElement,this,N),N},getNamedItemNS:function(y,b){y||(y=null);for(var N=0;N<this.length;){var U=this[N];if(U.localName===b&&U.namespaceURI===y)return U;N++}return null}},ue.prototype[Symbol.iterator]=function(){var y=this,b=0;return{next:function(){return b<y.length?{value:y[b++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function _e(){}_e.prototype={hasFeature:function(y,b){return!0},createDocument:function(y,b,N){var U=a.XML_APPLICATION;y===l.HTML?U=a.XML_XHTML_APPLICATION:y===l.SVG&&(U=a.XML_SVG_IMAGE);var re=new De(u,{contentType:U});if(re.implementation=this,re.childNodes=new ee,re.doctype=N||null,N&&re.appendChild(N),b){var le=re.createElementNS(y,b);re.appendChild(le)}return re},createDocumentType:function(y,b,N,U){M(y);var re=new gn(u);return re.name=y,re.nodeName=y,re.publicId=b||"",re.systemId=N||"",re.internalSubset=U||"",re.childNodes=new ee,re},createHTMLDocument:function(y){var b=new De(u,{contentType:a.HTML});if(b.implementation=this,b.childNodes=new ee,y!==!1){b.doctype=this.createDocumentType("html"),b.doctype.ownerDocument=b,b.appendChild(b.doctype);var N=b.createElement("html");b.appendChild(N);var U=b.createElement("head");if(N.appendChild(U),typeof y=="string"){var re=b.createElement("title");re.appendChild(b.createTextNode(y)),U.appendChild(re)}N.appendChild(b.createElement("body"))}return b}};function ae(y){p(y)}ae.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var y=this.getRootNode();return y&&y.nodeType===y.DOCUMENT_NODE},contains:function(y){if(!y)return!1;var b=y;do{if(this===b)return!0;b=y.parentNode}while(b);return!1},getRootNode:function(y){var b=this;do{if(!b.parentNode)return b;b=b.parentNode}while(b)},isEqualNode:function(y){if(!y||this.nodeType!==y.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==y.name||this.publicId!==y.publicId||this.systemId!==y.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==y.namespaceURI||this.prefix!==y.prefix||this.localName!==y.localName||this.attributes.length!==y.attributes.length)return!1;for(var b=0;b<this.attributes.length;b++){var N=this.attributes.item(b);if(!N.isEqualNode(y.getAttributeNodeNS(N.namespaceURI,N.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==y.namespaceURI||this.localName!==y.localName||this.value!==y.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==y.target||this.data!==y.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==y.data)return!1;break}if(this.childNodes.length!==y.childNodes.length)return!1;for(var b=0;b<this.childNodes.length;b++)if(!this.childNodes[b].isEqualNode(y.childNodes[b]))return!1;return!0},isSameNode:function(y){return this===y},insertBefore:function(y,b){return me(this,y,b)},replaceChild:function(y,b){me(this,y,b,fn),b&&this.removeChild(b)},removeChild:function(y){return un(this,y)},appendChild:function(y){return this.insertBefore(y,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(y){return qr(this.ownerDocument||this,this,y)},normalize:function(){for(var y=this.firstChild;y;){var b=y.nextSibling;b&&b.nodeType==w&&y.nodeType==w?(this.removeChild(b),y.appendData(b.data)):(y.normalize(),y=b)}},isSupported:function(y,b){return this.ownerDocument.implementation.hasFeature(y,b)},lookupPrefix:function(y){for(var b=this;b;){var N=b._nsMap;if(N){for(var U in N)if(r(N,U)&&N[U]===y)return U}b=b.nodeType==z?b.ownerDocument:b.parentNode}return null},lookupNamespaceURI:function(y){for(var b=this;b;){var N=b._nsMap;if(N&&r(N,y))return N[y];b=b.nodeType==z?b.ownerDocument:b.parentNode}return null},isDefaultNamespace:function(y){var b=this.lookupPrefix(y);return b==null},compareDocumentPosition:function(y){if(this===y)return 0;var b=y,N=this,U=null,re=null;if(b instanceof at&&(U=b,b=U.ownerElement),N instanceof at&&(re=N,N=re.ownerElement,U&&b&&N===b))for(var le=0,Te;Te=N.attributes[le];le++){if(Te===U)return Q.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+Q.DOCUMENT_POSITION_PRECEDING;if(Te===re)return Q.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+Q.DOCUMENT_POSITION_FOLLOWING}if(!b||!N||N.ownerDocument!==b.ownerDocument)return Q.DOCUMENT_POSITION_DISCONNECTED+Q.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(te(N.ownerDocument)>te(b.ownerDocument)?Q.DOCUMENT_POSITION_FOLLOWING:Q.DOCUMENT_POSITION_PRECEDING);if(re&&b===N)return Q.DOCUMENT_POSITION_CONTAINS+Q.DOCUMENT_POSITION_PRECEDING;if(U&&b===N)return Q.DOCUMENT_POSITION_CONTAINED_BY+Q.DOCUMENT_POSITION_FOLLOWING;for(var Xe=[],tt=b.parentNode;tt;){if(!re&&tt===N)return Q.DOCUMENT_POSITION_CONTAINED_BY+Q.DOCUMENT_POSITION_FOLLOWING;Xe.push(tt),tt=tt.parentNode}Xe.reverse();for(var xt=[],lt=N.parentNode;lt;){if(!U&&lt===b)return Q.DOCUMENT_POSITION_CONTAINS+Q.DOCUMENT_POSITION_PRECEDING;xt.push(lt),lt=lt.parentNode}xt.reverse();var Je=ie(Xe,xt);for(var bn in Je.childNodes){var Rt=Je.childNodes[bn];if(Rt===N)return Q.DOCUMENT_POSITION_FOLLOWING;if(Rt===b)return Q.DOCUMENT_POSITION_PRECEDING;if(xt.indexOf(Rt)>=0)return Q.DOCUMENT_POSITION_FOLLOWING;if(Xe.indexOf(Rt)>=0)return Q.DOCUMENT_POSITION_PRECEDING}return 0}};function Se(y){return y=="<"&&"&lt;"||y==">"&&"&gt;"||y=="&"&&"&amp;"||y=='"'&&"&quot;"||"&#"+y.charCodeAt()+";"}k(D,ae),k(D,ae.prototype),k(Q,ae),k(Q,ae.prototype);function Ie(y,b){if(b(y))return!0;if(y=y.firstChild)do if(Ie(y,b))return!0;while(y=y.nextSibling)}function De(y,b){p(y);var N=b||{};this.ownerDocument=this,this.contentType=N.contentType||a.XML_APPLICATION,this.type=i(this.contentType)?"html":"xml"}function Qt(y,b,N){y&&y._inc++;var U=N.namespaceURI;U===l.XMLNS&&(b._nsMap[N.prefix?N.localName:""]=N.value)}function Wt(y,b,N,U){y&&y._inc++;var re=N.namespaceURI;re===l.XMLNS&&delete b._nsMap[N.prefix?N.localName:""]}function It(y,b,N){if(y&&y._inc){y._inc++;var U=b.childNodes;if(N&&!N.nextSibling)U[U.length++]=N;else{for(var re=b.firstChild,le=0;re;)U[le++]=re,re=re.nextSibling;U.length=le,delete U[U.length]}}}function un(y,b){if(y!==b.parentNode)throw new f(f.NOT_FOUND_ERR,"child's parent is not parent");var N=b.previousSibling,U=b.nextSibling;return N?N.nextSibling=U:y.firstChild=U,U?U.previousSibling=N:y.lastChild=N,It(y.ownerDocument,y),b.parentNode=null,b.previousSibling=null,b.nextSibling=null,b}function Zt(y){return y&&(y.nodeType===ae.DOCUMENT_NODE||y.nodeType===ae.DOCUMENT_FRAGMENT_NODE||y.nodeType===ae.ELEMENT_NODE)}function cn(y){return y&&(y.nodeType===ae.CDATA_SECTION_NODE||y.nodeType===ae.COMMENT_NODE||y.nodeType===ae.DOCUMENT_FRAGMENT_NODE||y.nodeType===ae.DOCUMENT_TYPE_NODE||y.nodeType===ae.ELEMENT_NODE||y.nodeType===ae.PROCESSING_INSTRUCTION_NODE||y.nodeType===ae.TEXT_NODE)}function pt(y){return y&&y.nodeType===ae.DOCUMENT_TYPE_NODE}function Re(y){return y&&y.nodeType===ae.ELEMENT_NODE}function ot(y){return y&&y.nodeType===ae.TEXT_NODE}function ze(y,b){var N=y.childNodes||[];if(e(N,Re)||pt(b))return!1;var U=e(N,pt);return!(b&&U&&N.indexOf(U)>N.indexOf(b))}function Pn(y,b){var N=y.childNodes||[];function U(le){return Re(le)&&le!==b}if(e(N,U))return!1;var re=e(N,pt);return!(b&&re&&N.indexOf(re)>N.indexOf(b))}function dn(y,b,N){if(!Zt(y))throw new f(f.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+y.nodeType);if(N&&N.parentNode!==y)throw new f(f.NOT_FOUND_ERR,"child not in parent");if(!cn(b)||pt(b)&&y.nodeType!==ae.DOCUMENT_NODE)throw new f(f.HIERARCHY_REQUEST_ERR,"Unexpected node type "+b.nodeType+" for parent node type "+y.nodeType)}function en(y,b,N){var U=y.childNodes||[],re=b.childNodes||[];if(b.nodeType===ae.DOCUMENT_FRAGMENT_NODE){var le=re.filter(Re);if(le.length>1||e(re,ot))throw new f(f.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(le.length===1&&!ze(y,N))throw new f(f.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Re(b)&&!ze(y,N))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(pt(b)){if(e(U,pt))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var Te=e(U,Re);if(N&&U.indexOf(Te)<U.indexOf(N))throw new f(f.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!N&&Te)throw new f(f.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function fn(y,b,N){var U=y.childNodes||[],re=b.childNodes||[];if(b.nodeType===ae.DOCUMENT_FRAGMENT_NODE){var le=re.filter(Re);if(le.length>1||e(re,ot))throw new f(f.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(le.length===1&&!Pn(y,N))throw new f(f.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(Re(b)&&!Pn(y,N))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(pt(b)){if(e(U,function(tt){return pt(tt)&&tt!==N}))throw new f(f.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var Te=e(U,Re);if(N&&U.indexOf(Te)<U.indexOf(N))throw new f(f.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function me(y,b,N,U){dn(y,b,N),y.nodeType===ae.DOCUMENT_NODE&&(U||en)(y,b,N);var re=b.parentNode;if(re&&re.removeChild(b),b.nodeType===J){var le=b.firstChild;if(le==null)return b;var Te=b.lastChild}else le=Te=b;var Xe=N?N.previousSibling:y.lastChild;le.previousSibling=Xe,Te.nextSibling=N,Xe?Xe.nextSibling=le:y.firstChild=le,N==null?y.lastChild=Te:N.previousSibling=Te;do le.parentNode=y;while(le!==Te&&(le=le.nextSibling));return It(y.ownerDocument||y,y,b),b.nodeType==J&&(b.firstChild=b.lastChild=null),b}De.prototype={implementation:null,nodeName:"#document",nodeType:j,doctype:null,documentElement:null,_inc:1,insertBefore:function(y,b){if(y.nodeType===J){for(var N=y.firstChild;N;){var U=N.nextSibling;this.insertBefore(N,b),N=U}return y}return me(this,y,b),y.ownerDocument=this,this.documentElement===null&&y.nodeType===O&&(this.documentElement=y),y},removeChild:function(y){var b=un(this,y);return b===this.documentElement&&(this.documentElement=null),b},replaceChild:function(y,b){me(this,y,b,fn),y.ownerDocument=this,b&&this.removeChild(b),Re(y)&&(this.documentElement=y)},importNode:function(y,b){return $n(this,y,b)},getElementById:function(y){var b=null;return Ie(this.documentElement,function(N){if(N.nodeType==O&&N.getAttribute("id")==y)return b=N,!0}),b},createElement:function(y){var b=new Fe(u);b.ownerDocument=this,this.type==="html"&&(y=y.toLowerCase()),t(this.contentType)&&(b.namespaceURI=l.HTML),b.nodeName=y,b.tagName=y,b.localName=y,b.childNodes=new ee;var N=b.attributes=new ue;return N._ownerElement=b,b},createDocumentFragment:function(){var y=new _n(u);return y.ownerDocument=this,y.childNodes=new ee,y},createTextNode:function(y){var b=new hn(u);return b.ownerDocument=this,b.childNodes=new ee,b.appendData(y),b},createComment:function(y){var b=new pn(u);return b.ownerDocument=this,b.childNodes=new ee,b.appendData(y),b},createCDATASection:function(y){var b=new Ln(u);return b.ownerDocument=this,b.childNodes=new ee,b.appendData(y),b},createProcessingInstruction:function(y,b){var N=new tn(u);return N.ownerDocument=this,N.childNodes=new ee,N.nodeName=N.target=y,N.nodeValue=N.data=b,N},createAttribute:function(y){if(!h.QName_exact.test(y))throw new f(f.INVALID_CHARACTER_ERR,'invalid character in name "'+y+'"');return this.type==="html"&&(y=y.toLowerCase()),this._createAttribute(y)},_createAttribute:function(y){var b=new at(u);return b.ownerDocument=this,b.childNodes=new ee,b.name=y,b.nodeName=y,b.localName=y,b.specified=!0,b},createEntityReference:function(y){if(!h.Name.test(y))throw new f(f.INVALID_CHARACTER_ERR,'not a valid xml name "'+y+'"');if(this.type==="html")throw new f("document is an html document",d.NotSupportedError);var b=new yn(u);return b.ownerDocument=this,b.childNodes=new ee,b.nodeName=y,b},createElementNS:function(y,b){var N=$(y,b),U=new Fe(u),re=U.attributes=new ue;return U.childNodes=new ee,U.ownerDocument=this,U.nodeName=b,U.tagName=b,U.namespaceURI=N[0],U.prefix=N[1],U.localName=N[2],re._ownerElement=U,U},createAttributeNS:function(y,b){var N=$(y,b),U=new at(u);return U.ownerDocument=this,U.childNodes=new ee,U.nodeName=b,U.name=b,U.specified=!0,U.namespaceURI=N[0],U.prefix=N[1],U.localName=N[2],U}},P(De,ae);function Fe(y){p(y),this._nsMap=Object.create(null)}Fe.prototype={nodeType:O,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return this.ownerDocument.type==="html"&&this.namespaceURI===l.HTML},hasAttributes:function(){return!!(this.attributes&&this.attributes.length)},hasAttribute:function(y){return!!this.getAttributeNode(y)},getAttribute:function(y){var b=this.getAttributeNode(y);return b?b.value:null},getAttributeNode:function(y){return this._isInHTMLDocumentAndNamespace()&&(y=y.toLowerCase()),this.attributes.getNamedItem(y)},setAttribute:function(y,b){this._isInHTMLDocumentAndNamespace()&&(y=y.toLowerCase());var N=this.getAttributeNode(y);N?N.value=N.nodeValue=""+b:(N=this.ownerDocument._createAttribute(y),N.value=N.nodeValue=""+b,this.setAttributeNode(N))},removeAttribute:function(y){var b=this.getAttributeNode(y);b&&this.removeAttributeNode(b)},setAttributeNode:function(y){return this.attributes.setNamedItem(y)},setAttributeNodeNS:function(y){return this.attributes.setNamedItemNS(y)},removeAttributeNode:function(y){return this.attributes.removeNamedItem(y.nodeName)},removeAttributeNS:function(y,b){var N=this.getAttributeNodeNS(y,b);N&&this.removeAttributeNode(N)},hasAttributeNS:function(y,b){return this.getAttributeNodeNS(y,b)!=null},getAttributeNS:function(y,b){var N=this.getAttributeNodeNS(y,b);return N?N.value:null},setAttributeNS:function(y,b,N){var U=$(y,b),re=U[2],le=this.getAttributeNodeNS(y,re);le?le.value=le.nodeValue=""+N:(le=this.ownerDocument.createAttributeNS(y,b),le.value=le.nodeValue=""+N,this.setAttributeNode(le))},getAttributeNodeNS:function(y,b){return this.attributes.getNamedItemNS(y,b)},getElementsByClassName:function(y){var b=v(y);return new Y(this,function(N){var U=[];return b.length>0&&Ie(N,function(re){if(re!==N&&re.nodeType===O){var le=re.getAttribute("class");if(le){var Te=y===le;if(!Te){var Xe=v(le);Te=b.every(x(Xe))}Te&&U.push(re)}}}),U})},getElementsByTagName:function(y){var b=(this.nodeType===j?this:this.ownerDocument).type==="html",N=y.toLowerCase();return new Y(this,function(U){var re=[];return Ie(U,function(le){if(!(le===U||le.nodeType!==O))if(y==="*")re.push(le);else{var Te=le.getQualifiedName(),Xe=b&&le.namespaceURI===l.HTML?N:y;Te===Xe&&re.push(le)}}),re})},getElementsByTagNameNS:function(y,b){return new Y(this,function(N){var U=[];return Ie(N,function(re){re!==N&&re.nodeType===O&&(y==="*"||re.namespaceURI===y)&&(b==="*"||re.localName==b)&&U.push(re)}),U})}},De.prototype.getElementsByClassName=Fe.prototype.getElementsByClassName,De.prototype.getElementsByTagName=Fe.prototype.getElementsByTagName,De.prototype.getElementsByTagNameNS=Fe.prototype.getElementsByTagNameNS,P(Fe,ae);function at(y){p(y),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}at.prototype.nodeType=z,P(at,ae);function gt(y){p(y)}gt.prototype={data:"",substringData:function(y,b){return this.data.substring(y,y+b)},appendData:function(y){y=this.data+y,this.nodeValue=this.data=y,this.length=y.length},insertData:function(y,b){this.replaceData(y,0,b)},deleteData:function(y,b){this.replaceData(y,b,"")},replaceData:function(y,b,N){var U=this.data.substring(0,y),re=this.data.substring(y+b);N=U+N+re,this.nodeValue=this.data=N,this.length=N.length}},P(gt,ae);function hn(y){p(y)}hn.prototype={nodeName:"#text",nodeType:w,splitText:function(y){var b=this.data,N=b.substring(y);b=b.substring(0,y),this.data=this.nodeValue=b,this.length=b.length;var U=this.ownerDocument.createTextNode(N);return this.parentNode&&this.parentNode.insertBefore(U,this.nextSibling),U}},P(hn,gt);function pn(y){p(y)}pn.prototype={nodeName:"#comment",nodeType:L},P(pn,gt);function Ln(y){p(y)}Ln.prototype={nodeName:"#cdata-section",nodeType:q},P(Ln,hn);function gn(y){p(y)}gn.prototype.nodeType=K,P(gn,ae);function mn(y){p(y)}mn.prototype.nodeType=W,P(mn,ae);function wt(y){p(y)}wt.prototype.nodeType=H,P(wt,ae);function yn(y){p(y)}yn.prototype.nodeType=S,P(yn,ae);function _n(y){p(y)}_n.prototype.nodeName="#document-fragment",_n.prototype.nodeType=J,P(_n,ae);function tn(y){p(y)}tn.prototype.nodeType=A,P(tn,gt);function Qn(){}Qn.prototype.serializeToString=function(y,b){return Be.call(y,b)},ae.prototype.toString=Be;function Be(y){var b=[],N=this.nodeType===j&&this.documentElement||this,U=N.prefix,re=N.namespaceURI;if(re&&U==null){var U=N.lookupPrefix(re);if(U==null)var le=[{namespace:re,prefix:null}]}return Ht(this,b,y,le),b.join("")}function Ye(y,b,N){var U=y.prefix||"",re=y.namespaceURI;if(!re||U==="xml"&&re===l.XML||re===l.XMLNS)return!1;for(var le=N.length;le--;){var Te=N[le];if(Te.prefix===U)return Te.namespace!==re}return!0}function zt(y,b,N){y.push(" ",b,'="',N.replace(/[<>&"\t\n\r]/g,Se),'"')}function Ht(y,b,N,U){U||(U=[]);var re=y.nodeType===j?y:y.ownerDocument,le=re.type==="html";if(N)if(y=N(y),y){if(typeof y=="string"){b.push(y);return}}else return;switch(y.nodeType){case O:var Te=y.attributes,Xe=Te.length,rt=y.firstChild,tt=y.tagName,xt=tt;if(!le&&!y.prefix&&y.namespaceURI){for(var lt,Je=0;Je<Te.length;Je++)if(Te.item(Je).name==="xmlns"){lt=Te.item(Je).value;break}if(!lt)for(var bn=U.length-1;bn>=0;bn--){var Rt=U[bn];if(Rt.prefix===""&&Rt.namespace===y.namespaceURI){lt=Rt.namespace;break}}if(lt!==y.namespaceURI)for(var bn=U.length-1;bn>=0;bn--){var Rt=U[bn];if(Rt.namespace===y.namespaceURI){Rt.prefix&&(xt=Rt.prefix+":"+tt);break}}}b.push("<",xt);for(var Fn=0;Fn<Xe;Fn++){var nn=Te.item(Fn);nn.prefix=="xmlns"?U.push({prefix:nn.localName,namespace:nn.value}):nn.nodeName=="xmlns"&&U.push({prefix:"",namespace:nn.value})}for(var Fn=0;Fn<Xe;Fn++){var nn=Te.item(Fn);if(Ye(nn,le,U)){var Bn=nn.prefix||"",nt=nn.namespaceURI;zt(b,Bn?"xmlns:"+Bn:"xmlns",nt),U.push({prefix:Bn,namespace:nt})}Ht(nn,b,N,U)}if(tt===xt&&Ye(y,le,U)){var Bn=y.prefix||"",nt=y.namespaceURI;zt(b,Bn?"xmlns:"+Bn:"xmlns",nt),U.push({prefix:Bn,namespace:nt})}var yi=!rt;if(yi&&(le||y.namespaceURI===l.HTML)&&(yi=o(tt)),yi)b.push("/>");else{if(b.push(">"),le&&s(tt))for(;rt;)rt.data?b.push(rt.data):Ht(rt,b,N,U.slice()),rt=rt.nextSibling;else for(;rt;)Ht(rt,b,N,U.slice()),rt=rt.nextSibling;b.push("</",xt,">")}return;case j:case J:for(var rt=y.firstChild;rt;)Ht(rt,b,N,U.slice()),rt=rt.nextSibling;return;case z:return zt(b,y.name,y.value);case w:return b.push(y.data.replace(/[<&>]/g,Se));case q:return b.push(h.CDATA_START,y.data,h.CDATA_END);case L:return b.push(h.COMMENT_START,y.data,h.COMMENT_END);case K:var ts=y.publicId,Zn=y.systemId;b.push(h.DOCTYPE_DECL_START," ",y.name),ts?(b.push(" ",h.PUBLIC," ",ts),Zn&&Zn!=="."&&b.push(" ",Zn)):Zn&&Zn!=="."&&b.push(" ",h.SYSTEM," ",Zn),y.internalSubset&&b.push(" [",y.internalSubset,"]"),b.push(">");return;case A:return b.push("<?",y.target," ",y.data,"?>");case S:return b.push("&",y.nodeName,";");default:b.push("??",y.nodeName)}}function $n(y,b,N){var U;switch(b.nodeType){case O:U=b.cloneNode(!1),U.ownerDocument=y;case J:break;case z:N=!0;break}if(U||(U=b.cloneNode(!1)),U.ownerDocument=y,U.parentNode=null,N)for(var re=b.firstChild;re;)U.appendChild($n(y,re,N)),re=re.nextSibling;return U}function qr(y,b,N){var U=new b.constructor(u);for(var re in b)if(r(b,re)){var le=b[re];typeof le!="object"&&le!=U[re]&&(U[re]=le)}switch(b.childNodes&&(U.childNodes=new ee),U.ownerDocument=y,U.nodeType){case O:var Te=b.attributes,Xe=U.attributes=new ue,tt=Te.length;Xe._ownerElement=U;for(var xt=0;xt<tt;xt++)U.setAttributeNode(qr(y,Te.item(xt),!0));break;case z:N=!0}if(N)for(var lt=b.firstChild;lt;)U.appendChild(qr(y,lt,N)),lt=lt.nextSibling;return U}function Sn(y,b,N){y[b]=N}try{if(Object.defineProperty){let y=function(b){switch(b.nodeType){case O:case J:var N=[];for(b=b.firstChild;b;)b.nodeType!==7&&b.nodeType!==8&&N.push(y(b)),b=b.nextSibling;return N.join("");default:return b.nodeValue}};Object.defineProperty(Y.prototype,"length",{get:function(){return oe(this),this.$$length}}),Object.defineProperty(ae.prototype,"textContent",{get:function(){return y(this)},set:function(b){switch(this.nodeType){case O:case J:for(;this.firstChild;)this.removeChild(this.firstChild);(b||String(b))&&this.appendChild(this.ownerDocument.createTextNode(b));break;default:this.data=b,this.value=b,this.nodeValue=b}}}),Sn=function(b,N,U){b["$$"+N]=U}}}catch{}return Qe._updateLiveList=oe,Qe.Attr=at,Qe.CDATASection=Ln,Qe.CharacterData=gt,Qe.Comment=pn,Qe.Document=De,Qe.DocumentFragment=_n,Qe.DocumentType=gn,Qe.DOMImplementation=_e,Qe.Element=Fe,Qe.Entity=wt,Qe.EntityReference=yn,Qe.LiveNodeList=Y,Qe.NamedNodeMap=ue,Qe.Node=ae,Qe.NodeList=ee,Qe.Notation=mn,Qe.Text=hn,Qe.ProcessingInstruction=tn,Qe.XMLSerializer=Qn,Qe}var Ei={},Bu={},Uh;function uC(){return Uh||(Uh=1,function(n){var e=Us().freeze;n.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),n.HTML_ENTITIES=e({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),n.entityMap=n.HTML_ENTITIES}(Bu)),Bu}var io={},Wh;function cC(){if(Wh)return io;Wh=1;var n=Us(),e=Wy(),t=Yl(),r=n.isHTMLEscapableRawTextElement,i=n.isHTMLMimeType,s=n.isHTMLRawTextElement,o=n.hasOwn,a=n.NAMESPACE,l=t.ParseError,u=t.DOMException,c=0,f=1,d=2,h=3,p=4,m=5,_=6,C=7;function v(){}v.prototype={parse:function(A,L,j){var K=this.domBuilder;K.startDocument(),O(L,L=Object.create(null)),M(A,L,j,K,this.errorHandler),K.endDocument()}};var x=/&#?\w+;?/g;function M(A,L,j,K,J){var W=i(K.mimeType);A.indexOf(e.UNICODE_REPLACEMENT_CHARACTER)>=0&&J.warning("Unicode replacement character detected, source encoding issues?");function Q(me){if(me>65535){me-=65536;var Fe=55296+(me>>10),at=56320+(me&1023);return String.fromCharCode(Fe,at)}else return String.fromCharCode(me)}function ie(me){var Fe=me[me.length-1]===";"?me:me+";";if(!W&&Fe!==me)return J.error("EntityRef: expecting ;"),me;var at=e.Reference.exec(Fe);if(!at||at[0].length!==Fe.length)return J.error("entity not matching Reference production: "+me),me;var gt=Fe.slice(1,-1);return o(j,gt)?j[gt]:gt.charAt(0)==="#"?Q(parseInt(gt.substring(1).replace("x","0x"))):(J.error("entity not found:"+me),me)}function te(me){if(me>_e){var Fe=A.substring(_e,me).replace(x,ie);ue&&de(_e),K.characters(Fe,0,me-_e),_e=me}}var ee=0,Y=0,oe=/\r\n?|\n|$/g,ue=K.locator;function de(me,Fe){for(;me>=Y&&(Fe=oe.exec(A));)ee=Y,Y=Fe.index+Fe[0].length,ue.lineNumber++;ue.columnNumber=me-ee+1}for(var pe=[{currentNSMap:L}],ge=[],_e=0;;){try{var ae=A.indexOf("<",_e);if(ae<0){if(!W&&ge.length>0)return J.fatalError("unclosed xml tag(s): "+ge.join(", "));if(!A.substring(_e).match(/^\s*$/)){var Se=K.doc,Ie=Se.createTextNode(A.substring(_e));if(Se.documentElement)return J.error("Extra content at the end of the document");Se.appendChild(Ie),K.currentElement=Ie}return}if(ae>_e){var De=A.substring(_e,ae);!W&&ge.length===0&&(De=De.replace(new RegExp(e.S_OPT.source,"g"),""),De&&J.error("Unexpected content outside root element: '"+De+"'")),te(ae)}switch(A.charAt(ae+1)){case"/":var ze=A.indexOf(">",ae+2),Qt=A.substring(ae+2,ze>0?ze:void 0);if(!Qt)return J.fatalError("end tag name missing");var Wt=ze>0&&e.reg("^",e.QName_group,e.S_OPT,"$").exec(Qt);if(!Wt)return J.fatalError('end tag name contains invalid characters: "'+Qt+'"');if(!K.currentElement&&!K.doc.documentElement)return;var It=ge[ge.length-1]||K.currentElement.tagName||K.doc.documentElement.tagName||"";if(It!==Wt[1]){var un=Wt[1].toLowerCase();if(!W||It.toLowerCase()!==un)return J.fatalError('Opening and ending tag mismatch: "'+It+'" != "'+Qt+'"')}var Zt=pe.pop();ge.pop();var cn=Zt.localNSMap;if(K.endElement(Zt.uri,Zt.localName,It),cn)for(var pt in cn)o(cn,pt)&&K.endPrefixMapping(pt);ze++;break;case"?":ue&&de(ae),ze=S(A,ae,K,J);break;case"!":ue&&de(ae),ze=q(A,ae,K,J,W);break;default:ue&&de(ae);var Re=new H,ot=pe[pe.length-1].currentNSMap,ze=k(A,ae,Re,ot,ie,J,W),Pn=Re.length;if(Re.closed||(W&&n.isHTMLVoidElement(Re.tagName)?Re.closed=!0:ge.push(Re.tagName)),ue&&Pn){for(var dn=$(ue,{}),en=0;en<Pn;en++){var fn=Re[en];de(fn.offset),fn.locator=$(ue,{})}K.locator=dn,P(Re,K,ot)&&pe.push(Re),K.locator=ue}else P(Re,K,ot)&&pe.push(Re);W&&!Re.closed?ze=D(A,ze,Re.tagName,ie,K):ze++}}catch(me){if(me instanceof l)throw me;if(me instanceof u)throw new l(me.name+": "+me.message,K.locator,me);J.error("element parse error: "+me),ze=-1}ze>_e?_e=ze:te(Math.max(ae,_e)+1)}}function $(A,L){return L.lineNumber=A.lineNumber,L.columnNumber=A.columnNumber,L}function k(A,L,j,K,J,W,Q){function ie(de,pe,ge){if(o(j.attributeNames,de))return W.fatalError("Attribute "+de+" redefined");if(!Q&&pe.indexOf("<")>=0)return W.fatalError("Unescaped '<' not allowed in attributes values");j.addValue(de,pe.replace(/[\t\n\r]/g," ").replace(x,J),ge)}for(var te,ee,Y=++L,oe=c;;){var ue=A.charAt(Y);switch(ue){case"=":if(oe===f)te=A.slice(L,Y),oe=h;else if(oe===d)oe=h;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(oe===h||oe===f)if(oe===f&&(W.warning('attribute value must after "="'),te=A.slice(L,Y)),L=Y+1,Y=A.indexOf(ue,L),Y>0)ee=A.slice(L,Y),ie(te,ee,L-1),oe=m;else throw new Error("attribute value no end '"+ue+"' match");else if(oe==p)ee=A.slice(L,Y),ie(te,ee,L),W.warning('attribute "'+te+'" missed start quot('+ue+")!!"),L=Y+1,oe=m;else throw new Error('attribute value must after "="');break;case"/":switch(oe){case c:j.setTagName(A.slice(L,Y));case m:case _:case C:oe=C,j.closed=!0;case p:case f:break;case d:j.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return W.error("unexpected end of input"),oe==c&&j.setTagName(A.slice(L,Y)),Y;case">":switch(oe){case c:j.setTagName(A.slice(L,Y));case m:case _:case C:break;case p:case f:ee=A.slice(L,Y),ee.slice(-1)==="/"&&(j.closed=!0,ee=ee.slice(0,-1));case d:oe===d&&(ee=te),oe==p?(W.warning('attribute "'+ee+'" missed quot(")!'),ie(te,ee,L)):(Q||W.warning('attribute "'+ee+'" missed value!! "'+ee+'" instead!!'),ie(ee,ee,L));break;case h:if(!Q)return W.fatalError(`AttValue: ' or " expected`)}return Y;case"":ue=" ";default:if(ue<=" ")switch(oe){case c:j.setTagName(A.slice(L,Y)),oe=_;break;case f:te=A.slice(L,Y),oe=d;break;case p:var ee=A.slice(L,Y);W.warning('attribute "'+ee+'" missed quot(")!!'),ie(te,ee,L);case m:oe=_;break}else switch(oe){case d:Q||W.warning('attribute "'+te+'" missed value!! "'+te+'" instead2!!'),ie(te,te,L),L=Y,oe=f;break;case m:W.warning('attribute space is required"'+te+'"!!');case _:oe=f,L=Y;break;case h:oe=p,L=Y;break;case C:throw new Error("elements closed character '/' and '>' must be connected to")}}Y++}}function P(A,L,j){for(var K=A.tagName,J=null,oe=A.length;oe--;){var W=A[oe],Q=W.qName,ie=W.value,ue=Q.indexOf(":");if(ue>0)var te=W.prefix=Q.slice(0,ue),ee=Q.slice(ue+1),Y=te==="xmlns"&&ee;else ee=Q,te=null,Y=Q==="xmlns"&&"";W.localName=ee,Y!==!1&&(J==null&&(J=Object.create(null),O(j,j=Object.create(null))),j[Y]=J[Y]=ie,W.uri=a.XMLNS,L.startPrefixMapping(Y,ie))}for(var oe=A.length;oe--;)W=A[oe],W.prefix&&(W.prefix==="xml"&&(W.uri=a.XML),W.prefix!=="xmlns"&&(W.uri=j[W.prefix]));var ue=K.indexOf(":");ue>0?(te=A.prefix=K.slice(0,ue),ee=A.localName=K.slice(ue+1)):(te=null,ee=A.localName=K);var de=A.uri=j[te||""];if(L.startElement(de,ee,K,A),A.closed){if(L.endElement(de,ee,K),J)for(te in J)o(J,te)&&L.endPrefixMapping(te)}else return A.currentNSMap=j,A.localNSMap=J,!0}function D(A,L,j,K,J){var W=r(j);if(W||s(j)){var Q=A.indexOf("</"+j+">",L),ie=A.substring(L+1,Q);return W&&(ie=ie.replace(x,K)),J.characters(ie,0,ie.length),Q}return L+1}function O(A,L){for(var j in A)o(A,j)&&(L[j]=A[j])}function z(A,L){var j=L;function K(Y){return Y=Y||0,A.charAt(j+Y)}function J(Y){Y=Y||1,j+=Y}function W(){for(var Y=0;j<A.length;){var oe=K();if(oe!==" "&&oe!==`
`&&oe!=="	"&&oe!=="\r")return Y;Y++,J()}return-1}function Q(){return A.substring(j)}function ie(Y){return A.substring(j,j+Y.length)===Y}function te(Y){return A.substring(j,j+Y.length).toUpperCase()===Y.toUpperCase()}function ee(Y){var oe=e.reg("^",Y),ue=oe.exec(Q());return ue?(J(ue[0].length),ue[0]):null}return{char:K,getIndex:function(){return j},getMatch:ee,getSource:function(){return A},skip:J,skipBlanks:W,substringFromIndex:Q,substringStartsWith:ie,substringStartsWithCaseInsensitive:te}}function w(A,L){function j(ie,te){var ee=e.PI.exec(ie.substringFromIndex());return ee?ee[1].toLowerCase()==="xml"?te.fatalError("xml declaration is only allowed at the start of the document, but found at position "+ie.getIndex()):(ie.skip(ee[0].length),ee[0]):te.fatalError("processing instruction is not well-formed at position "+ie.getIndex())}var K=A.getSource();if(A.char()==="["){A.skip(1);for(var J=A.getIndex();A.getIndex()<K.length;){if(A.skipBlanks(),A.char()==="]"){var W=K.substring(J,A.getIndex());return A.skip(1),W}var Q=null;if(A.char()==="<"&&A.char(1)==="!")switch(A.char(2)){case"E":A.char(3)==="L"?Q=A.getMatch(e.elementdecl):A.char(3)==="N"&&(Q=A.getMatch(e.EntityDecl));break;case"A":Q=A.getMatch(e.AttlistDecl);break;case"N":Q=A.getMatch(e.NotationDecl);break;case"-":Q=A.getMatch(e.Comment);break}else if(A.char()==="<"&&A.char(1)==="?")Q=j(A,L);else if(A.char()==="%")Q=A.getMatch(e.PEReference);else return L.fatalError("Error detected in Markup declaration");if(!Q)return L.fatalError("Error in internal subset at position "+A.getIndex())}return L.fatalError("doctype internal subset is not well-formed, missing ]")}}function q(A,L,j,K,J){var W=z(A,L);switch(J?W.char(2).toUpperCase():W.char(2)){case"-":var Q=W.getMatch(e.Comment);return Q?(j.comment(Q,e.COMMENT_START.length,Q.length-e.COMMENT_START.length-e.COMMENT_END.length),W.getIndex()):K.fatalError("comment is not well-formed at position "+W.getIndex());case"[":var ie=W.getMatch(e.CDSect);return ie?!J&&!j.currentElement?K.fatalError("CDATA outside of element"):(j.startCDATA(),j.characters(ie,e.CDATA_START.length,ie.length-e.CDATA_START.length-e.CDATA_END.length),j.endCDATA(),W.getIndex()):K.fatalError("Invalid CDATA starting at position "+L);case"D":{if(j.doc&&j.doc.documentElement)return K.fatalError("Doctype not allowed inside or after documentElement at position "+W.getIndex());if(J?!W.substringStartsWithCaseInsensitive(e.DOCTYPE_DECL_START):!W.substringStartsWith(e.DOCTYPE_DECL_START))return K.fatalError("Expected "+e.DOCTYPE_DECL_START+" at position "+W.getIndex());if(W.skip(e.DOCTYPE_DECL_START.length),W.skipBlanks()<1)return K.fatalError("Expected whitespace after "+e.DOCTYPE_DECL_START+" at position "+W.getIndex());var te={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(te.name=W.getMatch(e.Name),!te.name)return K.fatalError("doctype name missing or contains unexpected characters at position "+W.getIndex());if(J&&te.name.toLowerCase()!=="html"&&K.warning("Unexpected DOCTYPE in HTML document at position "+W.getIndex()),W.skipBlanks(),W.substringStartsWith(e.PUBLIC)||W.substringStartsWith(e.SYSTEM)){var ee=e.ExternalID_match.exec(W.substringFromIndex());if(!ee)return K.fatalError("doctype external id is not well-formed at position "+W.getIndex());ee.groups.SystemLiteralOnly!==void 0?te.systemId=ee.groups.SystemLiteralOnly:(te.systemId=ee.groups.SystemLiteral,te.publicId=ee.groups.PubidLiteral),W.skip(ee[0].length)}else if(J&&W.substringStartsWithCaseInsensitive(e.SYSTEM)){if(W.skip(e.SYSTEM.length),W.skipBlanks()<1)return K.fatalError("Expected whitespace after "+e.SYSTEM+" at position "+W.getIndex());if(te.systemId=W.getMatch(e.ABOUT_LEGACY_COMPAT_SystemLiteral),!te.systemId)return K.fatalError("Expected "+e.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+e.SYSTEM+" at position "+W.getIndex())}return J&&te.systemId&&!e.ABOUT_LEGACY_COMPAT_SystemLiteral.test(te.systemId)&&K.warning("Unexpected doctype.systemId in HTML document at position "+W.getIndex()),J||(W.skipBlanks(),te.internalSubset=w(W,K)),W.skipBlanks(),W.char()!==">"?K.fatalError("doctype not terminated with > at position "+W.getIndex()):(W.skip(1),j.startDTD(te.name,te.publicId,te.systemId,te.internalSubset),j.endDTD(),W.getIndex())}default:return K.fatalError('Not well-formed XML starting with "<!" at position '+L)}}function S(A,L,j,K){var J=A.substring(L).match(e.PI);if(!J)return K.fatalError("Invalid processing instruction starting at position "+L);if(J[1].toLowerCase()==="xml"){if(L>0)return K.fatalError("processing instruction at position "+L+" is an xml declaration which is only at the start of the document");if(!e.XMLDecl.test(A.substring(L)))return K.fatalError("xml declaration is not well-formed")}return j.processingInstruction(J[1],J[2]),L+J[0].length}function H(){this.attributeNames=Object.create(null)}return H.prototype={setTagName:function(A){if(!e.QName_exact.test(A))throw new Error("invalid tagName:"+A);this.tagName=A},addValue:function(A,L,j){if(!e.QName_exact.test(A))throw new Error("invalid attribute:"+A);this.attributeNames[A]=this.length,this[this.length++]={qName:A,value:L,offset:j}},length:0,getLocalName:function(A){return this[A].localName},getLocator:function(A){return this[A].locator},getQName:function(A){return this[A].qName},getURI:function(A){return this[A].uri},getValue:function(A){return this[A].value}},io.XMLReader=v,io.parseUtils=z,io.parseDoctypeCommentOrCData=q,io}var zh;function dC(){if(zh)return Ei;zh=1;var n=Us(),e=zy(),t=Yl(),r=uC(),i=cC(),s=e.DOMImplementation,o=n.hasDefaultHTMLNamespace,a=n.isHTMLMimeType,l=n.isValidMimeType,u=n.MIME_TYPE,c=n.NAMESPACE,f=t.ParseError,d=i.XMLReader;function h(k){return k.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028\u2029]/g,`
`)}function p(k){if(k=k||{},k.locator===void 0&&(k.locator=!0),this.assign=k.assign||n.assign,this.domHandler=k.domHandler||m,this.onError=k.onError||k.errorHandler,k.errorHandler&&typeof k.errorHandler!="function")throw new TypeError("errorHandler object is no longer supported, switch to onError!");k.errorHandler&&k.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=k.normalizeLineEndings||h,this.locator=!!k.locator,this.xmlns=this.assign(Object.create(null),k.xmlns)}p.prototype.parseFromString=function(k,P){if(!l(P))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+P+'" is not valid.');var D=this.assign(Object.create(null),this.xmlns),O=r.XML_ENTITIES,z=D[""]||null;o(P)?(O=r.HTML_ENTITIES,z=c.HTML):P===u.XML_SVG_IMAGE&&(z=c.SVG),D[""]=z,D.xml=D.xml||c.XML;var w=new this.domHandler({mimeType:P,defaultNamespace:z,onError:this.onError}),q=this.locator?{}:void 0;this.locator&&w.setDocumentLocator(q);var S=new d;S.errorHandler=w,S.domBuilder=w;var H=!n.isHTMLMimeType(P);return H&&typeof k!="string"&&S.errorHandler.fatalError("source is not a string"),S.parse(this.normalizeLineEndings(String(k)),D,O),w.doc.documentElement||S.errorHandler.fatalError("missing root element"),w.doc};function m(k){var P=k||{};this.mimeType=P.mimeType||u.XML_APPLICATION,this.defaultNamespace=P.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=P.onError}function _(k,P){P.lineNumber=k.lineNumber,P.columnNumber=k.columnNumber}m.prototype={startDocument:function(){var k=new s;this.doc=a(this.mimeType)?k.createHTMLDocument(!1):k.createDocument(this.defaultNamespace,"")},startElement:function(k,P,D,O){var z=this.doc,w=z.createElementNS(k,D||P),q=O.length;x(this,w),this.currentElement=w,this.locator&&_(this.locator,w);for(var S=0;S<q;S++){var k=O.getURI(S),H=O.getValue(S),D=O.getQName(S),A=z.createAttributeNS(k,D);this.locator&&_(O.getLocator(S),A),A.value=A.nodeValue=H,w.setAttributeNode(A)}},endElement:function(k,P,D){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(k,P){},endPrefixMapping:function(k){},processingInstruction:function(k,P){var D=this.doc.createProcessingInstruction(k,P);this.locator&&_(this.locator,D),x(this,D)},ignorableWhitespace:function(k,P,D){},characters:function(k,P,D){if(k=v.apply(this,arguments),k){if(this.cdata)var O=this.doc.createCDATASection(k);else var O=this.doc.createTextNode(k);this.currentElement?this.currentElement.appendChild(O):/^\s*$/.test(k)&&this.doc.appendChild(O),this.locator&&_(this.locator,O)}},skippedEntity:function(k){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(k){k&&(k.lineNumber=0),this.locator=k},comment:function(k,P,D){k=v.apply(this,arguments);var O=this.doc.createComment(k);this.locator&&_(this.locator,O),x(this,O)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(k,P,D,O){var z=this.doc.implementation;if(z&&z.createDocumentType){var w=z.createDocumentType(k,P,D,O);this.locator&&_(this.locator,w),x(this,w),this.doc.doctype=w}},reportError:function(k,P){if(typeof this.onError=="function")try{this.onError(k,P,this)}catch(D){throw new f("Reporting "+k+' "'+P+'" caused '+D,this.locator)}else console.error("[xmldom "+k+"]	"+P,C(this.locator))},warning:function(k){this.reportError("warning",k)},error:function(k){this.reportError("error",k)},fatalError:function(k){throw this.reportError("fatalError",k),new f(k,this.locator)}};function C(k){if(k)return`
@#[line:`+k.lineNumber+",col:"+k.columnNumber+"]"}function v(k,P,D){return typeof k=="string"?k.substr(P,D):k.length>=P+D||P?new java.lang.String(k,P,D)+"":k}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(k){m.prototype[k]=function(){return null}});function x(k,P){k.currentElement?k.currentElement.appendChild(P):k.doc.appendChild(P)}function M(k){if(k==="error")throw"onErrorStopParsing"}function $(){throw"onWarningStopParsing"}return Ei.__DOMHandler=m,Ei.DOMParser=p,Ei.normalizeLineEndings=h,Ei.onErrorStopParsing=M,Ei.onWarningStopParsing=$,Ei}var Hh;function fC(){if(Hh)return Ae;Hh=1;var n=Us();Ae.assign=n.assign,Ae.hasDefaultHTMLNamespace=n.hasDefaultHTMLNamespace,Ae.isHTMLMimeType=n.isHTMLMimeType,Ae.isValidMimeType=n.isValidMimeType,Ae.MIME_TYPE=n.MIME_TYPE,Ae.NAMESPACE=n.NAMESPACE;var e=Yl();Ae.DOMException=e.DOMException,Ae.DOMExceptionName=e.DOMExceptionName,Ae.ExceptionCode=e.ExceptionCode,Ae.ParseError=e.ParseError;var t=zy();Ae.Attr=t.Attr,Ae.CDATASection=t.CDATASection,Ae.CharacterData=t.CharacterData,Ae.Comment=t.Comment,Ae.Document=t.Document,Ae.DocumentFragment=t.DocumentFragment,Ae.DocumentType=t.DocumentType,Ae.DOMImplementation=t.DOMImplementation,Ae.Element=t.Element,Ae.Entity=t.Entity,Ae.EntityReference=t.EntityReference,Ae.LiveNodeList=t.LiveNodeList,Ae.NamedNodeMap=t.NamedNodeMap,Ae.Node=t.Node,Ae.NodeList=t.NodeList,Ae.Notation=t.Notation,Ae.ProcessingInstruction=t.ProcessingInstruction,Ae.Text=t.Text,Ae.XMLSerializer=t.XMLSerializer;var r=dC();return Ae.DOMParser=r.DOMParser,Ae.normalizeLineEndings=r.normalizeLineEndings,Ae.onErrorStopParsing=r.onErrorStopParsing,Ae.onWarningStopParsing=r.onWarningStopParsing,Ae}var hC=fC();const Fi="USJ",Bi="3.1",pC=["type","marker","content","sid","eid","number","code","altnumber","pubnumber","caller","align","category"];function gC(n){return mC.includes(n)}const mC=["GEN","EXO","LEV","NUM","DEU","JOS","JDG","RUT","1SA","2SA","1KI","2KI","1CH","2CH","EZR","NEH","EST","JOB","PSA","PRO","ECC","SNG","ISA","JER","LAM","EZK","DAN","HOS","JOL","AMO","OBA","JON","MIC","NAM","HAB","ZEP","HAG","ZEC","MAL","MAT","MRK","LUK","JHN","ACT","ROM","1CO","2CO","GAL","EPH","PHP","COL","1TH","2TH","1TI","2TI","TIT","PHM","HEB","JAS","1PE","2PE","1JN","2JN","3JN","JUD","REV","TOB","JDT","ESG","WIS","SIR","BAR","LJE","S3Y","SUS","BEL","1MA","2MA","3MA","4MA","1ES","2ES","MAN","PS2","ODA","PSS","EZA","5EZ","6EZ","DAG","PS3","2BA","LBA","JUB","ENO","1MQ","2MQ","3MQ","REP","4BA","LAO","FRT","BAK","OTH","INT","CNC","GLO","TDX","NDX","XXA","XXB","XXC","XXD","XXE","XXF","XXG"],yC="usx";function Yd(n){const e=new hC.DOMParser().parseFromString(n,"text/xml");return _C(e.documentElement)}function _C(n){const[e]=n?Hy(n):[{content:[]}];return e.type=Fi,e.version=Bi,e}function Hy(n){const e={};let t=n.tagName,r,i,s="append";if(["row","cell"].includes(t)&&(t="table:"+t),n.attributes)for(const l of Array.from(n.attributes))e[l.name]=l.value;e.style&&(r=e.style,delete e.style),e.vid&&delete e.vid,e.status&&delete e.status;let o={type:t};r&&(o.marker=r),o={...o,...e},n.firstChild&&n.firstChild.nodeType===n.firstChild.TEXT_NODE&&n.firstChild.nodeValue&&Kh(n.firstChild.nodeValue)!==""&&(i=n.firstChild.nodeValue);const a=Array.from(n.childNodes);o.content=[],i&&o.content.push(i);for(const l of a){if(l.tagName===void 0)continue;const[u,c]=Hy(l);switch(c){case"append":o.content.push(u);break;case"merge":o.content=o.content.concat(u);break}l.nextSibling&&l.nextSibling.nodeType===l.nextSibling.TEXT_NODE&&l.nextSibling.nodeValue&&(Kh(l.nextSibling.nodeValue)!==""||l.nextSibling.nodeValue===" ")&&o.content.push(l.nextSibling.nodeValue)}return o.content.length===0&&o.type!==yC&&delete o.content,"eid"in o&&["verse","chapter"].includes(t)&&(s="ignore"),[o,s]}function Kh(n){return n.replace(/(^[ \t\n\r\f\v]+)|([ \t\n\r\f\v]+$)/g,"")}const Dc="$",Ky=".content[";function bC(n){const e=n.split(Ky);if(e.shift()!==Dc)throw new Error(`indexesFromJsonPath: jsonPath didn't start with '${Dc}'`);return e.map(t=>parseInt(t,10))}function vC(n){return n.reduce((e,t)=>`${e}${Ky}${t}]`,Dc)}const CC=new Map;function Vh(n){let e=n;for(;e!=null;){if(e.nodeType===Node.TEXT_NODE)return e;e=e.firstChild}return null}function Jh(n){const e=n.parentNode;if(e==null)throw new Error("Should never happen");return[e,Array.from(e.childNodes).indexOf(n)]}function EC(n,e,t,r,i){const s=e.getKey(),o=r.getKey(),a=document.createRange();let l=n.getElementByKey(s),u=n.getElementByKey(o),c=t,f=i;if(Z(e)&&(l=Vh(l)),Z(r)&&(u=Vh(u)),e===void 0||r===void 0||l===null||u===null)return null;l.nodeName==="BR"&&([l,c]=Jh(l)),u.nodeName==="BR"&&([u,f]=Jh(u));const d=l.firstChild;l===u&&d!=null&&d.nodeName==="BR"&&c===0&&f===0&&(f=1);try{a.setStart(l,c),a.setEnd(u,f)}catch{return null}return!a.collapsed||c===f&&s===o||(a.setStart(u,f),a.setEnd(l,c)),a}function wC(n,e){const t=n.getRootElement();if(t===null)return[];const r=t.getBoundingClientRect(),i=getComputedStyle(t),s=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight),o=Array.from(e.getClientRects());let a,l=o.length;o.sort((u,c)=>{const f=u.top-c.top;return Math.abs(f)<=3?u.left-c.left:f});for(let u=0;u<l;u++){const c=o[u],f=a&&a.top<=c.top&&a.top+a.height>c.top&&a.left+a.width>c.left,d=c.width+s===r.width;f||d?(o.splice(u--,1),l--):a=c}return o}function xC(n){const e={};if(!n)return e;const t=n.split(";");for(const r of t)if(r!==""){const[i,s]=r.split(/:([^]+)/);i&&s&&(e[i.trim()]=s.trim())}return e}function Vy(n,e){const t=n.getStartEndPoints();if(e.isSelected(n)&&!wr(e)&&t!==null){const[r,i]=t,s=n.isBackward(),o=r.getNode(),a=i.getNode(),l=e.is(o),u=e.is(a);if(l||u){const[c,f]=yc(n),d=o.is(a),h=e.is(s?a:o),p=e.is(s?o:a);let m,_=0;d?(_=c>f?f:c,m=c>f?c:f):h?(_=s?f:c,m=void 0):p&&(_=0,m=s?c:f),e.__text=e.__text.slice(_,m)}}return e}function kC(n){const e=n.getStyle(),t=xC(e);CC.set(e,t)}function SC(n,e){const t=n.getFormatType(),r=n.getIndent();t!==e.getFormatType()&&e.setFormat(t),r!==e.getIndent()&&e.setIndent(r)}function TC(n,e,t=SC){if(n===null)return;const r=n.getStartEndPoints(),i=new Map;let s=null;if(r){const[o,a]=r;s=jo(),s.anchor.set(o.key,o.offset,o.type),s.focus.set(a.key,a.offset,a.type);const l=qu(o.getNode(),Dn),u=qu(a.getNode(),Dn);V(l)&&i.set(l.getKey(),l),V(u)&&i.set(u.getKey(),u)}for(const o of n.getNodes())if(V(o)&&Dn(o))i.set(o.getKey(),o);else if(r===null){const a=qu(o,Dn);V(a)&&i.set(a.getKey(),a)}for(const[o,a]of i){const l=e();t(a,l),a.replace(l,!0),s&&(o===s.anchor.key&&s.anchor.set(l.getKey(),s.anchor.offset,s.anchor.type),o===s.focus.key&&s.focus.set(l.getKey(),s.focus.offset,s.focus.type))}s&&n.is(ne())&&Ot(s)}function Jy(n){const e=n.anchor.getNode(),t=At(e)?e:e.getParentOrThrow(),r=Vl().getElementByKey(t.getKey());if(r===null)return!1;const i=r.ownerDocument.defaultView;return i===null?!1:i.getComputedStyle(r).writingMode==="vertical-rl"}function bl(n,e){let t=Jy(n)?!e:e;Gy(n)&&(t=!t);const r=Mr(n.focus,t?"previous":"next");if(jy(r))return!1;for(const i of Gd(r)){if(zn(i))return!i.origin.isInline();if(!V(i.origin)){if(Pe(i.origin))return!0;break}}return!1}function AC(n,e,t,r){n.modify(e?"extend":"move",t,r)}function Gy(n){const e=n.anchor.getNode();return(At(e)?e:e.getParentOrThrow()).getDirection()==="rtl"}function vl(n,e,t){const r=Gy(n);let i;i=Jy(n)||r?!t:t,AC(n,e,i,"character")}function qu(n,e){let t=n;for(;t!==null&&t.getParent()!==null&&!e(t);)t=t.getParentOrThrow();return e(t)?t:null}function DC(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const zo=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,NC=zo&&"documentMode"in document?document.documentMode:null,MC=zo&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),OC=zo&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent);!(!zo||!("InputEvent"in window)||NC)&&"getTargetRanges"in new window.InputEvent("input");function Yy(...n){const e=[];for(const t of n)if(t&&typeof t=="string")for(const[r]of t.matchAll(/\S+/g))e.push(r);return e}function vt(...n){return()=>{for(let e=n.length-1;e>=0;e--)n[e]();n.length=0}}const IC=zo,Nc=MC,RC=OC;function $t(n,...e){const t=Yy(...e);t.length>0&&n.classList.add(...t)}function Ni(n,...e){const t=Yy(...e);t.length>0&&n.classList.remove(...t)}function Xd(n,e){return Array.from(PC(n))}function PC(n,e){return LC("next",n)}function LC(n,e,t){const r=Ne(),i=e||r,s=V(i)?Jn(i,n):ft(i,n),o=$C(i),a=function(u,c){const f=Yh(ft(u,c));return f&&f[0]}(i,n);let l=o;return Jl({hasNext:u=>u!==null,initial:s,map:u=>({depth:l,node:u.origin}),step:u=>{if(u.isSameNodeCaret(a))return null;zn(u)&&l++;const c=Yh(u);return!c||c[0].isSameNodeCaret(a)?null:(l+=c[1],c[0])}})}function $C(n){let e=-1;for(let t=n;t!==null;t=t.getParent())e++;return e}function FC(n){const e=Gn(n,t=>V(t)&&!t.isInline());return V(e)||DC(4,n.__key),e}const Gn=(n,e)=>{let t=n;for(;t!==Ne()&&t!=null;){if(e(t))return t;t=t.getParent()}return null};function Xy(n,e,t,r){const i=s=>s instanceof e;return n.registerNodeTransform(e,s=>{const o=(a=>{const l=a.getChildren();for(let f=0;f<l.length;f++){const d=l[f];if(i(d))return null}let u=a,c=a;for(;u!==null;)if(c=u,u=u.getParent(),i(u))return{child:c,parent:u};return null})(s);if(o!==null){const{child:a,parent:l}=o;if(a.is(s)){r(l,s);const u=a.getNextSiblings(),c=u.length;if(l.insertAfter(a),c!==0){const f=t(l);a.insertAfter(f);for(let d=0;d<c;d++)f.append(u[d])}l.canBeEmpty()||l.getChildrenSize()!==0||l.remove()}}})}function Ar(n,e){return n!==null&&Object.getPrototypeOf(n).constructor.name===e.name}let ju=!(RC||!IC)&&void 0;function BC(n){let e=1;if(function(){if(ju===void 0){const t=document.createElement("div");t.style.cssText="position: absolute; opacity: 0; width: 100px; left: -1000px;",document.body.appendChild(t);const r=t.getBoundingClientRect();t.style.setProperty("zoom","2"),ju=t.getBoundingClientRect().width===r.width,document.body.removeChild(t)}return ju}())for(;n;)e*=Number(window.getComputedStyle(n).getPropertyValue("zoom")),n=n.parentElement;return e}function Qy(n,e){const t=[],r=Array.from(n).reverse();for(let i=r.pop();i!==void 0;i=r.pop())if(e(i))t.push(i);else if(V(i))for(const s of qC(i))r.push(s);return t}function qC(n){return jC(Jn(n,"previous"))}function jC(n){return Jl({hasNext:Li,initial:n.getAdjacentCaret(),map:e=>e.origin.getLatest(),step:e=>e.getAdjacentCaret()})}function Gh(n){Gl(ft(n,"next")).splice(1,n.getChildren())}function Yh(n,e="root"){let t=0,r=n,i=To(r);for(;i===null;){if(t--,i=r.getParentCaret(e),!i)return null;r=i,i=To(r)}return i&&[i,t]}function UC(n,e){const t=e.body?e.body.childNodes:[];let r=[];const i=[];for(let s=0;s<t.length;s++){const o=t[s];if(!t_.has(o.nodeName)){const a=n_(o,n,i,!1);a!==null&&(r=r.concat(a))}}return function(s){for(const o of s)o.getNextSibling()instanceof Rd&&o.insertAfter(Pi());for(const o of s){const a=o.getChildren();for(const l of a)o.insertBefore(l);o.remove()}}(i),r}function Zy(n,e){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const t=document.createElement("div"),r=Ne().getChildren();for(let i=0;i<r.length;i++)e_(n,r[i],t,e);return t.innerHTML}function e_(n,e,t,r=null){let i=r===null||e.isSelected(r);const s=V(e)&&e.excludeFromCopy("html");let o=e;if(r!==null){let h=Hd(e);h=Z(h)&&r!==null?Vy(r,h):h,o=h}const a=V(o)?o.getChildren():[],l=$d(n,o.getType());let u;u=l&&l.exportDOM!==void 0?l.exportDOM(n,o):o.exportDOM(n);const{element:c,after:f}=u;if(!c)return!1;const d=document.createDocumentFragment();for(let h=0;h<a.length;h++){const p=a[h],m=e_(n,p,d,r);!i&&V(e)&&m&&e.extractWithChild(p,r,"html")&&(i=!0)}if(i&&!s){if((je(c)||xc(c))&&c.append(d),t.append(c),f){const h=f.call(o,c);h&&(xc(c)?c.replaceChildren(h):c.replaceWith(h))}}else t.append(d);return i}const t_=new Set(["STYLE","SCRIPT"]);function n_(n,e,t,r,i=new Map,s){let o=[];if(t_.has(n.nodeName))return o;let a=null;const l=function(p,m){const{nodeName:_}=p,C=m._htmlConversions.get(_.toLowerCase());let v=null;if(C!==void 0)for(const x of C){const M=x(p);M!==null&&(v===null||(v.priority||0)<=(M.priority||0))&&(v=M)}return v!==null?v.conversion:null}(n,e),u=l?l(n):null;let c=null;if(u!==null){c=u.after;const p=u.node;if(a=Array.isArray(p)?p[p.length-1]:p,a!==null){for(const[,m]of i)if(a=m(a,s),!a)break;a&&o.push(...Array.isArray(p)?p:[a])}u.forChild!=null&&i.set(n.nodeName,u.forChild)}const f=n.childNodes;let d=[];const h=(a==null||!gr(a))&&(a!=null&&_c(a)||r);for(let p=0;p<f.length;p++)d.push(...n_(f[p],e,t,h,new Map(i),a));return c!=null&&(d=c(d)),ml(n)&&(d=WC(n,d,h?()=>{const p=new Rd;return t.push(p),p}:kn)),a==null?d.length>0?o=o.concat(d):ml(n)&&function(p){return p.nextSibling==null||p.previousSibling==null?!1:kc(p.nextSibling)&&kc(p.previousSibling)}(n)&&(o=o.concat(Pi())):V(a)&&a.append(...d),o}function WC(n,e,t){const r=n.style.textAlign,i=[];let s=[];for(let o=0;o<e.length;o++){const a=e[o];if(_c(a))r&&!a.getFormat()&&a.setFormat(r),i.push(a);else if(s.push(a),o===e.length-1||o<e.length-1&&_c(e[o+1])){const l=t();l.setFormat(r),l.append(...s),i.push(l),s=[]}}return i}const zC=new Set(["http:","https:","mailto:","sms:","tel:"]);let r_=class i_ extends Ut{static getType(){return"link"}static clone(e){return new i_(e.__url,{rel:e.__rel,target:e.__target,title:e.__title},e.__key)}constructor(e="",t={},r){super(r);const{target:i=null,rel:s=null,title:o=null}=t;this.__url=e,this.__target=i,this.__rel=s,this.__title=o}createDOM(e){const t=document.createElement("a");return this.updateLinkDOM(null,t,e),$t(t,e.theme.link),t}updateLinkDOM(e,t,r){if(Ly(t)){e&&e.__url===this.__url||(t.href=this.sanitizeUrl(this.__url));for(const i of["target","rel","title"]){const s=`__${i}`,o=this[s];e&&e[s]===o||(o?t[i]=o:t.removeAttribute(i))}}}updateDOM(e,t,r){return this.updateLinkDOM(e,t,r),!1}static importDOM(){return{a:e=>({conversion:HC,priority:1})}}static importJSON(e){return Mc().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setURL(e.url).setRel(e.rel||null).setTarget(e.target||null).setTitle(e.title||null)}sanitizeUrl(e){e=Xh(e);try{const t=new URL(Xh(e));if(!zC.has(t.protocol))return"about:blank"}catch{return e}return e}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(e){const t=this.getWritable();return t.__url=e,t}getTarget(){return this.getLatest().__target}setTarget(e){const t=this.getWritable();return t.__target=e,t}getRel(){return this.getLatest().__rel}setRel(e){const t=this.getWritable();return t.__rel=e,t}getTitle(){return this.getLatest().__title}setTitle(e){const t=this.getWritable();return t.__title=e,t}insertNewAfter(e,t=!0){const r=Mc(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(r,t),r}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(e,t,r){if(!G(t))return!1;const i=t.anchor.getNode(),s=t.focus.getNode();return this.isParentOf(i)&&this.isParentOf(s)&&t.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}};function HC(n){let e=null;if(Ly(n)){const t=n.textContent;(t!==null&&t!==""||n.children.length>0)&&(e=Mc(n.getAttribute("href")||"",{rel:n.getAttribute("rel"),target:n.getAttribute("target"),title:n.getAttribute("title")}))}return{node:e}}function Mc(n="",e){return We(new r_(n,e))}function KC(n){return n instanceof r_}const VC=/^\+?[0-9\s()-]{5,}$/;function Xh(n){return n.match(/^[a-z][a-z0-9+.-]*:/i)||n.match(/^[/#.]/)?n:n.includes("@")?`mailto:${n}`:VC.test(n)?`tel:${n}`:`https://${n}`}const s_=[];let o_=class a_ extends Ut{static getType(){return"mark"}static clone(e){return new a_(e.__ids,e.__key)}static importDOM(){return null}static importJSON(e){return Qh().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setIDs(e.ids)}exportJSON(){return{...super.exportJSON(),ids:this.getIDs()}}constructor(e=s_,t){super(t),this.__ids=e}createDOM(e){const t=document.createElement("mark");return $t(t,e.theme.mark),this.__ids.length>1&&$t(t,e.theme.markOverlap),t}updateDOM(e,t,r){const i=e.__ids,s=this.__ids,o=i.length,a=s.length,l=r.theme.markOverlap;return o!==a&&(o===1?a===2&&$t(t,l):a===1&&Ni(t,l)),!1}hasID(e){return this.getIDs().includes(e)}getIDs(){return Array.from(this.getLatest().__ids)}setIDs(e){const t=this.getWritable();return t.__ids=e,t}addID(e){const t=this.getWritable();return t.__ids.includes(e)?t:t.setIDs([...t.__ids,e])}deleteID(e){const t=this.getWritable(),r=t.__ids.indexOf(e);if(r===-1)return t;const i=Array.from(t.__ids);return i.splice(r,1),t.setIDs(i)}insertNewAfter(e,t=!0){const r=Qh(this.__ids);return this.insertAfter(r,t),r}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(e,t,r){if(!G(t)||r==="html")return!1;const i=t.anchor,s=t.focus,o=i.getNode(),a=s.getNode(),l=t.isBackward()?i.offset-s.offset:s.offset-i.offset;return this.isParentOf(o)&&this.isParentOf(a)&&this.getTextContent().length===l}excludeFromCopy(e){return e!=="clone"}};function Qh(n=s_){return We(new o_(n))}function JC(n){return n instanceof o_}function Cl(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function l_(n,e=ne()){return e==null&&Cl(166),G(e)&&e.isCollapsed()||e.getNodes().length===0?"":Zy(n,e)}function GC(n,e=ne()){return e==null&&Cl(166),G(e)&&e.isCollapsed()||e.getNodes().length===0?null:JSON.stringify(YC(n,e))}function Zh(n,e){const t=n.getData("text/plain")||n.getData("text/uri-list");t!=null&&e.insertRawText(t)}function ep(n,e,t){const r=n.getData("application/x-lexical-editor");if(r)try{const a=JSON.parse(r);if(a.namespace===t._config.namespace&&Array.isArray(a.nodes))return tp(t,XC(a.nodes),e)}catch{}const i=n.getData("text/html"),s=n.getData("text/plain");if(i&&s!==i)try{const a=new DOMParser().parseFromString(function(l){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:u=>u}).createHTML(l):l}(i),"text/html");return tp(t,UC(t,a),e)}catch{}const o=s||n.getData("text/uri-list");if(o!=null)if(G(e)){const a=o.split(/(\r?\n|\t)/);a[a.length-1]===""&&a.pop();for(let l=0;l<a.length;l++){const u=ne();if(G(u)){const c=a[l];c===`
`||c===`\r
`?u.insertParagraph():c==="	"?u.insertNodes([Bo()]):u.insertText(c)}}}else e.insertRawText(o)}function tp(n,e,t){n.dispatchCommand(o2,{nodes:e,selection:t})||(t.insertNodes(e),function(r){if(G(r)&&r.isCollapsed()){const i=r.anchor;let s=null;const o=Mr(i,"previous");if(o)if(Xr(o))s=o.origin;else{const a=ni(o,Jn(Ne(),"next").getFlipped());for(const l of a){if(Z(l.origin)){s=l.origin;break}if(V(l.origin)&&!l.origin.isInline())break}}if(s&&Z(s)){const a=s.getFormat(),l=s.getStyle();r.format===a&&r.style===l||(r.format=a,r.style=l,r.dirty=!0)}}}(t))}function u_(n,e,t,r=[]){let i=e===null||t.isSelected(e);const s=V(t)&&t.excludeFromCopy("html");let o=t;if(e!==null){let u=Hd(t);u=Z(u)&&e!==null?Vy(e,u):u,o=u}const a=V(o)?o.getChildren():[],l=function(u){const c=u.exportJSON(),f=u.constructor;if(c.type!==f.getType()&&Cl(58,f.name),V(u)){const d=c.children;Array.isArray(d)||Cl(59,f.name)}return c}(o);if(Z(o)){const u=o.__text;u.length>0?l.text=u:i=!1}for(let u=0;u<a.length;u++){const c=a[u],f=u_(n,e,c,l.children);!i&&V(t)&&f&&t.extractWithChild(c,e,"clone")&&(i=!0)}if(i&&!s)r.push(l);else if(Array.isArray(l.children))for(let u=0;u<l.children.length;u++){const c=l.children[u];r.push(c)}return i}function YC(n,e){const t=[],r=Ne().getChildren();for(let i=0;i<r.length;i++)u_(n,e,r[i],t);return{namespace:n._config.namespace,nodes:t}}function XC(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t],i=gy(r);Z(i)&&kC(i),e.push(i)}return e}let ls=null;async function np(n,e,t){if(ls!==null)return!1;if(e!==null)return new Promise((u,c)=>{n.update(()=>{u(rp(n,e,t))})});const r=n.getRootElement(),i=n._window||window,s=window.document,o=Vn(i);if(r===null||o===null)return!1;const a=s.createElement("span");a.style.cssText="position: fixed; top: -1000px;",a.append(s.createTextNode("#")),r.append(a);const l=new Range;return l.setStart(a,0),l.setEnd(a,1),o.removeAllRanges(),o.addRange(l),new Promise((u,c)=>{const f=n.registerCommand(Gi,d=>(Ar(d,ClipboardEvent)&&(f(),ls!==null&&(window.clearTimeout(ls),ls=null),u(rp(n,d,t))),!0),_o);ls=window.setTimeout(()=>{f(),ls=null,u(!1)},50),s.execCommand("copy"),a.remove()})}function rp(n,e,t){if(t===void 0){const i=Vn(n._window);if(!i)return!1;const s=i.anchorNode,o=i.focusNode;if(s!==null&&o!==null&&!Uo(n,s,o))return!1;const a=ne();if(a===null)return!1;t=ZC(a)}e.preventDefault();const r=e.clipboardData;return r!==null&&(eE(r,t),!0)}const QC=[["text/html",l_],["application/x-lexical-editor",GC]];function ZC(n=ne()){const e={"text/plain":n?n.getTextContent():""};if(n){const t=Vl();for(const[r,i]of QC){const s=i(t,n);s!==null&&(e[r]=s)}}return e}function eE(n,e){for(const t in e){const r=e[t];r!==void 0&&n.setData(t,r)}}const Qd=/^(\d+(?:\.\d+)?)px$/,gs={BOTH:3,NO_STATUS:0,ROW:1};let Zd=class c_ extends Ut{static getType(){return"tablecell"}static clone(e){return new c_(e.__headerState,e.__colSpan,e.__width,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__rowSpan=e.__rowSpan,this.__backgroundColor=e.__backgroundColor,this.__verticalAlign=e.__verticalAlign}static importDOM(){return{td:e=>({conversion:ip,priority:0}),th:e=>({conversion:ip,priority:0})}}static importJSON(e){return d_().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeaderStyles(e.headerState).setColSpan(e.colSpan||1).setRowSpan(e.rowSpan||1).setWidth(e.width||void 0).setBackgroundColor(e.backgroundColor||null).setVerticalAlign(e.verticalAlign||void 0)}constructor(e=gs.NO_STATUS,t=1,r,i){super(i),this.__colSpan=t,this.__rowSpan=1,this.__headerState=e,this.__width=r,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(e){const t=document.createElement(this.getTag());return this.__width&&(t.style.width=`${this.__width}px`),this.__colSpan>1&&(t.colSpan=this.__colSpan),this.__rowSpan>1&&(t.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(t.style.backgroundColor=this.__backgroundColor),Oc(this.__verticalAlign)&&(t.style.verticalAlign=this.__verticalAlign),$t(t,e.theme.tableCell,this.hasHeader()&&e.theme.tableCellHeader),t}exportDOM(e){const t=super.exportDOM(e);if(je(t.element)){const r=t.element;r.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),r.style.border="1px solid black",this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),r.style.width=`${this.getWidth()||75}px`,r.style.verticalAlign=this.getVerticalAlign()||"top",r.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(r.style.backgroundColor="#f2f3f5")}return t}exportJSON(){return{...super.exportJSON(),...Oc(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(e){const t=this.getWritable();return t.__colSpan=e,t}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(e){const t=this.getWritable();return t.__rowSpan=e,t}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(e,t=gs.BOTH){const r=this.getWritable();return r.__headerState=e&t|r.__headerState&~t,r}getHeaderStyles(){return this.getLatest().__headerState}setWidth(e){const t=this.getWritable();return t.__width=e,t}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(e){const t=this.getWritable();return t.__backgroundColor=e,t}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(e){const t=this.getWritable();return t.__verticalAlign=e||void 0,t}toggleHeaderStyle(e){const t=this.getWritable();return(t.__headerState&e)===e?t.__headerState-=e:t.__headerState+=e,t}hasHeaderState(e){return(this.getHeaderStyles()&e)===e}hasHeader(){return this.getLatest().__headerState!==gs.NO_STATUS}updateDOM(e){return e.__headerState!==this.__headerState||e.__width!==this.__width||e.__colSpan!==this.__colSpan||e.__rowSpan!==this.__rowSpan||e.__backgroundColor!==this.__backgroundColor||e.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}};function Oc(n){return n==="middle"||n==="bottom"}function ip(n){const e=n,t=n.nodeName.toLowerCase();let r;Qd.test(e.style.width)&&(r=parseFloat(e.style.width));const i=d_(t==="th"?gs.ROW:gs.NO_STATUS,e.colSpan,r);i.__rowSpan=e.rowSpan;const s=e.style.backgroundColor;s!==""&&(i.__backgroundColor=s);const o=e.style.verticalAlign;Oc(o)&&(i.__verticalAlign=o);const a=e.style,l=(a&&a.textDecoration||"").split(" "),u=a.fontWeight==="700"||a.fontWeight==="bold",c=l.includes("line-through"),f=a.fontStyle==="italic",d=l.includes("underline");return{after:h=>{const p=[];let m=null;const _=()=>{if(m){const C=m.getFirstChild();Si(C)&&m.getChildrenSize()===1&&C.remove()}};for(const C of h)W2(C)||Z(C)||Si(C)?(Z(C)&&(u&&C.toggleFormat("bold"),c&&C.toggleFormat("strikethrough"),f&&C.toggleFormat("italic"),d&&C.toggleFormat("underline")),m?m.append(C):(m=kn().append(C),p.push(m))):(p.push(C),_(),m=null);return _(),p.length===0&&p.push(kn()),p},node:i}}function d_(n=gs.NO_STATUS,e=1,t){return We(new Zd(n,e,t))}function wn(n){return n instanceof Zd}function dt(n,...e){const t=new URL("https://lexical.dev/docs/error"),r=new URLSearchParams;r.append("code",n);for(const i of e)r.append("v",i);throw t.search=r.toString(),Error(`Minified Lexical error #${n}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}let f_=class h_ extends Ut{static getType(){return"tablerow"}static clone(e){return new h_(e.__height,e.__key)}static importDOM(){return{tr:e=>({conversion:tE,priority:0})}}static importJSON(e){return p_().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeight(e.height)}constructor(e,t){super(t),this.__height=e}exportJSON(){const e=this.getHeight();return{...super.exportJSON(),...e===void 0?void 0:{height:e}}}createDOM(e){const t=document.createElement("tr");return this.__height&&(t.style.height=`${this.__height}px`),$t(t,e.theme.tableRow),t}extractWithChild(e,t,r){return r==="html"}isShadowRoot(){return!0}setHeight(e){const t=this.getWritable();return t.__height=e,t}getHeight(){return this.getLatest().__height}updateDOM(e){return e.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}};function tE(n){const e=n;let t;return Qd.test(e.style.height)&&(t=parseFloat(e.style.height)),{after:r=>Qy(r,wn),node:p_(t)}}function p_(n){return We(new f_(n))}function Ho(n){return n instanceof f_}const g_=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,nE=g_&&"documentMode"in document?document.documentMode:null;g_&&"InputEvent"in window&&!nE&&new window.InputEvent("input");function rE(n,e,t){const[r,i,s]=m_(n,e,t);return i===null&&dt(207),s===null&&dt(208),[r,i,s]}function m_(n,e,t){const r=[];let i=null,s=null;function o(l){let u=r[l];return u===void 0&&(r[l]=u=[]),u}const a=n.getChildren();for(let l=0;l<a.length;l++){const u=a[l];Ho(u)||dt(209);const c=o(l);for(let f=u.getFirstChild(),d=0;f!=null;f=f.getNextSibling()){for(wn(f)||dt(147);c[d]!==void 0;)d++;const h={cell:f,startColumn:d,startRow:l},{__rowSpan:p,__colSpan:m}=f;for(let _=0;_<p&&!(l+_>=a.length);_++){const C=o(l+_);for(let v=0;v<m;v++)C[d+v]=h}e!==null&&i===null&&e.is(f)&&(i=h),t!==null&&s===null&&t.is(f)&&(s=h)}}return[r,i,s]}function iE(n){let e;if(n instanceof Zd)e=n;else if("__type"in n){const i=Gn(n,wn);wn(i)||dt(148),e=i}else{const i=Gn(n.getNode(),wn);wn(i)||dt(148),e=i}const t=e.getParent();Ho(t)||dt(149);const r=t.getParent();return E_(r)||dt(210),[e,t,r]}function sE(n,e,t){let r,i=Math.min(e.startColumn,t.startColumn),s=Math.min(e.startRow,t.startRow),o=Math.max(e.startColumn+e.cell.__colSpan-1,t.startColumn+t.cell.__colSpan-1),a=Math.max(e.startRow+e.cell.__rowSpan-1,t.startRow+t.cell.__rowSpan-1);do{r=!1;for(let l=0;l<n.length;l++)for(let u=0;u<n[0].length;u++){const c=n[l][u];if(!c)continue;const f=c.startColumn+c.cell.__colSpan-1,d=c.startRow+c.cell.__rowSpan-1,h=c.startColumn<=o&&f>=i,p=c.startRow<=a&&d>=s;if(h&&p){const m=Math.min(i,c.startColumn),_=Math.max(o,f),C=Math.min(s,c.startRow),v=Math.max(a,d);m===i&&_===o&&C===s&&v===a||(i=m,o=_,s=C,a=v,r=!0)}}}while(r);return{maxColumn:o,maxRow:a,minColumn:i,minRow:s}}function sp(n){const[e,,t]=iE(n),r=t.getChildren(),i=r.length,s=r[0].getChildren().length,o=new Array(i);for(let a=0;a<i;a++)o[a]=new Array(s);for(let a=0;a<i;a++){const l=r[a].getChildren();let u=0;for(let c=0;c<l.length;c++){for(;o[a][u];)u++;const f=l[c],d=f.__rowSpan||1,h=f.__colSpan||1;for(let p=0;p<d;p++)for(let m=0;m<h;m++)o[a+p][u+m]=f;if(e===f)return{colSpan:h,columnIndex:u,rowIndex:a,rowSpan:d};u+=h}}return null}function op(n){const[[e,t,r,i],[s,o,a,l]]=["anchor","focus"].map(u=>{const c=n[u].getNode(),f=Gn(c,wn);wn(f)||dt(238,u,c.getKey(),c.getType());const d=f.getParent();Ho(d)||dt(239,u);const h=d.getParent();return E_(h)||dt(240,u),[c,f,d,h]});return i.is(l)||dt(241),{anchorCell:t,anchorNode:e,anchorRow:r,anchorTable:i,focusCell:o,focusNode:s,focusRow:a,focusTable:l}}let oE=class y_{constructor(e,t,r){this.anchor=t,this.focus=r,t._selection=this,r._selection=this,this._cachedNodes=null,this.dirty=!1,this.tableKey=e}getStartEndPoints(){return[this.anchor,this.focus]}isValid(){return this.tableKey!=="root"&&this.anchor.key!=="root"&&this.anchor.type==="element"&&this.focus.key!=="root"&&this.focus.type==="element"}isBackward(){return this.focus.isBefore(this.anchor)}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return __(e)&&this.tableKey===e.tableKey&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)}set(e,t,r){this.dirty=this.dirty||e!==this.tableKey||t!==this.anchor.key||r!==this.focus.key,this.tableKey=e,this.anchor.key=t,this.focus.key=r,this._cachedNodes=null}clone(){return new y_(this.tableKey,an(this.anchor.key,this.anchor.offset,this.anchor.type),an(this.focus.key,this.focus.offset,this.focus.type))}isCollapsed(){return!1}extract(){return this.getNodes()}insertRawText(e){}insertText(){}hasFormat(e){let t=0;this.getNodes().filter(wn).forEach(i=>{const s=i.getFirstChild();Pd(s)&&(t|=s.getTextFormat())});const r=Zr[e];return!!(t&r)}insertNodes(e){const t=this.focus.getNode();V(t)||dt(151),Eo(t.select(0,t.getChildrenSize())).insertNodes(e)}getShape(){const{anchorCell:e,focusCell:t}=op(this),r=sp(e);r===null&&dt(153);const i=sp(t);i===null&&dt(155);const s=Math.min(r.columnIndex,i.columnIndex),o=Math.max(r.columnIndex+r.colSpan-1,i.columnIndex+i.colSpan-1),a=Math.min(r.rowIndex,i.rowIndex),l=Math.max(r.rowIndex+r.rowSpan-1,i.rowIndex+i.rowSpan-1);return{fromX:Math.min(s,o),fromY:Math.min(a,l),toX:Math.max(s,o),toY:Math.max(a,l)}}getNodes(){if(!this.isValid())return[];const e=this._cachedNodes;if(e!==null)return e;const{anchorTable:t,anchorCell:r,focusCell:i}=op(this),s=i.getParents()[1];if(s!==t){if(t.isParentOf(i)){const _=s.getParent();_==null&&dt(159),this.set(this.tableKey,i.getKey(),_.getKey())}else{const _=t.getParent();_==null&&dt(158),this.set(this.tableKey,_.getKey(),i.getKey())}return this.getNodes()}const[o,a,l]=rE(t,r,i),{minColumn:u,maxColumn:c,minRow:f,maxRow:d}=sE(o,a,l),h=new Map([[t.getKey(),t]]);let p=null;for(let _=f;_<=d;_++)for(let C=u;C<=c;C++){const{cell:v}=o[_][C],x=v.getParent();Ho(x)||dt(160),x!==p&&(h.set(x.getKey(),x),p=x),h.has(v.getKey())||aE(v,M=>{h.set(M.getKey(),M)})}const m=Array.from(h.values());return Bs()||(this._cachedNodes=m),m}getTextContent(){const e=this.getNodes().filter(r=>wn(r));let t="";for(let r=0;r<e.length;r++){const i=e[r],s=i.__parent,o=(e[r+1]||{}).__parent;t+=i.getTextContent()+(o!==s?`
`:"	")}return t}};function __(n){return n instanceof oE}function aE(n,e){const t=[[n]];for(let r=t.at(-1);r!==void 0&&t.length>0;r=t.at(-1)){const i=r.pop();i===void 0?t.pop():e(i)!==!1&&V(i)&&t.push(i.getChildren())}}function so(n){return je(n)&&n.nodeName==="TABLE"}function lE(n,e){for(let t=e,r=null;t!==null;t=t.getParent()){if(n.is(t))return r;wn(t)&&(r=t)}return null}function uE(n,e,t){return lE(n,ti(e,t))}function ap(n,e,t){if(!e.theme.tableAlignment)return;const r=[],i=[];for(const s of["center","right"]){const o=e.theme.tableAlignment[s];o&&(s===t?i:r).push(o)}Ni(n,...r),$t(n,...i)}const cE=new WeakSet;function lp(n=Vl()){return cE.has(n)}let b_=class v_ extends Ut{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(e){const t=this.getWritable();return t.__colWidths=e,t}static clone(e){return new v_(e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__colWidths=e.__colWidths,this.__rowStriping=e.__rowStriping,this.__frozenColumnCount=e.__frozenColumnCount,this.__frozenRowCount=e.__frozenRowCount}static importDOM(){return{table:e=>({conversion:dE,priority:1})}}static importJSON(e){return C_().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setRowStriping(e.rowStriping||!1).setFrozenColumns(e.frozenColumnCount||0).setFrozenRows(e.frozenRowCount||0).setColWidths(e.colWidths)}constructor(e){super(e),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(e,t,r){return r==="html"}getDOMSlot(e){const t=so(e)?e:e.querySelector("table");return so(t)||dt(229),super.getDOMSlot(e).withElement(t).withAfter(t.querySelector("colgroup"))}createDOM(e,t){const r=document.createElement("table");this.__style&&(r.style.cssText=this.__style);const i=document.createElement("colgroup");if(r.appendChild(i),G2(i),$t(r,e.theme.table),this.updateTableElement(null,r,e),lp(t)){const s=document.createElement("div"),o=e.theme.tableScrollableWrapper;return o?$t(s,o):s.style.cssText="overflow-x: auto;",s.appendChild(r),this.updateTableWrapper(null,s,r,e),s}return r}updateTableWrapper(e,t,r,i){this.__frozenColumnCount!==(e?e.__frozenColumnCount:0)&&function(s,o,a,l){l>0?($t(s,a.theme.tableFrozenColumn),o.setAttribute("data-lexical-frozen-column","true")):(Ni(s,a.theme.tableFrozenColumn),o.removeAttribute("data-lexical-frozen-column"))}(t,r,i,this.__frozenColumnCount),this.__frozenRowCount!==(e?e.__frozenRowCount:0)&&function(s,o,a,l){l>0?($t(s,a.theme.tableFrozenRow),o.setAttribute("data-lexical-frozen-row","true")):(Ni(s,a.theme.tableFrozenRow),o.removeAttribute("data-lexical-frozen-row"))}(t,r,i,this.__frozenRowCount)}updateTableElement(e,t,r){this.__style!==(e?e.__style:"")&&(t.style.cssText=this.__style),this.__rowStriping!==(!!e&&e.__rowStriping)&&function(i,s,o){o?($t(i,s.theme.tableRowStriping),i.setAttribute("data-lexical-row-striping","true")):(Ni(i,s.theme.tableRowStriping),i.removeAttribute("data-lexical-row-striping"))}(t,r,this.__rowStriping),function(i,s,o,a){const l=i.querySelector("colgroup");if(!l)return;const u=[];for(let c=0;c<o;c++){const f=document.createElement("col"),d=a&&a[c];d&&(f.style.width=`${d}px`),u.push(f)}l.replaceChildren(...u)}(t,0,this.getColumnCount(),this.getColWidths()),ap(t,r,this.getFormatType())}updateDOM(e,t,r){const i=this.getDOMSlot(t).element;return t===i===lp()||(je(s=t)&&s.nodeName==="DIV"&&this.updateTableWrapper(e,t,i,r),this.updateTableElement(e,i,r),!1);var s}exportDOM(e){const t=super.exportDOM(e),{element:r}=t;return{after:i=>{if(t.after&&(i=t.after(i)),!so(i)&&je(i)&&(i=i.querySelector("table")),!so(i))return null;ap(i,e._config,this.getFormatType());const[s]=m_(this,null,null),o=new Map;for(const c of s)for(const f of c){const d=f.cell.getKey();o.has(d)||o.set(d,{colSpan:f.cell.getColSpan(),startColumn:f.startColumn})}const a=new Set;for(const c of i.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const f=c.getAttribute("data-temporary-table-cell-lexical-key");if(f){const d=o.get(f);if(c.removeAttribute("data-temporary-table-cell-lexical-key"),d){o.delete(f);for(let h=0;h<d.colSpan;h++)a.add(h+d.startColumn)}}}const l=i.querySelector(":scope > colgroup");if(l){const c=Array.from(i.querySelectorAll(":scope > colgroup > col")).filter((f,d)=>a.has(d));l.replaceChildren(...c)}const u=i.querySelectorAll(":scope > tr");if(u.length>0){const c=document.createElement("tbody");for(const f of u)c.appendChild(f);i.append(c)}return i},element:!so(r)&&je(r)?r.querySelector("table"):r}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(e,t){const{rows:r,domRows:i}=t;for(let s=0;s<r;s++){const o=i[s];if(o!=null)for(let a=0;a<o.length;a++){const l=o[a];if(l==null)continue;const{elem:u}=l,c=uE(this,u);if(c!==null&&e.is(c))return{x:a,y:s}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(e,t,r){const{domRows:i}=r,s=i[t];if(s==null)return null;const o=s[e<s.length?e:s.length-1];return o??null}getDOMCellFromCordsOrThrow(e,t,r){const i=this.getDOMCellFromCords(e,t,r);if(!i)throw new Error("Cell not found at cords.");return i}getCellNodeFromCords(e,t,r){const i=this.getDOMCellFromCords(e,t,r);if(i==null)return null;const s=ti(i.elem);return wn(s)?s:null}getCellNodeFromCordsOrThrow(e,t,r){const i=this.getCellNodeFromCords(e,t,r);if(!i)throw new Error("Node at cords not TableCellNode.");return i}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(e){const t=this.getWritable();return t.__rowStriping=e,t}setFrozenColumns(e){const t=this.getWritable();return t.__frozenColumnCount=e,t}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(e){const t=this.getWritable();return t.__frozenRowCount=e,t}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const e=this.getFirstChild();if(!e)return 0;let t=0;return e.getChildren().forEach(r=>{wn(r)&&(t+=r.getColSpan())}),t}};function dE(n){const e=C_();n.hasAttribute("data-lexical-row-striping")&&e.setRowStriping(!0),n.hasAttribute("data-lexical-frozen-column")&&e.setFrozenColumns(1),n.hasAttribute("data-lexical-frozen-row")&&e.setFrozenRows(1);const t=n.querySelector(":scope > colgroup");if(t){let r=[];for(const i of t.querySelectorAll(":scope > col")){let s=i.style.width||"";if(!Qd.test(s)&&(s=i.getAttribute("width")||"",!/^\d+$/.test(s))){r=void 0;break}r.push(parseFloat(s))}r&&e.setColWidths(r)}return{after:r=>Qy(r,Ho),node:e}}function C_(){return We(new b_)}function E_(n){return n instanceof b_}const w_=Object.freeze({"	":"\\t","\n":"\\n"}),up=new RegExp(Object.keys(w_).join("|"),"g"),ar=Object.freeze({ancestorHasNextSibling:"|",ancestorIsLastChild:" ",hasNextSibling:"├",isLastChild:"└",selectedChar:"^",selectedLine:">"}),fE=[n=>n.hasFormat("bold")&&"Bold",n=>n.hasFormat("code")&&"Code",n=>n.hasFormat("italic")&&"Italic",n=>n.hasFormat("strikethrough")&&"Strikethrough",n=>n.hasFormat("subscript")&&"Subscript",n=>n.hasFormat("superscript")&&"Superscript",n=>n.hasFormat("underline")&&"Underline",n=>n.hasFormat("highlight")&&"Highlight"],hE=[n=>n.hasTextFormat("bold")&&"Bold",n=>n.hasTextFormat("code")&&"Code",n=>n.hasTextFormat("italic")&&"Italic",n=>n.hasTextFormat("strikethrough")&&"Strikethrough",n=>n.hasTextFormat("subscript")&&"Subscript",n=>n.hasTextFormat("superscript")&&"Superscript",n=>n.hasTextFormat("underline")&&"Underline",n=>n.hasTextFormat("highlight")&&"Highlight"],pE=[n=>n.isDirectionless()&&"Directionless",n=>n.isUnmergeable()&&"Unmergeable"],gE=[n=>n.isToken()&&"Token",n=>n.isSegmented()&&"Segmented"];function mE(n,e,t,r,i=!1){const s=n.getEditorState(),o=n._config,a=n._compositionKey,l=n._editable;if(t){let d="";return s.read(()=>{d=function(h){const p=document.createElement("div");return p.innerHTML=h.trim(),k_(p,0).innerHTML}(Zy(n))}),d}let u=` root
`;const c=s.read(()=>{const d=ne();return x_(Ne(),(h,p)=>{const m=`(${h.getKey()})`,_=h.getType()||"",C=h.isSelected();u+=`${C?ar.selectedLine:" "} ${p.join(" ")} ${m} ${_} ${function(v,x,M=!1){const $=x?x(v,M):void 0;if($!==void 0&&$.length>0)return $;if(Z(v)){const k=v.getTextContent(),P=k.length===0?"(empty)":`"${cp(k,M)}"`,D=function(O){return[dp(O),yE(O),_E(O),fp(O)].filter(Boolean).join(", ")}(v);return[P,D.length!==0?`{ ${D} }`:null].filter(Boolean).join(" ").trim()}if(KC(v)){const k=v.getURL(),P=k.length===0?"(empty)":`"${cp(k,M)}"`,D=function(O){return[bE(O),vE(O),CE(O),fp(O)].filter(Boolean).join(", ")}(v);return[P,D.length!==0?`{ ${D} }`:null].filter(Boolean).join(" ").trim()}if(JC(v))return`ids: [ ${v.getIDs().join(", ")} ]`;if(Pd(v)){const k=function(D){let O=hE.map(z=>z(D)).filter(Boolean).join(", ").toLocaleLowerCase();return O!==""&&(O="format: "+O),O}(v);let P=k!==""?`{ ${k} }`:"";return P+=v.__style?`(${v.__style})`:"",P}return""}(h,r,i)}
`,u+=function({indent:v,isSelected:x,node:M,nodeKeyDisplay:$,selection:k,typeDisplay:P}){if(!Z(M)||!G(k)||!x||V(M))return"";const D=k.anchor,O=k.focus;if(M.getTextContent()===""||D.getNode()===k.focus.getNode()&&D.offset===O.offset)return"";const[z,w]=function(K,J){const W=J.getStartEndPoints();if(Vt(J)||W===null)return[-1,-1];const[Q,ie]=W,te=K.getTextContent(),ee=te.length;let Y=-1,oe=-1;if(Q.type==="text"&&ie.type==="text"){const pe=Q.getNode(),ge=ie.getNode();pe===ge&&K===pe&&Q.offset!==ie.offset?[Y,oe]=Q.offset<ie.offset?[Q.offset,ie.offset]:[ie.offset,Q.offset]:[Y,oe]=K===pe?pe.isBefore(ge)?[Q.offset,ee]:[0,Q.offset]:K===ge?ge.isBefore(pe)?[ie.offset,ee]:[0,ie.offset]:[0,ee]}const ue=(te.slice(0,Y).match(up)||[]).length,de=(te.slice(Y,oe).match(up)||[]).length;return[Y+ue,oe+ue+de]}(M,k);if(z===w)return"";const q=v[v.length-1]===ar.hasNextSibling?ar.ancestorHasNextSibling:ar.ancestorIsLastChild,S=[...v.slice(0,v.length-1),q],H=Array(z+1).fill(" "),A=Array(w-z).fill(ar.selectedChar),L=P.length+2,j=Array($.length+L).fill(" ");return[ar.selectedLine,S.join(" "),[...j,...H,...A].join("")].join(" ")+`
`}({indent:p,isSelected:C,node:h,nodeKeyDisplay:m,selection:d,typeDisplay:_})}),d===null?": null":G(d)?function(h){let p="";const m=dp(h);p+=`: range ${m!==""?`{ ${m} }`:""} ${h.style!==""?`{ style: ${h.style} } `:""}`;const _=h.anchor,C=h.focus,v=_.offset,x=C.offset;return p+=`
  ├ anchor { key: ${_.key}, offset: ${v===null?"null":v}, type: ${_.type} }`,p+=`
  └ focus { key: ${C.key}, offset: ${x===null?"null":x}, type: ${C.type} }`,p}(d):__(d)?function(h){return`: table
  └ { table: ${h.tableKey}, anchorCell: ${h.anchor.key}, focusCell: ${h.focus.key} }`}(d):function(h){return Vt(h)?`: node
  └ [${Array.from(h._nodes).join(", ")}]`:""}(d)});if(u+=`
 selection`+c,u+=`

 commands:`,e.length)for(const{index:d,type:h,payload:p}of e)u+=`
  └ ${d}. { type: ${h}, payload: ${p instanceof Event?p.constructor.name:p} }`;else u+=`
  └ None dispatched.`;const{version:f}=n.constructor;return u+=`

 editor${f?` (v${f})`:""}:`,u+=`
  └ namespace ${o.namespace}`,a!==null&&(u+=`
  └ compositionKey ${a}`),u+=`
  └ editable ${String(l)}`,u}function x_(n,e,t=[]){const r=n.getChildren(),i=r.length;r.forEach((s,o)=>{e(s,t.concat(o===i-1?ar.isLastChild:ar.hasNextSibling)),V(s)&&x_(s,e,t.concat(o===i-1?ar.ancestorIsLastChild:ar.ancestorHasNextSibling))})}function cp(n,e=!1){const t=Object.entries(w_).reduce((r,[i,s])=>r.replace(new RegExp(i,"g"),String(s)),n);return e?t.replace(/[^\s]/g,"*"):t}function yE(n){let e=pE.map(t=>t(n)).filter(Boolean).join(", ").toLocaleLowerCase();return e!==""&&(e="detail: "+e),e}function _E(n){let e=gE.map(t=>t(n)).filter(Boolean).join(", ").toLocaleLowerCase();return e!==""&&(e="mode: "+e),e}function dp(n){let e=fE.map(t=>t(n)).filter(Boolean).join(", ").toLocaleLowerCase();return e!==""&&(e="format: "+e),e}function bE(n){let e=n.getTarget();return e!=null&&(e="target: "+e),e}function vE(n){let e=n.getRel();return e!=null&&(e="rel: "+e),e}function CE(n){let e=n.getTitle();return e!=null&&(e="title: "+e),e}function fp(n){if(!n.__state)return!1;const e=[];for(const[r,i]of n.__state.knownState.entries()){if(r.isEqual(i,r.defaultValue))continue;const s=JSON.stringify(r.unparse(i));e.push(`[${r.key}: ${s}]`)}let t=e.join(",");return t!==""&&(t="state: "+t),t}function k_(n,e){const t=new Array(1+e++).join("  "),r=new Array(e-1).join("  ");let i;for(let s=0;s<n.children.length;s++)i=document.createTextNode(`
`+t),n.insertBefore(i,n.children[s]),k_(n.children[s],e),n.lastElementChild===n.children[s]&&(i=document.createTextNode(`
`+r),n.appendChild(i));return n}const EE=T.forwardRef(function({treeTypeButtonClassName:n,timeTravelButtonClassName:e,timeTravelPanelSliderClassName:t,timeTravelPanelButtonClassName:r,viewClassName:i,timeTravelPanelClassName:s,editorState:o,setEditorState:a,setEditorReadOnly:l,generateContent:u,commandsLog:c=[]},f){const[d,h]=T.useState([]),[p,m]=T.useState(""),[_,C]=T.useState(!1),[v,x]=T.useState(!1),M=T.useRef(0),$=T.useRef(null),[k,P]=T.useState(!1),[D,O]=T.useState(!1),[z,w]=T.useState(!1),q=T.useRef(),S=T.useRef([]),H=T.useRef(0),A=T.useCallback(j=>{const K=++H.current;u(j).then(J=>{K===H.current&&m(J)}).catch(J=>{K===H.current&&m(`Error rendering tree: ${J.message}

Stack:
${J.stack}`)})},[u]);T.useEffect(()=>{if(!(!z&&o._nodeMap.size>1e3&&(O(!0),!z))&&(q.current!==o||S.current!==c)){const j=q.current!==o;q.current=o,S.current=c,A(v),!_&&j&&h(K=>[...K,[Date.now(),o]])}},[o,A,v,z,_,c]);const L=d.length;return T.useEffect(()=>{if(k){let j;const K=()=>{const J=M.current;if(J===L-1)return void P(!1);const W=d[J][0],Q=d[J+1][0];j=setTimeout(()=>{M.current++;const ie=M.current,te=$.current;te!==null&&(te.value=String(ie)),a(d[ie][1]),K()},Q-W)};return K(),()=>{clearTimeout(j)}}},[d,k,L,a]),I.jsxs("div",{className:i,children:[!z&&D?I.jsxs("div",{style:{padding:20},children:[I.jsx("span",{style:{marginRight:20},children:"Detected large EditorState, this can impact debugging performance."}),I.jsx("button",{onClick:()=>{w(!0)},style:{background:"transparent",border:"1px solid white",color:"white",cursor:"pointer",padding:5},children:"Show full tree"})]}):null,z?null:I.jsx("button",{onClick:()=>(A(!v),void x(!v)),className:n,type:"button",children:v?"Tree":"Export DOM"}),!_&&(z||!D)&&L>2&&I.jsx("button",{onClick:()=>{l(!0),M.current=L-1,C(!0)},className:e,type:"button",children:"Time Travel"}),(z||!D)&&I.jsx("pre",{ref:f,children:p}),_&&(z||!D)&&I.jsxs("div",{className:s,children:[I.jsx("button",{className:r,onClick:()=>{M.current===L-1&&(M.current=1),P(!k)},type:"button",children:k?"Pause":"Play"}),I.jsx("input",{className:t,ref:$,onChange:j=>{const K=Number(j.target.value),J=d[K];J&&(M.current=K,a(J[1]))},type:"range",min:"1",max:L-1}),I.jsx("button",{className:r,onClick:()=>{l(!1);const j=d.length-1,K=d[j];a(K[1]);const J=$.current;J!==null&&(J.value=String(j)),C(!1),P(!1)},type:"button",children:"Exit"})]})]})});function wE(n,e){const t=new Set;let r=0;for(const[i]of n._commands)t.add(n.registerCommand(i,s=>(e(o=>{r+=1;const a=[...o];return a.push({index:r,payload:s,type:i.type?i.type:"UNKNOWN"}),a.length>10&&a.shift(),a}),!1),_o));return()=>t.forEach(i=>i())}function xE(n){const[e,t]=T.useState([]);return T.useEffect(()=>wE(n,t),[n]),T.useMemo(()=>e,[e])}function kE({treeTypeButtonClassName:n,timeTravelButtonClassName:e,timeTravelPanelSliderClassName:t,timeTravelPanelButtonClassName:r,timeTravelPanelClassName:i,viewClassName:s,editor:o,customPrintNode:a}){const l=T.createRef(),[u,c]=T.useState(o.getEditorState()),f=xE(o);return T.useEffect(()=>vt(o.registerUpdateListener(({editorState:d})=>{c(d)}),o.registerEditableListener(()=>{c(o.getEditorState())})),[o]),T.useEffect(()=>{const d=l.current;if(d!==null)return d.__lexicalEditor=o,()=>{d.__lexicalEditor=null}},[o,l]),I.jsx(EE,{treeTypeButtonClassName:n,timeTravelButtonClassName:e,timeTravelPanelSliderClassName:t,timeTravelPanelButtonClassName:r,viewClassName:s,timeTravelPanelClassName:i,setEditorReadOnly:d=>{const h=o.getRootElement();h!=null&&(h.contentEditable=d?"false":"true")},editorState:u,setEditorState:d=>o.setEditorState(d),generateContent:async function(d){return mE(o,f,d,a)},ref:l,commandsLog:f})}const S_=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,SE=S_?T.useLayoutEffect:T.useEffect,ya={tag:Ti};function T_({initialConfig:n,children:e}){const t=T.useMemo(()=>{const{theme:r,namespace:i,nodes:s,onError:o,editorState:a,html:l}=n,u=Nv(null,r),c=P2({editable:n.editable,html:l,namespace:i,nodes:s,onError:f=>o(f,c),theme:r});return function(f,d){if(d!==null){if(d===void 0)f.update(()=>{const h=Ne();if(h.isEmpty()){const p=kn();h.append(p);const m=S_?document.activeElement:null;(ne()!==null||m!==null&&m===f.getRootElement())&&p.select()}},ya);else if(d!==null)switch(typeof d){case"string":{const h=f.parseEditorState(d);f.setEditorState(h,ya);break}case"object":f.setEditorState(d,ya);break;case"function":f.update(()=>{Ne().isEmpty()&&d(f)},ya)}}}(c,a),[c,u]},[]);return SE(()=>{const r=n.editable,[i]=t;i.setEditable(r===void 0||r)},[]),I.jsx(Em.Provider,{value:t,children:e})}function A_(){return Ne().getTextContent()}function D_(n,e=!0){if(n)return!1;let t=A_();return e&&(t=t.trim()),t===""}function TE(n){if(!D_(n,!1))return!1;const e=Ne().getChildren(),t=e.length;if(t>1)return!1;for(let r=0;r<t;r++){const i=e[r];if(Pe(i))return!1;if(V(i)){if(!Pd(i)||i.__indent!==0)return!1;const s=i.getChildren(),o=s.length;for(let a=0;a<o;a++){const l=s[r];if(!Z(l))return!1}}}return!0}function ef(n){return()=>TE(n)}const N_=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?T.useLayoutEffect:T.useEffect;function AE({editor:n,ariaActiveDescendant:e,ariaAutoComplete:t,ariaControls:r,ariaDescribedBy:i,ariaErrorMessage:s,ariaExpanded:o,ariaInvalid:a,ariaLabel:l,ariaLabelledBy:u,ariaMultiline:c,ariaOwns:f,ariaRequired:d,autoCapitalize:h,className:p,id:m,role:_="textbox",spellCheck:C=!0,style:v,tabIndex:x,"data-testid":M,...$},k){const[P,D]=T.useState(n.isEditable()),O=T.useCallback(w=>{w&&w.ownerDocument&&w.ownerDocument.defaultView?n.setRootElement(w):n.setRootElement(null)},[n]),z=T.useMemo(()=>function(...w){return q=>{w.forEach(S=>{typeof S=="function"?S(q):S!=null&&(S.current=q)})}}(k,O),[O,k]);return N_(()=>(D(n.isEditable()),n.registerEditableListener(w=>{D(w)})),[n]),I.jsx("div",{"aria-activedescendant":P?e:void 0,"aria-autocomplete":P?t:"none","aria-controls":P?r:void 0,"aria-describedby":i,...s!=null?{"aria-errormessage":s}:{},"aria-expanded":P&&_==="combobox"?!!o:void 0,...a!=null?{"aria-invalid":a}:{},"aria-label":l,"aria-labelledby":u,"aria-multiline":c,"aria-owns":P?f:void 0,"aria-readonly":!P||void 0,"aria-required":d,autoCapitalize:h,className:p,contentEditable:P,"data-testid":M,id:m,ref:z,role:_,spellCheck:C,style:v,tabIndex:x,...$})}const DE=T.forwardRef(AE);function hp(n){return n.getEditorState().read(ef(n.isComposing()))}const M_=T.forwardRef(NE);function NE(n,e){const{placeholder:t,...r}=n,[i]=ke();return I.jsxs(I.Fragment,{children:[I.jsx(DE,{editor:i,...r,ref:e}),t!=null&&I.jsx(ME,{editor:i,content:t})]})}function ME({content:n,editor:e}){const t=function(o){const[a,l]=T.useState(()=>hp(o));return N_(()=>{function u(){const c=hp(o);l(c)}return u(),vt(o.registerUpdateListener(()=>{u()}),o.registerEditableListener(()=>{u()}))},[o]),a}(e),[r,i]=T.useState(e.isEditable());if(T.useLayoutEffect(()=>(i(e.isEditable()),e.registerEditableListener(o=>{i(o)})),[e]),!t)return null;let s=null;return typeof n=="function"?s=n(r):n!==null&&(s=n),s===null?null:I.jsx("div",{"aria-hidden":!0,children:s})}function O_({editorRef:n}){const[e]=ke();return T.useEffect(()=>{typeof n=="function"?n(e):typeof n=="object"&&(n.current=e)},[e]),null}function Ic(n,e){return Ic=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Ic(n,e)}var pp={error:null},OE=function(n){var e,t;function r(){for(var s,o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return(s=n.call.apply(n,[this].concat(a))||this).state=pp,s.resetErrorBoundary=function(){for(var u,c=arguments.length,f=new Array(c),d=0;d<c;d++)f[d]=arguments[d];s.props.onReset==null||(u=s.props).onReset.apply(u,f),s.reset()},s}t=n,(e=r).prototype=Object.create(t.prototype),e.prototype.constructor=e,Ic(e,t),r.getDerivedStateFromError=function(s){return{error:s}};var i=r.prototype;return i.reset=function(){this.setState(pp)},i.componentDidCatch=function(s,o){var a,l;(a=(l=this.props).onError)==null||a.call(l,s,o)},i.componentDidUpdate=function(s,o){var a,l,u,c,f=this.state.error,d=this.props.resetKeys;f!==null&&o.error!==null&&((u=s.resetKeys)===void 0&&(u=[]),(c=d)===void 0&&(c=[]),u.length!==c.length||u.some(function(h,p){return!Object.is(h,c[p])}))&&((a=(l=this.props).onResetKeysChange)==null||a.call(l,s.resetKeys,d),this.reset())},i.render=function(){var s=this.state.error,o=this.props,a=o.fallbackRender,l=o.FallbackComponent,u=o.fallback;if(s!==null){var c={error:s,resetErrorBoundary:this.resetErrorBoundary};if(T.isValidElement(u))return u;if(typeof a=="function")return a(c);if(l)return T.createElement(l,c);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},r}(T.Component);function I_({children:n,onError:e}){return I.jsx(OE,{fallback:I.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:e,children:n})}const _a=0,Rc=1,Pc=2,jn=0,IE=1,gp=2,RE=3,PE=4;function LE(n,e,t,r,i){if(n===null||t.size===0&&r.size===0&&!i)return jn;const s=e._selection,o=n._selection;if(i)return IE;if(!(G(s)&&G(o)&&o.isCollapsed()&&s.isCollapsed()))return jn;const a=function(C,v,x){const M=C._nodeMap,$=[];for(const k of v){const P=M.get(k);P!==void 0&&$.push(P)}for(const[k,P]of x){if(!P)continue;const D=M.get(k);D===void 0||At(D)||$.push(D)}return $}(e,t,r);if(a.length===0)return jn;if(a.length>1){const C=e._nodeMap,v=C.get(s.anchor.key),x=C.get(o.anchor.key);return v&&x&&!n._nodeMap.has(v.__key)&&Z(v)&&v.__text.length===1&&s.anchor.offset===1?gp:jn}const l=a[0],u=n._nodeMap.get(l.__key);if(!Z(u)||!Z(l)||u.__mode!==l.__mode)return jn;const c=u.__text,f=l.__text;if(c===f)return jn;const d=s.anchor,h=o.anchor;if(d.key!==h.key||d.type!=="text")return jn;const p=d.offset,m=h.offset,_=f.length-c.length;return _===1&&m===p-1?gp:_===-1&&m===p+1?RE:_===-1&&m===p?PE:jn}function $E(n,e){let t=Date.now(),r=jn;return(i,s,o,a,l,u)=>{const c=Date.now();if(u.has(bc))return r=jn,t=c,Pc;const f=LE(i,s,a,l,n.isComposing()),d=(()=>{const h=o===null||o.editor===n,p=u.has(N2);if(!p&&h&&u.has(Ti))return _a;if(i===null)return Rc;const m=s._selection;return a.size>0||l.size>0?p===!1&&f!==jn&&f===r&&c<t+e&&h||a.size===1&&function(_,C,v){const x=C._nodeMap.get(_),M=v._nodeMap.get(_),$=C._selection,k=v._selection;return!(G($)&&G(k)&&$.anchor.type==="element"&&$.focus.type==="element"&&k.anchor.type==="text"&&k.focus.type==="text"||!Z(x)||!Z(M)||x.__parent!==M.__parent)&&JSON.stringify(C.read(()=>x.exportJSON()))===JSON.stringify(v.read(()=>M.exportJSON()))}(Array.from(a)[0],i,s)?_a:Rc:m!==null?_a:Pc})();return t=c,r=f,d}}function mp(n){n.undoStack=[],n.redoStack=[],n.current=null}function FE(n,e,t){const r=$E(n,t);return vt(n.registerCommand($l,()=>(function(s,o){const a=o.redoStack,l=o.undoStack;if(l.length!==0){const u=o.current,c=l.pop();u!==null&&(a.push(u),s.dispatchCommand(lo,!0)),l.length===0&&s.dispatchCommand(uo,!1),o.current=c||null,c&&c.editor.setEditorState(c.editorState,{tag:bc})}}(n,e),!0),ye),n.registerCommand(Fl,()=>(function(s,o){const a=o.redoStack,l=o.undoStack;if(a.length!==0){const u=o.current;u!==null&&(l.push(u),s.dispatchCommand(uo,!0));const c=a.pop();a.length===0&&s.dispatchCommand(lo,!1),o.current=c||null,c&&c.editor.setEditorState(c.editorState,{tag:bc})}}(n,e),!0),ye),n.registerCommand(Td,()=>(mp(e),!1),ye),n.registerCommand(zm,()=>(mp(e),n.dispatchCommand(lo,!1),n.dispatchCommand(uo,!1),!0),ye),n.registerUpdateListener(({editorState:s,prevEditorState:o,dirtyLeaves:a,dirtyElements:l,tags:u})=>{const c=e.current,f=e.redoStack,d=e.undoStack,h=c===null?null:c.editorState;if(c!==null&&s===h)return;const p=r(o,s,c,a,l,u);if(p===Rc)f.length!==0&&(e.redoStack=[],n.dispatchCommand(lo,!1)),c!==null&&(d.push({...c}),n.dispatchCommand(uo,!0));else if(p===Pc)return;e.current={editor:n,editorState:s}}))}function BE(){return{current:null,redoStack:[],undoStack:[]}}function R_({delay:n,externalHistoryState:e}){const[t]=ke();return function(r,i,s=1e3){const o=T.useMemo(()=>i||BE(),[i]);T.useEffect(()=>FE(r,o,s),[s,r,o])}(t,e,n),null}const qE=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?T.useLayoutEffect:T.useEffect;function jE(n){return{initialValueFn:()=>n.isEditable(),subscribe:e=>n.registerEditableListener(e)}}function P_(){return function(n){const[e]=ke(),t=T.useMemo(()=>n(e),[e,n]),[r,i]=T.useState(()=>t.initialValueFn()),s=T.useRef(r);return qE(()=>{const{initialValueFn:o,subscribe:a}=t,l=o();return s.current!==l&&(s.current=l,i(l)),a(u=>{s.current=u,i(u)})},[t,n]),r}(jE)}function L_(n){const e=window.location.origin,t=r=>{if(r.origin!==e)return;const i=n.getRootElement();if(document.activeElement!==i)return;const s=r.data;if(typeof s=="string"){let o;try{o=JSON.parse(s)}catch{return}if(o&&o.protocol==="nuanria_messaging"&&o.type==="request"){const a=o.payload;if(a&&a.functionId==="makeChanges"){const l=a.args;if(l){const[u,c,f,d,h,p]=l;n.update(()=>{const m=ne();if(G(m)){const _=m.anchor;let C=_.getNode(),v=0,x=0;if(Z(C)&&u>=0&&c>=0&&(v=u,x=u+c,m.setTextNodeRange(C,v,C,x)),v===x&&f===""||(m.insertRawText(f),C=_.getNode()),Z(C)){v=d,x=d+h;const M=C.getTextContentSize();v=v>M?M:v,x=x>M?M:x,m.setTextNodeRange(C,v,C,x)}r.stopImmediatePropagation()}})}}}}};return window.addEventListener("message",t,!0),()=>{window.removeEventListener("message",t,!0)}}function yp(n,e){if(document.caretRangeFromPoint!==void 0){const t=document.caretRangeFromPoint(n,e);return t===null?null:{node:t.startContainer,offset:t.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const t=document.caretPositionFromPoint(n,e);return t===null?null:{node:t.offsetNode,offset:t.offset}}return null}const Ws=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,UE=Ws&&"documentMode"in document?document.documentMode:null,WE=!(!Ws||!("InputEvent"in window)||UE)&&"getTargetRanges"in new window.InputEvent("input"),zE=Ws&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),_p=Ws&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,HE=Ws&&/^(?=.*Chrome).*/i.test(navigator.userAgent),KE=Ws&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!HE,bp=be("DRAG_DROP_PASTE_FILE");function ba(n){let e=null;if(Ar(n,DragEvent)?e=n.dataTransfer:Ar(n,ClipboardEvent)&&(e=n.clipboardData),e===null)return[!1,[],!1];const t=e.types,r=t.includes("Files"),i=t.includes("text/html")||t.includes("text/plain");return[r,Array.from(e.files),i]}function vp(n){const e=ne();if(!G(e))return!1;const t=new Set,r=e.getNodes();for(let i=0;i<r.length;i++){const s=r[i],o=s.getKey();if(t.has(o))continue;const a=Gn(s,u=>V(u)&&!u.isInline());if(a===null)continue;const l=a.getKey();a.canIndent()&&!t.has(l)&&(t.add(l),n(a))}return t.size>0}function Cp(n){const e=ti(n);return Pe(e)}function Uu(n){for(const e of["lowercase","uppercase","capitalize"])n.hasFormat(e)&&n.toggleFormat(e)}function VE(n){return vt(n.registerCommand(jm,e=>{const t=ne();return!!Vt(t)&&(t.clear(),!0)},ye),n.registerCommand(ur,e=>{const t=ne();return G(t)?(t.deleteCharacter(e),!0):!!Vt(t)&&(t.deleteNodes(),!0)},ye),n.registerCommand(Cs,e=>{const t=ne();return!!G(t)&&(t.deleteWord(e),!0)},ye),n.registerCommand(Es,e=>{const t=ne();return!!G(t)&&(t.deleteLine(e),!0)},ye),n.registerCommand(ki,e=>{const t=ne();if(typeof e=="string")t!==null&&t.insertText(e);else{if(t===null)return!1;const r=e.dataTransfer;if(r!=null)ep(r,t,n);else if(G(t)){const i=e.data;return i&&t.insertText(i),!0}}return!0},ye),n.registerCommand(ul,()=>{const e=ne();return!!G(e)&&(e.removeText(),!0)},ye),n.registerCommand(Kr,e=>{const t=ne();return!!G(t)&&(t.formatText(e),!0)},ye),n.registerCommand(d2,e=>{const t=ne();if(!G(t)&&!Vt(t))return!1;const r=t.getNodes();for(const i of r){const s=Gn(i,o=>V(o)&&!o.isInline());s!==null&&s.setFormat(e)}return!0},ye),n.registerCommand(Yr,e=>{const t=ne();return!!G(t)&&(t.insertLineBreak(e),!0)},ye),n.registerCommand(So,()=>{const e=ne();return!!G(e)&&(e.insertParagraph(),!0)},ye),n.registerCommand(u2,()=>(S2([Bo()]),!0),ye),n.registerCommand(c2,()=>vp(e=>{const t=e.getIndent();e.setIndent(t+1)}),ye),n.registerCommand(th,()=>vp(e=>{const t=e.getIndent();t>0&&e.setIndent(Math.max(0,t-1))}),ye),n.registerCommand(Cd,e=>{const t=ne();if(Vt(t)){const r=t.getNodes();if(r.length>0)return r[0].selectPrevious(),!0}else if(G(t)){const r=Cc(t.focus,!0);if(!e.shiftKey&&Pe(r)&&!r.isIsolated()&&!r.isInline())return r.selectPrevious(),e.preventDefault(),!0}return!1},ye),n.registerCommand(Ed,e=>{const t=ne();if(Vt(t)){const r=t.getNodes();if(r.length>0)return r[0].selectNext(0,0),!0}else if(G(t)){if(function(i){const s=i.focus;return s.key==="root"&&s.offset===Ne().getChildrenSize()}(t))return e.preventDefault(),!0;const r=Cc(t.focus,!1);if(!e.shiftKey&&Pe(r)&&!r.isIsolated()&&!r.isInline())return r.selectNext(),e.preventDefault(),!0}return!1},ye),n.registerCommand(vd,e=>{const t=ne();if(Vt(t)){const r=t.getNodes();if(r.length>0)return e.preventDefault(),r[0].selectPrevious(),!0}if(!G(t))return!1;if(bl(t,!0)){const r=e.shiftKey;return e.preventDefault(),vl(t,r,!0),!0}return!1},ye),n.registerCommand(bd,e=>{const t=ne();if(Vt(t)){const i=t.getNodes();if(i.length>0)return e.preventDefault(),i[0].selectNext(0,0),!0}if(!G(t))return!1;const r=e.shiftKey;return!!bl(t,!1)&&(e.preventDefault(),vl(t,r,!1),!0)},ye),n.registerCommand(wd,e=>{if(Cp(e.target))return!1;const t=ne();if(G(t)){if(function(r){if(!r.isCollapsed())return!1;const{anchor:i}=r;if(i.offset!==0)return!1;const s=i.getNode();if(At(s))return!1;const o=FC(s);return o.getIndent()>0&&(o.is(s)||s.is(o.getFirstDescendant()))}(t))return e.preventDefault(),n.dispatchCommand(th,void 0);if(_p&&navigator.language==="ko-KR")return!1}else if(!Vt(t))return!1;return e.preventDefault(),n.dispatchCommand(ur,!0)},ye),n.registerCommand(xd,e=>{if(Cp(e.target))return!1;const t=ne();return!(!G(t)&&!Vt(t))&&(e.preventDefault(),n.dispatchCommand(ur,!1))},ye),n.registerCommand(ws,e=>{const t=ne();if(!G(t))return!1;if(Uu(t),e!==null){if((_p||zE||KE)&&WE)return!1;if(e.preventDefault(),e.shiftKey)return n.dispatchCommand(Yr,!1)}return n.dispatchCommand(So,void 0)},ye),n.registerCommand(Bl,()=>{const e=ne();return!!G(e)&&(n.blur(),!0)},ye),n.registerCommand(ql,e=>{const[,t]=ba(e);if(t.length>0){const i=yp(e.clientX,e.clientY);if(i!==null){const{offset:s,node:o}=i,a=ti(o);if(a!==null){const l=jo();if(Z(a))l.anchor.set(a.getKey(),s,"text"),l.focus.set(a.getKey(),s,"text");else{const c=a.getParentOrThrow().getKey(),f=a.getIndexWithinParent()+1;l.anchor.set(c,f,"element"),l.focus.set(c,f,"element")}const u=Eo(l);Ot(u)}n.dispatchCommand(bp,t)}return e.preventDefault(),!0}const r=ne();return!!G(r)},ye),n.registerCommand(Sd,e=>{const[t]=ba(e),r=ne();return!(t&&!G(r))},ye),n.registerCommand(Wm,e=>{const[t]=ba(e),r=ne();if(t&&!G(r))return!1;const i=yp(e.clientX,e.clientY);if(i!==null){const s=ti(i.node);Pe(s)&&e.preventDefault()}return!0},ye),n.registerCommand(cl,()=>(Oy(),!0),ye),n.registerCommand(Gi,e=>(np(n,Ar(e,ClipboardEvent)?e:null),!0),ye),n.registerCommand(Ls,e=>(async function(t,r){await np(r,Ar(t,ClipboardEvent)?t:null),r.update(()=>{const i=ne();G(i)?i.removeText():Vt(i)&&i.getNodes().forEach(s=>s.remove())})}(e,n),!0),ye),n.registerCommand(Ji,e=>{const[,t,r]=ba(e);return t.length>0&&!r?(n.dispatchCommand(bp,t),!0):Qi(e.target)&&Fd(e.target)?!1:ne()!==null&&(function(i,s){i.preventDefault(),s.update(()=>{const o=ne(),a=Ar(i,InputEvent)||Ar(i,KeyboardEvent)?null:i.clipboardData;a!=null&&o!==null&&ep(a,o,s)},{tag:Cy})}(e,n),!0)},ye),n.registerCommand(Um,e=>{const t=ne();return G(t)&&Uu(t),!1},ye),n.registerCommand(kd,e=>{const t=ne();return G(t)&&Uu(t),!1},ye))}const Lc=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?T.useLayoutEffect:T.useEffect;function Ep(n){return n.getEditorState().read(ef(n.isComposing()))}function JE({contentEditable:n,placeholder:e=null,ErrorBoundary:t}){const[r]=ke(),i=function(s,o){const[a,l]=T.useState(()=>s.getDecorators());return Lc(()=>s.registerDecoratorListener(u=>{En.flushSync(()=>{l(u)})}),[s]),T.useEffect(()=>{l(s.getDecorators())},[s]),T.useMemo(()=>{const u=[],c=Object.keys(a);for(let f=0;f<c.length;f++){const d=c[f],h=I.jsx(o,{onError:m=>s._onError(m),children:I.jsx(T.Suspense,{fallback:null,children:a[d]})}),p=s.getElementByKey(d);p!==null&&u.push(En.createPortal(h,p,d))}return u},[o,a,s])}(r,t);return function(s){Lc(()=>vt(VE(s),L_(s)),[s])}(r),I.jsxs(I.Fragment,{children:[n,I.jsx(GE,{content:e}),i]})}function GE({content:n}){const[e]=ke(),t=function(i){const[s,o]=T.useState(()=>Ep(i));return Lc(()=>{function a(){const l=Ep(i);o(l)}return a(),vt(i.registerUpdateListener(()=>{a()}),i.registerEditableListener(()=>{a()}))},[i]),s}(e),r=P_();return t?typeof n=="function"?n(r):n:null}var va={exports:{}},Wu,wp;function YE(){if(wp)return Wu;wp=1;var n=-1,e=1,t=0;function r(w,q,S,H,A){if(w===q)return w?[[t,w]]:[];if(S!=null){var L=O(w,q,S);if(L)return L}var j=a(w,q),K=w.substring(0,j);w=w.substring(j),q=q.substring(j),j=u(w,q);var J=w.substring(w.length-j);w=w.substring(0,w.length-j),q=q.substring(0,q.length-j);var W=i(w,q);return K&&W.unshift([t,K]),J&&W.push([t,J]),v(W,A),H&&f(W),W}function i(w,q){var S;if(!w)return[[e,q]];if(!q)return[[n,w]];var H=w.length>q.length?w:q,A=w.length>q.length?q:w,L=H.indexOf(A);if(L!==-1)return S=[[e,H.substring(0,L)],[t,A],[e,H.substring(L+A.length)]],w.length>q.length&&(S[0][0]=S[2][0]=n),S;if(A.length===1)return[[n,w],[e,q]];var j=c(w,q);if(j){var K=j[0],J=j[1],W=j[2],Q=j[3],ie=j[4],te=r(K,W),ee=r(J,Q);return te.concat([[t,ie]],ee)}return s(w,q)}function s(w,q){for(var S=w.length,H=q.length,A=Math.ceil((S+H)/2),L=A,j=2*A,K=new Array(j),J=new Array(j),W=0;W<j;W++)K[W]=-1,J[W]=-1;K[L+1]=0,J[L+1]=0;for(var Q=S-H,ie=Q%2!==0,te=0,ee=0,Y=0,oe=0,ue=0;ue<A;ue++){for(var de=-ue+te;de<=ue-ee;de+=2){var pe=L+de,ge;de===-ue||de!==ue&&K[pe-1]<K[pe+1]?ge=K[pe+1]:ge=K[pe-1]+1;for(var _e=ge-de;ge<S&&_e<H&&w.charAt(ge)===q.charAt(_e);)ge++,_e++;if(K[pe]=ge,ge>S)ee+=2;else if(_e>H)te+=2;else if(ie){var ae=L+Q-de;if(ae>=0&&ae<j&&J[ae]!==-1){var Se=S-J[ae];if(ge>=Se)return o(w,q,ge,_e)}}}for(var Ie=-ue+Y;Ie<=ue-oe;Ie+=2){var ae=L+Ie,Se;Ie===-ue||Ie!==ue&&J[ae-1]<J[ae+1]?Se=J[ae+1]:Se=J[ae-1]+1;for(var De=Se-Ie;Se<S&&De<H&&w.charAt(S-Se-1)===q.charAt(H-De-1);)Se++,De++;if(J[ae]=Se,Se>S)oe+=2;else if(De>H)Y+=2;else if(!ie){var pe=L+Q-Ie;if(pe>=0&&pe<j&&K[pe]!==-1){var ge=K[pe],_e=L+ge-pe;if(Se=S-Se,ge>=Se)return o(w,q,ge,_e)}}}}return[[n,w],[e,q]]}function o(w,q,S,H){var A=w.substring(0,S),L=q.substring(0,H),j=w.substring(S),K=q.substring(H),J=r(A,L),W=r(j,K);return J.concat(W)}function a(w,q){if(!w||!q||w.charAt(0)!==q.charAt(0))return 0;for(var S=0,H=Math.min(w.length,q.length),A=H,L=0;S<A;)w.substring(L,A)==q.substring(L,A)?(S=A,L=S):H=A,A=Math.floor((H-S)/2+S);return x(w.charCodeAt(A-1))&&A--,A}function l(w,q){var S=w.length,H=q.length;if(S==0||H==0)return 0;S>H?w=w.substring(S-H):S<H&&(q=q.substring(0,S));var A=Math.min(S,H);if(w==q)return A;for(var L=0,j=1;;){var K=w.substring(A-j),J=q.indexOf(K);if(J==-1)return L;j+=J,(J==0||w.substring(A-j)==q.substring(0,j))&&(L=j,j++)}}function u(w,q){if(!w||!q||w.slice(-1)!==q.slice(-1))return 0;for(var S=0,H=Math.min(w.length,q.length),A=H,L=0;S<A;)w.substring(w.length-A,w.length-L)==q.substring(q.length-A,q.length-L)?(S=A,L=S):H=A,A=Math.floor((H-S)/2+S);return M(w.charCodeAt(w.length-A))&&A--,A}function c(w,q){var S=w.length>q.length?w:q,H=w.length>q.length?q:w;if(S.length<4||H.length*2<S.length)return null;function A(ee,Y,oe){for(var ue=ee.substring(oe,oe+Math.floor(ee.length/4)),de=-1,pe="",ge,_e,ae,Se;(de=Y.indexOf(ue,de+1))!==-1;){var Ie=a(ee.substring(oe),Y.substring(de)),De=u(ee.substring(0,oe),Y.substring(0,de));pe.length<De+Ie&&(pe=Y.substring(de-De,de)+Y.substring(de,de+Ie),ge=ee.substring(0,oe-De),_e=ee.substring(oe+Ie),ae=Y.substring(0,de-De),Se=Y.substring(de+Ie))}return pe.length*2>=ee.length?[ge,_e,ae,Se,pe]:null}var L=A(S,H,Math.ceil(S.length/4)),j=A(S,H,Math.ceil(S.length/2)),K;if(!L&&!j)return null;j?L?K=L[4].length>j[4].length?L:j:K=j:K=L;var J,W,Q,ie;w.length>q.length?(J=K[0],W=K[1],Q=K[2],ie=K[3]):(Q=K[0],ie=K[1],J=K[2],W=K[3]);var te=K[4];return[J,W,Q,ie,te]}function f(w){for(var q=!1,S=[],H=0,A=null,L=0,j=0,K=0,J=0,W=0;L<w.length;)w[L][0]==t?(S[H++]=L,j=J,K=W,J=0,W=0,A=w[L][1]):(w[L][0]==e?J+=w[L][1].length:W+=w[L][1].length,A&&A.length<=Math.max(j,K)&&A.length<=Math.max(J,W)&&(w.splice(S[H-1],0,[n,A]),w[S[H-1]+1][0]=e,H--,H--,L=H>0?S[H-1]:-1,j=0,K=0,J=0,W=0,A=null,q=!0)),L++;for(q&&v(w),C(w),L=1;L<w.length;){if(w[L-1][0]==n&&w[L][0]==e){var Q=w[L-1][1],ie=w[L][1],te=l(Q,ie),ee=l(ie,Q);te>=ee?(te>=Q.length/2||te>=ie.length/2)&&(w.splice(L,0,[t,ie.substring(0,te)]),w[L-1][1]=Q.substring(0,Q.length-te),w[L+1][1]=ie.substring(te),L++):(ee>=Q.length/2||ee>=ie.length/2)&&(w.splice(L,0,[t,Q.substring(0,ee)]),w[L-1][0]=e,w[L-1][1]=ie.substring(0,ie.length-ee),w[L+1][0]=n,w[L+1][1]=Q.substring(ee),L++),L++}L++}}var d=/[^a-zA-Z0-9]/,h=/\s/,p=/[\r\n]/,m=/\n\r?\n$/,_=/^\r?\n\r?\n/;function C(w){function q(ee,Y){if(!ee||!Y)return 6;var oe=ee.charAt(ee.length-1),ue=Y.charAt(0),de=oe.match(d),pe=ue.match(d),ge=de&&oe.match(h),_e=pe&&ue.match(h),ae=ge&&oe.match(p),Se=_e&&ue.match(p),Ie=ae&&ee.match(m),De=Se&&Y.match(_);return Ie||De?5:ae||Se?4:de&&!ge&&_e?3:ge||_e?2:de||pe?1:0}for(var S=1;S<w.length-1;){if(w[S-1][0]==t&&w[S+1][0]==t){var H=w[S-1][1],A=w[S][1],L=w[S+1][1],j=u(H,A);if(j){var K=A.substring(A.length-j);H=H.substring(0,H.length-j),A=K+A.substring(0,A.length-j),L=K+L}for(var J=H,W=A,Q=L,ie=q(H,A)+q(A,L);A.charAt(0)===L.charAt(0);){H+=A.charAt(0),A=A.substring(1)+L.charAt(0),L=L.substring(1);var te=q(H,A)+q(A,L);te>=ie&&(ie=te,J=H,W=A,Q=L)}w[S-1][1]!=J&&(J?w[S-1][1]=J:(w.splice(S-1,1),S--),w[S][1]=W,Q?w[S+1][1]=Q:(w.splice(S+1,1),S--))}S++}}function v(w,q){w.push([t,""]);for(var S=0,H=0,A=0,L="",j="",K;S<w.length;){if(S<w.length-1&&!w[S][1]){w.splice(S,1);continue}switch(w[S][0]){case e:A++,j+=w[S][1],S++;break;case n:H++,L+=w[S][1],S++;break;case t:var J=S-A-H-1;if(q){if(J>=0&&k(w[J][1])){var W=w[J][1].slice(-1);if(w[J][1]=w[J][1].slice(0,-1),L=W+L,j=W+j,!w[J][1]){w.splice(J,1),S--;var Q=J-1;w[Q]&&w[Q][0]===e&&(A++,j=w[Q][1]+j,Q--),w[Q]&&w[Q][0]===n&&(H++,L=w[Q][1]+L,Q--),J=Q}}if($(w[S][1])){var W=w[S][1].charAt(0);w[S][1]=w[S][1].slice(1),L+=W,j+=W}}if(S<w.length-1&&!w[S][1]){w.splice(S,1);break}if(L.length>0||j.length>0){L.length>0&&j.length>0&&(K=a(j,L),K!==0&&(J>=0?w[J][1]+=j.substring(0,K):(w.splice(0,0,[t,j.substring(0,K)]),S++),j=j.substring(K),L=L.substring(K)),K=u(j,L),K!==0&&(w[S][1]=j.substring(j.length-K)+w[S][1],j=j.substring(0,j.length-K),L=L.substring(0,L.length-K)));var ie=A+H;L.length===0&&j.length===0?(w.splice(S-ie,ie),S=S-ie):L.length===0?(w.splice(S-ie,ie,[e,j]),S=S-ie+1):j.length===0?(w.splice(S-ie,ie,[n,L]),S=S-ie+1):(w.splice(S-ie,ie,[n,L],[e,j]),S=S-ie+2)}S!==0&&w[S-1][0]===t?(w[S-1][1]+=w[S][1],w.splice(S,1)):S++,A=0,H=0,L="",j="";break}}w[w.length-1][1]===""&&w.pop();var te=!1;for(S=1;S<w.length-1;)w[S-1][0]===t&&w[S+1][0]===t&&(w[S][1].substring(w[S][1].length-w[S-1][1].length)===w[S-1][1]?(w[S][1]=w[S-1][1]+w[S][1].substring(0,w[S][1].length-w[S-1][1].length),w[S+1][1]=w[S-1][1]+w[S+1][1],w.splice(S-1,1),te=!0):w[S][1].substring(0,w[S+1][1].length)==w[S+1][1]&&(w[S-1][1]+=w[S+1][1],w[S][1]=w[S][1].substring(w[S+1][1].length)+w[S+1][1],w.splice(S+1,1),te=!0)),S++;te&&v(w,q)}function x(w){return w>=55296&&w<=56319}function M(w){return w>=56320&&w<=57343}function $(w){return M(w.charCodeAt(0))}function k(w){return x(w.charCodeAt(w.length-1))}function P(w){for(var q=[],S=0;S<w.length;S++)w[S][1].length>0&&q.push(w[S]);return q}function D(w,q,S,H){return k(w)||$(H)?null:P([[t,w],[n,q],[e,S],[t,H]])}function O(w,q,S){var H=typeof S=="number"?{index:S,length:0}:S.oldRange,A=typeof S=="number"?null:S.newRange,L=w.length,j=q.length;if(H.length===0&&(A===null||A.length===0)){var K=H.index,J=w.slice(0,K),W=w.slice(K),Q=A?A.index:null;e:{var ie=K+j-L;if(Q!==null&&Q!==ie||ie<0||ie>j)break e;var te=q.slice(0,ie),ee=q.slice(ie);if(ee!==W)break e;var Y=Math.min(K,ie),oe=J.slice(0,Y),ue=te.slice(0,Y);if(oe!==ue)break e;var de=J.slice(Y),pe=te.slice(Y);return D(oe,de,pe,W)}e:{if(Q!==null&&Q!==K)break e;var ge=K,te=q.slice(0,ge),ee=q.slice(ge);if(te!==J)break e;var _e=Math.min(L-ge,j-ge),ae=W.slice(W.length-_e),Se=ee.slice(ee.length-_e);if(ae!==Se)break e;var de=W.slice(0,W.length-_e),pe=ee.slice(0,ee.length-_e);return D(J,de,pe,ae)}}if(H.length>0&&A&&A.length===0)e:{var oe=w.slice(0,H.index),ae=w.slice(H.index+H.length),Y=oe.length,_e=ae.length;if(j<Y+_e)break e;var ue=q.slice(0,Y),Se=q.slice(j-_e);if(oe!==ue||ae!==Se)break e;var de=w.slice(Y,L-_e),pe=q.slice(Y,j-_e);return D(oe,de,pe,ae)}return null}function z(w,q,S,H){return r(w,q,S,H,!0)}return z.INSERT=e,z.DELETE=n,z.EQUAL=t,Wu=z,Wu}var co={exports:{}};co.exports;var xp;function $_(){return xp||(xp=1,function(n,e){var t=200,r="__lodash_hash_undefined__",i=9007199254740991,s="[object Arguments]",o="[object Array]",a="[object Boolean]",l="[object Date]",u="[object Error]",c="[object Function]",f="[object GeneratorFunction]",d="[object Map]",h="[object Number]",p="[object Object]",m="[object Promise]",_="[object RegExp]",C="[object Set]",v="[object String]",x="[object Symbol]",M="[object WeakMap]",$="[object ArrayBuffer]",k="[object DataView]",P="[object Float32Array]",D="[object Float64Array]",O="[object Int8Array]",z="[object Int16Array]",w="[object Int32Array]",q="[object Uint8Array]",S="[object Uint8ClampedArray]",H="[object Uint16Array]",A="[object Uint32Array]",L=/[\\^$.*+?()[\]{}|]/g,j=/\w*$/,K=/^\[object .+?Constructor\]$/,J=/^(?:0|[1-9]\d*)$/,W={};W[s]=W[o]=W[$]=W[k]=W[a]=W[l]=W[P]=W[D]=W[O]=W[z]=W[w]=W[d]=W[h]=W[p]=W[_]=W[C]=W[v]=W[x]=W[q]=W[S]=W[H]=W[A]=!0,W[u]=W[c]=W[M]=!1;var Q=typeof Hr=="object"&&Hr&&Hr.Object===Object&&Hr,ie=typeof self=="object"&&self&&self.Object===Object&&self,te=Q||ie||Function("return this")(),ee=e&&!e.nodeType&&e,Y=ee&&!0&&n&&!n.nodeType&&n,oe=Y&&Y.exports===ee;function ue(g,E){return g.set(E[0],E[1]),g}function de(g,E){return g.add(E),g}function pe(g,E){for(var R=-1,X=g?g.length:0;++R<X&&E(g[R],R,g)!==!1;);return g}function ge(g,E){for(var R=-1,X=E.length,Ce=g.length;++R<X;)g[Ce+R]=E[R];return g}function _e(g,E,R,X){for(var Ce=-1,he=g?g.length:0;++Ce<he;)R=E(R,g[Ce],Ce,g);return R}function ae(g,E){for(var R=-1,X=Array(g);++R<g;)X[R]=E(R);return X}function Se(g,E){return g==null?void 0:g[E]}function Ie(g){var E=!1;if(g!=null&&typeof g.toString!="function")try{E=!!(g+"")}catch{}return E}function De(g){var E=-1,R=Array(g.size);return g.forEach(function(X,Ce){R[++E]=[Ce,X]}),R}function Qt(g,E){return function(R){return g(E(R))}}function Wt(g){var E=-1,R=Array(g.size);return g.forEach(function(X){R[++E]=X}),R}var It=Array.prototype,un=Function.prototype,Zt=Object.prototype,cn=te["__core-js_shared__"],pt=function(){var g=/[^.]+$/.exec(cn&&cn.keys&&cn.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Re=un.toString,ot=Zt.hasOwnProperty,ze=Zt.toString,Pn=RegExp("^"+Re.call(ot).replace(L,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),dn=oe?te.Buffer:void 0,en=te.Symbol,fn=te.Uint8Array,me=Qt(Object.getPrototypeOf,Object),Fe=Object.create,at=Zt.propertyIsEnumerable,gt=It.splice,hn=Object.getOwnPropertySymbols,pn=dn?dn.isBuffer:void 0,Ln=Qt(Object.keys,Object),gn=qn(te,"DataView"),mn=qn(te,"Map"),wt=qn(te,"Promise"),yn=qn(te,"Set"),_n=qn(te,"WeakMap"),tn=qn(Object,"create"),Qn=Kt(gn),Be=Kt(mn),Ye=Kt(wt),zt=Kt(yn),Ht=Kt(_n),$n=en?en.prototype:void 0,qr=$n?$n.valueOf:void 0;function Sn(g){var E=-1,R=g?g.length:0;for(this.clear();++E<R;){var X=g[E];this.set(X[0],X[1])}}function y(){this.__data__=tn?tn(null):{}}function b(g){return this.has(g)&&delete this.__data__[g]}function N(g){var E=this.__data__;if(tn){var R=E[g];return R===r?void 0:R}return ot.call(E,g)?E[g]:void 0}function U(g){var E=this.__data__;return tn?E[g]!==void 0:ot.call(E,g)}function re(g,E){var R=this.__data__;return R[g]=tn&&E===void 0?r:E,this}Sn.prototype.clear=y,Sn.prototype.delete=b,Sn.prototype.get=N,Sn.prototype.has=U,Sn.prototype.set=re;function le(g){var E=-1,R=g?g.length:0;for(this.clear();++E<R;){var X=g[E];this.set(X[0],X[1])}}function Te(){this.__data__=[]}function Xe(g){var E=this.__data__,R=rs(E,g);if(R<0)return!1;var X=E.length-1;return R==X?E.pop():gt.call(E,R,1),!0}function tt(g){var E=this.__data__,R=rs(E,g);return R<0?void 0:E[R][1]}function xt(g){return rs(this.__data__,g)>-1}function lt(g,E){var R=this.__data__,X=rs(R,g);return X<0?R.push([g,E]):R[X][1]=E,this}le.prototype.clear=Te,le.prototype.delete=Xe,le.prototype.get=tt,le.prototype.has=xt,le.prototype.set=lt;function Je(g){var E=-1,R=g?g.length:0;for(this.clear();++E<R;){var X=g[E];this.set(X[0],X[1])}}function bn(){this.__data__={hash:new Sn,map:new(mn||le),string:new Sn}}function Rt(g){return bi(this,g).delete(g)}function Fn(g){return bi(this,g).get(g)}function nn(g){return bi(this,g).has(g)}function Bn(g,E){return bi(this,g).set(g,E),this}Je.prototype.clear=bn,Je.prototype.delete=Rt,Je.prototype.get=Fn,Je.prototype.has=nn,Je.prototype.set=Bn;function nt(g){this.__data__=new le(g)}function yi(){this.__data__=new le}function rt(g){return this.__data__.delete(g)}function ts(g){return this.__data__.get(g)}function Zn(g){return this.__data__.has(g)}function ou(g,E){var R=this.__data__;if(R instanceof le){var X=R.__data__;if(!mn||X.length<t-1)return X.push([g,E]),this;R=this.__data__=new Je(X)}return R.set(g,E),this}nt.prototype.clear=yi,nt.prototype.delete=rt,nt.prototype.get=ts,nt.prototype.has=Zn,nt.prototype.set=ou;function ns(g,E){var R=Qs(g)||ss(g)?ae(g.length,String):[],X=R.length,Ce=!!X;for(var he in g)ot.call(g,he)&&!(Ce&&(he=="length"||vu(he,X)))&&R.push(he);return R}function ea(g,E,R){var X=g[E];(!(ot.call(g,E)&&sa(X,R))||R===void 0&&!(E in g))&&(g[E]=R)}function rs(g,E){for(var R=g.length;R--;)if(sa(g[R][0],E))return R;return-1}function er(g,E){return g&&Xs(E,eo(E),g)}function Gs(g,E,R,X,Ce,he,Oe){var Me;if(X&&(Me=he?X(g,Ce,he,Oe):X(g)),Me!==void 0)return Me;if(!nr(g))return g;var it=Qs(g);if(it){if(Me=_u(g),!E)return gu(g,Me)}else{var Le=yr(g),Pt=Le==c||Le==f;if(oa(g))return is(g,E);if(Le==p||Le==s||Pt&&!he){if(Ie(g))return he?g:{};if(Me=tr(Pt?{}:g),!E)return mu(g,er(Me,g))}else{if(!W[Le])return he?g:{};Me=bu(g,Le,Gs,E)}}Oe||(Oe=new nt);var rn=Oe.get(g);if(rn)return rn;if(Oe.set(g,Me),!it)var ut=R?yu(g):eo(g);return pe(ut||g,function(Lt,kt){ut&&(kt=Lt,Lt=g[kt]),ea(Me,kt,Gs(Lt,E,R,X,kt,g,Oe))}),Me}function au(g){return nr(g)?Fe(g):{}}function lu(g,E,R){var X=E(g);return Qs(g)?X:ge(X,R(g))}function uu(g){return ze.call(g)}function cu(g){if(!nr(g)||Eu(g))return!1;var E=Zs(g)||Ie(g)?Pn:K;return E.test(Kt(g))}function du(g){if(!ra(g))return Ln(g);var E=[];for(var R in Object(g))ot.call(g,R)&&R!="constructor"&&E.push(R);return E}function is(g,E){if(E)return g.slice();var R=new g.constructor(g.length);return g.copy(R),R}function Ys(g){var E=new g.constructor(g.byteLength);return new fn(E).set(new fn(g)),E}function _i(g,E){var R=E?Ys(g.buffer):g.buffer;return new g.constructor(R,g.byteOffset,g.byteLength)}function ta(g,E,R){var X=E?R(De(g),!0):De(g);return _e(X,ue,new g.constructor)}function na(g){var E=new g.constructor(g.source,j.exec(g));return E.lastIndex=g.lastIndex,E}function fu(g,E,R){var X=E?R(Wt(g),!0):Wt(g);return _e(X,de,new g.constructor)}function hu(g){return qr?Object(qr.call(g)):{}}function pu(g,E){var R=E?Ys(g.buffer):g.buffer;return new g.constructor(R,g.byteOffset,g.length)}function gu(g,E){var R=-1,X=g.length;for(E||(E=Array(X));++R<X;)E[R]=g[R];return E}function Xs(g,E,R,X){R||(R={});for(var Ce=-1,he=E.length;++Ce<he;){var Oe=E[Ce],Me=void 0;ea(R,Oe,Me===void 0?g[Oe]:Me)}return R}function mu(g,E){return Xs(g,mr(g),E)}function yu(g){return lu(g,eo,mr)}function bi(g,E){var R=g.__data__;return Cu(E)?R[typeof E=="string"?"string":"hash"]:R.map}function qn(g,E){var R=Se(g,E);return cu(R)?R:void 0}var mr=hn?Qt(hn,Object):xu,yr=uu;(gn&&yr(new gn(new ArrayBuffer(1)))!=k||mn&&yr(new mn)!=d||wt&&yr(wt.resolve())!=m||yn&&yr(new yn)!=C||_n&&yr(new _n)!=M)&&(yr=function(g){var E=ze.call(g),R=E==p?g.constructor:void 0,X=R?Kt(R):void 0;if(X)switch(X){case Qn:return k;case Be:return d;case Ye:return m;case zt:return C;case Ht:return M}return E});function _u(g){var E=g.length,R=g.constructor(E);return E&&typeof g[0]=="string"&&ot.call(g,"index")&&(R.index=g.index,R.input=g.input),R}function tr(g){return typeof g.constructor=="function"&&!ra(g)?au(me(g)):{}}function bu(g,E,R,X){var Ce=g.constructor;switch(E){case $:return Ys(g);case a:case l:return new Ce(+g);case k:return _i(g,X);case P:case D:case O:case z:case w:case q:case S:case H:case A:return pu(g,X);case d:return ta(g,X,R);case h:case v:return new Ce(g);case _:return na(g);case C:return fu(g,X,R);case x:return hu(g)}}function vu(g,E){return E=E??i,!!E&&(typeof g=="number"||J.test(g))&&g>-1&&g%1==0&&g<E}function Cu(g){var E=typeof g;return E=="string"||E=="number"||E=="symbol"||E=="boolean"?g!=="__proto__":g===null}function Eu(g){return!!pt&&pt in g}function ra(g){var E=g&&g.constructor,R=typeof E=="function"&&E.prototype||Zt;return g===R}function Kt(g){if(g!=null){try{return Re.call(g)}catch{}try{return g+""}catch{}}return""}function ia(g){return Gs(g,!0,!0)}function sa(g,E){return g===E||g!==g&&E!==E}function ss(g){return wu(g)&&ot.call(g,"callee")&&(!at.call(g,"callee")||ze.call(g)==s)}var Qs=Array.isArray;function os(g){return g!=null&&aa(g.length)&&!Zs(g)}function wu(g){return la(g)&&os(g)}var oa=pn||ku;function Zs(g){var E=nr(g)?ze.call(g):"";return E==c||E==f}function aa(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=i}function nr(g){var E=typeof g;return!!g&&(E=="object"||E=="function")}function la(g){return!!g&&typeof g=="object"}function eo(g){return os(g)?ns(g):du(g)}function xu(){return[]}function ku(){return!1}n.exports=ia}(co,co.exports)),co.exports}var fo={exports:{}};fo.exports;var kp;function F_(){return kp||(kp=1,function(n,e){var t=200,r="__lodash_hash_undefined__",i=1,s=2,o=9007199254740991,a="[object Arguments]",l="[object Array]",u="[object AsyncFunction]",c="[object Boolean]",f="[object Date]",d="[object Error]",h="[object Function]",p="[object GeneratorFunction]",m="[object Map]",_="[object Number]",C="[object Null]",v="[object Object]",x="[object Promise]",M="[object Proxy]",$="[object RegExp]",k="[object Set]",P="[object String]",D="[object Symbol]",O="[object Undefined]",z="[object WeakMap]",w="[object ArrayBuffer]",q="[object DataView]",S="[object Float32Array]",H="[object Float64Array]",A="[object Int8Array]",L="[object Int16Array]",j="[object Int32Array]",K="[object Uint8Array]",J="[object Uint8ClampedArray]",W="[object Uint16Array]",Q="[object Uint32Array]",ie=/[\\^$.*+?()[\]{}|]/g,te=/^\[object .+?Constructor\]$/,ee=/^(?:0|[1-9]\d*)$/,Y={};Y[S]=Y[H]=Y[A]=Y[L]=Y[j]=Y[K]=Y[J]=Y[W]=Y[Q]=!0,Y[a]=Y[l]=Y[w]=Y[c]=Y[q]=Y[f]=Y[d]=Y[h]=Y[m]=Y[_]=Y[v]=Y[$]=Y[k]=Y[P]=Y[z]=!1;var oe=typeof Hr=="object"&&Hr&&Hr.Object===Object&&Hr,ue=typeof self=="object"&&self&&self.Object===Object&&self,de=oe||ue||Function("return this")(),pe=e&&!e.nodeType&&e,ge=pe&&!0&&n&&!n.nodeType&&n,_e=ge&&ge.exports===pe,ae=_e&&oe.process,Se=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),Ie=Se&&Se.isTypedArray;function De(g,E){for(var R=-1,X=g==null?0:g.length,Ce=0,he=[];++R<X;){var Oe=g[R];E(Oe,R,g)&&(he[Ce++]=Oe)}return he}function Qt(g,E){for(var R=-1,X=E.length,Ce=g.length;++R<X;)g[Ce+R]=E[R];return g}function Wt(g,E){for(var R=-1,X=g==null?0:g.length;++R<X;)if(E(g[R],R,g))return!0;return!1}function It(g,E){for(var R=-1,X=Array(g);++R<g;)X[R]=E(R);return X}function un(g){return function(E){return g(E)}}function Zt(g,E){return g.has(E)}function cn(g,E){return g==null?void 0:g[E]}function pt(g){var E=-1,R=Array(g.size);return g.forEach(function(X,Ce){R[++E]=[Ce,X]}),R}function Re(g,E){return function(R){return g(E(R))}}function ot(g){var E=-1,R=Array(g.size);return g.forEach(function(X){R[++E]=X}),R}var ze=Array.prototype,Pn=Function.prototype,dn=Object.prototype,en=de["__core-js_shared__"],fn=Pn.toString,me=dn.hasOwnProperty,Fe=function(){var g=/[^.]+$/.exec(en&&en.keys&&en.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),at=dn.toString,gt=RegExp("^"+fn.call(me).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hn=_e?de.Buffer:void 0,pn=de.Symbol,Ln=de.Uint8Array,gn=dn.propertyIsEnumerable,mn=ze.splice,wt=pn?pn.toStringTag:void 0,yn=Object.getOwnPropertySymbols,_n=hn?hn.isBuffer:void 0,tn=Re(Object.keys,Object),Qn=mr(de,"DataView"),Be=mr(de,"Map"),Ye=mr(de,"Promise"),zt=mr(de,"Set"),Ht=mr(de,"WeakMap"),$n=mr(Object,"create"),qr=Kt(Qn),Sn=Kt(Be),y=Kt(Ye),b=Kt(zt),N=Kt(Ht),U=pn?pn.prototype:void 0,re=U?U.valueOf:void 0;function le(g){var E=-1,R=g==null?0:g.length;for(this.clear();++E<R;){var X=g[E];this.set(X[0],X[1])}}function Te(){this.__data__=$n?$n(null):{},this.size=0}function Xe(g){var E=this.has(g)&&delete this.__data__[g];return this.size-=E?1:0,E}function tt(g){var E=this.__data__;if($n){var R=E[g];return R===r?void 0:R}return me.call(E,g)?E[g]:void 0}function xt(g){var E=this.__data__;return $n?E[g]!==void 0:me.call(E,g)}function lt(g,E){var R=this.__data__;return this.size+=this.has(g)?0:1,R[g]=$n&&E===void 0?r:E,this}le.prototype.clear=Te,le.prototype.delete=Xe,le.prototype.get=tt,le.prototype.has=xt,le.prototype.set=lt;function Je(g){var E=-1,R=g==null?0:g.length;for(this.clear();++E<R;){var X=g[E];this.set(X[0],X[1])}}function bn(){this.__data__=[],this.size=0}function Rt(g){var E=this.__data__,R=is(E,g);if(R<0)return!1;var X=E.length-1;return R==X?E.pop():mn.call(E,R,1),--this.size,!0}function Fn(g){var E=this.__data__,R=is(E,g);return R<0?void 0:E[R][1]}function nn(g){return is(this.__data__,g)>-1}function Bn(g,E){var R=this.__data__,X=is(R,g);return X<0?(++this.size,R.push([g,E])):R[X][1]=E,this}Je.prototype.clear=bn,Je.prototype.delete=Rt,Je.prototype.get=Fn,Je.prototype.has=nn,Je.prototype.set=Bn;function nt(g){var E=-1,R=g==null?0:g.length;for(this.clear();++E<R;){var X=g[E];this.set(X[0],X[1])}}function yi(){this.size=0,this.__data__={hash:new le,map:new(Be||Je),string:new le}}function rt(g){var E=qn(this,g).delete(g);return this.size-=E?1:0,E}function ts(g){return qn(this,g).get(g)}function Zn(g){return qn(this,g).has(g)}function ou(g,E){var R=qn(this,g),X=R.size;return R.set(g,E),this.size+=R.size==X?0:1,this}nt.prototype.clear=yi,nt.prototype.delete=rt,nt.prototype.get=ts,nt.prototype.has=Zn,nt.prototype.set=ou;function ns(g){var E=-1,R=g==null?0:g.length;for(this.__data__=new nt;++E<R;)this.add(g[E])}function ea(g){return this.__data__.set(g,r),this}function rs(g){return this.__data__.has(g)}ns.prototype.add=ns.prototype.push=ea,ns.prototype.has=rs;function er(g){var E=this.__data__=new Je(g);this.size=E.size}function Gs(){this.__data__=new Je,this.size=0}function au(g){var E=this.__data__,R=E.delete(g);return this.size=E.size,R}function lu(g){return this.__data__.get(g)}function uu(g){return this.__data__.has(g)}function cu(g,E){var R=this.__data__;if(R instanceof Je){var X=R.__data__;if(!Be||X.length<t-1)return X.push([g,E]),this.size=++R.size,this;R=this.__data__=new nt(X)}return R.set(g,E),this.size=R.size,this}er.prototype.clear=Gs,er.prototype.delete=au,er.prototype.get=lu,er.prototype.has=uu,er.prototype.set=cu;function du(g,E){var R=ss(g),X=!R&&sa(g),Ce=!R&&!X&&os(g),he=!R&&!X&&!Ce&&la(g),Oe=R||X||Ce||he,Me=Oe?It(g.length,String):[],it=Me.length;for(var Le in g)me.call(g,Le)&&!(Oe&&(Le=="length"||Ce&&(Le=="offset"||Le=="parent")||he&&(Le=="buffer"||Le=="byteLength"||Le=="byteOffset")||bu(Le,it)))&&Me.push(Le);return Me}function is(g,E){for(var R=g.length;R--;)if(ia(g[R][0],E))return R;return-1}function Ys(g,E,R){var X=E(g);return ss(g)?X:Qt(X,R(g))}function _i(g){return g==null?g===void 0?O:C:wt&&wt in Object(g)?yr(g):ra(g)}function ta(g){return nr(g)&&_i(g)==a}function na(g,E,R,X,Ce){return g===E?!0:g==null||E==null||!nr(g)&&!nr(E)?g!==g&&E!==E:fu(g,E,R,X,na,Ce)}function fu(g,E,R,X,Ce,he){var Oe=ss(g),Me=ss(E),it=Oe?l:tr(g),Le=Me?l:tr(E);it=it==a?v:it,Le=Le==a?v:Le;var Pt=it==v,rn=Le==v,ut=it==Le;if(ut&&os(g)){if(!os(E))return!1;Oe=!0,Pt=!1}if(ut&&!Pt)return he||(he=new er),Oe||la(g)?Xs(g,E,R,X,Ce,he):mu(g,E,it,R,X,Ce,he);if(!(R&i)){var Lt=Pt&&me.call(g,"__wrapped__"),kt=rn&&me.call(E,"__wrapped__");if(Lt||kt){var jr=Lt?g.value():g,_r=kt?E.value():E;return he||(he=new er),Ce(jr,_r,R,X,he)}}return ut?(he||(he=new er),yu(g,E,R,X,Ce,he)):!1}function hu(g){if(!aa(g)||Cu(g))return!1;var E=oa(g)?gt:te;return E.test(Kt(g))}function pu(g){return nr(g)&&Zs(g.length)&&!!Y[_i(g)]}function gu(g){if(!Eu(g))return tn(g);var E=[];for(var R in Object(g))me.call(g,R)&&R!="constructor"&&E.push(R);return E}function Xs(g,E,R,X,Ce,he){var Oe=R&i,Me=g.length,it=E.length;if(Me!=it&&!(Oe&&it>Me))return!1;var Le=he.get(g);if(Le&&he.get(E))return Le==E;var Pt=-1,rn=!0,ut=R&s?new ns:void 0;for(he.set(g,E),he.set(E,g);++Pt<Me;){var Lt=g[Pt],kt=E[Pt];if(X)var jr=Oe?X(kt,Lt,Pt,E,g,he):X(Lt,kt,Pt,g,E,he);if(jr!==void 0){if(jr)continue;rn=!1;break}if(ut){if(!Wt(E,function(_r,vi){if(!Zt(ut,vi)&&(Lt===_r||Ce(Lt,_r,R,X,he)))return ut.push(vi)})){rn=!1;break}}else if(!(Lt===kt||Ce(Lt,kt,R,X,he))){rn=!1;break}}return he.delete(g),he.delete(E),rn}function mu(g,E,R,X,Ce,he,Oe){switch(R){case q:if(g.byteLength!=E.byteLength||g.byteOffset!=E.byteOffset)return!1;g=g.buffer,E=E.buffer;case w:return!(g.byteLength!=E.byteLength||!he(new Ln(g),new Ln(E)));case c:case f:case _:return ia(+g,+E);case d:return g.name==E.name&&g.message==E.message;case $:case P:return g==E+"";case m:var Me=pt;case k:var it=X&i;if(Me||(Me=ot),g.size!=E.size&&!it)return!1;var Le=Oe.get(g);if(Le)return Le==E;X|=s,Oe.set(g,E);var Pt=Xs(Me(g),Me(E),X,Ce,he,Oe);return Oe.delete(g),Pt;case D:if(re)return re.call(g)==re.call(E)}return!1}function yu(g,E,R,X,Ce,he){var Oe=R&i,Me=bi(g),it=Me.length,Le=bi(E),Pt=Le.length;if(it!=Pt&&!Oe)return!1;for(var rn=it;rn--;){var ut=Me[rn];if(!(Oe?ut in E:me.call(E,ut)))return!1}var Lt=he.get(g);if(Lt&&he.get(E))return Lt==E;var kt=!0;he.set(g,E),he.set(E,g);for(var jr=Oe;++rn<it;){ut=Me[rn];var _r=g[ut],vi=E[ut];if(X)var Rf=Oe?X(vi,_r,ut,E,g,he):X(_r,vi,ut,g,E,he);if(!(Rf===void 0?_r===vi||Ce(_r,vi,R,X,he):Rf)){kt=!1;break}jr||(jr=ut=="constructor")}if(kt&&!jr){var ua=g.constructor,ca=E.constructor;ua!=ca&&"constructor"in g&&"constructor"in E&&!(typeof ua=="function"&&ua instanceof ua&&typeof ca=="function"&&ca instanceof ca)&&(kt=!1)}return he.delete(g),he.delete(E),kt}function bi(g){return Ys(g,eo,_u)}function qn(g,E){var R=g.__data__;return vu(E)?R[typeof E=="string"?"string":"hash"]:R.map}function mr(g,E){var R=cn(g,E);return hu(R)?R:void 0}function yr(g){var E=me.call(g,wt),R=g[wt];try{g[wt]=void 0;var X=!0}catch{}var Ce=at.call(g);return X&&(E?g[wt]=R:delete g[wt]),Ce}var _u=yn?function(g){return g==null?[]:(g=Object(g),De(yn(g),function(E){return gn.call(g,E)}))}:xu,tr=_i;(Qn&&tr(new Qn(new ArrayBuffer(1)))!=q||Be&&tr(new Be)!=m||Ye&&tr(Ye.resolve())!=x||zt&&tr(new zt)!=k||Ht&&tr(new Ht)!=z)&&(tr=function(g){var E=_i(g),R=E==v?g.constructor:void 0,X=R?Kt(R):"";if(X)switch(X){case qr:return q;case Sn:return m;case y:return x;case b:return k;case N:return z}return E});function bu(g,E){return E=E??o,!!E&&(typeof g=="number"||ee.test(g))&&g>-1&&g%1==0&&g<E}function vu(g){var E=typeof g;return E=="string"||E=="number"||E=="symbol"||E=="boolean"?g!=="__proto__":g===null}function Cu(g){return!!Fe&&Fe in g}function Eu(g){var E=g&&g.constructor,R=typeof E=="function"&&E.prototype||dn;return g===R}function ra(g){return at.call(g)}function Kt(g){if(g!=null){try{return fn.call(g)}catch{}try{return g+""}catch{}}return""}function ia(g,E){return g===E||g!==g&&E!==E}var sa=ta(function(){return arguments}())?ta:function(g){return nr(g)&&me.call(g,"callee")&&!gn.call(g,"callee")},ss=Array.isArray;function Qs(g){return g!=null&&Zs(g.length)&&!oa(g)}var os=_n||ku;function wu(g,E){return na(g,E)}function oa(g){if(!aa(g))return!1;var E=_i(g);return E==h||E==p||E==u||E==M}function Zs(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=o}function aa(g){var E=typeof g;return g!=null&&(E=="object"||E=="function")}function nr(g){return g!=null&&typeof g=="object"}var la=Ie?un(Ie):pu;function eo(g){return Qs(g)?du(g):gu(g)}function xu(){return[]}function ku(){return!1}n.exports=wu}(fo,fo.exports)),fo.exports}var Ca={},Sp;function XE(){if(Sp)return Ca;Sp=1,Object.defineProperty(Ca,"__esModule",{value:!0});const n=$_(),e=F_();var t;return function(r){function i(l={},u={},c=!1){typeof l!="object"&&(l={}),typeof u!="object"&&(u={});let f=n(u);c||(f=Object.keys(f).reduce((d,h)=>(f[h]!=null&&(d[h]=f[h]),d),{}));for(const d in l)l[d]!==void 0&&u[d]===void 0&&(f[d]=l[d]);return Object.keys(f).length>0?f:void 0}r.compose=i;function s(l={},u={}){typeof l!="object"&&(l={}),typeof u!="object"&&(u={});const c=Object.keys(l).concat(Object.keys(u)).reduce((f,d)=>(e(l[d],u[d])||(f[d]=u[d]===void 0?null:u[d]),f),{});return Object.keys(c).length>0?c:void 0}r.diff=s;function o(l={},u={}){l=l||{};const c=Object.keys(u).reduce((f,d)=>(u[d]!==l[d]&&l[d]!==void 0&&(f[d]=u[d]),f),{});return Object.keys(l).reduce((f,d)=>(l[d]!==u[d]&&u[d]===void 0&&(f[d]=null),f),c)}r.invert=o;function a(l,u,c=!1){if(typeof l!="object")return u;if(typeof u!="object")return;if(!c)return u;const f=Object.keys(u).reduce((d,h)=>(l[h]===void 0&&(d[h]=u[h]),d),{});return Object.keys(f).length>0?f:void 0}r.transform=a}(t||(t={})),Ca.default=t,Ca}var Ea={},Tp;function B_(){if(Tp)return Ea;Tp=1,Object.defineProperty(Ea,"__esModule",{value:!0});var n;return function(e){function t(r){return typeof r.delete=="number"?r.delete:typeof r.retain=="number"?r.retain:typeof r.retain=="object"&&r.retain!==null?1:typeof r.insert=="string"?r.insert.length:1}e.length=t}(n||(n={})),Ea.default=n,Ea}var wa={},Ap;function QE(){if(Ap)return wa;Ap=1,Object.defineProperty(wa,"__esModule",{value:!0});const n=B_();class e{constructor(r){this.ops=r,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(r){r||(r=1/0);const i=this.ops[this.index];if(i){const s=this.offset,o=n.default.length(i);if(r>=o-s?(r=o-s,this.index+=1,this.offset=0):this.offset+=r,typeof i.delete=="number")return{delete:r};{const a={};return i.attributes&&(a.attributes=i.attributes),typeof i.retain=="number"?a.retain=r:typeof i.retain=="object"&&i.retain!==null?a.retain=i.retain:typeof i.insert=="string"?a.insert=i.insert.substr(s,r):a.insert=i.insert,a}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?n.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const r=this.ops[this.index];return r?typeof r.delete=="number"?"delete":typeof r.retain=="number"||typeof r.retain=="object"&&r.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const r=this.offset,i=this.index,s=this.next(),o=this.ops.slice(this.index);return this.offset=r,this.index=i,[s].concat(o)}}else return[]}}return wa.default=e,wa}var Dp;function ZE(){return Dp||(Dp=1,function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeMap=e.OpIterator=e.Op=void 0;const t=YE(),r=$_(),i=F_(),s=XE();e.AttributeMap=s.default;const o=B_();e.Op=o.default;const a=QE();e.OpIterator=a.default;const l="\0",u=(f,d)=>{if(typeof f!="object"||f===null)throw new Error(`cannot retain a ${typeof f}`);if(typeof d!="object"||d===null)throw new Error(`cannot retain a ${typeof d}`);const h=Object.keys(f)[0];if(!h||h!==Object.keys(d)[0])throw new Error(`embed types not matched: ${h} != ${Object.keys(d)[0]}`);return[h,f[h],d[h]]};class c{constructor(d){Array.isArray(d)?this.ops=d:d!=null&&Array.isArray(d.ops)?this.ops=d.ops:this.ops=[]}static registerEmbed(d,h){this.handlers[d]=h}static unregisterEmbed(d){delete this.handlers[d]}static getHandler(d){const h=this.handlers[d];if(!h)throw new Error(`no handlers for embed type "${d}"`);return h}insert(d,h){const p={};return typeof d=="string"&&d.length===0?this:(p.insert=d,h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(p.attributes=h),this.push(p))}delete(d){return d<=0?this:this.push({delete:d})}retain(d,h){if(typeof d=="number"&&d<=0)return this;const p={retain:d};return h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(p.attributes=h),this.push(p)}push(d){let h=this.ops.length,p=this.ops[h-1];if(d=r(d),typeof p=="object"){if(typeof d.delete=="number"&&typeof p.delete=="number")return this.ops[h-1]={delete:p.delete+d.delete},this;if(typeof p.delete=="number"&&d.insert!=null&&(h-=1,p=this.ops[h-1],typeof p!="object"))return this.ops.unshift(d),this;if(i(d.attributes,p.attributes)){if(typeof d.insert=="string"&&typeof p.insert=="string")return this.ops[h-1]={insert:p.insert+d.insert},typeof d.attributes=="object"&&(this.ops[h-1].attributes=d.attributes),this;if(typeof d.retain=="number"&&typeof p.retain=="number")return this.ops[h-1]={retain:p.retain+d.retain},typeof d.attributes=="object"&&(this.ops[h-1].attributes=d.attributes),this}}return h===this.ops.length?this.ops.push(d):this.ops.splice(h,0,d),this}chop(){const d=this.ops[this.ops.length-1];return d&&typeof d.retain=="number"&&!d.attributes&&this.ops.pop(),this}filter(d){return this.ops.filter(d)}forEach(d){this.ops.forEach(d)}map(d){return this.ops.map(d)}partition(d){const h=[],p=[];return this.forEach(m=>{(d(m)?h:p).push(m)}),[h,p]}reduce(d,h){return this.ops.reduce(d,h)}changeLength(){return this.reduce((d,h)=>h.insert?d+o.default.length(h):h.delete?d-h.delete:d,0)}length(){return this.reduce((d,h)=>d+o.default.length(h),0)}slice(d=0,h=1/0){const p=[],m=new a.default(this.ops);let _=0;for(;_<h&&m.hasNext();){let C;_<d?C=m.next(d-_):(C=m.next(h-_),p.push(C)),_+=o.default.length(C)}return new c(p)}compose(d){const h=new a.default(this.ops),p=new a.default(d.ops),m=[],_=p.peek();if(_!=null&&typeof _.retain=="number"&&_.attributes==null){let v=_.retain;for(;h.peekType()==="insert"&&h.peekLength()<=v;)v-=h.peekLength(),m.push(h.next());_.retain-v>0&&p.next(_.retain-v)}const C=new c(m);for(;h.hasNext()||p.hasNext();)if(p.peekType()==="insert")C.push(p.next());else if(h.peekType()==="delete")C.push(h.next());else{const v=Math.min(h.peekLength(),p.peekLength()),x=h.next(v),M=p.next(v);if(M.retain){const $={};if(typeof x.retain=="number")$.retain=typeof M.retain=="number"?v:M.retain;else if(typeof M.retain=="number")x.retain==null?$.insert=x.insert:$.retain=x.retain;else{const P=x.retain==null?"insert":"retain",[D,O,z]=u(x[P],M.retain),w=c.getHandler(D);$[P]={[D]:w.compose(O,z,P==="retain")}}const k=s.default.compose(x.attributes,M.attributes,typeof x.retain=="number");if(k&&($.attributes=k),C.push($),!p.hasNext()&&i(C.ops[C.ops.length-1],$)){const P=new c(h.rest());return C.concat(P).chop()}}else typeof M.delete=="number"&&(typeof x.retain=="number"||typeof x.retain=="object"&&x.retain!==null)&&C.push(M)}return C.chop()}concat(d){const h=new c(this.ops.slice());return d.ops.length>0&&(h.push(d.ops[0]),h.ops=h.ops.concat(d.ops.slice(1))),h}diff(d,h){if(this.ops===d.ops)return new c;const p=[this,d].map(x=>x.map(M=>{if(M.insert!=null)return typeof M.insert=="string"?M.insert:l;const $=x===d?"on":"with";throw new Error("diff() called "+$+" non-document")}).join("")),m=new c,_=t(p[0],p[1],h,!0),C=new a.default(this.ops),v=new a.default(d.ops);return _.forEach(x=>{let M=x[1].length;for(;M>0;){let $=0;switch(x[0]){case t.INSERT:$=Math.min(v.peekLength(),M),m.push(v.next($));break;case t.DELETE:$=Math.min(M,C.peekLength()),C.next($),m.delete($);break;case t.EQUAL:$=Math.min(C.peekLength(),v.peekLength(),M);const k=C.next($),P=v.next($);i(k.insert,P.insert)?m.retain($,s.default.diff(k.attributes,P.attributes)):m.push(P).delete($);break}M-=$}}),m.chop()}eachLine(d,h=`
`){const p=new a.default(this.ops);let m=new c,_=0;for(;p.hasNext();){if(p.peekType()!=="insert")return;const C=p.peek(),v=o.default.length(C)-p.peekLength(),x=typeof C.insert=="string"?C.insert.indexOf(h,v)-v:-1;if(x<0)m.push(p.next());else if(x>0)m.push(p.next(x));else{if(d(m,p.next(1).attributes||{},_)===!1)return;_+=1,m=new c}}m.length()>0&&d(m,{},_)}invert(d){const h=new c;return this.reduce((p,m)=>{if(m.insert)h.delete(o.default.length(m));else{if(typeof m.retain=="number"&&m.attributes==null)return h.retain(m.retain),p+m.retain;if(m.delete||typeof m.retain=="number"){const _=m.delete||m.retain;return d.slice(p,p+_).forEach(v=>{m.delete?h.push(v):m.retain&&m.attributes&&h.retain(o.default.length(v),s.default.invert(m.attributes,v.attributes))}),p+_}else if(typeof m.retain=="object"&&m.retain!==null){const _=d.slice(p,p+1),C=new a.default(_.ops).next(),[v,x,M]=u(m.retain,C.insert),$=c.getHandler(v);return h.retain({[v]:$.invert(x,M)},s.default.invert(m.attributes,C.attributes)),p+1}}return p},0),h.chop()}transform(d,h=!1){if(h=!!h,typeof d=="number")return this.transformPosition(d,h);const p=d,m=new a.default(this.ops),_=new a.default(p.ops),C=new c;for(;m.hasNext()||_.hasNext();)if(m.peekType()==="insert"&&(h||_.peekType()!=="insert"))C.retain(o.default.length(m.next()));else if(_.peekType()==="insert")C.push(_.next());else{const v=Math.min(m.peekLength(),_.peekLength()),x=m.next(v),M=_.next(v);if(x.delete)continue;if(M.delete)C.push(M);else{const $=x.retain,k=M.retain;let P=typeof k=="object"&&k!==null?k:v;if(typeof $=="object"&&$!==null&&typeof k=="object"&&k!==null){const D=Object.keys($)[0];if(D===Object.keys(k)[0]){const O=c.getHandler(D);O&&(P={[D]:O.transform($[D],k[D],h)})}}C.retain(P,s.default.transform(x.attributes,M.attributes,h))}}return C.chop()}transformPosition(d,h=!1){h=!!h;const p=new a.default(this.ops);let m=0;for(;p.hasNext()&&m<=d;){const _=p.peekLength(),C=p.peekType();if(p.next(),C==="delete"){d-=Math.min(_,d-m);continue}else C==="insert"&&(m<d||!h)&&(d+=_);m+=_}return d}}c.Op=o.default,c.OpIterator=a.default,c.AttributeMap=s.default,c.handlers={},e.default=c,n.exports=c,n.exports.default=c}(va,va.exports)),va.exports}var ew=ZE();const ho=q0(ew),$c=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,tw=$c?T.useLayoutEffect:T.useEffect;let nw=class{constructor(e){this.key=e,this.ref={current:null},this.setRefElement=this.setRefElement.bind(this)}setRefElement(e){this.ref={current:e}}};const Np=n=>{const e=document.getElementById("typeahead-menu");if(!e)return;const t=e.getBoundingClientRect();t.top+t.height>window.innerHeight&&e.scrollIntoView({block:"center"}),t.top<0&&e.scrollIntoView({block:"center"}),n.scrollIntoView({block:"nearest"})};function Mp(n,e){const t=n.getBoundingClientRect(),r=e.getBoundingClientRect();return t.top>r.top&&t.top<r.bottom}function rw(n,e,t,r){const[i]=ke();T.useEffect(()=>{if(e!=null&&n!=null){const s=i.getRootElement(),o=s!=null?function(f,d){let h=getComputedStyle(f);const p=h.position==="absolute",m=/(auto|scroll)/;if(h.position==="fixed")return document.body;for(let _=f;_=_.parentElement;)if(h=getComputedStyle(_),(!p||h.position!=="static")&&m.test(h.overflow+h.overflowY+h.overflowX))return _;return document.body}(s):document.body;let a=!1,l=Mp(e,o);const u=function(){a||(window.requestAnimationFrame(function(){t(),a=!1}),a=!0);const f=Mp(e,o);f!==l&&(l=f,r!=null&&r(f))},c=new ResizeObserver(t);return window.addEventListener("resize",t),document.addEventListener("scroll",u,{capture:!0,passive:!0}),c.observe(e),()=>{c.unobserve(e),window.removeEventListener("resize",t),document.removeEventListener("scroll",u,!0)}}},[e,i,r,t,n])}const Op=be("SCROLL_TYPEAHEAD_OPTION_INTO_VIEW_COMMAND");function iw({close:n,editor:e,anchorElementRef:t,resolution:r,options:i,menuRenderFn:s,onSelectOption:o,shouldSplitNodeWithQuery:a=!1,commandPriority:l=Xi,preselectFirstItem:u=!0}){const[c,f]=T.useState(null),d=r.match&&r.match.matchingString;T.useEffect(()=>{u&&f(0)},[d,u]);const h=T.useCallback(m=>{e.update(()=>{const _=r.match!=null&&a?function(C){const v=ne();if(!G(v)||!v.isCollapsed())return null;const x=v.anchor;if(x.type!=="text")return null;const M=x.getNode();if(!M.isSimpleText())return null;const $=x.offset,k=M.getTextContent().slice(0,$),P=C.replaceableString.length,D=$-function(z,w,q){let S=q;for(let H=S;H<=w.length;H++)z.slice(-H)===w.substring(0,H)&&(S=H);return S}(k,C.matchingString,P);if(D<0)return null;let O;return D===0?[O]=M.splitText($):[,O]=M.splitText(D,$),O}(r.match):null;o(m,_,n,r.match?r.match.matchingString:"")})},[e,a,r.match,o,n]),p=T.useCallback(m=>{const _=e.getRootElement();_!==null&&(_.setAttribute("aria-activedescendant","typeahead-item-"+m),f(m))},[e]);return T.useEffect(()=>()=>{const m=e.getRootElement();m!==null&&m.removeAttribute("aria-activedescendant")},[e]),tw(()=>{i===null?f(null):c===null&&u&&p(0)},[i,c,p,u]),T.useEffect(()=>vt(e.registerCommand(Op,({option:m})=>!(!m.ref||m.ref.current==null)&&(Np(m.ref.current),!0),l)),[e,p,l]),T.useEffect(()=>vt(e.registerCommand(Ed,m=>{const _=m;if(i!==null&&i.length){const C=c===null?0:c!==i.length-1?c+1:0;p(C);const v=i[C];v.ref!=null&&v.ref.current&&e.dispatchCommand(Op,{index:C,option:v}),_.preventDefault(),_.stopImmediatePropagation()}return!0},l),e.registerCommand(Cd,m=>{const _=m;if(i!==null&&i.length){const C=c===null?i.length-1:c!==0?c-1:i.length-1;p(C);const v=i[C];v.ref!=null&&v.ref.current&&Np(v.ref.current),_.preventDefault(),_.stopImmediatePropagation()}return!0},l),e.registerCommand(Bl,m=>{const _=m;return _.preventDefault(),_.stopImmediatePropagation(),n(),!0},l),e.registerCommand(kd,m=>{const _=m;return i!==null&&c!==null&&i[c]!=null&&(_.preventDefault(),_.stopImmediatePropagation(),h(i[c]),!0)},l),e.registerCommand(ws,m=>i!==null&&c!==null&&i[c]!=null&&(m!==null&&(m.preventDefault(),m.stopImmediatePropagation()),h(i[c]),!0),l)),[h,n,e,i,c,p,l]),s(t,T.useMemo(()=>({options:i,selectOptionAndCleanUp:h,selectedIndex:c,setHighlightedIndex:f}),[h,c,i]),r.match?r.match.matchingString:"")}function Ip(n,e){e!=null&&(n.className=e),n.setAttribute("aria-label","Typeahead menu"),n.setAttribute("role","listbox"),n.style.display="block",n.style.position="absolute"}function sw({options:n,onWillOpen:e,onClose:t,onOpen:r,onSelectOption:i,menuRenderFn:s,anchorClassName:o,commandPriority:a=Xi,parent:l}){const[u]=ke(),[c,f]=T.useState(null),d=T.useRef(null),h=function(v,x,M,$=$c?document.body:void 0,k=!0){const[P]=ke(),D=$c?document.createElement("div"):null,O=T.useRef(D),z=T.useCallback(()=>{if(O.current===null||$===void 0)return;O.current.style.top=O.current.style.bottom;const q=P.getRootElement(),S=O.current,H=S.firstChild;if(q!==null&&v!==null){const{left:A,top:L,width:j,height:K}=v.getRect(),J=O.current.offsetHeight;if(S.style.top=`${L+J+3+(k?window.pageYOffset:0)}px`,S.style.left=`${A+window.pageXOffset}px`,S.style.height=`${K}px`,S.style.width=`${j}px`,H!==null){H.style.top=`${L}`;const W=H.getBoundingClientRect(),Q=W.height,ie=W.width,te=q.getBoundingClientRect();A+ie>te.right&&(S.style.left=`${te.right-ie+window.pageXOffset}px`),(L+Q>window.innerHeight||L+Q>te.bottom)&&L-te.top>Q+K&&(S.style.top=`${L-Q-K+(k?window.pageYOffset:0)}px`)}S.isConnected||(Ip(S,M),$.append(S)),S.setAttribute("id","typeahead-menu"),q.setAttribute("aria-controls","typeahead-menu")}},[P,v,k,M,$]);T.useEffect(()=>{const q=P.getRootElement();return v!==null&&z(),()=>{q!==null&&q.removeAttribute("aria-controls");const S=O.current;S!==null&&S.isConnected&&(S.remove(),S.removeAttribute("id"))}},[P,z,v]);const w=T.useCallback(q=>{v!==null&&(q||x(null))},[v,x]);return rw(v,O.current,z,w),D!=null&&D===O.current&&(Ip(D,M),$!=null&&$.append(D)),O}(c,f,o,l),p=T.useCallback(()=>{f(null),t!=null&&c!==null&&t()},[t,c]),m=T.useCallback(v=>{f(v),r!=null&&c===null&&r(v)},[r,c]),_=T.useCallback(v=>{v.preventDefault(),e!=null&&e(v);const x=BC(v.target);m({getRect:()=>new DOMRect(v.clientX/x,v.clientY/x,1,1)})},[m,e]),C=T.useCallback(v=>{c!==null&&d.current!=null&&v.target!=null&&Qi(v.target)&&!d.current.contains(v.target)&&p()},[p,c]);return T.useEffect(()=>{const v=u.getRootElement();if(v)return v.addEventListener("contextmenu",_),()=>v.removeEventListener("contextmenu",_)},[u,_]),T.useEffect(()=>(document.addEventListener("click",C),()=>document.removeEventListener("click",C)),[u,C]),h.current===null||c===null||u===null?null:I.jsx(iw,{close:p,resolution:c,editor:u,anchorElementRef:h,options:n,menuRenderFn:(v,x)=>s(v,x,{setMenuRef:M=>{d.current=M}}),onSelectOption:i,commandPriority:a})}function ow({defaultSelection:n}){const[e]=ke();return T.useEffect(()=>{e.focus(()=>{const t=document.activeElement,r=e.getRootElement();r===null||t!==null&&r.contains(t)||r.focus({preventScroll:!0})},{defaultSelection:n})},[n,e]),null}const aw=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?T.useLayoutEffect:T.useEffect;function lw({onClear:n}){const[e]=ke();return aw(()=>e.registerCommand(Td,t=>(e.update(()=>{if(n==null){const r=Ne(),i=ne(),s=kn();r.clear(),r.append(s),i!==null&&s.select(),G(i)&&(i.format=0)}else n()}),!0),ye),[e,n]),null}const Rp=[["Cat","rgb(125, 50, 0)"],["Dog","rgb(100, 0, 0)"],["Rabbit","rgb(150, 0, 0)"],["Frog","rgb(200, 0, 0)"],["Fox","rgb(200, 75, 0)"],["Hedgehog","rgb(0, 75, 0)"],["Pigeon","rgb(0, 125, 0)"],["Squirrel","rgb(75, 100, 0)"],["Bear","rgb(125, 100, 0)"],["Tiger","rgb(0, 0, 150)"],["Leopard","rgb(0, 0, 200)"],["Zebra","rgb(0, 0, 250)"],["Wolf","rgb(0, 100, 150)"],["Owl","rgb(0, 100, 100)"],["Gull","rgb(100, 0, 100)"],["Squid","rgb(150, 0, 150)"]],Pp=Rp[Math.floor(Math.random()*Rp.length)],uw=T.createContext({clientID:0,color:Pp[1],isCollabActive:!1,name:Pp[0],yjsDocMap:new Map});function q_(n,e){return T.useContext(uw)}const cw=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?T.useLayoutEffect:T.useEffect;function dw({ignoreHistoryMergeTagChange:n=!0,ignoreSelectionChange:e=!1,onChange:t}){const[r]=ke();return cw(()=>{if(t)return r.registerUpdateListener(({editorState:i,dirtyElements:s,dirtyLeaves:o,prevEditorState:a,tags:l})=>{e&&s.size===0&&o.size===0||n&&l.has(Ti)||a.isEmpty()||t(i,r,l)})},[r,n,e,t]),null}const zs=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,fw=zs&&"documentMode"in document?document.documentMode:null,hw=!(!zs||!("InputEvent"in window)||fw)&&"getTargetRanges"in new window.InputEvent("input"),pw=zs&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),Lp=zs&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,gw=zs&&/^(?=.*Chrome).*/i.test(navigator.userAgent),mw=zs&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!gw;function $p(n,e){e.update(()=>{if(n!==null){const t=Ar(n,KeyboardEvent)?null:n.clipboardData,r=ne();if(r!==null&&t!=null){n.preventDefault();const i=l_(e);i!==null&&t.setData("text/html",i),t.setData("text/plain",r.getTextContent())}}})}function yw(n){return vt(n.registerCommand(ur,e=>{const t=ne();return!!G(t)&&(t.deleteCharacter(e),!0)},ye),n.registerCommand(Cs,e=>{const t=ne();return!!G(t)&&(t.deleteWord(e),!0)},ye),n.registerCommand(Es,e=>{const t=ne();return!!G(t)&&(t.deleteLine(e),!0)},ye),n.registerCommand(ki,e=>{const t=ne();if(!G(t))return!1;if(typeof e=="string")t.insertText(e);else{const r=e.dataTransfer;if(r!=null)Zh(r,t);else{const i=e.data;i&&t.insertText(i)}}return!0},ye),n.registerCommand(ul,()=>{const e=ne();return!!G(e)&&(e.removeText(),!0)},ye),n.registerCommand(Yr,e=>{const t=ne();return!!G(t)&&(t.insertLineBreak(e),!0)},ye),n.registerCommand(So,()=>{const e=ne();return!!G(e)&&(e.insertLineBreak(),!0)},ye),n.registerCommand(vd,e=>{const t=ne();if(!G(t))return!1;const r=e,i=r.shiftKey;return!!bl(t,!0)&&(r.preventDefault(),vl(t,i,!0),!0)},ye),n.registerCommand(bd,e=>{const t=ne();if(!G(t))return!1;const r=e,i=r.shiftKey;return!!bl(t,!1)&&(r.preventDefault(),vl(t,i,!1),!0)},ye),n.registerCommand(wd,e=>{const t=ne();return!!G(t)&&(!Lp||navigator.language!=="ko-KR")&&(e.preventDefault(),n.dispatchCommand(ur,!0))},ye),n.registerCommand(xd,e=>{const t=ne();return!!G(t)&&(e.preventDefault(),n.dispatchCommand(ur,!1))},ye),n.registerCommand(ws,e=>{const t=ne();if(!G(t))return!1;if(e!==null){if((Lp||pw||mw)&&hw)return!1;e.preventDefault()}return n.dispatchCommand(Yr,!1)},ye),n.registerCommand(cl,()=>(Oy(),!0),ye),n.registerCommand(Gi,e=>{const t=ne();return!!G(t)&&($p(e,n),!0)},ye),n.registerCommand(Ls,e=>{const t=ne();return!!G(t)&&(function(r,i){$p(r,i),i.update(()=>{const s=ne();G(s)&&s.removeText()})}(e,n),!0)},ye),n.registerCommand(Ji,e=>{const t=ne();return!!G(t)&&(function(r,i){r.preventDefault(),i.update(()=>{const s=ne(),o=Ar(r,ClipboardEvent)?r.clipboardData:null;o!=null&&G(s)&&Zh(o,s)},{tag:Cy})}(e,n),!0)},ye),n.registerCommand(ql,e=>{const t=ne();return!!G(t)&&(e.preventDefault(),!0)},ye),n.registerCommand(Sd,e=>{const t=ne();return!!G(t)&&(e.preventDefault(),!0)},ye))}const Fc=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?T.useLayoutEffect:T.useEffect;function Fp(n){return n.getEditorState().read(ef(n.isComposing()))}function _w({contentEditable:n,placeholder:e=null,ErrorBoundary:t}){const[r]=ke(),i=function(s,o){const[a,l]=T.useState(()=>s.getDecorators());return Fc(()=>s.registerDecoratorListener(u=>{En.flushSync(()=>{l(u)})}),[s]),T.useEffect(()=>{l(s.getDecorators())},[s]),T.useMemo(()=>{const u=[],c=Object.keys(a);for(let f=0;f<c.length;f++){const d=c[f],h=I.jsx(o,{onError:m=>s._onError(m),children:I.jsx(T.Suspense,{fallback:null,children:a[d]})}),p=s.getElementByKey(d);p!==null&&u.push(En.createPortal(h,p,d))}return u},[o,a,s])}(r,t);return function(s){Fc(()=>vt(yw(s),L_(s)),[s])}(r),I.jsxs(I.Fragment,{children:[n,I.jsx(bw,{content:e}),i]})}function bw({content:n}){const[e]=ke(),t=function(i){const[s,o]=T.useState(()=>Fp(i));return Fc(()=>{function a(){const l=Fp(i);o(l)}return a(),vt(i.registerUpdateListener(()=>{a()}),i.registerEditableListener(()=>{a()}))},[i]),s}(e),r=P_();return t?typeof n=="function"?n(r):n:null}const cr=()=>new Map,Bc=n=>{const e=cr();return n.forEach((t,r)=>{e.set(r,t)}),e},Hs=(n,e,t)=>{let r=n.get(e);return r===void 0&&n.set(e,r=t()),r},vw=(n,e)=>{const t=[];for(const[r,i]of n)t.push(e(i,r));return t},Cw=(n,e)=>{for(const[t,r]of n)if(e(r,t))return!0;return!1},Ts=()=>new Set,zu=n=>n[n.length-1],As=Array.from,Ew=Array.isArray;class ww{constructor(){this._observers=cr()}on(e,t){return Hs(this._observers,e,Ts).add(t),t}once(e,t){const r=(...i)=>{this.off(e,r),t(...i)};this.on(e,r)}off(e,t){const r=this._observers.get(e);r!==void 0&&(r.delete(t),r.size===0&&this._observers.delete(e))}emit(e,t){return As((this._observers.get(e)||cr()).values()).forEach(r=>r(...t))}destroy(){this._observers=cr()}}const qi=Math.floor,Va=Math.abs,j_=(n,e)=>n<e?n:e,Ks=(n,e)=>n>e?n:e,xw=n=>n!==0?n<0:1/n<0,Bp=1,qp=2,Hu=4,Ku=8,kw=32,U_=64,El=128,Sw=31,jp=63,vo=127,Tw=2147483647,Aw=Number.isInteger||(n=>typeof n=="number"&&isFinite(n)&&qi(n)===n),Dw=n=>n.toLowerCase(),Nw=/^\s*/g,Mw=n=>n.replace(Nw,""),Ow=/([A-Z])/g,Up=(n,e)=>Mw(n.replace(Ow,t=>`${e}${Dw(t)}`)),Iw=n=>{const e=unescape(encodeURIComponent(n)),t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.codePointAt(i);return r},Do=typeof TextEncoder<"u"?new TextEncoder:null,Rw=n=>Do.encode(n),Pw=Do?Rw:Iw;let Vu=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Vu&&Vu.decode(new Uint8Array).length===1&&(Vu=null);class Ko{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const tf=()=>new Ko,Lw=n=>{let e=n.cpos;for(let t=0;t<n.bufs.length;t++)e+=n.bufs[t].length;return e},Dr=n=>{const e=new Uint8Array(Lw(n));let t=0;for(let r=0;r<n.bufs.length;r++){const i=n.bufs[r];e.set(i,t),t+=i.length}return e.set(new Uint8Array(n.cbuf.buffer,0,n.cpos),t),e},$w=(n,e)=>{const t=n.cbuf.length;t-n.cpos<e&&(n.bufs.push(new Uint8Array(n.cbuf.buffer,0,n.cpos)),n.cbuf=new Uint8Array(Ks(t,e)*2),n.cpos=0)},yt=(n,e)=>{const t=n.cbuf.length;n.cpos===t&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(t*2),n.cpos=0),n.cbuf[n.cpos++]=e},qc=yt,Ue=(n,e)=>{for(;e>vo;)yt(n,El|vo&e),e=qi(e/128);yt(n,vo&e)},nf=(n,e)=>{const t=xw(e);for(t&&(e=-e),yt(n,(e>jp?El:0)|(t?U_:0)|jp&e),e=qi(e/64);e>0;)yt(n,(e>vo?El:0)|vo&e),e=qi(e/128)},jc=new Uint8Array(3e4),Fw=jc.length/3,Bw=(n,e)=>{if(e.length<Fw){const t=Do.encodeInto(e,jc).written||0;Ue(n,t);for(let r=0;r<t;r++)yt(n,jc[r])}else vn(n,Pw(e))},qw=(n,e)=>{const t=unescape(encodeURIComponent(e)),r=t.length;Ue(n,r);for(let i=0;i<r;i++)yt(n,t.codePointAt(i))},ms=Do&&Do.encodeInto?Bw:qw,rf=(n,e)=>{const t=n.cbuf.length,r=n.cpos,i=j_(t-r,e.length),s=e.length-i;n.cbuf.set(e.subarray(0,i),r),n.cpos+=i,s>0&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(Ks(t*2,s)),n.cbuf.set(e.subarray(i)),n.cpos=s)},vn=(n,e)=>{Ue(n,e.byteLength),rf(n,e)},sf=(n,e)=>{$w(n,e);const t=new DataView(n.cbuf.buffer,n.cpos,e);return n.cpos+=e,t},jw=(n,e)=>sf(n,4).setFloat32(0,e,!1),Uw=(n,e)=>sf(n,8).setFloat64(0,e,!1),Ww=(n,e)=>sf(n,8).setBigInt64(0,e,!1),Wp=new DataView(new ArrayBuffer(4)),zw=n=>(Wp.setFloat32(0,n),Wp.getFloat32(0)===n),No=(n,e)=>{switch(typeof e){case"string":yt(n,119),ms(n,e);break;case"number":Aw(e)&&Va(e)<=Tw?(yt(n,125),nf(n,e)):zw(e)?(yt(n,124),jw(n,e)):(yt(n,123),Uw(n,e));break;case"bigint":yt(n,122),Ww(n,e);break;case"object":if(e===null)yt(n,126);else if(Ew(e)){yt(n,117),Ue(n,e.length);for(let t=0;t<e.length;t++)No(n,e[t])}else if(e instanceof Uint8Array)yt(n,116),vn(n,e);else{yt(n,118);const t=Object.keys(e);Ue(n,t.length);for(let r=0;r<t.length;r++){const i=t[r];ms(n,i),No(n,e[i])}}break;case"boolean":yt(n,e?120:121);break;default:yt(n,127)}};class zp extends Ko{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Ue(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const Hp=n=>{n.count>0&&(nf(n.encoder,n.count===1?n.s:-n.s),n.count>1&&Ue(n.encoder,n.count-2))};class Ja{constructor(){this.encoder=new Ko,this.s=0,this.count=0}write(e){this.s===e?this.count++:(Hp(this),this.count=1,this.s=e)}toUint8Array(){return Hp(this),Dr(this.encoder)}}const Kp=n=>{if(n.count>0){const e=n.diff*2+(n.count===1?0:1);nf(n.encoder,e),n.count>1&&Ue(n.encoder,n.count-2)}};class Ju{constructor(){this.encoder=new Ko,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(Kp(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return Kp(this),Dr(this.encoder)}}class Hw{constructor(){this.sarr=[],this.s="",this.lensE=new Ja}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new Ko;return this.sarr.push(this.s),this.s="",ms(e,this.sarr.join("")),rf(e,this.lensE.toUint8Array()),Dr(e)}}const Ds=n=>new Error(n),dr=()=>{throw Ds("Method unimplemented")},ji=()=>{throw Ds("Unexpected case")},Kw=crypto.getRandomValues.bind(crypto),W_=()=>Kw(new Uint32Array(1))[0],Vw="10000000-1000-4000-8000"+-1e11,Jw=()=>Vw.replace(/[018]/g,n=>(n^W_()&15>>n/4).toString(16)),Vp=n=>new Promise(n);Promise.all.bind(Promise);const Jp=n=>n===void 0?null:n;class Gw{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let z_=new Gw,Yw=!0;try{typeof localStorage<"u"&&localStorage&&(z_=localStorage,Yw=!1)}catch{}const Xw=z_,Qw=Object.assign,Zw=Object.keys,ex=(n,e)=>{for(const t in n)e(n[t],t)},Gp=n=>Zw(n).length,tx=n=>{for(const e in n)return!1;return!0},nx=(n,e)=>{for(const t in n)if(!e(n[t],t))return!1;return!0},rx=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),ix=(n,e)=>n===e||Gp(n)===Gp(e)&&nx(n,(t,r)=>(t!==void 0||rx(e,r))&&e[r]===t),sx=Object.freeze,H_=n=>{for(const e in n){const t=n[e];(typeof t=="object"||typeof t=="function")&&H_(n[e])}return sx(n)},of=(n,e,t=0)=>{try{for(;t<n.length;t++)n[t](...e)}finally{t<n.length&&of(n,e,t+1)}},ox=(n,e)=>e.includes(n);var K_={};const Mo=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let rr;const ax=()=>{if(rr===void 0)if(Mo){rr=cr();const n=process.argv;let e=null;for(let t=0;t<n.length;t++){const r=n[t];r[0]==="-"?(e!==null&&rr.set(e,""),e=r):e!==null&&(rr.set(e,r),e=null)}e!==null&&rr.set(e,"")}else typeof location=="object"?(rr=cr(),(location.search||"?").slice(1).split("&").forEach(n=>{if(n.length!==0){const[e,t]=n.split("=");rr.set(`--${Up(e,"-")}`,t),rr.set(`-${Up(e,"-")}`,t)}})):rr=cr();return rr},Uc=n=>ax().has(n),wl=n=>Jp(Mo?K_[n.toUpperCase().replaceAll("-","_")]:Xw.getItem(n)),V_=n=>Uc("--"+n)||wl(n)!==null;V_("production");const lx=Mo&&ox(K_.FORCE_COLOR,["true","1","2"]),ux=lx||!Uc("--no-colors")&&!V_("no-color")&&(!Mo||process.stdout.isTTY)&&(!Mo||Uc("--color")||wl("COLORTERM")!==null||(wl("TERM")||"").includes("color"));class cx{constructor(e,t){this.left=e,this.right=t}}const Cr=(n,e)=>new cx(n,e);typeof DOMParser<"u"&&new DOMParser;const dx=n=>vw(n,(e,t)=>`${t}:${e};`).join(""),Lr=Symbol,J_=Lr(),G_=Lr(),fx=Lr(),hx=Lr(),px=Lr(),Y_=Lr(),gx=Lr(),af=Lr(),mx=Lr(),yx=n=>{var i;n.length===1&&((i=n[0])==null?void 0:i.constructor)===Function&&(n=n[0]());const e=[],t=[];let r=0;for(;r<n.length;r++){const s=n[r];if(s===void 0)break;if(s.constructor===String||s.constructor===Number)e.push(s);else if(s.constructor===Object)break}for(r>0&&t.push(e.join(""));r<n.length;r++){const s=n[r];s instanceof Symbol||t.push(s)}return t},_x={[J_]:Cr("font-weight","bold"),[G_]:Cr("font-weight","normal"),[fx]:Cr("color","blue"),[px]:Cr("color","green"),[hx]:Cr("color","grey"),[Y_]:Cr("color","red"),[gx]:Cr("color","purple"),[af]:Cr("color","orange"),[mx]:Cr("color","black")},bx=n=>{var o;n.length===1&&((o=n[0])==null?void 0:o.constructor)===Function&&(n=n[0]());const e=[],t=[],r=cr();let i=[],s=0;for(;s<n.length;s++){const a=n[s],l=_x[a];if(l!==void 0)r.set(l.left,l.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const u=dx(r);s>0||u.length>0?(e.push("%c"+a),t.push(u)):e.push(a)}else break}}for(s>0&&(i=t,i.unshift(e.join("")));s<n.length;s++){const a=n[s];a instanceof Symbol||i.push(a)}return i},X_=ux?bx:yx,vx=(...n)=>{console.log(...X_(n)),Q_.forEach(e=>e.print(n))},Cx=(...n)=>{console.warn(...X_(n)),n.unshift(af),Q_.forEach(e=>e.print(n))},Q_=Ts(),Z_=n=>({[Symbol.iterator](){return this},next:n}),Ex=(n,e)=>Z_(()=>{let t;do t=n.next();while(!t.done&&!e(t.value));return t}),Gu=(n,e)=>Z_(()=>{const{done:t,value:r}=n.next();return{done:t,value:t?void 0:e(r)}});class wx{constructor(e,t){this.clock=e,this.len=t}}class xx{constructor(){this.clients=new Map}}const eb=(n,e,t)=>e.clients.forEach((r,i)=>{const s=n.doc.store.clients.get(i);if(s!=null){const o=s[s.length-1],a=o.id.clock+o.length;for(let l=0,u=r[l];l<r.length&&u.clock<a;u=r[++l])ab(n,s,u.clock,u.len,t)}}),kx=(n,e)=>{let t=0,r=n.length-1;for(;t<=r;){const i=qi((t+r)/2),s=n[i],o=s.clock;if(o<=e){if(e<o+s.len)return i;t=i+1}else r=i-1}return null},tb=(n,e)=>{const t=n.clients.get(e.client);return t!==void 0&&kx(t,e.clock)!==null},nb=n=>{n.clients.forEach(e=>{e.sort((i,s)=>i.clock-s.clock);let t,r;for(t=1,r=1;t<e.length;t++){const i=e[r-1],s=e[t];i.clock+i.len>=s.clock?i.len=Ks(i.len,s.clock+s.len-i.clock):(r<t&&(e[r]=s),r++)}e.length=r})},rb=(n,e,t,r)=>{Hs(n.clients,e,()=>[]).push(new wx(t,r))},Sx=(n,e)=>{Ue(n.restEncoder,e.clients.size),As(e.clients.entries()).sort((t,r)=>r[0]-t[0]).forEach(([t,r])=>{n.resetDsCurVal(),Ue(n.restEncoder,t);const i=r.length;Ue(n.restEncoder,i);for(let s=0;s<i;s++){const o=r[s];n.writeDsClock(o.clock),n.writeDsLen(o.len)}})},ib=W_;class Vo extends ww{constructor({guid:e=Jw(),collectionid:t=null,gc:r=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:o=!1,shouldLoad:a=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=ib(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new Lx,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=o,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=Vp(u=>{this.on("load",()=>{this.isLoaded=!0,u(this)})});const l=()=>Vp(u=>{const c=f=>{(f===void 0||f===!0)&&(this.off("sync",c),u())};this.on("sync",c)});this.on("sync",u=>{u===!1&&this.isSynced&&(this.whenSynced=l()),this.isSynced=u===void 0||u===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=l()}load(){const e=this._item;e!==null&&!this.shouldLoad&&He(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(As(this.subdocs).map(e=>e.guid))}transact(e,t=null){return He(this,e,t)}get(e,t=Nt){const r=Hs(this.share,e,()=>{const s=new t;return s._integrate(this,null),s}),i=r.constructor;if(t!==Nt&&i!==t)if(i===Nt){const s=new t;s._map=r._map,r._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=s}),s._start=r._start;for(let o=s._start;o!==null;o=o.right)o.parent=s;return s._length=r._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return r}getArray(e=""){return this.get(e,Mi)}getText(e=""){return this.get(e,Sl)}getMap(e=""){return this.get(e,Ns)}getXmlElement(e=""){return this.get(e,Ro)}getXmlFragment(e=""){return this.get(e,Ms)}toJSON(){const e={};return this.share.forEach((t,r)=>{e[r]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,As(this.subdocs).forEach(t=>t.destroy());const e=this._item;if(e!==null){this._item=null;const t=e.content;t.doc=new Vo({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,He(e.parent.doc,r=>{const i=t.doc;e.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class Tx{constructor(){this.restEncoder=tf()}toUint8Array(){return Dr(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Ue(this.restEncoder,e)}writeDsLen(e){Ue(this.restEncoder,e)}}class Ax extends Tx{writeLeftID(e){Ue(this.restEncoder,e.client),Ue(this.restEncoder,e.clock)}writeRightID(e){Ue(this.restEncoder,e.client),Ue(this.restEncoder,e.clock)}writeClient(e){Ue(this.restEncoder,e)}writeInfo(e){qc(this.restEncoder,e)}writeString(e){ms(this.restEncoder,e)}writeParentInfo(e){Ue(this.restEncoder,e?1:0)}writeTypeRef(e){Ue(this.restEncoder,e)}writeLen(e){Ue(this.restEncoder,e)}writeAny(e){No(this.restEncoder,e)}writeBuf(e){vn(this.restEncoder,e)}writeJSON(e){ms(this.restEncoder,JSON.stringify(e))}writeKey(e){ms(this.restEncoder,e)}}class Dx{constructor(){this.restEncoder=tf(),this.dsCurrVal=0}toUint8Array(){return Dr(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,Ue(this.restEncoder,t)}writeDsLen(e){e===0&&ji(),Ue(this.restEncoder,e-1),this.dsCurrVal+=e}}class Nx extends Dx{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Ju,this.clientEncoder=new Ja,this.leftClockEncoder=new Ju,this.rightClockEncoder=new Ju,this.infoEncoder=new zp(qc),this.stringEncoder=new Hw,this.parentInfoEncoder=new zp(qc),this.typeRefEncoder=new Ja,this.lenEncoder=new Ja}toUint8Array(){const e=tf();return Ue(e,0),vn(e,this.keyClockEncoder.toUint8Array()),vn(e,this.clientEncoder.toUint8Array()),vn(e,this.leftClockEncoder.toUint8Array()),vn(e,this.rightClockEncoder.toUint8Array()),vn(e,Dr(this.infoEncoder)),vn(e,this.stringEncoder.toUint8Array()),vn(e,Dr(this.parentInfoEncoder)),vn(e,this.typeRefEncoder.toUint8Array()),vn(e,this.lenEncoder.toUint8Array()),rf(e,Dr(this.restEncoder)),Dr(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){No(this.restEncoder,e)}writeBuf(e){vn(this.restEncoder,e)}writeJSON(e){No(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const Mx=(n,e,t,r)=>{r=Ks(r,e[0].id.clock);const i=Or(e,r);Ue(n.restEncoder,e.length-i),n.writeClient(t),Ue(n.restEncoder,r);const s=e[i];s.write(n,r-s.id.clock);for(let o=i+1;o<e.length;o++)e[o].write(n,0)},Ox=(n,e,t)=>{const r=new Map;t.forEach((i,s)=>{sn(e,s)>i&&r.set(s,i)}),lf(e).forEach((i,s)=>{t.has(s)||r.set(s,0)}),Ue(n.restEncoder,r.size),As(r.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{Mx(n,e.clients.get(i),i,s)})},Ix=(n,e)=>Ox(n,e.doc.store,e.beforeState);class Rx{constructor(){this.l=[]}}const Yp=()=>new Rx,Xp=(n,e)=>n.l.push(e),Qp=(n,e)=>{const t=n.l,r=t.length;n.l=t.filter(i=>e!==i),r===n.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},sb=(n,e,t)=>of(n.l,[e,t]);class Ga{constructor(e,t){this.client=e,this.clock=t}}const xa=(n,e)=>n===e||n!==null&&e!==null&&n.client===e.client&&n.clock===e.clock,Ze=(n,e)=>new Ga(n,e),Px=n=>{for(const[e,t]of n.doc.share.entries())if(t===n)return e;throw ji()},cs=(n,e)=>e===void 0?!n.deleted:e.sv.has(n.id.client)&&(e.sv.get(n.id.client)||0)>n.id.clock&&!tb(e.ds,n.id),Wc=(n,e)=>{const t=Hs(n.meta,Wc,Ts),r=n.doc.store;t.has(e)||(e.sv.forEach((i,s)=>{i<sn(r,s)&&ri(n,Ze(s,i))}),eb(n,e.ds,i=>{}),t.add(e))};class Lx{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const lf=n=>{const e=new Map;return n.clients.forEach((t,r)=>{const i=t[t.length-1];e.set(r,i.id.clock+i.length)}),e},sn=(n,e)=>{const t=n.clients.get(e);if(t===void 0)return 0;const r=t[t.length-1];return r.id.clock+r.length},ob=(n,e)=>{let t=n.clients.get(e.id.client);if(t===void 0)t=[],n.clients.set(e.id.client,t);else{const r=t[t.length-1];if(r.id.clock+r.length!==e.id.clock)throw ji()}t.push(e)},Or=(n,e)=>{let t=0,r=n.length-1,i=n[r],s=i.id.clock;if(s===e)return r;let o=qi(e/(s+i.length-1)*r);for(;t<=r;){if(i=n[o],s=i.id.clock,s<=e){if(e<s+i.length)return o;t=o+1}else r=o-1;o=qi((t+r)/2)}throw ji()},$x=(n,e)=>{const t=n.clients.get(e.client);return t[Or(t,e.clock)]},Yu=$x,zc=(n,e,t)=>{const r=Or(e,t),i=e[r];return i.id.clock<t&&i instanceof Ft?(e.splice(r+1,0,Sb(n,i,t-i.id.clock)),r+1):r},ri=(n,e)=>{const t=n.doc.store.clients.get(e.client);return t[zc(n,t,e.clock)]},Zp=(n,e,t)=>{const r=e.clients.get(t.client),i=Or(r,t.clock),s=r[i];return t.clock!==s.id.clock+s.length-1&&s.constructor!==zr&&r.splice(i+1,0,Sb(n,s,t.clock-s.id.clock+1)),s},Fx=(n,e,t)=>{const r=n.clients.get(e.id.client);r[Or(r,e.id.clock)]=t},ab=(n,e,t,r,i)=>{if(r===0)return;const s=t+r;let o=zc(n,e,t),a;do a=e[o++],s<a.id.clock+a.length&&zc(n,e,s),i(a);while(o<e.length&&e[o].id.clock<s)};class Bx{constructor(e,t,r){this.doc=e,this.deleteSet=new xx,this.beforeState=lf(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const eg=(n,e)=>e.deleteSet.clients.size===0&&!Cw(e.afterState,(t,r)=>e.beforeState.get(r)!==t)?!1:(nb(e.deleteSet),Ix(n,e),Sx(n,e.deleteSet),!0),tg=(n,e,t)=>{const r=e._item;(r===null||r.id.clock<(n.beforeState.get(r.id.client)||0)&&!r.deleted)&&Hs(n.changed,e,Ts).add(t)},Ya=(n,e)=>{let t=n[e],r=n[e-1],i=e;for(;i>0;t=r,r=n[--i-1]){if(r.deleted===t.deleted&&r.constructor===t.constructor&&r.mergeWith(t)){t instanceof Ft&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,r);continue}break}const s=e-i;return s&&n.splice(e+1-s,s),s},qx=(n,e,t)=>{for(const[r,i]of n.clients.entries()){const s=e.clients.get(r);for(let o=i.length-1;o>=0;o--){const a=i[o],l=a.clock+a.len;for(let u=Or(s,a.clock),c=s[u];u<s.length&&c.id.clock<l;c=s[++u]){const f=s[u];if(a.clock+a.len<=f.id.clock)break;f instanceof Ft&&f.deleted&&!f.keep&&t(f)&&f.gc(e,!1)}}}},jx=(n,e)=>{n.clients.forEach((t,r)=>{const i=e.clients.get(r);for(let s=t.length-1;s>=0;s--){const o=t[s],a=j_(i.length-1,1+Or(i,o.clock+o.len-1));for(let l=a,u=i[l];l>0&&u.id.clock>=o.clock;u=i[l])l-=1+Ya(i,l)}})},lb=(n,e)=>{if(e<n.length){const t=n[e],r=t.doc,i=r.store,s=t.deleteSet,o=t._mergeStructs;try{nb(s),t.afterState=lf(t.doc.store),r.emit("beforeObserverCalls",[t,r]);const a=[];t.changed.forEach((l,u)=>a.push(()=>{(u._item===null||!u._item.deleted)&&u._callObserver(t,l)})),a.push(()=>{t.changedParentTypes.forEach((l,u)=>{u._dEH.l.length>0&&(u._item===null||!u._item.deleted)&&(l=l.filter(c=>c.target._item===null||!c.target._item.deleted),l.forEach(c=>{c.currentTarget=u,c._path=null}),l.sort((c,f)=>c.path.length-f.path.length),sb(u._dEH,l,t))})}),a.push(()=>r.emit("afterTransaction",[t,r])),of(a,[]),t._needFormattingCleanup&&Qx(t)}finally{r.gc&&qx(s,i,r.gcFilter),jx(s,i),t.afterState.forEach((c,f)=>{const d=t.beforeState.get(f)||0;if(d!==c){const h=i.clients.get(f),p=Ks(Or(h,d),1);for(let m=h.length-1;m>=p;)m-=1+Ya(h,m)}});for(let c=o.length-1;c>=0;c--){const{client:f,clock:d}=o[c].id,h=i.clients.get(f),p=Or(h,d);p+1<h.length&&Ya(h,p+1)>1||p>0&&Ya(h,p)}if(!t.local&&t.afterState.get(r.clientID)!==t.beforeState.get(r.clientID)&&(vx(af,J_,"[yjs] ",G_,Y_,"Changed the client-id because another client seems to be using it."),r.clientID=ib()),r.emit("afterTransactionCleanup",[t,r]),r._observers.has("update")){const c=new Ax;eg(c,t)&&r.emit("update",[c.toUint8Array(),t.origin,r,t])}if(r._observers.has("updateV2")){const c=new Nx;eg(c,t)&&r.emit("updateV2",[c.toUint8Array(),t.origin,r,t])}const{subdocsAdded:a,subdocsLoaded:l,subdocsRemoved:u}=t;(a.size>0||u.size>0||l.size>0)&&(a.forEach(c=>{c.clientID=r.clientID,c.collectionid==null&&(c.collectionid=r.collectionid),r.subdocs.add(c)}),u.forEach(c=>r.subdocs.delete(c)),r.emit("subdocs",[{loaded:l,added:a,removed:u},r,t]),u.forEach(c=>c.destroy())),n.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,n])):lb(n,e+1)}}},He=(n,e,t=null,r=!0)=>{const i=n._transactionCleanups;let s=!1,o=null;n._transaction===null&&(s=!0,n._transaction=new Bx(n,t,r),i.push(n._transaction),i.length===1&&n.emit("beforeAllTransactions",[n]),n.emit("beforeTransaction",[n._transaction,n]));try{o=e(n._transaction)}finally{if(s){const a=n._transaction===i[0];n._transaction=null,a&&lb(i,0)}}return o},ng="You must not compute changes after the event-handler fired.";class Xl{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Ux(this.currentTarget,this.target))}deletes(e){return tb(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ds(ng);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(i=>{if(i!==null){const s=t._map.get(i);let o,a;if(this.adds(s)){let l=s.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(s))if(l!==null&&this.deletes(l))o="delete",a=zu(l.content.getContent());else return;else l!==null&&this.deletes(l)?(o="update",a=zu(l.content.getContent())):(o="add",a=void 0)}else if(this.deletes(s))o="delete",a=zu(s.content.getContent());else return;e.set(i,{action:o,oldValue:a})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ds(ng);const t=this.target,r=Ts(),i=Ts(),s=[];if(e={added:r,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(t).has(null)){let a=null;const l=()=>{a&&s.push(a)};for(let u=t._start;u!==null;u=u.right)u.deleted?this.deletes(u)&&!this.adds(u)&&((a===null||a.delete===void 0)&&(l(),a={delete:0}),a.delete+=u.length,i.add(u)):this.adds(u)?((a===null||a.insert===void 0)&&(l(),a={insert:[]}),a.insert=a.insert.concat(u.content.getContent()),r.add(u)):((a===null||a.retain===void 0)&&(l(),a={retain:0}),a.retain+=u.length);a!==null&&a.retain===void 0&&l()}this._changes=e}return e}}const Ux=(n,e)=>{const t=[];for(;e._item!==null&&e!==n;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let r=0,i=e._item.parent._start;for(;i!==e._item&&i!==null;)!i.deleted&&i.countable&&(r+=i.length),i=i.right;t.unshift(r)}e=e._item.parent}return t},qt=()=>{Cx("Invalid access: Add Yjs type to a document before reading data.")},ub=80;let uf=0;class Wx{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=uf++}}const zx=n=>{n.timestamp=uf++},cb=(n,e,t)=>{n.p.marker=!1,n.p=e,e.marker=!0,n.index=t,n.timestamp=uf++},Hx=(n,e,t)=>{if(n.length>=ub){const r=n.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return cb(r,e,t),r}else{const r=new Wx(e,t);return n.push(r),r}},Ql=(n,e)=>{if(n._start===null||e===0||n._searchMarker===null)return null;const t=n._searchMarker.length===0?null:n._searchMarker.reduce((s,o)=>Va(e-s.index)<Va(e-o.index)?s:o);let r=n._start,i=0;for(t!==null&&(r=t.p,i=t.index,zx(t));r.right!==null&&i<e;){if(!r.deleted&&r.countable){if(e<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>e;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return t!==null&&Va(t.index-i)<r.parent.length/ub?(cb(t,r,i),t):Hx(n._searchMarker,r,i)},Oo=(n,e,t)=>{for(let r=n.length-1;r>=0;r--){const i=n[r];if(t>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){n.splice(r,1);continue}i.p=s,s.marker=!0}(e<i.index||t>0&&e===i.index)&&(i.index=Ks(e,i.index+t))}},Zl=(n,e,t)=>{const r=n,i=e.changedParentTypes;for(;Hs(i,n,()=>[]).push(t),n._item!==null;)n=n._item.parent;sb(r._eH,t,e)};class Nt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Yp(),this._dEH=Yp(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw dr()}clone(){throw dr()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){Xp(this._eH,e)}observeDeep(e){Xp(this._dEH,e)}unobserve(e){Qp(this._eH,e)}unobserveDeep(e){Qp(this._dEH,e)}toJSON(){}}const db=(n,e,t)=>{n.doc??qt(),e<0&&(e=n._length+e),t<0&&(t=n._length+t);let r=t-e;const i=[];let s=n._start;for(;s!==null&&r>0;){if(s.countable&&!s.deleted){const o=s.content.getContent();if(o.length<=e)e-=o.length;else{for(let a=e;a<o.length&&r>0;a++)i.push(o[a]),r--;e=0}}s=s.right}return i},fb=n=>{n.doc??qt();const e=[];let t=n._start;for(;t!==null;){if(t.countable&&!t.deleted){const r=t.content.getContent();for(let i=0;i<r.length;i++)e.push(r[i])}t=t.right}return e},Io=(n,e)=>{let t=0,r=n._start;for(n.doc??qt();r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let s=0;s<i.length;s++)e(i[s],t++,n)}r=r.right}},hb=(n,e)=>{const t=[];return Io(n,(r,i)=>{t.push(e(r,i,n))}),t},Kx=n=>{let e=n._start,t=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),r=0,e=e.right}const i=t[r++];return t.length<=r&&(t=null),{done:!1,value:i}}}},pb=(n,e)=>{n.doc??qt();const t=Ql(n,e);let r=n._start;for(t!==null&&(r=t.p,e-=t.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},xl=(n,e,t,r)=>{let i=t;const s=n.doc,o=s.clientID,a=s.store,l=t===null?e._start:t.right;let u=[];const c=()=>{u.length>0&&(i=new Ft(Ze(o,sn(a,o)),i,i&&i.lastId,l,l&&l.id,e,null,new Os(u)),i.integrate(n,0),u=[])};r.forEach(f=>{if(f===null)u.push(f);else switch(f.constructor){case Number:case Object:case Boolean:case Array:case String:u.push(f);break;default:switch(c(),f.constructor){case Uint8Array:case ArrayBuffer:i=new Ft(Ze(o,sn(a,o)),i,i&&i.lastId,l,l&&l.id,e,null,new eu(new Uint8Array(f))),i.integrate(n,0);break;case Vo:i=new Ft(Ze(o,sn(a,o)),i,i&&i.lastId,l,l&&l.id,e,null,new tu(f)),i.integrate(n,0);break;default:if(f instanceof Nt)i=new Ft(Ze(o,sn(a,o)),i,i&&i.lastId,l,l&&l.id,e,null,new di(f)),i.integrate(n,0);else throw new Error("Unexpected content type in insert operation")}}}),c()},gb=()=>Ds("Length exceeded!"),mb=(n,e,t,r)=>{if(t>e._length)throw gb();if(t===0)return e._searchMarker&&Oo(e._searchMarker,t,r.length),xl(n,e,null,r);const i=t,s=Ql(e,t);let o=e._start;for(s!==null&&(o=s.p,t-=s.index,t===0&&(o=o.prev,t+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(t<=o.length){t<o.length&&ri(n,Ze(o.id.client,o.id.clock+t));break}t-=o.length}return e._searchMarker&&Oo(e._searchMarker,i,r.length),xl(n,e,o,r)},Vx=(n,e,t)=>{let i=(e._searchMarker||[]).reduce((s,o)=>o.index>s.index?o:s,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;return xl(n,e,i,t)},yb=(n,e,t,r)=>{if(r===0)return;const i=t,s=r,o=Ql(e,t);let a=e._start;for(o!==null&&(a=o.p,t-=o.index);a!==null&&t>0;a=a.right)!a.deleted&&a.countable&&(t<a.length&&ri(n,Ze(a.id.client,a.id.clock+t)),t-=a.length);for(;r>0&&a!==null;)a.deleted||(r<a.length&&ri(n,Ze(a.id.client,a.id.clock+r)),a.delete(n),r-=a.length),a=a.right;if(r>0)throw gb();e._searchMarker&&Oo(e._searchMarker,i,-s+r)},kl=(n,e,t)=>{const r=e._map.get(t);r!==void 0&&r.delete(n)},cf=(n,e,t,r)=>{const i=e._map.get(t)||null,s=n.doc,o=s.clientID;let a;if(r==null)a=new Os([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:a=new Os([r]);break;case Uint8Array:a=new eu(r);break;case Vo:a=new tu(r);break;default:if(r instanceof Nt)a=new di(r);else throw new Error("Unexpected content type")}new Ft(Ze(o,sn(s.store,o)),i,i&&i.lastId,null,null,e,t,a).integrate(n,0)},df=(n,e)=>{n.doc??qt();const t=n._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},_b=n=>{const e={};return n.doc??qt(),n._map.forEach((t,r)=>{t.deleted||(e[r]=t.content.getContent()[t.length-1])}),e},bb=(n,e)=>{n.doc??qt();const t=n._map.get(e);return t!==void 0&&!t.deleted},Jx=(n,e)=>{const t={};return n._map.forEach((r,i)=>{let s=r;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&cs(s,e)&&(t[i]=s.content.getContent()[s.length-1])}),t},ka=n=>(n.doc??qt(),Ex(n._map.entries(),e=>!e[1].deleted));class vb extends Xl{}class Mi extends Nt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new Mi;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Mi}clone(){const e=new Mi;return e.insert(0,this.toArray().map(t=>t instanceof Nt?t.clone():t)),e}get length(){return this.doc??qt(),this._length}_callObserver(e,t){super._callObserver(e,t),Zl(this,e,new vb(this,e))}insert(e,t){this.doc!==null?He(this.doc,r=>{mb(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?He(this.doc,t=>{Vx(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?He(this.doc,r=>{yb(r,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return pb(this,e)}toArray(){return fb(this)}slice(e=0,t=this.length){return db(this,e,t)}toJSON(){return this.map(e=>e instanceof Nt?e.toJSON():e)}map(e){return hb(this,e)}forEach(e){Io(this,e)}[Symbol.iterator](){return Kx(this)}_write(e){e.writeTypeRef(ik)}}class Gx extends Xl{constructor(e,t,r){super(e,t),this.keysChanged=r}}class Ns extends Nt{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new Ns}clone(){const e=new Ns;return this.forEach((t,r)=>{e.set(r,t instanceof Nt?t.clone():t)}),e}_callObserver(e,t){Zl(this,e,new Gx(this,e,t))}toJSON(){this.doc??qt();const e={};return this._map.forEach((t,r)=>{if(!t.deleted){const i=t.content.getContent()[t.length-1];e[r]=i instanceof Nt?i.toJSON():i}}),e}get size(){return[...ka(this)].length}keys(){return Gu(ka(this),e=>e[0])}values(){return Gu(ka(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return Gu(ka(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??qt(),this._map.forEach((t,r)=>{t.deleted||e(t.content.getContent()[t.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?He(this.doc,t=>{kl(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?He(this.doc,r=>{cf(r,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return df(this,e)}has(e){return bb(this,e)}clear(){this.doc!==null?He(this.doc,e=>{this.forEach(function(t,r,i){kl(e,i,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(sk)}}const Jr=(n,e)=>n===e||typeof n=="object"&&typeof e=="object"&&n&&e&&ix(n,e);class Hc{constructor(e,t,r,i){this.left=e,this.right=t,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&ji(),this.right.content.constructor){case Ct:this.right.deleted||Vs(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const rg=(n,e,t)=>{for(;e.right!==null&&t>0;){switch(e.right.content.constructor){case Ct:e.right.deleted||Vs(e.currentAttributes,e.right.content);break;default:e.right.deleted||(t<e.right.length&&ri(n,Ze(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},Sa=(n,e,t,r)=>{const i=new Map,s=r?Ql(e,t):null;if(s){const o=new Hc(s.p.left,s.p,s.index,i);return rg(n,o,t-s.index)}else{const o=new Hc(null,e._start,0,i);return rg(n,o,t)}},Cb=(n,e,t,r)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===Ct&&Jr(r.get(t.right.content.key),t.right.content.value));)t.right.deleted||r.delete(t.right.content.key),t.forward();const i=n.doc,s=i.clientID;r.forEach((o,a)=>{const l=t.left,u=t.right,c=new Ft(Ze(s,sn(i.store,s)),l,l&&l.lastId,u,u&&u.id,e,null,new Ct(a,o));c.integrate(n,0),t.right=c,t.forward()})},Vs=(n,e)=>{const{key:t,value:r}=e;r===null?n.delete(t):n.set(t,r)},Eb=(n,e)=>{for(;n.right!==null;){if(!(n.right.deleted||n.right.content.constructor===Ct&&Jr(e[n.right.content.key]??null,n.right.content.value)))break;n.forward()}},wb=(n,e,t,r)=>{const i=n.doc,s=i.clientID,o=new Map;for(const a in r){const l=r[a],u=t.currentAttributes.get(a)??null;if(!Jr(u,l)){o.set(a,u);const{left:c,right:f}=t;t.right=new Ft(Ze(s,sn(i.store,s)),c,c&&c.lastId,f,f&&f.id,e,null,new Ct(a,l)),t.right.integrate(n,0),t.forward()}}return o},Xu=(n,e,t,r,i)=>{t.currentAttributes.forEach((d,h)=>{i[h]===void 0&&(i[h]=null)});const s=n.doc,o=s.clientID;Eb(t,i);const a=wb(n,e,t,i),l=r.constructor===String?new Ir(r):r instanceof Nt?new di(r):new Js(r);let{left:u,right:c,index:f}=t;e._searchMarker&&Oo(e._searchMarker,t.index,l.getLength()),c=new Ft(Ze(o,sn(s.store,o)),u,u&&u.lastId,c,c&&c.id,e,null,l),c.integrate(n,0),t.right=c,t.index=f,t.forward(),Cb(n,e,t,a)},ig=(n,e,t,r,i)=>{const s=n.doc,o=s.clientID;Eb(t,i);const a=wb(n,e,t,i);e:for(;t.right!==null&&(r>0||a.size>0&&(t.right.deleted||t.right.content.constructor===Ct));){if(!t.right.deleted)switch(t.right.content.constructor){case Ct:{const{key:l,value:u}=t.right.content,c=i[l];if(c!==void 0){if(Jr(c,u))a.delete(l);else{if(r===0)break e;a.set(l,u)}t.right.delete(n)}else t.currentAttributes.set(l,u);break}default:r<t.right.length&&ri(n,Ze(t.right.id.client,t.right.id.clock+r)),r-=t.right.length;break}t.forward()}if(r>0){let l="";for(;r>0;r--)l+=`
`;t.right=new Ft(Ze(o,sn(s.store,o)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new Ir(l)),t.right.integrate(n,0),t.forward()}Cb(n,e,t,a)},xb=(n,e,t,r,i)=>{let s=e;const o=cr();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===Ct){const u=s.content;o.set(u.key,u)}s=s.right}let a=0,l=!1;for(;e!==s;){if(t===e&&(l=!0),!e.deleted){const u=e.content;switch(u.constructor){case Ct:{const{key:c,value:f}=u,d=r.get(c)??null;(o.get(c)!==u||d===f)&&(e.delete(n),a++,!l&&(i.get(c)??null)===f&&d!==f&&(d===null?i.delete(c):i.set(c,d))),!l&&!e.deleted&&Vs(i,u);break}}}e=e.right}return a},Yx=(n,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Ct){const r=e.content.key;t.has(r)?e.delete(n):t.add(r)}e=e.left}},Xx=n=>{let e=0;return He(n.doc,t=>{let r=n._start,i=n._start,s=cr();const o=Bc(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case Ct:Vs(o,i.content);break;default:e+=xb(t,r,i,s,o),s=Bc(o),r=i;break}i=i.right}}),e},Qx=n=>{const e=new Set,t=n.doc;for(const[r,i]of n.afterState.entries()){const s=n.beforeState.get(r)||0;i!==s&&ab(n,t.store.clients.get(r),s,i,o=>{!o.deleted&&o.content.constructor===Ct&&o.constructor!==zr&&e.add(o.parent)})}He(t,r=>{eb(n,n.deleteSet,i=>{if(i instanceof zr||!i.parent._hasFormatting||e.has(i.parent))return;const s=i.parent;i.content.constructor===Ct?e.add(s):Yx(r,i)});for(const i of e)Xx(i)})},sg=(n,e,t)=>{const r=t,i=Bc(e.currentAttributes),s=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case di:case Js:case Ir:t<e.right.length&&ri(n,Ze(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(n);break}e.forward()}s&&xb(n,s,e.right,i,e.currentAttributes);const o=(e.left||e.right).parent;return o._searchMarker&&Oo(o._searchMarker,e.index,-r+t),e};class Zx extends Xl{constructor(e,t,r){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,t=[];He(e,r=>{const i=new Map,s=new Map;let o=this.target._start,a=null;const l={};let u="",c=0,f=0;const d=()=>{if(a!==null){let h=null;switch(a){case"delete":f>0&&(h={delete:f}),f=0;break;case"insert":(typeof u=="object"||u.length>0)&&(h={insert:u},i.size>0&&(h.attributes={},i.forEach((p,m)=>{p!==null&&(h.attributes[m]=p)}))),u="";break;case"retain":c>0&&(h={retain:c},tx(l)||(h.attributes=Qw({},l))),c=0;break}h&&t.push(h),a=null}};for(;o!==null;){switch(o.content.constructor){case di:case Js:this.adds(o)?this.deletes(o)||(d(),a="insert",u=o.content.getContent()[0],d()):this.deletes(o)?(a!=="delete"&&(d(),a="delete"),f+=1):o.deleted||(a!=="retain"&&(d(),a="retain"),c+=1);break;case Ir:this.adds(o)?this.deletes(o)||(a!=="insert"&&(d(),a="insert"),u+=o.content.str):this.deletes(o)?(a!=="delete"&&(d(),a="delete"),f+=o.length):o.deleted||(a!=="retain"&&(d(),a="retain"),c+=o.length);break;case Ct:{const{key:h,value:p}=o.content;if(this.adds(o)){if(!this.deletes(o)){const m=i.get(h)??null;Jr(m,p)?p!==null&&o.delete(r):(a==="retain"&&d(),Jr(p,s.get(h)??null)?delete l[h]:l[h]=p)}}else if(this.deletes(o)){s.set(h,p);const m=i.get(h)??null;Jr(m,p)||(a==="retain"&&d(),l[h]=m)}else if(!o.deleted){s.set(h,p);const m=l[h];m!==void 0&&(Jr(m,p)?m!==null&&o.delete(r):(a==="retain"&&d(),p===null?delete l[h]:l[h]=p))}o.deleted||(a==="insert"&&d(),Vs(i,o.content));break}}o=o.right}for(d();t.length>0;){const h=t[t.length-1];if(h.retain!==void 0&&h.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}}class Sl extends Nt{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??qt(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new Sl}clone(){const e=new Sl;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const r=new Zx(this,e,t);Zl(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??qt();let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===Ir&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?He(this.doc,r=>{const i=new Hc(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const o=e[s];if(o.insert!==void 0){const a=!t&&typeof o.insert=="string"&&s===e.length-1&&i.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof a!="string"||a.length>0)&&Xu(r,this,i,a,o.attributes||{})}else o.retain!==void 0?ig(r,this,i,o.retain,o.attributes||{}):o.delete!==void 0&&sg(r,i,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,r){this.doc??qt();const i=[],s=new Map,o=this.doc;let a="",l=this._start;function u(){if(a.length>0){const f={};let d=!1;s.forEach((p,m)=>{d=!0,f[m]=p});const h={insert:a};d&&(h.attributes=f),i.push(h),a=""}}const c=()=>{for(;l!==null;){if(cs(l,e)||t!==void 0&&cs(l,t))switch(l.content.constructor){case Ir:{const f=s.get("ychange");e!==void 0&&!cs(l,e)?(f===void 0||f.user!==l.id.client||f.type!=="removed")&&(u(),s.set("ychange",r?r("removed",l.id):{type:"removed"})):t!==void 0&&!cs(l,t)?(f===void 0||f.user!==l.id.client||f.type!=="added")&&(u(),s.set("ychange",r?r("added",l.id):{type:"added"})):f!==void 0&&(u(),s.delete("ychange")),a+=l.content.str;break}case di:case Js:{u();const f={insert:l.content.getContent()[0]};if(s.size>0){const d={};f.attributes=d,s.forEach((h,p)=>{d[p]=h})}i.push(f);break}case Ct:cs(l,e)&&(u(),Vs(s,l.content));break}l=l.right}u()};return e||t?He(o,f=>{e&&Wc(f,e),t&&Wc(f,t),c()},"cleanup"):c(),i}insert(e,t,r){if(t.length<=0)return;const i=this.doc;i!==null?He(i,s=>{const o=Sa(s,this,e,!r);r||(r={},o.currentAttributes.forEach((a,l)=>{r[l]=a})),Xu(s,this,o,t,r)}):this._pending.push(()=>this.insert(e,t,r))}insertEmbed(e,t,r){const i=this.doc;i!==null?He(i,s=>{const o=Sa(s,this,e,!r);Xu(s,this,o,t,r||{})}):this._pending.push(()=>this.insertEmbed(e,t,r||{}))}delete(e,t){if(t===0)return;const r=this.doc;r!==null?He(r,i=>{sg(i,Sa(i,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,r){if(t===0)return;const i=this.doc;i!==null?He(i,s=>{const o=Sa(s,this,e,!1);o.right!==null&&ig(s,this,o,t,r)}):this._pending.push(()=>this.format(e,t,r))}removeAttribute(e){this.doc!==null?He(this.doc,t=>{kl(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?He(this.doc,r=>{cf(r,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return df(this,e)}getAttributes(){return _b(this)}_write(e){e.writeTypeRef(ok)}}class Qu{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??qt()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===Ro||t.constructor===Ms)&&t._start!==null)e=t._start;else for(;e!==null;){const r=e.next;if(r!==null){e=r;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Ms extends Nt{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Ms}clone(){const e=new Ms;return e.insert(0,this.toArray().map(t=>t instanceof Nt?t.clone():t)),e}get length(){return this.doc??qt(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new Qu(this,e)}querySelector(e){e=e.toUpperCase();const r=new Qu(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return r.done?null:r.value}querySelectorAll(e){return e=e.toUpperCase(),As(new Qu(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){Zl(this,e,new ek(this,t,e))}toString(){return hb(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},r){const i=e.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),Io(this,s=>{i.insertBefore(s.toDOM(e,t,r),null)}),i}insert(e,t){this.doc!==null?He(this.doc,r=>{mb(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)He(this.doc,r=>{const i=e&&e instanceof Nt?e._item:e;xl(r,this,i,t)});else{const r=this._prelimContent,i=e===null?0:r.findIndex(s=>s===e)+1;if(i===0&&e!==null)throw Ds("Reference item not found");r.splice(i,0,...t)}}delete(e,t=1){this.doc!==null?He(this.doc,r=>{yb(r,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return fb(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return pb(this,e)}slice(e=0,t=this.length){return db(this,e,t)}forEach(e){Io(this,e)}_write(e){e.writeTypeRef(lk)}}class Ro extends Ms{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new Ro(this.nodeName)}clone(){const e=new Ro(this.nodeName),t=this.getAttributes();return ex(t,(r,i)=>{typeof r=="string"&&e.setAttribute(i,r)}),e.insert(0,this.toArray().map(r=>r instanceof Nt?r.clone():r)),e}toString(){const e=this.getAttributes(),t=[],r=[];for(const a in e)r.push(a);r.sort();const i=r.length;for(let a=0;a<i;a++){const l=r[a];t.push(l+'="'+e[l]+'"')}const s=this.nodeName.toLocaleLowerCase(),o=t.length>0?" "+t.join(" "):"";return`<${s}${o}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?He(this.doc,t=>{kl(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?He(this.doc,r=>{cf(r,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return df(this,e)}hasAttribute(e){return bb(this,e)}getAttributes(e){return e?Jx(this,e):_b(this)}toDOM(e=document,t={},r){const i=e.createElement(this.nodeName),s=this.getAttributes();for(const o in s){const a=s[o];typeof a=="string"&&i.setAttribute(o,a)}return Io(this,o=>{i.appendChild(o.toDOM(e,t,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(e){e.writeTypeRef(ak),e.writeKey(this.nodeName)}}class ek extends Xl{constructor(e,t,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class kb{constructor(e,t){this.id=e,this.length=t}get deleted(){throw dr()}mergeWith(e){return!1}write(e,t,r){throw dr()}integrate(e,t){throw dr()}}const tk=0;class zr extends kb{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),ob(e.doc.store,this)}write(e,t){e.writeInfo(tk),e.writeLen(this.length-t)}getMissing(e,t){return null}}class eu{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new eu(this.content)}splice(e){throw dr()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}class Tl{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Tl(this.len)}splice(e){const t=new Tl(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){rb(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const nk=(n,e)=>new Vo({guid:n,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class tu{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new tu(nk(this.doc.guid,this.opts))}splice(e){throw dr()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}class Js{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Js(this.embed)}splice(e){throw dr()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}class Ct{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Ct(this.key,this.value)}splice(e){throw dr()}mergeWith(e){return!1}integrate(e,t){const r=t.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const rk=wl("node_env")==="development";class Os{constructor(e){this.arr=e,rk&&H_(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Os(this.arr)}splice(e){const t=new Os(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const r=this.arr.length;e.writeLen(r-t);for(let i=t;i<r;i++){const s=this.arr[i];e.writeAny(s)}}getRef(){return 8}}class Ir{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Ir(this.str)}splice(e){const t=new Ir(this.str.slice(e));this.str=this.str.slice(0,e);const r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"�",t.str="�"+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}}const ik=0,sk=1,ok=2,ak=3,lk=4;class di{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new di(this.type._copy())}splice(e){throw dr()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(e,!0),r=r.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const Sb=(n,e,t)=>{const{client:r,clock:i}=e.id,s=new Ft(Ze(r,i+t),e,Ze(r,i+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=Ze(e.redone.client,e.redone.clock+t)),e.right=s,s.right!==null&&(s.right.left=s),n._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=t,s};class Ft extends kb{constructor(e,t,r,i,s,o,a,l){super(e,l.getLength()),this.origin=r,this.left=t,this.right=i,this.rightOrigin=s,this.parent=o,this.parentSub=a,this.redone=null,this.content=l,this.info=this.content.isCountable()?qp:0}set marker(e){(this.info&Ku)>0!==e&&(this.info^=Ku)}get marker(){return(this.info&Ku)>0}get keep(){return(this.info&Bp)>0}set keep(e){this.keep!==e&&(this.info^=Bp)}get countable(){return(this.info&qp)>0}get deleted(){return(this.info&Hu)>0}set deleted(e){this.deleted!==e&&(this.info^=Hu)}markDeleted(){this.info|=Hu}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=sn(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=sn(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Ga&&this.id.client!==this.parent.client&&this.parent.clock>=sn(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Zp(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=ri(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===zr||this.right&&this.right.constructor===zr)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Ft?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===Ft&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Ga){const r=Yu(t,this.parent);r.constructor===zr?this.parent=null:this.parent=r.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=Zp(e,e.doc.store,Ze(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const s=new Set,o=new Set;for(;i!==null&&i!==this.right;){if(o.add(i),s.add(i),xa(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,s.clear();else if(xa(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&o.has(Yu(e.doc.store,i.origin)))s.has(Yu(e.doc.store,i.origin))||(r=i,s.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),ob(e.doc.store,this),this.content.integrate(e,this),tg(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new zr(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Ze(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&xa(e.origin,this.lastId)&&this.right===e&&xa(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(r=>{r.p===e&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),rb(e.deleteSet,this.id.client,this.id.clock,this.length),tg(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw ji();this.content.gc(e),t?Fx(e,this,new zr(this.id,this.length)):this.content=new Tl(this.length)}write(e,t){const r=t>0?Ze(this.id.client,this.id.clock+t-1):this.origin,i=this.rightOrigin,s=this.parentSub,o=this.content.getRef()&Sw|(r===null?0:El)|(i===null?0:U_)|(s===null?0:kw);if(e.writeInfo(o),r!==null&&e.writeLeftID(r),i!==null&&e.writeRightID(i),r===null&&i===null){const a=this.parent;if(a._item!==void 0){const l=a._item;if(l===null){const u=Px(a);e.writeParentInfo(!0),e.writeString(u)}else e.writeParentInfo(!1),e.writeLeftID(l.id)}else a.constructor===String?(e.writeParentInfo(!0),e.writeString(a)):a.constructor===Ga?(e.writeParentInfo(!1),e.writeLeftID(a)):ji();s!==null&&e.writeString(s)}this.content.write(e,t)}}const Tb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},Ab="__ $YJS$ __";Tb[Ab]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Tb[Ab]=!0;const uk=be("TOGGLE_CONNECT_COMMAND");var ck=Object.defineProperty,dk=(n,e,t)=>e in n?ck(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,fe=(n,e,t)=>dk(n,typeof e!="symbol"?e+"":e,t);function fk({options:n,editedUsjRef:e,usj:t,setUsj:r}){const{view:i,nodes:s}=n||{},{hasSpacing:o,isFormattedFont:a,markerMode:l}=i||{};return T.useEffect(()=>{e.current&&!Wr(e.current,t)&&r(e.current)},[e,o,a,l,s,r,t]),null}const Zu=n=>We(gy(n)),ii=Mm("cid",{parse:n=>typeof n=="string"?n:void 0}),Is=Mm("segment",{parse:n=>typeof n=="string"?n:void 0}),Kc="unknown",Db=1;class Zi extends Ut{constructor(e="",t="",r,i){super(i),fe(this,"__tag"),fe(this,"__marker"),fe(this,"__unknownAttributes"),this.__tag=e,this.__marker=t,this.__unknownAttributes=r}static getType(){return"unknown"}static clone(e){const{__tag:t,__marker:r,__unknownAttributes:i,__key:s}=e;return new Zi(t,r,i,s)}static importDOM(){return{[Kc]:e=>pk(e)?{conversion:hk,priority:1}:null}}static importJSON(e){return Nb().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTag(e.tag).setMarker(e.marker).setUnknownAttributes(e.unknownAttributes)}setTag(e){if(this.__tag===e)return this;const t=this.getWritable();return t.__tag=e,t}getTag(){return this.getLatest().__tag}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t}getMarker(){return this.getLatest().__marker}setUnknownAttributes(e){const t=this.getWritable();return t.__unknownAttributes=e,t}getUnknownAttributes(){return this.getLatest().__unknownAttributes}createDOM(){const e=document.createElement(Kc);return e.style.display="none",e}updateDOM(){return!1}exportDOM(){return{element:null}}exportJSON(){return{...super.exportJSON(),type:this.getType(),tag:this.getTag(),marker:this.getMarker(),unknownAttributes:this.getUnknownAttributes(),version:Db}}canBeEmpty(){return!0}isInline(){return!0}extractWithChild(){return!1}excludeFromCopy(e){return e!=="clone"}}function hk(n){const e=n.getAttribute("data-tag")??"",t=n.getAttribute("data-marker")??"";return{node:Nb(e,t)}}function Nb(n,e,t){return We(new Zi(n,e,t))}function pk(n){return(n==null?void 0:n.tagName)===Kc}function Jo(n){return n instanceof Zi}const nu="id",Mb=1;class In extends Ut{constructor(e="",t,r){super(r),fe(this,"__marker",nu),fe(this,"__code"),fe(this,"__unknownAttributes"),this.__code=e,this.__unknownAttributes=t}static getType(){return"book"}static clone(e){const{__code:t,__unknownAttributes:r,__key:i}=e;return new In(t,r,i)}static importJSON(e){const{code:t}=e;return Ob(t).updateFromJSON(e)}static isValidBookCode(e){return gC(e)}updateFromJSON(e){return super.updateFromJSON(e).setCode(e.code).setUnknownAttributes(e.unknownAttributes)}getMarker(){return this.getLatest().__marker}setCode(e){if(this.__code===e)return this;const t=this.getWritable();return t.__code=e,t}getCode(){return this.getLatest().__code}setUnknownAttributes(e){const t=this.getWritable();return t.__unknownAttributes=e,t}getUnknownAttributes(){return this.getLatest().__unknownAttributes}createDOM(){const e=document.createElement("p");return e.setAttribute("data-marker",this.__marker),e.classList.add(this.__type,`usfm_${this.__marker}`),e.setAttribute("data-code",this.__code),e}updateDOM(){return!1}exportJSON(){return{...super.exportJSON(),type:this.getType(),marker:this.getMarker(),code:this.getCode(),unknownAttributes:this.getUnknownAttributes(),version:Mb}}}function Ob(n,e){return We(new In(n,e))}function fr(n){return n instanceof In}function gk(n){return(n==null?void 0:n.type)===In.getType()}const Ve=" ",Vc="​",Ib=`${Ve}|`,ff="p",Ui="+",hf="-",Al="chapter",Jc="verse",og="invalid",mk="text-spacing",yk="formatted-font",_k="marker-",pf="external-usj-mutation",Rb="selection-change",Gc="cursor-change",Yc="annotation-change",Xc="delta-change",bk=[pf,Rb,Gc,Yc,Xc],gf="c",Pb=1;class Xn extends Ut{constructor(e="",t,r,i,s,o){super(o),fe(this,"__marker"),fe(this,"__number"),fe(this,"__sid"),fe(this,"__altnumber"),fe(this,"__pubnumber"),fe(this,"__unknownAttributes"),this.__marker=gf,this.__number=e,this.__sid=t,this.__altnumber=r,this.__pubnumber=i,this.__unknownAttributes=s}static getType(){return"chapter"}static clone(e){const{__number:t,__sid:r,__altnumber:i,__pubnumber:s,__unknownAttributes:o,__key:a}=e;return new Xn(t,r,i,s,o,a)}static importJSON(e){return Lb().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setMarker(e.marker).setNumber(e.number).setSid(e.sid).setAltnumber(e.altnumber).setPubnumber(e.pubnumber).setUnknownAttributes(e.unknownAttributes)}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t}getMarker(){return this.getLatest().__marker}setNumber(e){if(this.__number===e)return this;const t=this.getWritable();return t.__number=e,t}getNumber(){return this.getLatest().__number}setSid(e){if(this.__sid===e)return this;const t=this.getWritable();return t.__sid=e,t}getSid(){return this.getLatest().__sid}setAltnumber(e){if(this.__altnumber===e)return this;const t=this.getWritable();return t.__altnumber=e,t}getAltnumber(){return this.getLatest().__altnumber}setPubnumber(e){if(this.__pubnumber===e)return this;const t=this.getWritable();return t.__pubnumber=e,t}getPubnumber(){return this.getLatest().__pubnumber}setUnknownAttributes(e){const t=this.getWritable();return t.__unknownAttributes=e,t}getUnknownAttributes(){return this.getLatest().__unknownAttributes}createDOM(){const e=document.createElement("p");return e.setAttribute("data-marker",this.__marker),e.classList.add(Al,`usfm_${this.__marker}`),e.setAttribute("data-number",this.__number),e}updateDOM(){return!1}exportJSON(){return{...super.exportJSON(),type:this.getType(),marker:this.getMarker(),number:this.getNumber(),sid:this.getSid(),altnumber:this.getAltnumber(),pubnumber:this.getPubnumber(),unknownAttributes:this.getUnknownAttributes(),version:Pb}}}function Lb(n,e,t,r,i){return We(new Xn(n,e,t,r,i))}function mf(n){return n instanceof Xn}function vk(n){return(n==null?void 0:n.type)===Xn.getType()}const $b=["fr","fq","fqa","fk","ft","fl","fw","fp","fv","fdc","fm"],Fb=["xo","xop","xk","xq","xt","xta","xot","xnt","xdc"],Ck=["ca","cp","va","vp","add","bk","dc","em","jmp","k","nd","ord","pn","png","qt","rb","rq","sig","sls","tl","w","wa","wg","wh","wj","bd","it","bdit","no","sc","sup","ior","iqt","qac","qs","litl","lik","liv","liv1","liv2","liv3","liv4","liv5",...$b,...Fb],Bb=1;class et extends Ut{constructor(e="",t,r){super(r),fe(this,"__marker"),fe(this,"__unknownAttributes"),this.__marker=e,this.__unknownAttributes=t}static getType(){return"char"}static clone(e){const{__marker:t,__unknownAttributes:r,__key:i}=e;return new et(t,r,i)}static importDOM(){return{span:e=>wk(e)?{conversion:Ek,priority:1}:null}}static importJSON(e){return Sr().updateFromJSON(e)}static isValidMarker(e){return e!==void 0&&Ck.includes(e)}static isValidFootnoteMarker(e){return e!==void 0&&$b.includes(e)}static isValidCrossReferenceMarker(e){return e!==void 0&&Fb.includes(e)}updateFromJSON(e){return super.updateFromJSON(e).setMarker(e.marker).setUnknownAttributes(e.unknownAttributes)}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t}getMarker(){return this.getLatest().__marker}setUnknownAttributes(e){const t=this.getWritable();return t.__unknownAttributes=e,t}getUnknownAttributes(){return this.getLatest().__unknownAttributes}createDOM(){const e=document.createElement("span");return e.setAttribute("data-marker",this.__marker),e.setAttribute("title",this.__marker),e.classList.add(this.__type,`usfm_${this.__marker}`),e}updateDOM(){return!1}exportDOM(e){const{element:t}=super.exportDOM(e);return t&&je(t)&&(t.setAttribute("data-marker",this.getMarker()),t.classList.add(this.getType(),`usfm_${this.getMarker()}`)),{element:t}}exportJSON(){return{...super.exportJSON(),type:this.getType(),marker:this.getMarker(),unknownAttributes:this.getUnknownAttributes(),version:Bb}}canBeEmpty(){return!1}isInline(){return!0}}function Ek(n){const e=n.getAttribute("data-marker")??"f";return{node:Sr(e)}}function Sr(n,e){return We(new et(n,e))}function wk(n){if(!n)return!1;const e=n.getAttribute("data-marker")??"";return et.isValidMarker(e)&&n.classList.contains(et.getType())}function st(n){return n instanceof et}function xk(n){return(n==null?void 0:n.type)===et.getType()}const qb=1,kk="c",jb="span";class $r extends ci{constructor(e="",t=!1,r,i,s,o,a){super(a),fe(this,"__marker"),fe(this,"__number"),fe(this,"__showMarker"),fe(this,"__sid"),fe(this,"__altnumber"),fe(this,"__pubnumber"),fe(this,"__unknownAttributes"),this.__marker=kk,this.__number=e,this.__showMarker=t,this.__sid=r,this.__altnumber=i,this.__pubnumber=s,this.__unknownAttributes=o}static getType(){return"immutable-chapter"}static clone(e){const{__number:t,__showMarker:r,__sid:i,__altnumber:s,__pubnumber:o,__unknownAttributes:a,__key:l}=e;return new $r(t,r,i,s,o,a,l)}static importDOM(){return{span:e=>Ub(e)?{conversion:Sk,priority:1}:null}}static importJSON(e){return yf().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setMarker(e.marker).setNumber(e.number).setShowMarker(e.showMarker).setSid(e.sid).setAltnumber(e.altnumber).setPubnumber(e.pubnumber).setUnknownAttributes(e.unknownAttributes)}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t}getMarker(){return this.getLatest().__marker}setNumber(e){if(this.__number===e)return this;const t=this.getWritable();return t.__number=e,t}getNumber(){return this.getLatest().__number}setShowMarker(e=!1){if(this.__showMarker===e)return this;const t=this.getWritable();return t.__showMarker=e,t}getShowMarker(){return this.getLatest().__showMarker}setSid(e){if(this.__sid===e)return this;const t=this.getWritable();return t.__sid=e,t}getSid(){return this.getLatest().__sid}setAltnumber(e){if(this.__altnumber===e)return this;const t=this.getWritable();return t.__altnumber=e,t}getAltnumber(){return this.getLatest().__altnumber}setPubnumber(e){if(this.__pubnumber===e)return this;const t=this.getWritable();return t.__pubnumber=e,t}getPubnumber(){return this.getLatest().__pubnumber}setUnknownAttributes(e){const t=this.getWritable();return t.__unknownAttributes=e,t}getUnknownAttributes(){return this.getLatest().__unknownAttributes}createDOM(){const e=document.createElement(jb);return e.setAttribute("data-marker",this.__marker),e.classList.add(Al,`usfm_${this.__marker}`),this.__showMarker&&e.classList.add("marker"),e.setAttribute("data-number",this.__number),e}updateDOM(){return!1}exportDOM(e){const{element:t}=super.exportDOM(e);return t&&je(t)&&(t.setAttribute("data-marker",this.getMarker()),t.classList.add(Al,`usfm_${this.getMarker()}`),t.setAttribute("data-number",this.getNumber())),{element:t}}decorate(){return this.getShowMarker()?Yo(this.getMarker(),this.getNumber()):this.getNumber()}exportJSON(){return{type:this.getType(),marker:this.getMarker(),number:this.getNumber(),showMarker:this.getShowMarker(),sid:this.getSid(),altnumber:this.getAltnumber(),pubnumber:this.getPubnumber(),unknownAttributes:this.getUnknownAttributes(),version:qb}}isInline(){return!1}isKeyboardSelectable(){return!1}}function Sk(n){const e=n.getAttribute("data-number")??"0";return{node:yf(e)}}function yf(n,e,t,r,i,s){return We(new $r(n,e,t,r,i,s))}function Ub(n){return n?n.classList.contains(Al)&&n.tagName.toLowerCase()===jb:!1}function Go(n){return n instanceof $r}function Tk(n){return(n==null?void 0:n.type)===$r.getType()}const Wb=1;class si extends qs{static getType(){return"implied-para"}static clone(e){return new si(e.__key)}static importJSON(e){return Hn().updateFromJSON(e)}getMarker(){return ff}exportJSON(){return{...super.exportJSON(),type:this.getType(),version:Wb}}insertNewAfter(e,t){const r=Hn();return r.setTextFormat(e.format),r.setTextStyle(e.style),r.setDirection(this.getDirection()),r.setFormat(this.getFormatType()),r.setStyle(this.getTextStyle()),r.setIndent(this.getIndent()),this.insertAfter(r,t),r}}function Hn(){return We(new si)}function Rr(n){return n instanceof si}function _f(n){return(n==null?void 0:n.type)===si.getType()}const Wi="zmsc-s",ys="zmsc-e",Ak=[Wi,ys],Dk=["ts-s","ts-e","t-s","t-e","ts","qt1-s","qt1-e","qt2-s","qt2-e","qt3-s","qt3-e","qt4-s","qt4-e","qt5-s","qt5-e","qt-s","qt-e",Wi,ys],zb=1;class hr extends ci{constructor(e="",t,r,i,s){super(s),fe(this,"__marker"),fe(this,"__sid"),fe(this,"__eid"),fe(this,"__unknownAttributes"),this.__marker=e,this.__sid=t,this.__eid=r,this.__unknownAttributes=i}static getType(){return"ms"}static clone(e){const{__marker:t,__sid:r,__eid:i,__unknownAttributes:s,__key:o}=e;return new hr(t,r,i,s,o)}static importJSON(e){return Hb().updateFromJSON(e)}static isValidMarker(e){return e!==void 0&&(Dk.includes(e)||e.startsWith("z"))}updateFromJSON(e){return super.updateFromJSON(e).setMarker(e.marker).setSid(e.sid).setEid(e.eid).setUnknownAttributes(e.unknownAttributes)}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t}getMarker(){return this.getLatest().__marker}setSid(e){if(this.__sid===e)return this;const t=this.getWritable();return t.__sid=e,t}getSid(){return this.getLatest().__sid}setEid(e){if(this.__eid===e)return this;const t=this.getWritable();return t.__eid=e,t}getEid(){return this.getLatest().__eid}setUnknownAttributes(e){const t=this.getWritable();return t.__unknownAttributes=e,t}getUnknownAttributes(){return this.getLatest().__unknownAttributes}createDOM(){const e=document.createElement("span");return e.setAttribute("data-marker",this.__marker),e.classList.add(this.__type,`usfm_${this.__marker}`),e}updateDOM(){return!1}decorate(){return""}exportJSON(){return{type:this.getType(),marker:this.getMarker(),sid:this.getSid(),eid:this.getEid(),unknownAttributes:this.getUnknownAttributes(),version:zb}}isKeyboardSelectable(){return!1}}function Nk(n){return Ak.includes(n)}function Hb(n,e,t,r){return We(new hr(n,e,t,r))}function ru(n){return n instanceof hr}const Kb="f",Mk=[Kb,"fe","ef","x","ex"],Vb=1;class jt extends Ut{constructor(e=Kb,t,r=!0,i,s,o){super(o),fe(this,"__marker"),fe(this,"__caller"),fe(this,"__isCollapsed"),fe(this,"__category"),fe(this,"__unknownAttributes"),this.__marker=e,this.__caller=t??(e==="x"||e==="ex"?hf:Ui),this.__isCollapsed=r,this.__category=i,this.__unknownAttributes=s}static getType(){return"note"}static clone(e){const{__marker:t,__caller:r,__isCollapsed:i,__category:s,__unknownAttributes:o,__key:a}=e;return new jt(t,r,i,s,o,a)}static importDOM(){return{span:e=>Ik(e)?{conversion:Ok,priority:1}:null}}static importJSON(e){return bf().updateFromJSON(e)}static isValidMarker(e){return e!==void 0&&Mk.includes(e)}updateFromJSON(e){return super.updateFromJSON(e).setMarker(e.marker).setCaller(e.caller).setIsCollapsed(e.isCollapsed).setCategory(e.category).setUnknownAttributes(e.unknownAttributes)}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t}getMarker(){return this.getLatest().__marker}setCaller(e){if(this.__caller===e)return this;const t=this.getWritable();return t.__caller=e,t}getCaller(){return this.getLatest().__caller}setIsCollapsed(e){if(this.__isCollapsed===e)return this;const t=this.getWritable();return t.__isCollapsed=e,t}toggleIsCollapsed(){const e=this.getWritable();return e.__isCollapsed=!e.__isCollapsed,e}getIsCollapsed(){return this.getLatest().__isCollapsed}setCategory(e){if(this.__category===e)return this;const t=this.getWritable();return t.__category=e,t}getCategory(){return this.getLatest().__category}setUnknownAttributes(e){const t=this.getWritable();return t.__unknownAttributes=e,t}getUnknownAttributes(){return this.getLatest().__unknownAttributes}createDOM(){const e=document.createElement("span");return e.setAttribute("data-marker",this.__marker),e.classList.add(this.__type,`usfm_${this.__marker}`,this.__isCollapsed?"collapsed":"expanded"),e.setAttribute("data-caller",this.__caller),e}updateDOM(e){return e.__isCollapsed!==this.__isCollapsed}exportDOM(e){const{element:t}=super.exportDOM(e);return t&&je(t)&&(t.setAttribute("data-marker",this.getMarker()),t.classList.add(this.getType(),`usfm_${this.getMarker()}`,this.getIsCollapsed()?"collapsed":"expanded"),t.setAttribute("data-caller",this.getCaller())),{element:t}}exportJSON(){return{...super.exportJSON(),type:this.getType(),marker:this.getMarker(),caller:this.getCaller(),isCollapsed:this.getIsCollapsed(),category:this.getCategory(),unknownAttributes:this.getUnknownAttributes(),version:Vb}}canBeEmpty(){return!1}isInline(){return!0}}function Ok(n){const e=n.getAttribute("data-marker")??"f",t=n.getAttribute("data-caller")??"",r=n.classList.contains("collapsed");return{node:bf(e,t,r)}}function bf(n,e,t,r,i){return We(new jt(n,e,t,r,i))}function Ik(n){if(!n)return!1;const e=n.getAttribute("data-marker")??"";return jt.isValidMarker(e)&&n.classList.contains(jt.getType())}function $e(n){return n instanceof jt}const Rk=["ide","sts","rem","h","toc1","toc2","toc3","toca1","toca2","toca3","imt","imt1","imt2","imt3","imt4","is","is1","is2","ip","ipi","im","imi","ipq","imq","ipr","iq","iq1","iq2","iq3","ili","ili1","ili2","ib","iot","io","io1","io2","io3","io4","iex","imte","imte1","imte2","ie","mt","mt1","mt2","mt3","mt4","mte","mte1","mte2","cl","cd","ms","ms1","ms2","ms3","mr","s","s1","s2","s3","s4","sr","r","d","sp","sd","sd1","sd2","sd3","sd4",ff,"m","po","cls","pr","pc","pm","pmo","pmc","pmr","pi","pi1","pi2","pi3","mi","lit","nb","q","q1","q2","q3","q4","qr","qc","qa","qm","qm1","qm2","qm3","qd","b","lh","li","li1","li2","li3","li4","lf","lim","lim1","lim2","lim3","lim4","pb"],Jb=1;class ln extends qs{constructor(e=ff,t,r){super(r),fe(this,"__marker"),fe(this,"__unknownAttributes"),this.__marker=e,this.__unknownAttributes=t}static getType(){return"para"}static clone(e){const{__marker:t,__unknownAttributes:r,__key:i}=e;return new ln(t,r,i)}static importDOM(){return{p:()=>({conversion:Pk,priority:1})}}static importJSON(e){return Po().updateFromJSON(e)}static isValidMarker(e){return e!==void 0&&Rk.includes(e)}updateFromJSON(e){return super.updateFromJSON(e).setMarker(e.marker).setUnknownAttributes(e.unknownAttributes)}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t}getMarker(){return this.getLatest().__marker}setUnknownAttributes(e){const t=this.getWritable();return t.__unknownAttributes=e,t}getUnknownAttributes(){return this.getLatest().__unknownAttributes}createDOM(){const e=document.createElement("p");return e.setAttribute("data-marker",this.__marker),e.classList.add(this.__type,`usfm_${this.__marker}`),e}exportDOM(e){const{element:t}=super.exportDOM(e);return t&&je(t)&&(t.setAttribute("data-marker",this.getMarker()),t.classList.add(this.getType(),`usfm_${this.getMarker()}`)),{element:t}}exportJSON(){return{...super.exportJSON(),type:this.getType(),marker:this.getMarker(),unknownAttributes:this.getUnknownAttributes(),version:Jb}}insertNewAfter(e,t){const r=Po(this.getMarker());return r.setTextFormat(e.format),r.setTextStyle(e.style),r.setDirection(this.getDirection()),r.setFormat(this.getFormatType()),r.setStyle(this.getTextStyle()),r.setIndent(this.getIndent()),this.insertAfter(r,t),r}}function Pk(n){const e=n.getAttribute("data-marker")??void 0,t=Po(e);if(n.style){t.setFormat(n.style.textAlign);const r=parseInt(n.style.textIndent,10)/20;r>0&&t.setIndent(r)}return{node:t}}function Po(n,e){return We(new ln(n,e))}function Bt(n){return n instanceof ln}function Lk(n){return(n==null?void 0:n.type)===ln.getType()}const vf="v",Gb=1;class Yt extends xn{constructor(e="",t,r,i,s,o,a){super(t??e,a),fe(this,"__marker"),fe(this,"__number"),fe(this,"__sid"),fe(this,"__altnumber"),fe(this,"__pubnumber"),fe(this,"__unknownAttributes"),this.__marker=vf,this.__number=e,this.__sid=r,this.__altnumber=i,this.__pubnumber=s,this.__unknownAttributes=o}static getType(){return"verse"}static clone(e){const{__number:t,__text:r,__sid:i,__altnumber:s,__pubnumber:o,__unknownAttributes:a,__key:l}=e;return new Yt(t,r,i,s,o,a,l)}static importJSON(e){return Yb().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setMarker(e.marker).setNumber(e.number).setSid(e.sid).setAltnumber(e.altnumber).setPubnumber(e.pubnumber).setUnknownAttributes(e.unknownAttributes)}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t}getMarker(){return this.getLatest().__marker}setNumber(e){if(this.__number===e)return this;const t=this.getWritable();return t.__number=e,t}getNumber(){return this.getLatest().__number}setSid(e){if(this.__sid===e)return this;const t=this.getWritable();return t.__sid=e,t}getSid(){return this.getLatest().__sid}setAltnumber(e){if(this.__altnumber===e)return this;const t=this.getWritable();return t.__altnumber=e,t}getAltnumber(){return this.getLatest().__altnumber}setPubnumber(e){if(this.__pubnumber===e)return this;const t=this.getWritable();return t.__pubnumber=e,t}getPubnumber(){return this.getLatest().__pubnumber}setUnknownAttributes(e){const t=this.getWritable();return t.__unknownAttributes=e,t}getUnknownAttributes(){return this.getLatest().__unknownAttributes}createDOM(e){const t=super.createDOM(e);return t.setAttribute("data-marker",this.__marker),t.classList.add(Jc,`usfm_${this.__marker}`),t.setAttribute("data-number",this.__number),t}exportJSON(){return{...super.exportJSON(),type:this.getType(),marker:this.getMarker(),number:this.getNumber(),sid:this.getSid(),altnumber:this.getAltnumber(),pubnumber:this.getPubnumber(),unknownAttributes:this.getUnknownAttributes(),version:Gb}}}function Yb(n,e,t,r,i,s){return We(new Yt(n,e,t,r,i,s))}function Cf(n){return n instanceof Yt}function $k(n){return(n==null?void 0:n.type)===Yt.getType()}function Fk(n){return vk(n)||Tk(n)}function Nn(n){return mf(n)||Go(n)}function Bk(n,e){return n.find(t=>Nn(t)&&t.getNumber()===e.toString())}function qk(n,e=!1){return n.find((t,r)=>(!e||r>0)&&Nn(t))}function Ef(n){var e;if(!n)return;if(Nn(n))return n;let t=(e=n.getTopLevelElement())==null?void 0:e.getPreviousSibling();for(;t&&!Nn(t);)t=t.getPreviousSibling();if(t&&Nn(t))return t}function Xb(n){let e=n;for(;e!==null;){if($e(e))return e;e=e.getParent()}}function jk(n){return fr(n)||mf(n)||st(n)||Go(n)||Rr(n)||ru(n)||Bt(n)||$e(n)||Cf(n)||Jo(n)}function Uk(n){var e;if(n.anchor.type==="element"){const r=n.anchor.getNode(),i=n.anchor.offset;if(i<r.getChildrenSize())return r.getChildAtIndex(i)}const t=n.anchor.getNode();return t.getNextSibling()??((e=t.getParent())==null?void 0:e.getNextSibling())??null}function Wk(n){var e;const t=n.anchor.offset;if(n.anchor.type==="element"&&t>0)return n.anchor.getNode().getChildAtIndex(t-1);const r=n.anchor.getNode();return r.getPreviousSibling()??((e=r.getParent())==null?void 0:e.getPreviousSibling())??null}function Un(n){return Bt(n)||Rr(n)}function Qc(n,e){const t=vs(e,ii),r=!!(n.cid&&t),i=!n.cid&&!t;return n.style===e.getMarker()&&(i||r&&n.cid===t)}function zk(n,e){const t=V(n)?n:n.getParent(),r=V(e)?e:e.getParent(),i=t&&r?bo(t,r):void 0;return i?i.commonAncestor:void 0}function Hk(n){const e=n.getStartEndPoints();if(!e)return;const[t,r]=e,i=n.isBackward()?t:r;n.focus.set(i.key,i.offset,i.type),n.anchor.set(i.key,i.offset,i.type)}function wf(n){return(n==null?void 0:n.type)===xn.getType()}function Kk(n,e){if(!e)return;const t=n.findIndex(r=>r===e);t&&(n.length=t)}function Vk(n,e){if(!e)return n;const t=e.getIndexWithinParent();return n.splice(t+1,n.length-t-1)}function fi(n){return`\\${n}`}function Lo(n){return`\\${n}*`}function Qb(n,e,t){const r=fi(n);if(e!=null&&e.startsWith(r)){const i=parseInt(e.slice(r.length),10);isNaN(i)||(t=i.toString())}return t}function Yo(n,e){let t=fi(n);return e&&(t+=`${Ve}${e}`),t+=" ",t}function Zb(n){return wf(n)?n.text:xk(n)?n.children.map(e=>Zb(e)).join(""):""}function Jk(n){return n.map(e=>Zb(e)).join(" ").trim()}function xf(n){return Ve+n+" "}function kf(n){return n.reduce((e,t)=>e+(st(t)?` ${t.getTextContent()}`:""),"").trim()}function Et(n,e=pC){const t={...n};return e.forEach(r=>{Reflect.deleteProperty(t,r)}),Object.keys(t).length===0?void 0:t}function Gk(n,e){const t=e.getElementByKey(n.getKey());return t?t.tagName.toLowerCase():void 0}function ht(n){return Object.fromEntries(Object.entries(n).filter(([,e])=>e!==void 0))}function e0(n){if(!n)return;const e=n.getNodes();if(e.length>0)return n.isBackward()?e[e.length-1]:e[0]}function Zc(n,e){if(!e)return(n+1).toString();const t=e.split("-");if(t.length===2)return parseInt(t[1])?`${parseInt(t[1])+1}`:`${parseInt(t[0])+1}`;const r=RegExp(/^(\d+)([a-yA-Y]{1,3})$/).exec(e);if(!r)return(parseInt(e)+1).toString();const i=String.fromCharCode(r[2].charCodeAt(0)+1);return`${r[1]}${i}`}function Sf(n,e){if(!e)return!1;const t=e.split("-").map(r=>parseInt(r));if(t.length<1||t.length>2||t[0]>t[1])throw new Error("isVerseInRange: invalid range");return t.length===1?n===t[0]:t.length===2&&isNaN(t[1])?n>=t[0]:(t.length===2&&isNaN(t[0])||n>=t[0])&&n<=t[1]}function Yk(n){return!!n&&n.includes("-")}const Xk=1;class es extends xn{constructor(e="",t="opening",r){super(ec(e,t),r),fe(this,"__marker"),fe(this,"__markerSyntax"),this.__marker=e,this.__markerSyntax=t}static getType(){return"marker"}static clone(e){return new es(e.__marker,e.__markerSyntax,e.__key)}static importJSON(e){return ed().updateFromJSON(e)}updateFromJSON(e){const{marker:t,markerSyntax:r="opening"}=e;return super.updateFromJSON(e).setMarker(t).setMarkerSyntax(r)}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t.__text=ec(e,t.__markerSyntax),t}getMarker(){return this.getLatest().__marker}setMarkerSyntax(e){if(this.__markerSyntax===e)return this;const t=this.getWritable();return t.__markerSyntax=e,t.__text=ec(t.__marker,e),t}getMarkerSyntax(){return this.getLatest().__markerSyntax}createDOM(e){const t=super.createDOM(e);return t.setAttribute("data-marker",this.__marker),t.classList.add(this.__markerSyntax),t}exportJSON(){return{...super.exportJSON(),type:this.getType(),text:this.getTextContent(),marker:this.getMarker(),markerSyntax:this.getMarkerSyntax(),version:Xk}}}function ed(n,e){return We(new es(n,e))}function Xo(n){return n instanceof es}function ec(n,e){return e==="closing"?Lo(n):e==="selfClosing"?Lo(""):fi(n)}const Gr="internal-comment",Qk=[Gr],Zk={},e1=1;class Dt extends Ut{constructor(e=Zk,t){super(t),fe(this,"__typedIDs"),this.__typedIDs=e}static getType(){return"typed-mark"}static clone(e){const t=JSON.parse(JSON.stringify(e.__typedIDs));return new Dt(t,e.__key)}static isReservedType(e){return Qk.includes(e)}static importDOM(){return null}static importJSON(e){return $o().updateFromJSON(e)}exportJSON(){return{...super.exportJSON(),type:this.getType(),typedIDs:this.getTypedIDs(),version:e1}}createDOM(e){const t=document.createElement("mark");for(const[r,i]of Object.entries(this.__typedIDs))$t(t,Ta(e.theme.typedMark,r)),i.length>1&&$t(t,Ta(e.theme.typedMarkOverlap,r));return t}updateDOM(e,t,r){for(const[i,s]of Object.entries(this.__typedIDs)){const o=e.__typedIDs[i].length,a=s.length,l=Ta(r.theme.typedMark,i),u=Ta(r.theme.typedMarkOverlap,i);o!==a&&(o===0?a===1&&$t(t,l):a===0&&Ni(t,l),o===1?a===2&&$t(t,u):a===1&&Ni(t,u))}return!1}updateFromJSON(e){return super.updateFromJSON(e).setTypedIDs(e.typedIDs)}hasID(e,t){const r=this.getTypedIDs()[e];if(!r)return!1;for(const i of r)if(t===i)return!0;return!1}getTypedIDs(){const e=this.getLatest();return Mt(e)?e.__typedIDs:{}}setTypedIDs(e){const t=this.getWritable();return t.__typedIDs=e,t}addID(e,t){const r=this.getWritable();if(!Mt(r))return;const i=r.__typedIDs[e]??[];r.__typedIDs[e]=i;for(const s of i)if(t===s)return;i.push(t)}deleteID(e,t){const r=this.getWritable();if(!Mt(r))return;const i=r.__typedIDs[e];for(let s=0;s<i.length;s++)if(t===i[s]){i.splice(s,1);return}}hasNoIDsForEveryType(){return Object.values(this.getTypedIDs()).every(e=>e===void 0||e.length===0)}insertNewAfter(e,t=!0){const r=$o(this.__typedIDs);return this.insertAfter(r,t),r}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(e,t,r){if(!G(t)||r==="html")return!1;const i=t.anchor,s=t.focus,o=i.getNode(),a=s.getNode(),l=t.isBackward()?i.offset-s.offset:s.offset-i.offset;return this.isParentOf(o)&&this.isParentOf(a)&&this.getTextContent().length===l}excludeFromCopy(e){return e!=="clone"}}function Ta(n,e){return`${n}-${e}`}function $o(n){return We(new Dt(n))}function Mt(n){return n instanceof Dt}function t1(n){return(n==null?void 0:n.type)===Dt.getType()}function t0(n){const e=n.getChildren();let t=null;for(const r of e)t===null?n.insertBefore(r):t.insertAfter(r),t=r;n.remove()}function n0(n,e,t,r){const i=n.getNodes(),s=n.anchor.offset,o=n.focus.offset,a=i.length,l=n.isBackward(),u=l?o:s,c=l?s:o;let f,d;for(let h=0;h<a;h++){const p=i[h];if(V(d)&&d.isParentOf(p))continue;const m=h===0,_=h===a-1;let C=null;if(Z(p)){const v=p.getTextContentSize(),x=m?u:0,M=_?c:v;if(x===0&&M===0)continue;const $=p.splitText(x,M);C=$.length>1&&($.length===3||m&&!_||M===v)?$[1]:$[0]}else{if(Mt(p))continue;V(p)&&p.isInline()&&(C=p)}if(C!==null){if(C&&C.is(f))continue;const v=C.getParent();(v==null||!v.is(f))&&(d=void 0),f=v,d===void 0&&(d=$o({[e]:[t]}),C.insertBefore(d)),d.append(C)}else f=void 0,d=void 0}e===Gr&&V(d)&&(l?d.selectStart():d.selectEnd())}function n1(n,e,t){let r=n;for(;r!==null;){if(Mt(r))return r.getTypedIDs()[e];if(Z(r)&&t===r.getTextContentSize()){const i=r.getNextSibling();if(Mt(i))return i.getTypedIDs()[e]}r=r.getParent()}}function ag(n){return`external-${n}`}const r0=1;class hi extends ci{constructor(e="",t="",r){super(r),fe(this,"__textType"),fe(this,"__text"),this.__textType=e,this.__text=t}static getType(){return"immutable-typed-text"}static clone(e){const{__textType:t,__text:r,__key:i}=e;return new hi(t,r,i)}static importDOM(){return{span:e=>i1(e)?{conversion:r1,priority:1}:null}}static importJSON(e){return Dl().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTextType(e.textType).setTextContent(e.text)}setTextType(e){if(this.__textType===e)return this;const t=this.getWritable();return t.__textType=e,t}getTextType(){return this.getLatest().__textType}setTextContent(e){if(this.__text===e)return this;const t=this.getWritable();return t.__text=e,t}getTextContent(){return this.getLatest().__text}createDOM(){const e=document.createElement("span");return e.setAttribute("data-text-type",this.__textType),e.classList.add(this.__textType),e}updateDOM(){return!1}exportDOM(e){const{element:t}=super.exportDOM(e);return t&&je(t)&&t.setAttribute("data-text-type",this.getTextType()),{element:t}}decorate(){return this.getTextContent()}exportJSON(){return{type:this.getType(),textType:this.getTextType(),text:this.getTextContent(),version:r0}}isKeyboardSelectable(){return!1}}function r1(n){const e=n.getAttribute("data-text-type")??"",t=n.textContent??"";return{node:Dl(e,t)}}function Dl(n,e){return We(new hi(n,e))}function i1(n){return(n==null?void 0:n.tagName)==="span"}function Nl(n){return n instanceof hi}function s1(n){return(n==null?void 0:n.type)===hi.getType()}const Ml="unmatched",i0=1;class pi extends ci{constructor(e="",t){super(t),fe(this,"__marker"),this.__marker=e}static getType(){return"unmatched"}static clone(e){const{__marker:t,__key:r}=e;return new pi(t,r)}static importDOM(){return{[Ml]:e=>a1(e)?{conversion:o1,priority:1}:null}}static importJSON(e){return s0().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setMarker(e.marker)}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t}getMarker(){return this.getLatest().__marker}createDOM(){const e=document.createElement(Ml);e.setAttribute("data-marker",this.__marker),e.classList.add(og);const t=this.__marker.endsWith("*");return e.title=t?"This closing marker has no matching opening marker!":"This opening marker has no matching closing marker!",e}updateDOM(){return!1}exportDOM(e){const{element:t}=super.exportDOM(e);return t&&je(t)&&(t.setAttribute("data-marker",this.getMarker()),t.classList.add(og)),{element:t}}decorate(){return`\\${this.getMarker()}${Vc}`}exportJSON(){return{type:this.getType(),marker:this.getMarker(),version:i0}}isKeyboardSelectable(){return!1}}function o1(n){const e=n.getAttribute("data-marker")??"";return{node:s0(e)}}function s0(n){return We(new pi(n))}function a1(n){return(n==null?void 0:n.tagName)===Ml}function l1(n){return n instanceof pi}const u1=[In,$r,Xn,Yt,et,jt,hr,es,Zi,hi,pi,ln,si,{replace:qs,with:()=>Hn(),withKlass:si}];var B;(function(n){n.FileIdentification="FileIdentification",n.Headers="Headers",n.Remarks="Remarks",n.Introduction="Introduction",n.DivisionMarks="DivisionMarks",n.Paragraphs="Paragraphs",n.Poetry="Poetry",n.TitlesHeadings="TitlesHeadings",n.Tables="Tables",n.CenterTables="CenterTables",n.RightTables="RightTables",n.Lists="Lists",n.Footnotes="Footnotes",n.CrossReferences="CrossReferences",n.SpecialText="SpecialText",n.CharacterStyling="CharacterStyling",n.Breaks="Breaks",n.SpecialFeatures="SpecialFeatures",n.PeripheralReferences="PeripheralReferences",n.PeripheralMaterials="PeripheralMaterials",n.Uncategorized="Uncategorized"})(B||(B={}));var F;(function(n){n.Paragraph="Paragraph",n.Character="Character",n.Note="Note",n.Unknown="Unknown"})(F||(F={}));const c1={id:{category:B.FileIdentification,type:F.Paragraph,description:"File identification information (BOOKID, FILENAME, EDITOR, MODIFICATION DATE)",hasEndMarker:!1,children:{FileIdentification:["usfm","ide"],Headers:["h","h1","h2","h3","toc1","toc2","toc3"],Remarks:["rem","sts","restore"],Introduction:["imt","imt1","imt2","imt3","imt4","imte","imte1","imte2","is","is1","is2","iot","io","io1","io2","io3","io4","ior","ip","im","ipi","imi","ili","ili1","ili2","ipq","imq","ipr","ib","iq","iq1","iq2","iq3","iex","ie"],DivisionMarks:["c","cl"],TitlesHeadings:["mt","mt1","mt2","mt3","mt4"]}},usfm:{category:B.FileIdentification,type:F.Paragraph,description:"File markup version information",hasEndMarker:!1,children:void 0},ide:{category:B.FileIdentification,type:F.Paragraph,description:"File encoding information",hasEndMarker:!1,children:{Remarks:["rem","sts"]}},h:{category:B.Headers,type:F.Paragraph,description:"Running header text for a book (basic)",hasEndMarker:!1,children:{Headers:["toc1","toc2","toc3","toca1","toca2","toca3"]}},h1:{category:B.Headers,type:F.Paragraph,description:"Running header text",hasEndMarker:!1,children:{Headers:["toc1","toc2","toc3","toca1","toca2","toca3"]}},h2:{category:B.Headers,type:F.Paragraph,description:"Running header text, left side of page",hasEndMarker:!1,children:{Headers:["toc1","toc2","toc3","toca1","toca2","toca3"]}},h3:{category:B.Headers,type:F.Paragraph,description:"Running header text, right side of page",hasEndMarker:!1,children:{Headers:["toc1","toc2","toc3","toca1","toca2","toca3"]}},toc1:{category:B.Headers,type:F.Paragraph,description:"Long table of contents text",hasEndMarker:!1,children:void 0},toc2:{category:B.Headers,type:F.Paragraph,description:"Short table of contents text",hasEndMarker:!1,children:void 0},toc3:{category:B.Headers,type:F.Paragraph,description:"Book Abbreviation",hasEndMarker:!1,children:void 0},toca1:{category:B.Headers,type:F.Paragraph,description:"Alternative language long table of contents text",hasEndMarker:!1,children:void 0},toca2:{category:B.Headers,type:F.Paragraph,description:"Alternative language short table of contents text",hasEndMarker:!1,children:void 0},toca3:{category:B.Headers,type:F.Paragraph,description:"Alternative language book Abbreviation",hasEndMarker:!1,children:void 0},rem:{category:B.Remarks,type:F.Paragraph,description:"Comments and remarks",hasEndMarker:!1,children:void 0},sts:{category:B.Remarks,type:F.Paragraph,description:"Status of this file",hasEndMarker:!1,children:void 0},restore:{category:B.Remarks,type:F.Paragraph,description:"Project restore information",hasEndMarker:!1,children:void 0},imt:{category:B.Introduction,type:F.Paragraph,description:"Introduction major title, level 1 (if single level) (basic)",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"]}},imt1:{category:B.Introduction,type:F.Paragraph,description:"Introduction major title, level 1 (if multiple levels)",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"]}},imt2:{category:B.Introduction,type:F.Paragraph,description:"Introduction major title, level 2",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"]}},imt3:{category:B.Introduction,type:F.Paragraph,description:"Introduction major title, level 3",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"]}},imt4:{category:B.Introduction,type:F.Paragraph,description:"Introduction major title, level 4 (usually within parenthesis)",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"]}},imte:{category:B.Introduction,type:F.Paragraph,description:"Introduction major title at introduction end, level 1 (if single level)",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"]}},imte1:{category:B.Introduction,type:F.Paragraph,description:"Introduction major title at introduction end, level 1 (if multiple levels)",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"]}},imte2:{category:B.Introduction,type:F.Paragraph,description:"Introduction major title at introduction end, level 2",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"]}},is:{category:B.Introduction,type:F.Paragraph,description:"Introduction section heading, level 1 (if single level) (basic)",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"],CharacterStyling:["no"]}},is1:{category:B.Introduction,type:F.Paragraph,description:"Introduction section heading, level 1 (if multiple levels)",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"]}},is2:{category:B.Introduction,type:F.Paragraph,description:"Introduction section heading, level 2",hasEndMarker:!1,children:{Introduction:["iqt"],SpecialText:["bk"]}},iot:{category:B.Introduction,type:F.Paragraph,description:"Introduction outline title (basic)",hasEndMarker:!1,children:{Introduction:["iqt"],CharacterStyling:["no"]}},io:{category:B.Introduction,type:F.Paragraph,description:"Introduction outline text, level 1 (if single level)",hasEndMarker:!1,children:{Introduction:["ior","iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},io1:{category:B.Introduction,type:F.Paragraph,description:"Introduction outline text, level 1 (if multiple levels) (basic)",hasEndMarker:!1,children:{Introduction:["ior","iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},io2:{category:B.Introduction,type:F.Paragraph,description:"Introduction outline text, level 2",hasEndMarker:!1,children:{Introduction:["ior","iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},io3:{category:B.Introduction,type:F.Paragraph,description:"Introduction outline text, level 3",hasEndMarker:!1,children:{Introduction:["ior","iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},io4:{category:B.Introduction,type:F.Paragraph,description:"Introduction outline text, level 4",hasEndMarker:!1,children:{Introduction:["ior","iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},ior:{category:B.Introduction,type:F.Character,description:"Introduction references range for outline entry; for marking references separately",hasEndMarker:!0,children:void 0},ip:{category:B.Introduction,type:F.Paragraph,description:"Introduction prose paragraph (basic)",hasEndMarker:!1,children:{Introduction:["iqt"],Footnotes:["f","fe","fm"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},im:{category:B.Introduction,type:F.Paragraph,description:"Introduction prose paragraph, with no first line indent (may occur after poetry)",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},ipi:{category:B.Introduction,type:F.Paragraph,description:"Introduction prose paragraph, indented, with first line indent",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},imi:{category:B.Introduction,type:F.Paragraph,description:"Introduction prose paragraph text, indented, with no first line indent",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},ili:{category:B.Introduction,type:F.Paragraph,description:"A list entry, level 1 (if single level)",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},ili1:{category:B.Introduction,type:F.Paragraph,description:"A list entry, level 1 (if multiple levels)",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},ili2:{category:B.Introduction,type:F.Paragraph,description:"A list entry, level 2",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},ipq:{category:B.Introduction,type:F.Paragraph,description:"Introduction prose paragraph, quote from the body text",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},imq:{category:B.Introduction,type:F.Paragraph,description:"Introduction prose paragraph, quote from the body text, with no first line indent",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},ipr:{category:B.Introduction,type:F.Paragraph,description:"Introduction prose paragraph, right aligned",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},ib:{category:B.Introduction,type:F.Paragraph,description:"Introduction blank line",hasEndMarker:!1,children:{Introduction:["iqt"]}},iq:{category:B.Introduction,type:F.Paragraph,description:"Introduction poetry text, level 1 (if single level)",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},iq1:{category:B.Introduction,type:F.Paragraph,description:"Introduction poetry text, level 1 (if multiple levels)",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},iq2:{category:B.Introduction,type:F.Paragraph,description:"Introduction poetry text, level 2",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},iq3:{category:B.Introduction,type:F.Paragraph,description:"Introduction poetry text, level 3",hasEndMarker:!1,children:{Introduction:["iqt"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},iex:{category:B.Introduction,type:F.Paragraph,description:"Introduction explanatory or bridge text (e.g. explanation of missing book in Short Old Testament)",hasEndMarker:!1,children:{Introduction:["iqt"],CharacterStyling:["no"]}},iqt:{category:B.Introduction,type:F.Character,description:"For quoted scripture text appearing in the introduction",hasEndMarker:!0,children:void 0},ie:{category:B.Introduction,type:F.Paragraph,description:"Introduction ending marker",hasEndMarker:!1,children:void 0},c:{category:B.DivisionMarks,type:F.Paragraph,description:"Chapter number",hasEndMarker:!1,children:{DivisionMarks:["ca","cp","cl","cd"],Paragraphs:["p","m","po","pr","cls","pi","pi1","pi2","pi3","pc","mi","nb"],Poetry:["q","q1","q2","q3","q4","qc","qr","qa","qd","b"],TitlesHeadings:["mte","ms","ms1","ms2","ms3","s","s1","s2","s3","s4","r","sp","d","sd","sd1","sd2","sd3","sd4"],Lists:["lh","li","li1","li2","li3","li4","lf","lim","lim1","lim2","lim3","lim4"],Footnotes:["f","fe"],SpecialText:["lit"],Breaks:["pb"]}},ca:{category:B.DivisionMarks,type:F.Character,description:"Second (alternate) chapter number (for coding dual versification; useful for places where different traditions of chapter breaks need to be supported in the same translation)",hasEndMarker:!0,children:void 0},cp:{category:B.DivisionMarks,type:F.Paragraph,description:"Published chapter number (chapter string that should appear in the published text)",hasEndMarker:!1,children:{Footnotes:["f"]}},cl:{category:B.DivisionMarks,type:F.Paragraph,description:"Chapter label used for translations that add a word such as 'Chapter' before chapter numbers (e.g. Psalms). The subsequent text is the chapter label.",hasEndMarker:!1,children:void 0},cd:{category:B.DivisionMarks,type:F.Paragraph,description:"Chapter Description (Publishing option D, e.g. in Russian Bibles)",hasEndMarker:!1,children:{DivisionMarks:["vp"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},v:{category:B.DivisionMarks,type:F.Character,description:"A verse number",hasEndMarker:!1,children:void 0},va:{category:B.DivisionMarks,type:F.Character,description:"Second (alternate) verse number (for coding dual numeration in Psalms; see also NRSV Exo 22.1-4)",hasEndMarker:!0,children:void 0},vp:{category:B.DivisionMarks,type:F.Character,description:"Published verse marker (verse string that should appear in the published text)",hasEndMarker:!0,children:void 0},p:{category:B.Paragraphs,type:F.Paragraph,description:"Paragraph text, with first line indent (basic)",hasEndMarker:!1,children:{Paragraphs:["pmo","pm","pmc","pmr"],Poetry:["qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},m:{category:B.Paragraphs,type:F.Paragraph,description:"Paragraph text, with no first line indent (may occur after poetry) (basic)",hasEndMarker:!1,children:{Paragraphs:["pmo","pm","pmc","pmr"],Poetry:["qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},po:{category:B.Paragraphs,type:F.Paragraph,description:"Letter opening",hasEndMarker:!1,children:{Paragraphs:["pmo","pm","pmc","pmr"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},pr:{category:B.Paragraphs,type:F.Paragraph,description:"Text refrain (paragraph text, right aligned)",hasEndMarker:!1,children:{Paragraphs:["pmo","pm","pmc","pmr"],Poetry:["qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},cls:{category:B.Paragraphs,type:F.Paragraph,description:"Letter Closing",hasEndMarker:!1,children:{SpecialText:["tl","sig","pn","png","addpn","add"]}},pmo:{category:B.Paragraphs,type:F.Paragraph,description:"Embedded text opening",hasEndMarker:!1,children:{TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},pm:{category:B.Paragraphs,type:F.Paragraph,description:"Embedded text paragraph",hasEndMarker:!1,children:{TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},pmc:{category:B.Paragraphs,type:F.Paragraph,description:"Embedded text closing",hasEndMarker:!1,children:{TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},pmr:{category:B.Paragraphs,type:F.Paragraph,description:"Embedded text refrain (e.g. Then all the people shall say, 'Amen!')",hasEndMarker:!1,children:{TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},pi:{category:B.Paragraphs,type:F.Paragraph,description:"Paragraph text, level 1 indent (if single level), with first line indent; often used for discourse (basic)",hasEndMarker:!1,children:{Poetry:["qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},pi1:{category:B.Paragraphs,type:F.Paragraph,description:"Paragraph text, level 1 indent (if multiple levels), with first line indent; often used for discourse",hasEndMarker:!1,children:{Poetry:["qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},pi2:{category:B.Paragraphs,type:F.Paragraph,description:"Paragraph text, level 2 indent, with first line indent; often used for discourse",hasEndMarker:!1,children:{Poetry:["qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},pi3:{category:B.Paragraphs,type:F.Paragraph,description:"Paragraph text, level 3 indent, with first line indent; often used for discourse",hasEndMarker:!1,children:{Poetry:["qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},pc:{category:B.Paragraphs,type:F.Paragraph,description:"Paragraph text, centered (for Inscription)",hasEndMarker:!1,children:{Poetry:["qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},mi:{category:B.Paragraphs,type:F.Paragraph,description:"Paragraph text, indented, with no first line indent; often used for discourse",hasEndMarker:!1,children:{Poetry:["qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},nb:{category:B.Paragraphs,type:F.Paragraph,description:"Paragraph text, with no break from previous paragraph text (at chapter boundary) (basic)",hasEndMarker:!1,children:{Poetry:["qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},q:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, level 1 indent (if single level)",hasEndMarker:!1,children:{Poetry:["qs","qac","qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},q1:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, level 1 indent (if multiple levels) (basic)",hasEndMarker:!1,children:{Poetry:["qs","qac","qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},q2:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, level 2 indent (basic)",hasEndMarker:!1,children:{Poetry:["qs","qac","qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},q3:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, level 3 indent",hasEndMarker:!1,children:{Poetry:["qs","qac","qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},q4:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, level 4 indent",hasEndMarker:!1,children:{Poetry:["qs","qac","qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},qc:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, centered",hasEndMarker:!1,children:{Poetry:["qs","qac","qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},qr:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, Right Aligned",hasEndMarker:!1,children:{Poetry:["qs","qac","qm","qm1","qm2","qm3"],TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},qs:{category:B.Poetry,type:F.Character,description:"Poetry text, Selah",hasEndMarker:!0,children:{Footnotes:["f"],CrossReferences:["x"]}},qa:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, Acrostic marker/heading",hasEndMarker:!1,children:void 0},qac:{category:B.Poetry,type:F.Character,description:"Poetry text, Acrostic markup of the first character of a line of acrostic poetry",hasEndMarker:!0,children:void 0},qm:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, embedded, level 1 indent (if single level)",hasEndMarker:!1,children:{TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},qm1:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, embedded, level 1 indent (if multiple levels)",hasEndMarker:!1,children:{TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},qm2:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, embedded, level 2 indent",hasEndMarker:!1,children:{TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},qm3:{category:B.Poetry,type:F.Paragraph,description:"Poetry text, embedded, level 3 indent",hasEndMarker:!1,children:{TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},qd:{category:B.Poetry,type:F.Paragraph,description:"A Hebrew musical performance annotation, similar in content to Hebrew descriptive title.",hasEndMarker:!1,children:{TitlesHeadings:["mte1"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},b:{category:B.Poetry,type:F.Paragraph,description:"Poetry text stanza break (e.g. stanza break) (basic)",hasEndMarker:!1,children:void 0},mt:{category:B.TitlesHeadings,type:F.Paragraph,description:"The main title of the book (if single level)",hasEndMarker:!1,children:{Footnotes:["f"],CrossReferences:["x"]}},mt1:{category:B.TitlesHeadings,type:F.Paragraph,description:"The main title of the book (if multiple levels) (basic)",hasEndMarker:!1,children:{Footnotes:["f"],CrossReferences:["x"]}},mt2:{category:B.TitlesHeadings,type:F.Paragraph,description:"A secondary title usually occurring before the main title (basic)",hasEndMarker:!1,children:{Footnotes:["f"],CrossReferences:["x"]}},mt3:{category:B.TitlesHeadings,type:F.Paragraph,description:"A secondary title occurring after the main title",hasEndMarker:!1,children:{Footnotes:["f"],CrossReferences:["x"]}},mt4:{category:B.TitlesHeadings,type:F.Paragraph,description:"A small secondary title sometimes occurring within parentheses",hasEndMarker:!1,children:void 0},mte:{category:B.TitlesHeadings,type:F.Paragraph,description:"The main title of the book repeated at the end of the book, level 1 (if single level)",hasEndMarker:!1,children:void 0},mte1:{category:B.TitlesHeadings,type:F.Paragraph,description:"The main title of the book repeated at the end of the book, level 1 (if multiple levels)",hasEndMarker:!1,children:{TitlesHeadings:["mte2"]}},mte2:{category:B.TitlesHeadings,type:F.Paragraph,description:"A secondary title occurring before or after the 'ending' main title",hasEndMarker:!1,children:void 0},ms:{category:B.TitlesHeadings,type:F.Paragraph,description:"A major section division heading, level 1 (if single level) (basic)",hasEndMarker:!1,children:{TitlesHeadings:["mr"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},ms1:{category:B.TitlesHeadings,type:F.Paragraph,description:"A major section division heading, level 1 (if multiple levels)",hasEndMarker:!1,children:{TitlesHeadings:["mr"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},ms2:{category:B.TitlesHeadings,type:F.Paragraph,description:"A major section division heading, level 2",hasEndMarker:!1,children:{TitlesHeadings:["mr"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},ms3:{category:B.TitlesHeadings,type:F.Paragraph,description:"A major section division heading, level 3",hasEndMarker:!1,children:{TitlesHeadings:["mr"],Footnotes:["f","fe"]}},mr:{category:B.TitlesHeadings,type:F.Paragraph,description:"A major section division references range heading (basic)",hasEndMarker:!1,children:void 0},s:{category:B.TitlesHeadings,type:F.Paragraph,description:"A section heading, level 1 (if single level) (basic)",hasEndMarker:!1,children:{TitlesHeadings:["sr","r"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},s1:{category:B.TitlesHeadings,type:F.Paragraph,description:"A section heading, level 1 (if multiple levels)",hasEndMarker:!1,children:{TitlesHeadings:["sr","r"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},s2:{category:B.TitlesHeadings,type:F.Paragraph,description:"A section heading, level 2 (e.g. Proverbs 22-24)",hasEndMarker:!1,children:{TitlesHeadings:["sr","r"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},s3:{category:B.TitlesHeadings,type:F.Paragraph,description:"A section heading, level 3 (e.g. Genesis 'The First Day')",hasEndMarker:!1,children:{TitlesHeadings:["sr","r"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["no","it","bd","bdit","em","sc","sup"]}},s4:{category:B.TitlesHeadings,type:F.Paragraph,description:"A section heading, level 4",hasEndMarker:!1,children:{TitlesHeadings:["sr","r"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},sr:{category:B.TitlesHeadings,type:F.Paragraph,description:"A section division references range heading",hasEndMarker:!1,children:void 0},r:{category:B.TitlesHeadings,type:F.Paragraph,description:"Parallel reference(s) (basic)",hasEndMarker:!1,children:void 0},sp:{category:B.TitlesHeadings,type:F.Paragraph,description:"A heading, to identify the speaker (e.g. Job)",hasEndMarker:!1,children:{Footnotes:["f","fe","fm"],CrossReferences:["x","xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},d:{category:B.TitlesHeadings,type:F.Paragraph,description:"A Hebrew text heading, to provide description (e.g. Psalms)",hasEndMarker:!1,children:{Footnotes:["f","fe","fm"],CrossReferences:["x","xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},sd:{category:B.TitlesHeadings,type:F.Paragraph,description:"Vertical space used to divide the text into sections, level 1 (if single level)",hasEndMarker:!1,children:void 0},sd1:{category:B.TitlesHeadings,type:F.Paragraph,description:"Vertical space used to divide the text into sections, level 1 (if multiple levels)",hasEndMarker:!1,children:void 0},sd2:{category:B.TitlesHeadings,type:F.Paragraph,description:"Vertical space used to divide the text into sections, level 2",hasEndMarker:!1,children:void 0},sd3:{category:B.TitlesHeadings,type:F.Paragraph,description:"Vertical space used to divide the text into sections, level 3",hasEndMarker:!1,children:void 0},sd4:{category:B.TitlesHeadings,type:F.Paragraph,description:"Vertical space used to divide the text into sections, level 4",hasEndMarker:!1,children:void 0},lh:{category:B.Lists,type:F.Paragraph,description:"List header (introductory remark)",hasEndMarker:!1,children:{Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},li:{category:B.Lists,type:F.Paragraph,description:"A list entry, level 1 (if single level)",hasEndMarker:!1,children:{Lists:["litl","lik","liv","liv1","liv2","liv3","liv4","liv5"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},li1:{category:B.Lists,type:F.Paragraph,description:"A list entry, level 1 (if multiple levels)",hasEndMarker:!1,children:{Lists:["litl","lik","liv","liv1","liv2","liv3","liv4","liv5"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},li2:{category:B.Lists,type:F.Paragraph,description:"A list entry, level 2",hasEndMarker:!1,children:{Lists:["litl","lik","liv","liv1","liv2","liv3","liv4","liv5"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},li3:{category:B.Lists,type:F.Paragraph,description:"A list entry, level 3",hasEndMarker:!1,children:{Lists:["litl","lik","liv","liv1","liv2","liv3","liv4","liv5"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},li4:{category:B.Lists,type:F.Paragraph,description:"A list entry, level 4",hasEndMarker:!1,children:{Lists:["litl","lik","liv","liv1","liv2","liv3","liv4","liv5"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},lf:{category:B.Lists,type:F.Paragraph,description:"List footer (concluding remark)",hasEndMarker:!1,children:{Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},lim:{category:B.Lists,type:F.Paragraph,description:"An embedded list entry, level 1 (if single level)",hasEndMarker:!1,children:{Lists:["litl","lik","liv","liv1","liv2","liv3","liv4","liv5"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},lim1:{category:B.Lists,type:F.Paragraph,description:"An embedded list entry, level 1 (if multiple levels)",hasEndMarker:!1,children:{Lists:["litl","lik","liv","liv1","liv2","liv3","liv4","liv5"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},lim2:{category:B.Lists,type:F.Paragraph,description:"An embedded list entry, level 2",hasEndMarker:!1,children:{Lists:["litl","lik","liv","liv1","liv2","liv3","liv4","liv5"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},lim3:{category:B.Lists,type:F.Paragraph,description:"An embedded list item, level 3",hasEndMarker:!1,children:{Lists:["litl","lik","liv","liv1","liv2","liv3","liv4","liv5"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},lim4:{category:B.Lists,type:F.Paragraph,description:"An embedded list entry, level 4",hasEndMarker:!1,children:{Lists:["litl","lik","liv","liv1","liv2","liv3","liv4","liv5"],Footnotes:["f","fe","fm"],CrossReferences:["x","xt","rq"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},litl:{category:B.Lists,type:F.Character,description:"List entry total text",hasEndMarker:!0,children:void 0},lik:{category:B.Lists,type:F.Character,description:"Structured list entry key text",hasEndMarker:!0,children:void 0},liv:{category:B.Lists,type:F.Character,description:"Structured list entry value 1 content (if single value)",hasEndMarker:!0,children:void 0},liv1:{category:B.Lists,type:F.Character,description:"Structured list entry value 1 content (if multiple values)",hasEndMarker:!0,children:void 0},liv2:{category:B.Lists,type:F.Character,description:"Structured list entry value 2 content",hasEndMarker:!0,children:void 0},liv3:{category:B.Lists,type:F.Character,description:"Structured list entry value 3 content",hasEndMarker:!0,children:void 0},liv4:{category:B.Lists,type:F.Character,description:"Structured list entry value 4 content",hasEndMarker:!0,children:void 0},liv5:{category:B.Lists,type:F.Character,description:"Structured list entry value 5 content",hasEndMarker:!0,children:void 0},f:{category:B.Footnotes,type:F.Note,description:"A Footnote text item (basic)",hasEndMarker:!0,children:{Footnotes:["fr","ft","fk","fq","fqa","fl","fw","fp","fv","fdc"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},fe:{category:B.Footnotes,type:F.Note,description:"An Endnote text item",hasEndMarker:!0,children:{Footnotes:["fr","ft","fk","fq","fqa","fl","fw","fp","fv","fdc"],CrossReferences:["xt"],SpecialText:["qt","nd","tl","dc","bk","sig","pn","png","addpn","wj","k","sls","ord","add"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},fr:{category:B.Footnotes,type:F.Character,description:"The origin reference for the footnote (basic)",hasEndMarker:!0,children:void 0},ft:{category:B.Footnotes,type:F.Character,description:"Footnote text, Protocanon (basic)",hasEndMarker:!0,children:void 0},fk:{category:B.Footnotes,type:F.Character,description:"A footnote keyword (basic)",hasEndMarker:!0,children:void 0},fq:{category:B.Footnotes,type:F.Character,description:"A footnote scripture quote or alternate rendering (basic)",hasEndMarker:!0,children:void 0},fqa:{category:B.Footnotes,type:F.Character,description:"A footnote alternate rendering for a portion of scripture text",hasEndMarker:!0,children:void 0},fl:{category:B.Footnotes,type:F.Character,description:"A footnote label text item, for marking or 'labelling' the type or alternate translation being provided in the note.",hasEndMarker:!0,children:void 0},fw:{category:B.Footnotes,type:F.Character,description:"A footnote witness list, for distinguishing a list of sigla representing witnesses in critical editions.",hasEndMarker:!0,children:void 0},fp:{category:B.Footnotes,type:F.Character,description:"A Footnote additional paragraph marker",hasEndMarker:!0,children:void 0},fv:{category:B.Footnotes,type:F.Character,description:"A verse number within the footnote text",hasEndMarker:!0,children:void 0},fdc:{category:B.Footnotes,type:F.Character,description:"Footnote text, applies to Deuterocanon only",hasEndMarker:!0,children:void 0},fm:{category:B.Footnotes,type:F.Character,description:"An additional footnote marker location for a previous footnote",hasEndMarker:!0,children:void 0},x:{category:B.CrossReferences,type:F.Note,description:"A list of cross references (basic)",hasEndMarker:!0,children:{CrossReferences:["xo","xop","xt","xta","xk","xq","xot","xnt","xdc"],CharacterStyling:["it","bd","bdit","em","sc","sup"]}},xo:{category:B.CrossReferences,type:F.Character,description:"The cross reference origin reference (basic)",hasEndMarker:!0,children:void 0},xop:{category:B.CrossReferences,type:F.Character,description:"Published cross reference origin reference (origin reference that should appear in the published text)",hasEndMarker:!0,children:void 0},xt:{category:B.CrossReferences,type:F.Character,description:"The cross reference target reference(s), protocanon only (basic)",hasEndMarker:!0,children:void 0},xta:{category:B.CrossReferences,type:F.Character,description:"Cross reference target references added text",hasEndMarker:!0,children:void 0},xk:{category:B.CrossReferences,type:F.Character,description:"A cross reference keyword",hasEndMarker:!0,children:void 0},xq:{category:B.CrossReferences,type:F.Character,description:"A cross-reference quotation from the scripture text",hasEndMarker:!0,children:void 0},xot:{category:B.CrossReferences,type:F.Character,description:"Cross-reference target reference(s), Old Testament only",hasEndMarker:!0,children:void 0},xnt:{category:B.CrossReferences,type:F.Character,description:"Cross-reference target reference(s), New Testament only",hasEndMarker:!0,children:void 0},xdc:{category:B.CrossReferences,type:F.Character,description:"Cross-reference target reference(s), Deuterocanon only",hasEndMarker:!0,children:void 0},rq:{category:B.CrossReferences,type:F.Character,description:"A cross-reference indicating the source text for the preceding quotation.",hasEndMarker:!0,children:void 0},qt:{category:B.SpecialText,type:F.Character,description:"For Old Testament quoted text appearing in the New Testament (basic)",hasEndMarker:!0,children:void 0},nd:{category:B.SpecialText,type:F.Character,description:"For name of deity (basic)",hasEndMarker:!0,children:void 0},tl:{category:B.SpecialText,type:F.Character,description:"For transliterated words",hasEndMarker:!0,children:void 0},dc:{category:B.SpecialText,type:F.Character,description:"Deuterocanonical/LXX additions or insertions in the Protocanonical text",hasEndMarker:!0,children:void 0},bk:{category:B.SpecialText,type:F.Character,description:"For the quoted name of a book",hasEndMarker:!0,children:void 0},sig:{category:B.SpecialText,type:F.Character,description:"For the signature of the author of an Epistle",hasEndMarker:!0,children:void 0},pn:{category:B.SpecialText,type:F.Character,description:"For a proper name",hasEndMarker:!0,children:void 0},png:{category:B.SpecialText,type:F.Character,description:"For a geographic proper name",hasEndMarker:!0,children:void 0},addpn:{category:B.SpecialText,type:F.Character,description:"For chinese words to be dot underline & underline",hasEndMarker:!0,children:void 0},wj:{category:B.SpecialText,type:F.Character,description:"For marking the words of Jesus",hasEndMarker:!0,children:void 0},k:{category:B.SpecialText,type:F.Character,description:"For a keyword",hasEndMarker:!0,children:void 0},sls:{category:B.SpecialText,type:F.Character,description:"To represent where the original text is in a secondary language or from an alternate text source",hasEndMarker:!0,children:void 0},ord:{category:B.SpecialText,type:F.Character,description:"For the text portion of an ordinal number",hasEndMarker:!0,children:void 0},add:{category:B.SpecialText,type:F.Character,description:"For a translational addition to the text",hasEndMarker:!0,children:void 0},lit:{category:B.SpecialText,type:F.Paragraph,description:"For a comment or note inserted for liturgical use",hasEndMarker:!1,children:void 0},no:{category:B.CharacterStyling,type:F.Character,description:"A character style, use normal text",hasEndMarker:!0,children:void 0},it:{category:B.CharacterStyling,type:F.Character,description:"A character style, use italic text",hasEndMarker:!0,children:void 0},bd:{category:B.CharacterStyling,type:F.Character,description:"A character style, use bold text",hasEndMarker:!0,children:void 0},bdit:{category:B.CharacterStyling,type:F.Character,description:"A character style, use bold + italic text",hasEndMarker:!0,children:void 0},em:{category:B.CharacterStyling,type:F.Character,description:"A character style, use emphasized text style",hasEndMarker:!0,children:void 0},sc:{category:B.CharacterStyling,type:F.Character,description:"A character style, for small capitalization text",hasEndMarker:!0,children:void 0},sup:{category:B.CharacterStyling,type:F.Character,description:"A character style, for superscript text. Typically for use in critical edition footnotes.",hasEndMarker:!0,children:void 0},pb:{category:B.Breaks,type:F.Paragraph,description:"Page Break used for new reader portions and children's bibles where content is controlled by the page",hasEndMarker:!1,children:void 0}},wi={DivisionMarks:{add:["v","c"],remove:[]},Paragraphs:{add:["p"],remove:[]},Poetry:{add:["q","q1","q2","q3","q4","b"],remove:[]},TitlesHeadings:{add:["mte","ms","ms1","ms2","ms3","s","s1","s2","s3","s4","r","sp","d","sd","sd1","sd2","sd3","sd4"],remove:[]}},d1={p:{children:wi},q:{children:wi},q1:{children:wi},q2:{children:wi},q3:{children:wi},q4:{children:wi},b:{children:wi},qm:{children:{Paragraphs:{add:["p"],remove:[]}}},c:{type:F.Paragraph,children:null},v:{children:null}};function lg(n){const e=c1[n],t=d1[n];if(!e)return;if(!t)return e;let r=e.children?{...e.children}:void 0;if(t.children===null&&(r=void 0),t.children){r=r||{};for(const[i,s]of Object.entries(t.children)){const o=i;if(s===null)Reflect.deleteProperty(r,o);else{let a=r[o]||[];s.remove&&(a=a.filter(l=>!s.remove.includes(l))),s.add&&(a=[...new Set([...a,...s.add])]),a.length>0?r[o]=a:Reflect.deleteProperty(r,o)}}Object.keys(r).length===0&&(r=void 0)}return{...e,...t,children:r}}function ug(n,e,t){const r={type:Fi,version:Bi,content:n},i=e.serializeEditorState(r,t);return _f(i.root.children[0])?i.root.children[0].children[0]:i.root.children[0]}const o0=1;class Kn extends ci{constructor(e=Ui,t="",r,i){super(i),fe(this,"__caller"),fe(this,"__previewText"),fe(this,"__onClick"),this.__caller=e,this.__previewText=t,this.__onClick=r??(()=>{})}static getType(){return"immutable-note-caller"}static clone(e){const{__caller:t,__previewText:r,__onClick:i,__key:s}=e;return new Kn(t,r,i,s)}static importDOM(){return{span:e=>h1(e)?{conversion:f1,priority:1}:null}}static importJSON(e){return Tf().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setCaller(e.caller).setPreviewText(e.previewText).setOnClick(e.onClick)}setCaller(e){if(this.__caller===e)return this;const t=this.getWritable();return t.__caller=e,t}getCaller(){return this.getLatest().__caller}setPreviewText(e){if(this.__previewText===e)return this;const t=this.getWritable();return t.__previewText=e,t}getPreviewText(){return this.getLatest().__previewText}setOnClick(e){if(this.__onClick===e)return this;const t=this.getWritable();return t.__onClick=e,t}getOnClick(){return this.getLatest().__onClick}createDOM(){const e=document.createElement("span");return e.classList.add(this.__type),e.setAttribute("data-caller",this.__caller),e.setAttribute("data-preview-text",this.__previewText),e}updateDOM(e){return e.__caller!==this.__caller}exportDOM(e){const{element:t}=super.exportDOM(e);return t&&je(t)&&(t.classList.add(this.getType()),t.setAttribute("data-caller",this.getCaller()),t.setAttribute("data-preview-text",this.getPreviewText())),{element:t}}decorate(e){const t=this.getParent();if(!t)return null;const r=t.getKey(),i=t.getIsCollapsed(),s=this.__key,o=l=>{var u;return(u=this.__onClick)==null?void 0:u.call(this,l,r,i,()=>p1(e,r),c=>g1(e,r,s,c))},a=`${this.__caller}_${this.__previewText}}`.replace(/\s+/g,"").substring(0,25);return I.jsx("button",{onClick:o,title:this.__previewText,"data-caller-id":a,children:this.__caller===Ui&&i?"":this.__caller})}exportJSON(){return{type:this.getType(),caller:this.getCaller(),previewText:this.getPreviewText(),onClick:this.getOnClick(),version:o0}}isKeyboardSelectable(){return!1}}function f1(n){const e=n.getAttribute("data-caller")??"",t=n.getAttribute("data-preview-text")??"";return{node:Tf(e,t)}}function Tf(n,e,t){return We(new Kn(n,e,t))}function h1(n){return n?n.classList.contains(Kn.getType()):!1}function gi(n){return n instanceof Kn}function p1(n,e){return n.read(()=>{const t=xe(e);if(!$e(t))throw new Error(`getCaller: Note node not found: ${e}`);return t.getCaller()})}function g1(n,e,t,r){n.update(()=>{const i=xe(e);if(!$e(i))throw new Error(`setCaller: Note node not found: ${e}`);i.setCaller(r);const s=xe(t);if(!gi(s))throw new Error(`setCaller: Caller node not found: ${t}`);s.setCaller(r)})}const m1=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],a0="v",l0=1;class Xt extends ci{constructor(e="",t=!1,r,i,s,o,a){super(a),fe(this,"__marker"),fe(this,"__number"),fe(this,"__showMarker"),fe(this,"__sid"),fe(this,"__altnumber"),fe(this,"__pubnumber"),fe(this,"__unknownAttributes"),this.__marker=a0,this.__number=e,this.__showMarker=t,this.__sid=r,this.__altnumber=i,this.__pubnumber=s,this.__unknownAttributes=o}static getType(){return"immutable-verse"}static clone(e){const{__number:t,__showMarker:r,__sid:i,__altnumber:s,__pubnumber:o,__unknownAttributes:a,__key:l}=e;return new Xt(t,r,i,s,o,a,l)}static importDOM(){return{span:e=>_1(e)?{conversion:y1,priority:1}:null}}static importJSON(e){return Af().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setMarker(e.marker).setNumber(e.number).setShowMarker(e.showMarker).setSid(e.sid).setAltnumber(e.altnumber).setPubnumber(e.pubnumber).setUnknownAttributes(e.unknownAttributes)}setMarker(e){if(this.__marker===e)return this;const t=this.getWritable();return t.__marker=e,t}getMarker(){return this.getLatest().__marker}setNumber(e){if(this.__number===e)return this;const t=this.getWritable();return t.__number=e,t}getNumber(){return this.getLatest().__number}setShowMarker(e=!1){if(this.__showMarker===e)return this;const t=this.getWritable();return t.__showMarker=e,t}getShowMarker(){return this.getLatest().__showMarker}setSid(e){if(this.__sid===e)return this;const t=this.getWritable();return t.__sid=e,t}getSid(){return this.getLatest().__sid}setAltnumber(e){if(this.__altnumber===e)return this;const t=this.getWritable();return t.__altnumber=e,t}getAltnumber(){return this.getLatest().__altnumber}setPubnumber(e){if(this.__pubnumber===e)return this;const t=this.getWritable();return t.__pubnumber=e,t}getPubnumber(){return this.getLatest().__pubnumber}setUnknownAttributes(e){const t=this.getWritable();return t.__unknownAttributes=e,t}getUnknownAttributes(){return this.getLatest().__unknownAttributes}createDOM(){const e=document.createElement("span");return e.setAttribute("data-marker",this.__marker),e.classList.add(Jc,`usfm_${this.__marker}`),this.__showMarker&&e.classList.add("marker"),e.setAttribute("data-number",this.__number),e}updateDOM(){return!1}exportDOM(e){const{element:t}=super.exportDOM(e);return t&&je(t)&&(t.setAttribute("data-marker",this.getMarker()),t.classList.add(Jc,`usfm_${this.getMarker()}`),t.setAttribute("data-number",this.getNumber())),{element:t}}decorate(){return I.jsx("span",{children:this.getShowMarker()?Yo(this.getMarker(),this.getNumber()):Vc+this.getNumber()+Vc})}exportJSON(){return{type:this.getType(),marker:this.getMarker(),number:this.getNumber(),showMarker:this.getShowMarker(),sid:this.getSid(),altnumber:this.getAltnumber(),pubnumber:this.getPubnumber(),unknownAttributes:this.getUnknownAttributes(),version:l0}}isKeyboardSelectable(){return!1}}function y1(n){const e=n.getAttribute("data-number")??"0";return{node:Af(e)}}function Af(n,e,t,r,i,s){return We(new Xt(n,e,t,r,i,s))}function _1(n){return((n==null?void 0:n.getAttribute("data-marker"))??void 0)===a0}function Qo(n){return n instanceof Xt}function b1(n){return(n==null?void 0:n.type)===Xt.getType()}function td(n,e){if(!n||!Z(n))return[void 0,void 0];const t=n.getTextContent();if(e>=0&&e<t.length)return[n,e];let r=n.getNextSibling();if(!r){const s=n.getParent();Mt(s)&&(r=s.getNextSibling())}if(!r||!Mt(r)&&!Z(r))return[void 0,void 0];const i=e-t.length;return r&&Z(r)?td(r,i):td(r.getFirstChild()??void 0,i)}function cg(n){const e=bC(n.jsonPath);let t=Ne();for(const r of e){if(!t||!V(t))return[void 0,void 0];t=t.getChildAtIndex(r)??void 0}return td(t,n.offset)}function dg(n){return V(n)?"element":"text"}function Df(n){const{start:e}=n;let{end:t}=n;t===void 0&&(t=e);const[r,i]=cg(e),[s,o]=cg(t);if(!r||!s||i===void 0||o===void 0)return;const a=jo();return a.anchor=an(r.getKey(),i,dg(r)),a.focus=an(s.getKey(),o,dg(s)),a}function fg(n,e){const t=[];let r=n;for(;r!=null&&r.getParent();){const i=r.getParent();if(i){const s=i==null?void 0:i.getChildren().indexOf(r);s>=0&&t.unshift(s)}r=i}return{jsonPath:vC(t),offset:e}}function u0(){const n=ne();if(!n||!G(n))return;const e=n.isBackward()?n.focus.getNode():n.anchor.getNode(),t=n.isBackward()?n.focus.offset:n.anchor.offset,r=fg(e,t);if(n.isCollapsed())return{start:r};const i=n.isBackward()?n.anchor.getNode():n.focus.getNode(),s=n.isBackward()?n.anchor.offset:n.focus.offset,o=fg(i,s);return{start:r,end:o}}function Mn(n){return Cf(n)||Qo(n)}function v1(n){return $k(n)||b1(n)}function C1(n,e,t,r,i,s){if(!jt.isValidMarker(n))throw new Error(`$insertNote: Invalid note marker '${n}'`);const o=t?Df(t):ne();if(!G(o))return;const a=E1(o,n,r),l=d0(n,e,a,i,s);return c0(l,o,i),l}function c0(n,e,t){const r=(t==null?void 0:t.noteMode)==="collapsed";if(n.setIsCollapsed(r),e.isCollapsed()||Hk(e),e.insertNodes([n]),!r){const i=n.getChildren().reverse().find(st);i==null||i.selectEnd()}}function E1(n,e,t){const r=[],{chapterNum:i,verseNum:s}=t??{};switch(e){case"f":case"fe":case"ef":if(i!==void 0&&s!==void 0&&r.push(Sr("fr").append(we(`${i}:${s}`))),!n.isCollapsed()){const o=n.getTextContent().trim();if(o.length>0){const a=Sr("fq");a.append(we(o)),r.push(a)}}r.push(Sr("ft").append(we("-")));break;case"x":case"ex":i!==void 0&&s!==void 0&&r.push(Sr("xo").append(we(`${i}:${s}`))),r.push(Sr("xt").append(we("-")));break}return r}function d0(n,e,t,r,i,s){const o=(r==null?void 0:r.noteMode)!=="expanded",a=bf(n,e,o);s&&Tr(a,Is,()=>s);let l,u;(r==null?void 0:r.markerMode)==="editable"?(l=ed(n),u=ed(n,"closing")):(r==null?void 0:r.markerMode)==="visible"&&(l=Dl("marker",fi(n)+Ve),u=Dl("marker",Lo(n)+Ve));let c;if(l&&a.append(l),(r==null?void 0:r.markerMode)==="editable")c=we(xf(a.__caller)),a.append(c,...t);else{const f=()=>we(Ve),d=kf(t);let h=()=>{};i!=null&&i.noteCallerOnClick&&(h=i.noteCallerOnClick),c=Tf(a.__caller,d,h);const p=t.flatMap(w1(f));a.append(c,f(),...p)}return u&&a.append(u),a}function w1(n){return e=>Nl(e)?[e]:[e,n()]}function x1(n){return n.find(e=>Bt(e))}function k1(n,e){return V(n)?n.getChildren().find(t=>Mn(t)&&Sf(e,t.getNumber())):void 0}function S1(n,e){return e===0?x1(n):n.map(t=>k1(t,e)).filter(t=>t)[0]}function hg(n){return!n||!V(n)?void 0:n.getChildren().findLast(e=>Mn(e))}function f0(n){var e,t;if(!n||Nn(n))return;if(Mn(n))return n;let r=Mt(n.getParent())?(e=n.getParent())==null?void 0:e.getPreviousSibling():n.getPreviousSibling();for(;r&&!Mn(r)&&!Nn(r);)r=r.getPreviousSibling();if(r&&Mn(r))return r;let i=(t=n.getTopLevelElement())==null?void 0:t.getPreviousSibling(),s=hg(i),o=s;for(;i&&!s&&!Nn(i);)s=o,i=i.getPreviousSibling(),o=hg(i);if(!(!s&&Nn(i)))return s}function T1(n){return jk(n)||Qo(n)}function Nf(n){if(Z(n)){const e=n.getTextContent();!e.endsWith(" ")&&!e.endsWith(Ve)&&n.setTextContent(`${e} `)}}function h0(n){if(Z(n)){const e=n.getTextContent();e.startsWith(" ")&&n.setTextContent(e.trimStart())}}function Mf(n,e){return n.getEditorState().read(()=>!xe(e))}const A1=[Kn,Xt,...u1],D1=T.forwardRef((n,e)=>{const{coords:t,children:r,style:i,...s}=n,o=t!==void 0;return I.jsx("div",{ref:e,className:"floating-box","aria-hidden":!o,style:{...i,position:"absolute",zIndex:1e3,top:t==null?void 0:t.y,left:t==null?void 0:t.x,visibility:o?"visible":"hidden",opacity:o?1:0},...s,children:r})});function N1(){const[n,e]=T.useState(void 0),[t,r]=T.useState(),i=T.useRef(null),s=T.useCallback((a,l)=>{i.current&&i.current();const u=a.commonAncestorContainer.nodeType===a.commonAncestorContainer.TEXT_NODE?a:a.commonAncestorContainer;i.current=j0(u,l,()=>{U0(u,l,{placement:"bottom-start",middleware:[W0(),z0()]}).then(c=>{r(c.placement),e(f=>(f==null?void 0:f.x)===c.x&&(f==null?void 0:f.y)===c.y?f:{x:c.x,y:c.y})}).catch(()=>{e(void 0)})})},[]),o=T.useCallback(()=>{i.current&&(e(void 0),i.current(),i.current=null)},[]);return T.useEffect(()=>o,[o]),{coords:n,placement:t,updatePosition:s,cleanup:o}}function M1({isOpen:n,floatingBoxRef:e}){const{coords:t,updatePosition:r,cleanup:i,placement:s}=N1();return T.useEffect(()=>{var o;if(!n||!e.current){i();return}const a=(o=window.getSelection())==null?void 0:o.getRangeAt(0);if(!a){i();return}return r(a,e.current),i},[i,n,e,r]),{coords:t,placement:s}}const O1=document.body,I1=T.memo(D1);function R1({isOpen:n=!1,children:e}){const t=T.useRef(null),{coords:r,placement:i}=M1({isOpen:n,floatingBoxRef:t}),s=T.useMemo(()=>r?typeof e=="function"?e:()=>e:()=>null,[e,r]);return En.createPortal(I.jsx(I1,{ref:t,coords:r,style:r?void 0:{display:"none"},children:s({isOpen:n,placement:i})}),O1)}const p0=T.createContext(void 0);function Of(){const n=T.useContext(p0);if(!n)throw new Error("useMenuContext must be used within a MenuProvider");return n}function P1(n,e){const[t,r]=T.useState(0),[i,s]=T.useState(-1),o=T.useMemo(()=>n??[],[n]),a={menuItems:o,activeIndex:t,selectedIndex:i,onSelectOption:e??(()=>{})},l=T.useCallback(()=>{r(f=>{const d=o.length;return d?(f-1+d)%d:0})},[o.length]),u=T.useCallback(()=>{r(f=>{const d=o.length;return d?(f+1)%d:0})},[o.length]),c=T.useCallback(()=>{const f=o.length;if(t>=0&&t<f){const d=o[t];e==null||e(d),s(t)}},[t,o,e]);return{state:a,moveUp:l,moveDown:u,select:c,setActiveIndex:r,setSelectedIndex:s}}function L1({children:n,menuItems:e,onSelectOption:t,...r}){const i=P1(e,t);return I.jsx(p0.Provider,{value:i,children:I.jsx("div",{...r,children:n})})}const g0=T.forwardRef(({index:n,children:e,onMouseEnter:t,onClick:r,...i},s)=>{const{state:{activeIndex:o},setActiveIndex:a,setSelectedIndex:l,select:u}=Of(),c=T.useCallback(d=>{u(),l(-1),r==null||r(d)},[r,u,l]),f=T.useCallback(d=>{a(n),t==null||t(d)},[n,a,t]);return I.jsx("button",{ref:s,role:"menuitem",...i,onClick:c,onMouseEnter:f,"aria-selected":n!==void 0&&o===n?"true":void 0,tabIndex:-1,children:e})});function $1({children:n,autoIndex:e=!0,...t}){const r=T.useRef(null),{state:{activeIndex:i,menuItems:s}}=Of(),o=T.useMemo(()=>s?typeof n=="function"?n:()=>n:()=>null,[n,s]),a=T.useMemo(()=>{const l=o(s);return e?T.Children.map(l,(u,c)=>T.isValidElement(u)&&u.type===g0&&u.props.index===void 0?T.cloneElement(u,{index:c}):u):l},[o,e,s]);return T.useEffect(()=>{if(r.current){const l=r.current,u=l.children[i];if(u){const c=l.getBoundingClientRect(),f=u.getBoundingClientRect();f.bottom>c.bottom?l.scrollTop+=f.bottom-c.bottom:f.top<c.top&&(l.scrollTop-=c.top-f.top)}}},[i]),I.jsx("div",{ref:r,role:"menu",...t,children:a})}const tc={Root:L1,Options:$1,Option:g0},F1=(n,e,t)=>Xa(n,t).toLowerCase().includes(e.toLowerCase()),pg=n=>Object.keys(n).find(e=>typeof n[e]=="string")||"",Xa=(n,e)=>{const t=n[e];return typeof t=="string"?t:String(t)};function B1(n){const{query:e,items:t,filterBy:r,filter:i,sortBy:s,sortingOptions:o}=n,{caseSensitive:a=!1,priorityOrder:l=["exact","startsWith","contains"]}=o||{},u=a?e:e.toLowerCase();let c,f;i?(f=i,c=t.length>0?pg(t[0]):""):(c=r||(t.length>0?pg(t[0]):""),f=(p,m)=>F1(p,m,c));const d=s||c,h=new Map;return t.filter(p=>{try{return f(p,e)}catch(m){return console.warn("Error filtering item:",p,m),!1}}).sort((p,m)=>{const _=x=>(h.has(x)||h.set(x,Xa(x,d).toLowerCase()),h.get(x)??""),C=a?Xa(p,d):_(p),v=a?Xa(m,d):_(m);for(const x of l)switch(x){case"exact":if(C===u&&v!==u)return-1;if(v===u&&C!==u)return 1;break;case"startsWith":if(C.startsWith(u)&&!v.startsWith(u))return-1;if(v.startsWith(u)&&!C.startsWith(u))return 1;break;case"contains":{const M=C.indexOf(u),$=v.indexOf(u);if(M!==-1&&$===-1)return-1;if($!==-1&&M===-1)return 1;if(M!==-1&&$!==-1)return M-$;break}}return C.localeCompare(v)})}function q1(n){const{query:e,items:t,filterBy:r,filter:i,sortBy:s,sortingOptions:o}=n;return T.useMemo(()=>B1({query:e,items:t,filterBy:r,filter:i,sortBy:s,sortingOptions:o}),[e,t,r,i,s,o])}function j1(){const{moveUp:n,moveDown:e,select:t}=Of();return T.useMemo(()=>({moveUp:n,moveDown:e,select:t}),[n,e,t])}const U1=()=>{const n=j1(),[e]=ke();T.useEffect(()=>{const t=r=>{const i={ArrowDown:()=>n==null?void 0:n.moveDown(),ArrowUp:()=>n==null?void 0:n.moveUp(),Enter:()=>n==null?void 0:n.select(),Tab:()=>n==null?void 0:n.select()}[r.key];return i?(i(),r.preventDefault(),r.stopPropagation(),!0):!1};return e.registerCommand(Ps,t,Ul)},[e,n])};function W1(){return U1(),null}function z1(n){const{options:e,onSelectOption:t,onClose:r,inverse:i,query:s,menuOpenKey:o}=n,[a]=ke(),l=s!==void 0,[u,c]=T.useState(""),f=l?s??"":u,d=q1({query:f,items:e,filterBy:"name"}),h=p=>{r==null||r(),t?t(p):p.action(a)};return T.useEffect(()=>a.registerCommand(Ps,p=>{if(l)return!1;const m={Escape:()=>r==null?void 0:r(),Backspace:()=>{f.length===0?r==null||r():c(_=>_.slice(0,-1))}}[p.key];return m?(p.stopPropagation(),p.preventDefault(),m(),!0):p.key.length===1?(p.stopPropagation(),p.preventDefault(),p.key!==o&&c(_=>_+p.key),!0):!1},Ul),[a,l,f,o,r]),I.jsxs(tc.Root,{className:`autocomplete-menu-container ${i?"inverse":""}`,menuItems:d,onSelectOption:p=>h(p),children:[!l&&I.jsx("input",{value:f,type:"text",disabled:!0}),I.jsx(W1,{}),I.jsx(tc.Options,{className:"autocomplete-menu-options",autoIndex:!1,children:p=>p.map((m,_)=>I.jsxs(tc.Option,{index:_,children:[I.jsx("span",{className:"label",children:m.label??m.name}),I.jsx("span",{className:"description",children:m.description})]},m.name))})]})}function H1({trigger:n,items:e}){const[t]=ke(),[r,i]=T.useState(!1),s=T.useCallback(o=>{o.key==="Escape"&&r?(i(!1),t.focus()):o.key===n&&!r&&(o.preventDefault(),i(!0))},[t,n,r]);return T.useEffect(()=>t.registerRootListener(o=>{if(o)return o.addEventListener("keydown",s),()=>{o.removeEventListener("keydown",s)}}),[t,s]),T.useEffect(()=>t.registerUpdateListener(({prevEditorState:o,editorState:a})=>{const l=o.read(()=>{const u=ne();if(G(u))return u});a.read(()=>{const u=ne();!G(u)||l!=null&&l.is(u)||i(!1)})}),[t]),e&&I.jsx(R1,{isOpen:r,children:({placement:o})=>I.jsx(z1,{options:e,onClose:()=>i(!1),inverse:o==="top-start",menuOpenKey:n})})}function K1({scriptureReference:n,contextMarker:e,getMarkerAction:t}){return{markersMenuItems:T.useMemo(()=>{if(!e||!n)return;const r=lg(e);if(r!=null&&r.children)return Object.values(r.children).flatMap(i=>i.map(s=>{const o=lg(s),{action:a}=t(s,o);return{name:s,label:s,description:(o==null?void 0:o.description)??"",action:l=>{a({editor:l,reference:n})}}}))},[e,t,n])}}function Qa(n,e){return`${n}:${e}`}function V1(n,e){T.useEffect(()=>{if(!n.hasNodes([Dt]))throw new Error("AnnotationPlugin: TypedMarkNode not registered on editor!");const t=new Map;return vt(Xy(n,Dt,r=>$o(r.getTypedIDs()),(r,i)=>{for(const[s,o]of Object.entries(r.getTypedIDs()))o.forEach(a=>{i.addID(s,a)})}),n.registerMutationListener(Dt,r=>{n.getEditorState().read(()=>{for(const[i,s]of r){const o=xe(i);let a={};s==="destroyed"?a=t.get(i)??{}:Mt(o)&&(a=o.getTypedIDs());for(const[l,u]of Object.entries(a))if(!Dt.isReservedType(l))for(const c of u){let f=e.get(Qa(l,c));a[l]=u,t.set(i,a),s==="destroyed"?f!==void 0&&(f.delete(i),f.size===0&&e.delete(Qa(l,c))):(f===void 0&&(f=new Set,e.set(Qa(l,c),f)),f.has(i)||f.add(i))}}})},{skipInitialization:!0}))},[n,e])}const J1=T.forwardRef(function({logger:n},e){const[t]=ke(),r=T.useMemo(()=>new Map,[]);return V1(t,r),T.useImperativeHandle(e,()=>({addAnnotation(i,s,o){if(Dt.isReservedType(s))throw new Error(`addAnnotation: Can't directly add this reserved annotation type '${s}'. Use the appropriate plugin instead.`);t.update(()=>{const a=Df(i);if(a===void 0){n==null||n.error("Failed to find start or end node of the annotation.");return}n0(a,s,o)},{tag:Yc})},removeAnnotation(i,s){if(Dt.isReservedType(i))throw new Error(`removeAnnotation: Can't directly remove this reserved annotation type '${i}'. Use the appropriate plugin instead.`);const o=r.get(Qa(i,s));o!==void 0&&setTimeout(()=>{t.update(()=>{for(const a of o){const l=xe(a);Mt(l)&&(l.deleteID(i,s),l.hasNoIDsForEveryType()&&t0(l))}},{tag:Yc})})}})),null}),iu=`
`;function oi(n){return Nn(n)||Mn(n)||ru(n)||$e(n)||l1(n)}function pr(n){return Un(n)||fr(n)}function m0(n,e){if(!n)return!1;if(!e)return!0;let t=e.node.getParent();for(;t;){if(t===n)return!1;t=t.getParent()}return!0}function nd(n,e){const t={insert:n.__text},r=vs(n,Is);if(r&&(t.attributes={segment:r}),e&&e.length>0){let i=e.map(s=>{const o={style:s.__marker},a=vs(s,ii);return a&&(o.cid=a),o});i.length===1&&(i=i[0]),t.attributes={...t.attributes,char:i}}return t}function gg(n){const e=new ho;return n.isEmpty()||n.read(()=>{const t=Ne();if(!t||t.isEmpty())return;const r=t.getChildren();if(r.length===1&&Rr(r[0])&&(!r[0].getChildren()||r[0].getChildrenSize()===0))return;const i=G1();for(const s of i)e.push(s)}),e}function G1(){const n=[],e=Xd(),t=[],r=[],i={children:[],contentsOps:[]};for(let s=0;s<e.length;s++){const o=e[s].node;n.push(...mg(o,s,e,t,r,i))}for(const s of t)n.push(...mg(s,e.length,e,t,r,i));return n}function mg(n,e,t,r,i,s){if(!n)return[];const o=[];return Y1(n,o,r),X1(n,o,i,s),Q1(n,e,t,i),Nn(n)&&o.push(tS(n)),Mn(n)&&o.push(rS(n)),ru(n)&&o.push(iS(n)),Z1(n,o,s),o}function Y1(n,e,t){if(!n.isInline()){const r=t.pop();fr(r)?e.push(eS(r)):Bt(r)?e.push(nS(r)):Rr(r)&&e.push({insert:iu})}pr(n)&&(t.includes(n)||t.push(n))}function X1(n,e,t,r){var i;if(!Z(n))return;const s=n.getParent();if($e(s)&&s.getFirstChild()===n)return;const o=nd(n,t);r.children.includes(n)?(i=r.contentsOps)==null||i.push(o):e.push(o)}function Q1(n,e,t,r){st(n)&&!r.includes(n)&&r.push(n);const i=t[e+1];for(const s of r.toReversed())m0(s,i)&&r.pop()}function Z1(n,e,t){var r;if(!$e(n))return;Xd(n).forEach(s=>t.children.push(s.node));const i=sS(n);t.contentsOps=(r=i.insert.note.contents)==null?void 0:r.ops,e.push(i)}function eS(n){const e={style:nu,code:n.__code};return{insert:iu,attributes:{book:e}}}function tS(n){const e={style:gf,number:n.__number};return n.__sid&&(e.sid=n.__sid),n.__altnumber&&(e.altnumber=n.__altnumber),n.__pubnumber&&(e.pubnumber=n.__pubnumber),{insert:{chapter:e}}}function nS(n){const e={style:n.__marker};return{insert:iu,attributes:{para:e}}}function rS(n){const e={style:vf,number:n.__number};return n.__sid&&(e.sid=n.__sid),n.__altnumber&&(e.altnumber=n.__altnumber),n.__pubnumber&&(e.pubnumber=n.__pubnumber),{insert:{verse:e}}}function iS(n){const e={style:n.__marker};return n.__sid&&(e.sid=n.__sid),n.__eid&&(e.eid=n.__eid),{insert:{milestone:e}}}function sS(n){const e={style:n.__marker,caller:n.__caller};return n.__category&&(e.category=n.__category),n.getChildrenSize()>1&&(e.contents={ops:[]}),{insert:{note:e}}}function oS({ignoreHistoryMergeTagChange:n=!0,ignoreSelectionChange:e=!1,onChange:t}){const[r]=ke();return T.useLayoutEffect(()=>{if(t)return r.registerUpdateListener(i=>{const{editorState:s,dirtyElements:o,dirtyLeaves:a,prevEditorState:l,tags:u}=i;if(e&&o.size===0&&a.size===0||n&&u.has(Ti)||l.isEmpty())return;const c=aS(r,i);c.length!==0&&t(s,r,u,c)})},[r,n,e,t]),null}function aS(n,{dirtyLeaves:e,prevEditorState:t}){let r=new ho;return n.getEditorState().read(()=>{const i=e.values().next().value??"";if(e.size===1&&Z(xe(i))){const s=xe(i),o=lS(s);if(Z(s)){const a=t.read(()=>{const c=xe(i);return new ho([Z(c)?nd(c):{insert:""}])}),l=new ho([nd(s)]),u=new ho(o>0?[{retain:o}]:[]);r=r.concat(u).concat(a.diff(l))}}else{const s=gg(t),o=gg(n.getEditorState());r=s.diff(o)}}),r.ops}function lS(n){if(!n)return 0;const e=Xd(),t=[];let r=0;for(let i=0;i<e.length;i++){const s=e[i].node;if(s===n)return r;r+=uS(s,i,e,t)}return r}function uS(n,e,t,r){return Z(n)?n.getTextContent().length:oi(n)?1:pr(n)?cS(n,e,t,r):0}function cS(n,e,t,r){if(r.includes(n)||r.push(n),m0(n,t[e+1])){const i=r.indexOf(n);return i>-1&&r.splice(i,1),1}return 0}const dS=["style"],fS=["style","code"],Ol=["style","cid"],hS=["style","number","sid","altnumber","pubnumber"],pS=["style","number","sid","altnumber","pubnumber"],gS=["style","sid","eid"],mS=["style","caller","category","contents"];function yS(n,e,t,r){let i=0;n.forEach(s=>{if("retain"in s)i+=_S(s,i,r);else if("delete"in s){if(typeof s.delete!="number"||s.delete<=0){r==null||r.error(`Invalid delete operation: ${JSON.stringify(s)}`);return}r==null||r.debug(`Delete: ${s.delete}`),vS(i,s.delete,r)}else"insert"in s?typeof s.insert=="string"?(r==null||r.debug(`Insert: '${s.insert}'`),i+=CS(i,s.insert,s.attributes,r)):typeof s.insert=="object"&&s.insert!==null?(r==null||r.debug(`Insert embed: ${JSON.stringify(s.insert)}`),wS(i,s,e,t,r)?i+=1:r==null||r.error(`Failed to process insert embed operation: ${JSON.stringify(s.insert)} at index ${i}. Document may be inconsistent.`)):r==null||r.error(`Insert of unknown type: ${JSON.stringify(s.insert)}`):r==null||r.error(`Unknown operation: ${JSON.stringify(s)}`)})}function _S(n,e,t){return typeof n.retain!="number"||n.retain<0?(t==null||t.error(`Invalid retain operation: ${JSON.stringify(n)}`),0):(t==null||t.debug(`Retain: ${n.retain}`),n.attributes&&(t==null||t.debug(`Retain attributes: ${JSON.stringify(n.attributes)}`),bS(e,n.retain,n.attributes,t)),n.retain)}function bS(n,e,t,r){r==null||r.debug(`Applying attributes for range [${n}, ${n+e-1}] with attributes: ${JSON.stringify(t)}`);let i=e,s=0,o=-1;const a=Ne();function l(u){if(i<=0)return!0;if(Z(u)){const c=u.getTextContentSize();if(n<s+c&&s<n+e){const f=Math.max(0,n-s),d=c-f,h=Math.min(i,d);if(h>0){let p=u;const m=f>0,_=h<c-f;if(m&&_){const[,C]=u.splitText(f);[p]=C.splitText(h)}else m?[,p]=u.splitText(f):_&&([p]=u.splitText(h));if(Fo(t)){const C=p.getParent();if(st(C)){const v=t.char;let x;Array.isArray(v)?o>=0&&o<=v.length-1&&(x=v[o]):o===0&&(x=v);const M=x?Qc(x,C):!1;if(M&&Array.isArray(v)&&v.length>1){const $=we("");p.replace($);const k=typeof t.segment=="string"?t.segment:void 0,P=su(v.slice(1),p,k);$.replace(P),An(t,p)}else if(M)An(t,p);else{const $=we("");p.replace($);const k=yg(p,t,r);k?C.insertAfter(k):$.replace(p)}}else{const v=we("");p.replace(v);const x=yg(p,t,r);x?v.replace(x):v.replace(p)}}else An(t,p);i-=h}}s+=c}else if(oi(u))n<=s&&s<n+e&&i>0&&(_g(u,t),i-=1),s+=1;else if(st(u)){o+=1;let c=!1;if(n<=s&&s<n+e&&i>0)if(Fo(t)){const f=t.char;let d;if(Array.isArray(f)?o>=0&&o<=f.length-1&&(d=f[o]):o===0&&(d=f),d){u.setMarker(d.style),typeof d.cid=="string"&&Tr(u,ii,()=>d.cid);const h=Et(d,Ol);h&&Object.keys(h).length>0?u.setUnknownAttributes({...u.getUnknownAttributes()??{},...h}):u.setUnknownAttributes(void 0)}}else(t.char===!1||t.char===null||MS(t.char))&&(c=!0);if(i>0){const f=u.getChildren();for(const d of f){if(i<=0)break;if(l(d)&&i<=0)return c&&Gh(u),!0}}c&&Gh(u),o-=1}else if(pr(u)){const c=u.getChildren();for(const d of c){if(i<=0)break;if(l(d)&&i<=0)return!0}const f=1;if(n<=s&&s<n+i&&i>0){if(!Rr(u))_g(u,t);else if(b0(t)){const d=_0(t.para);d&&u.replace(d,!0)}i-=f}s+=f}else if(V(u)){const c=u.getChildren();for(const f of c){if(i<=0)break;if(l(f)&&i<=0)return!0}}return i<=0}l(a),i>0&&(r==null||r.warn(`$applyAttributes: Not all characters in the retain operation (length ${e}) could be processed. Remaining: ${i}. targetIndex: ${n}, final currentIndex: ${s}`))}function yg(n,e,t){var r;const i=typeof e.segment=="string"?e.segment:void 0,s=su(e.char,n,i);if(!st(s)){t==null||t.error(`Failed to create CharNode for text transformation. Style: ${Array.isArray(e.char)?e.char[0].style:(r=e.char)==null?void 0:r.style}. Falling back to standard text attributes.`),An(e,n);return}const o={};v0.forEach(u=>{n.hasFormat(u)&&(o[u]="true")});const a={};Object.entries(e).forEach(([u,c])=>{u==="segment"||u==="char"||(typeof c=="string"?a[u]=c:c===!0?a[u]="true":c===!1&&(a[u]="false"))});const l={...s.getUnknownAttributes()??{},...o,...a};return Object.keys(l).length>0&&s.setUnknownAttributes(l),An(e,n),s}function _g(n,e){for(const t of Object.keys(e)){const r=e[t];if(t==="char"&&st(n)&&Fo(e)){const i=r;if(n.setMarker(i.style),typeof i.cid=="string"){const o=i.cid;Tr(n,ii,()=>o)}const s=Et(i,Ol);s&&Object.keys(s).length>0&&n.setUnknownAttributes({...n.getUnknownAttributes()??{},...s});continue}typeof r=="string"&&(Nn(n)||Mn(n)||ru(n)||$e(n)||Jo(n)?n.setUnknownAttributes({...n.getUnknownAttributes()??{},[t]:r}):(fr(n)||Bt(n)||st(n))&&(t==="style"&&!fr(n)?n.setMarker(r):t==="code"&&fr(n)?n.setCode(r):n.setUnknownAttributes({...n.getUnknownAttributes()??{},[t]:r})),t==="segment"&&Tr(n,Is,()=>r))}}function vS(n,e,t){if(e<=0)return;const r=Ne();let i=0,s=e;function o(a){if(s<=0)return!0;if(Z(a)){let l=a.getTextContentSize();if(n<i+l&&i<n+s){const u=Math.max(0,n-i),c=l-u,f=Math.min(s,c);f>0&&(a.spliceText(u,f,""),a.getTextContentSize()===0&&a.remove(),t==null||t.debug(`Deleted ${f} length from TextNode (key: ${a.getKey()}) at nodeOffset ${u}. Original targetIndex: ${n}, current currentIndex: ${i}.`),s-=f,l-=f)}i+=l}else if(oi(a))n<=i&&i<n+s?(a.remove(),t==null||t.debug(`Deleted embed node (key: ${a.getKey()}) at currentIndex: ${i}. Original targetIndex: ${n}, remainingToDelete: ${s}.`),s-=1):i+=1;else if(pr(a)){const l=a.getChildren().slice(),u=a.getChildren();for(const c of u){if(s<=0)break;if(o(c)&&s<=0)return!0}if(n<=i&&i<n+s&&pr(a)){s-=1;const c=a.getChildren().length;if(l.length>0&&c===0){const f=a.getParent();((f==null?void 0:f.getChildren())??[]).length>1?(a.remove(),t==null||t.debug(`Removed entire ParaNode that had all its content deleted at currentIndex: ${i}. Original targetIndex: ${n}, remainingToDelete: ${s}.`)):(a.replace(Hn(),!0),t==null||t.debug(`Replaced last ParaNode with ImpliedParaNode at currentIndex: ${i}. Original targetIndex: ${n}, remainingToDelete: ${s}.`))}else if(s>0){const f=a.getNextSibling();if(f&&Un(f)){let d=i+1;const h=f.getChildren();for(const m of h){if(s<=0)break;const _=i;if(i=d,o(m)){i=_;break}Z(m)?d+=m.getTextContentSize():oi(m)&&(d+=1),i=_}const p=f.getChildren();for(const m of p)m.remove(),a.append(m);f.remove(),t==null||t.debug(`Merged next paragraph into current one after deleting symbolic close at currentIndex: ${i}. Original targetIndex: ${n}, remainingToDelete: ${s}.`)}else a.replace(Hn(),!0)}else Bt(a)?a.replace(Hn(),!0):a.remove()}i+=1}else if(V(a)){const l=a.getChildren();for(const u of l){if(s<=0)break;if(o(u)&&s<=0)return!0}}return s<=0}o(r),s>0&&(t==null||t.warn(`Delete operation could not remove all requested characters. Remaining to delete: ${s}. Original targetIndex: ${n}, OT length: ${e}. Final currentIndex: ${i}`))}function CS(n,e,t,r){return e===iu?xS(n,t,r):Fo(t)?ES(n,e,t,r):(r==null||r.debug(`Attempting to insert text "${e}" with attributes ${JSON.stringify(t)} at index ${n}`),rd(n,e,t,r))}function ES(n,e,t,r){r==null||r.debug(`Attempting to insert CharNode with text "${e}" and attributes ${JSON.stringify(t.char)} at index ${n}`);const i=we(e);An(t,i);let s;{let c=function(h){if(Z(h)){const p=h.getTextContentSize();if(n>=d&&n<=d+p){const m=h.getParent();return st(m)&&(s=m),!0}d+=p}else if(oi(h))d+=1;else if(st(h)){const p=h.getChildren();for(const m of p)if(c(m))return!0}else if(V(h)){const p=h.getChildren();for(const m of p)if(c(m))return!0;pr(h)&&(d+=1)}return!1};const f=Ne();let d=0;c(f)}let o=t.char;if(Array.isArray(o)&&s){const c=s.getMarker(),f=vs(s,ii),d=o[0];d&&d.style===c&&d.cid===f&&(o=o.slice(1),o.length===1&&(o=o[0]))}const a=typeof t.segment=="string"?t.segment:void 0,l=su(o,i,a);if(!st(l))return r==null||r.error(`CharNode style is missing for text "${e}". Attributes: ${JSON.stringify(t.char)}. Falling back to rich text insertion.`),rd(n,e,void 0,r);const u={};for(const[c,f]of Object.entries(t))c!=="char"&&c!=="segment"&&typeof f=="string"&&(u[c]=f);return Object.keys(u).length>0&&l.setUnknownAttributes(u),y0(n,l,r)?e.length:(r==null||r.error(`Failed to insert CharNode with text "${e}" at index ${n}. Falling back to rich text.`),rd(n,e,void 0,r))}function rd(n,e,t,r){if(e.length<=0)return r==null||r.debug("Attempted to insert empty string. No action taken."),0;const i=Ne();let s=0,o=!1;function a(l){if(o)return!0;if(Z(l)){const u=l.getTextContentSize();if(n>=s&&n<=s+u){const c=n-s,f=we(e);if(An(t,f),c===0)l.insertBefore(f);else if(c===u)l.insertAfter(f);else{const[,d]=l.splitText(c);d.insertBefore(f)}return r==null||r.debug(`Inserted text "${e}" in/around TextNode (key: ${l.getKey()}) at nodeOffset ${c}. Original targetIndex: ${n}, currentIndex at node start: ${s}.`),o=!0,!0}s+=u}else if(oi(l))s+=1;else if(st(l)){if(!o&&n===s){const c=we(e);An(t,c);const f=l.getFirstChild();return f?f.insertBefore(c):l.append(c),r==null||r.debug(`Inserted text "${e}" at beginning of CharNode ${l.getType()} (key: ${l.getKey()}).`),o=!0,!0}const u=l.getChildren();for(const c of u){if(a(c))return!0;if(o)break}if(!o&&n===s){const c=we(e);return An(t,c),l.append(c),r==null||r.debug(`Appended text "${e}" to end of CharNode ${l.getType()} (key: ${l.getKey()}).`),o=!0,!0}}else if(pr(l)){if(!o&&n===s){const c=we(e);An(t,c);const f=l.getFirstChild();return f?f.insertBefore(c):l.append(c),r==null||r.debug(`Inserted text "${e}" at beginning of container ${l.getType()} (key: ${l.getKey()}).`),o=!0,!0}const u=l.getChildren();for(const c of u){if(a(c))return!0;if(o)break}if(!o&&n===s){const c=we(e);return An(t,c),l.append(c),r==null||r.debug(`Appended text "${e}" to end of container ${l.getType()} (key: ${l.getKey()}).`),o=!0,!0}s+=1}else if(V(l)){const u=l.getChildren();for(const c of u){if(a(c))return!0;if(o)break}}return o}if(a(i),!o&&n===s){r==null||r.debug(`Insertion point matches end of document (targetIndex: ${n}, final currentIndex: ${s}). Appending text to new ParaNode.`);const l=we(e);An(t,l);const u=Hn().append(l);i.append(u),o=!0}return o?e.length:(r==null||r.warn(`$insertRichText: Could not find insertion point for text "${e}" at targetIndex ${n}. Final currentIndex: ${s}. Text not inserted.`),0)}function y0(n,e,t){const r=Ne();let i=0,s=!1;function o(a){if(s)return!0;if(a===r&&n===0&&!r.getFirstChild())return e.isInline()?(t==null||t.debug(`$insertNodeAtCharacterOffset: Inserting inline node ${e.getType()} into empty root, wrapped in ImpliedParaNode. targetIndex: ${n}`),r.append(Hn().append(e))):(t==null||t.debug(`$insertNodeAtCharacterOffset: Inserting block node ${e.getType()} directly into empty root. targetIndex: ${n}`),r.append(e)),s=!0,!0;if(!V(a))return!1;const l=a.getChildren();for(const u of l){if(n===i&&!s){if(a===r&&e.isInline())if(Un(u)){t==null||t.debug(`$insertNodeAtCharacterOffset: Inserting inline node ${e.getType()} into existing ${u.getType()} at beginning. targetIndex: ${n}`);const c=u.getFirstChild();c?c.insertBefore(e):u.append(e)}else t==null||t.debug(`$insertNodeAtCharacterOffset: Inserting inline node ${e.getType()} into root before ${u.getType()}, wrapping in ImpliedParaNode. targetIndex: ${n}`),u.insertBefore(Hn().append(e));else u.insertBefore(e),t==null||t.debug(`$insertNodeAtCharacterOffset: Inserted node ${e.getType()} (key: ${e.getKey()}) before child ${u.getType()} (key: ${u.getKey()}) in ${a.getType()} (key: ${a.getKey()}). targetIndex: ${n}, currentIndex: ${i}`);return s=!0,!0}if(Z(u)){const c=u.getTextContentSize();if(!s&&n>i&&n<i+c){const f=n-i,[d]=u.splitText(f);return d.insertAfter(e),t==null||t.debug(`$insertNodeAtCharacterOffset: Inserted node ${e.getType()} (key: ${e.getKey()}) by splitting TextNode (key: ${u.getKey()}) at offset ${f}. targetIndex: ${n}, currentIndex at node start: ${i}`),s=!0,!0}i+=c}else if(oi(u))i+=1;else if(st(u)){if(o(u))return!0}else if(pr(u)){const c=u;if(o(c))return!0;const f=i;if(Rr(c)&&pr(e)&&n===f&&!s)return t==null||t.debug(`$insertNodeAtCharacterOffset: Replacing ImpliedParaNode (key: ${c.getKey()}) with block node '${e.getType()}' (key: ${e.getKey()}) at OT index ${n}.`),u.replace(e,!0),i=f+1,s=!0,!0;i+=1}else if(V(u)&&o(u))return!0;if(s)return!0}return V(a)&&!s&&(n===i||a===r&&n>i)?a===r?(e.isInline()?(t==null||t.debug(`$insertNodeAtCharacterOffset: Appending inline node ${e.getType()} to root. Wrapping in new ImpliedParaNode. targetIndex: ${n}, current document OT length: ${i}.`),r.append(Hn().append(e))):(t==null||t.debug(`$insertNodeAtCharacterOffset: Appending block node ${e.getType()} to root. targetIndex: ${n}, current document OT length: ${i}.`),r.append(e)),s=!0,!0):Un(a)?Rr(a)&&Bt(e)&&n===i?(t==null||t.debug(`$insertNodeAtCharacterOffset: Replacing ImpliedParaNode container (key: ${a.getKey()}) with ParaNode ${e.getType()} (key: ${e.getKey()}) via append logic. targetIndex: ${n}`),a.replace(e,!0),s=!0,!0):e.isInline()||!Un(e)?(t==null||t.debug(`$insertNodeAtCharacterOffset: Appending node ${e.getType()} to existing container ${a.getType()} (key: ${a.getKey()}). targetIndex: ${n}, container end OT index: ${i}.`),a.append(e),s=!0,!0):(t==null||t.debug(`$insertNodeAtCharacterOffset: Inserting block node ${e.getType()} after container ${a.getType()} (key: ${a.getKey()}). targetIndex: ${n}, container end OT index: ${i}.`),a.insertAfter(e),s=!0,!0):(e.isInline()||!Un(e)?(t==null||t.debug(`$insertNodeAtCharacterOffset: Appending node ${e.getType()} to generic element ${a.getType()} (key: ${a.getKey()}). targetIndex: ${n}, element end OT index: ${i}.`),a.append(e)):(t==null||t.debug(`$insertNodeAtCharacterOffset: Inserting block node ${e.getType()} after generic element ${a.getType()} (key: ${a.getKey()}). targetIndex: ${n}, element end OT index: ${i}.`),a.insertAfter(e)),s=!0,!0):s}return o(r),s||t==null||t.warn(`$insertNodeAtCharacterOffset: Could not find insertion point for node ${e.getType()} (key: ${e.getKey()}) at targetIndex ${n}. Final currentIndex: ${i}. Node not inserted.`),s}function wS(n,e,t,r,i){const s=e.insert;let o;return Aa("chapter",s)?o=kS(s.chapter,t):Aa("verse",s)?o=SS(s.verse,t):Aa("ms",s)?o=TS(s.ms):Aa("note",s)&&(o=AS(e,t,r)),o?y0(n,o,i):(i==null||i.error(`$insertEmbedAtCurrentIndex: Cannot create LexicalNode for embed object: ${JSON.stringify(s)}`),!1)}function xS(n,e,t){let r;b0(e)?r=_0(e.para):NS(e)&&(r=DS(e.book)),r??(r=Hn());const i=r,s=Bt(i),o=Rr(i);let a=0,l=!1;function u(c){if(l)return!0;if(Z(c)){const f=c.getTextContentSize();if(n>=a&&n<=a+f){const d=c.getParent();if(Bt(d)&&(s||o)){t==null||t.debug(`Splitting ParaNode (marker: ${d.getMarker()}) with LF attributes at targetIndex ${n}`);const h=n-a,[p]=h>0?c.splitText(h):[void 0];let m=p==null?void 0:p.getPreviousSibling();for(;m;){const _=m;m=m.getPreviousSibling();const C=i.getFirstChild();C?C.insertBefore(_):i.append(_)}return p&&i.append(p),d.insertBefore(i),l=!0,!0}}a+=f}else if(oi(c))a+=1;else if(pr(c)){const f=c.getChildren();for(const d of f){if(u(d))return!0;if(l)break}if(n===a){if(Rr(c)&&i)return t==null||t.debug(`Replacing ImpliedParaNode (key: ${c.getKey()}) with ParaNode at targetIndex ${n}`),c.replace(i,!0),l=!0,!0;if(Bt(c)&&i){const d=c;return t==null||t.debug(`Creating new block node with LF attributes after existing ParaNode (marker: ${d.getMarker()}) at targetIndex ${n}`),d.insertAfter(i),l=!0,!0}}if(a+=1,n===a&&Bt(c)&&i)return t==null||t.debug(`Creating new block node after existing ParaNode (marker: ${c.getMarker()}) at targetIndex ${n}`),c.insertAfter(i),l=!0,!0}else if(V(c)){const f=c.getChildren();for(const d of f){if(u(d))return!0;if(l)break}}return l}return u(Ne()),l||t==null||t.warn(`Could not find location to handle newline with para attributes at targetIndex ${n}. Final currentIndex: ${a}.`),1}function kS(n,e){const{number:t,sid:r,altnumber:i,pubnumber:s}=n;if(!t)return;const o=Et(n,hS);let a;if(e.markerMode==="editable")a=Lb(t,r,i,s,o);else{const l=e.markerMode==="visible";a=yf(t,l,r,i,s,o)}return a}function SS(n,e){const{style:t,number:r,sid:i,altnumber:s,pubnumber:o}=n;if(!r)return;const a=Et(n,pS);let l;if(e.markerMode==="editable"){if(!t)return;const u=Yo(t,r);l=Yb(r,u,i,s,o,a)}else{const u=e.markerMode==="visible";l=Af(r,u,i,s,o,a)}return l}function TS(n){const{style:e,sid:t,eid:r}=n;if(!e)return;const i=Et(n,gS);return Hb(e,t,r,i)}function AS(n,e,t){var r;const i=n.insert,{style:s,caller:o,category:a,contents:l}=i.note;if(!s||!o)return;const u=Et(i.note,mS),c=(r=n.attributes)==null?void 0:r.segment;let f;c&&typeof c=="string"&&(f=c);const d=[];for(const h of(l==null?void 0:l.ops)??[])typeof h.insert=="string"&&(Fo(h.attributes)?d.push(su(h.attributes.char,we(h.insert))):d.push(we(h.insert)));return d0(s,o,d,e,t,f).setCategory(a).setUnknownAttributes(u)}function DS(n){const{style:e,code:t}=n;if(!e||e!==nu||!t||!In.isValidBookCode(t))return;const r=Et(n,fS);return Ob(t,r)}function _0(n){const{style:e}=n;if(!e)return;const t=Et(n,dS);return Po(e,t)}function su(n,e,t){if(Array.isArray(n)){if(n.length===0)throw new Error("Empty charAttr array");return n.reduceRight((r,i,s)=>{const o=Sr(i.style,Et(i,Ol));return typeof i.cid=="string"&&Tr(o,ii,()=>i.cid),t&&s===n.length-1&&Tr(o,Is,()=>t),r&&o.append(r),o},e)}else{const r=Sr(n.style,Et(n,Ol));return typeof n.cid=="string"&&Tr(r,ii,()=>n.cid),t&&Tr(r,Is,()=>t),e&&r.append(e),r}}function Aa(n,e){if(!(n in e))return!1;const t=e[n];return typeof t=="object"&&t!==null}function NS(n){return!!n&&!!n.book&&typeof n.book=="object"&&n.book!==null&&"style"in n.book&&typeof n.book.style=="string"&&"code"in n.book&&typeof n.book.code=="string"}function b0(n){return!!n&&!!n.para&&typeof n.para=="object"&&n.para!==null&&"style"in n.para&&typeof n.para.style=="string"}function Fo(n){return!!n&&!!n.char&&typeof n.char=="object"&&n.char!==null&&(!Array.isArray(n.char)&&"style"in n.char&&typeof n.char.style=="string"||Array.isArray(n.char)&&n.char.length>0&&"style"in n.char[0]&&typeof n.char[0].style=="string")}function MS(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&Object.keys(n).length===0}function An(n,e){if(n)for(const t of Object.keys(n)){if(t==="segment"&&typeof n[t]=="string"){const r=n[t];Tr(e,Is,()=>r);continue}if(OS(t)){const r=!!n[t],i=t,s=e.hasFormat(i);(r&&!s||!r&&s)&&e.toggleFormat(i)}}}const v0=["bold","underline","strikethrough","italic","highlight","code","subscript","superscript","lowercase","uppercase","capitalize"];function OS(n){return v0.includes(n)}function IS({viewOptions:n}){const[e]=ke();return RS(e,n),null}function RS(n,e){T.useEffect(()=>{if(!n.hasNodes([$r,Xt,jt]))throw new Error("ArrowNavigationPlugin: ImmutableChapterNode, ImmutableVerseNode or NoteNode not registered on editor!");const t=r=>{if(r.key!=="ArrowLeft"&&r.key!=="ArrowRight")return!1;const i=ne();if(!G(i)||!i.isCollapsed())return!1;const s=n.getRootElement();if(!s)return!1;const o=s.dir||"ltr";let a=!1;return PS(o,r.key)?a=$S(i):LS(o,r.key)&&(a=FS(i,e)),a&&r.preventDefault(),a};return n.registerCommand(Ps,t,Ul)},[n,e])}function PS(n,e){return n==="ltr"&&e==="ArrowRight"||n==="rtl"&&e==="ArrowLeft"}function LS(n,e){return n==="ltr"&&e==="ArrowLeft"||n==="rtl"&&e==="ArrowRight"}function $S(n){var e,t,r;const i=n.anchor.getNode(),s=Uk(n);if($e(s)&&!Xo(s.getFirstChild())){if(Un(i)){if(n.anchor.offset===i.getChildrenSize())return!1}else if(n.anchor.offset!==i.getTextContentSize())return!1;if(s.getIsCollapsed()){if(s.is((e=s.getParent())==null?void 0:e.getLastChild()))return(r=(t=s.getParent())==null?void 0:t.getNextSibling())==null||r.selectStart(),!0}else return Nl(s.getFirstChild())?s.select(2,2):s.select(1,1),!0}if(Un(i)&&$e(s)&&s.getIsCollapsed()){const a=s.getNextSibling();return a?a.selectStart():s.selectEnd(),!0}const o=s==null?void 0:s.getParent();if(Nl(s)&&$e(o)&&s.is(o==null?void 0:o.getLastChild())){const a=o.getNextSibling();return a?a.selectStart():o.selectEnd(),!0}return!1}function FS(n,e){const t=Wk(n);if(Go(t)&&!t.getPreviousSibling())return!0;if(n.anchor.offset!==0)return!1;const r=n.anchor.getNode();if(fr(r.getParent()))return!0;if($e(t)&&t.getIsCollapsed()){const s=t.getPreviousSibling();if(!Qo(s))return!1;const o=t.getParent();if(!o)return!1;const a=t.getIndexWithinParent();return o.select(a,a),!0}if(Un(t)&&(e==null?void 0:e.noteMode)==="collapsed"){const s=t.getLastChild();if(!s)return!1;const o=Gn(s,a=>$e(a));if($e(o)&&o.getIsCollapsed()){const a=o.getParent();if(!a)return!1;const l=o.getIndexWithinParent();return a.select(l,l),!0}}const i=Xb(r);if(!i||i.getIsCollapsed())return!1;if(gi(t)){const s=i.getParent();if(!s)return!1;const o=i.getIndexWithinParent();return s.select(o,o),!0}return!1}function BS(){const[n]=ke();return qS(n),null}function qS(n){T.useEffect(()=>{if(!n.hasNodes([et]))throw new Error("CharNodePlugin: CharNode not registered on editor!");return n.registerNodeTransform(et,jS)},[n])}function jS(n){if(!st(n))return;if(n.isEmpty()){n.remove();return}const e=n.getMarker(),t=vs(n,ii),r=n.getUnknownAttributes(),i=n.getNextSibling();st(i)&&Qc({style:e,cid:t},i)&&Wr(r,i.getUnknownAttributes())&&(n.append(...i.getChildren()),i.remove());const s=n.getPreviousSibling();st(s)&&Qc({style:e,cid:t},s)&&Wr(r,s.getUnknownAttributes())&&(s.append(...n.getChildren()),n.remove())}function C0(n){return n.replaceAll("	"," ")}const E0=n=>{navigator.clipboard.read().then(async e=>{if((await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){alert("Not allowed to paste from clipboard.");return}const t=new DataTransfer,r=e[0];for(const s of r.types){const o=await(await r.getType(s)).text();t.setData(s,C0(o))}const i=new ClipboardEvent("paste",{clipboardData:t});n.dispatchCommand(Ji,i)})},w0=n=>{navigator.clipboard.read().then(async()=>{if((await navigator.permissions.query({name:"clipboard-read"})).state==="denied"){alert("Not allowed to paste from clipboard.");return}const e=new DataTransfer,t=await navigator.clipboard.readText();e.setData("text/plain",C0(t));const r=new ClipboardEvent("paste",{clipboardData:e});n.dispatchCommand(Ji,r)})};function US(){const[n]=ke();return T.useEffect(()=>{const e=t=>{const{key:r,shiftKey:i,metaKey:s,ctrlKey:o,altKey:a}=t;!(Nc?s:o)||a||(!i&&r.toLowerCase()==="c"?(t.preventDefault(),n.dispatchCommand(Gi,null)):!i&&r.toLowerCase()==="x"?(t.preventDefault(),n.dispatchCommand(Ls,null)):r.toLowerCase()==="v"&&(t.preventDefault(),i?w0(n):E0(n)))};return n.registerRootListener((t,r)=>{r!==null&&r.removeEventListener("keydown",e),t!==null&&t.addEventListener("keydown",e)})},[n]),null}function WS({logger:n}){const[e]=ke();return T.useEffect(()=>vt(e.registerCommand(Ps,t=>t.key!=="\\"&&t.key!=="/"?!1:(t.preventDefault(),!0),Ha),e.registerCommand(Ji,t=>{var r;const i=(r=t.clipboardData)==null?void 0:r.getData("text/plain");return!i||!i.includes("\\")&&!i.includes("/")?!1:(n==null||n.info("CommandMenuPlugin: paste containing backslash or forward slash ignored."),t.preventDefault(),!0)},Ha),e.registerCommand(ql,t=>{var r;const i=(r=t.dataTransfer)==null?void 0:r.getData("text/plain");return!i||!i.includes("\\")&&!i.includes("/")?!1:(n==null||n.info("CommandMenuPlugin: drag containing backslash or forward slash ignored."),t.preventDefault(),!0)},Ha)),[e,n]),null}function zS({index:n,isSelected:e,onClick:t,onMouseEnter:r,option:i}){let s="item";return e&&(s+=" selected"),i.isDisabled&&(s+=" disabled"),I.jsx("li",{tabIndex:-1,className:s,ref:i.setRefElement,role:"option","aria-selected":e,"aria-disabled":i.isDisabled,id:"typeahead-item-"+n,onMouseEnter:r,onClick:i.isDisabled?void 0:t,children:I.jsx("span",{className:"text",children:i.title})},i.key)}function HS({options:n,selectedItemIndex:e,onOptionClick:t,onOptionMouseEnter:r}){return I.jsx("div",{className:"typeahead-popover",children:I.jsx("ul",{children:n.map((i,s)=>I.jsx(zS,{index:s,isSelected:e===s,onClick:()=>t(i,s),onMouseEnter:()=>r(s),option:i},i.key))})})}class Da extends nw{constructor(e,t){super(e),fe(this,"title"),fe(this,"onSelect"),fe(this,"isDisabled"),this.title=e,this.onSelect=t.onSelect.bind(this),this.isDisabled=t.isDisabled||!1}}function KS(n,e="editor-input"){return n?n.classList.contains(e):!1}function VS(){const[n]=ke(),[e,t]=T.useState(()=>!n.isEditable()),r=T.useRef(void 0),i=T.useRef(void 0),s=T.useRef(void 0),o=T.useMemo(()=>[new Da("Cut",{onSelect:()=>{n.dispatchCommand(Ls,null)},isDisabled:e}),new Da("Copy",{onSelect:()=>{n.dispatchCommand(Gi,null)}}),new Da("Paste",{onSelect:()=>{E0(n)},isDisabled:e}),new Da("Paste as Plain Text",{onSelect:()=>{w0(n)},isDisabled:e})],[n,e]),a=T.useCallback((l,u,c)=>{n.update(()=>{l==null||l.onSelect(u),c()})},[n]);return T.useEffect(()=>{var l;i.current=((l=n.getRootElement())==null?void 0:l.className)??""},[n]),T.useEffect(()=>{const l=()=>{var u;(u=s.current)==null||u.call(s)};return window.addEventListener("scroll",l,!0),()=>{window.removeEventListener("scroll",l,!0)}},[]),T.useEffect(()=>n.registerEditableListener(l=>{t(!l)}),[n]),I.jsx(sw,{options:o,onSelectOption:a,onWillOpen:l=>{r.current=l.target},menuRenderFn:(l,{selectedIndex:u,options:c,selectOptionAndCleanUp:f,setHighlightedIndex:d},{setMenuRef:h})=>(s.current=()=>f(void 0),l.current&&!KS(r.current,i.current)&&!Ub(r.current)?En.createPortal(I.jsx("div",{className:"typeahead-popover auto-embed-menu",style:{marginLeft:l.current.style.width,userSelect:"none",width:200},ref:h,children:I.jsx(HS,{options:o,selectedItemIndex:u,onOptionClick:(p,m)=>{p.isDisabled||(d(m),f(p))},onOptionMouseEnter:p=>{d(p)}})}),l.current):null)})}function JS({isEditable:n}){const[e]=ke();return T.useLayoutEffect(()=>{e.setEditable(n)},[e,n]),null}function GS({scripture:n,nodeOptions:e,editorAdaptor:t,viewOptions:r,logger:i}){const[s]=ke();return T.useEffect(()=>{var o;(o=t.initialize)==null||o.call(t,e,i)},[t,i,e]),T.useEffect(()=>{var o;(o=t.reset)==null||o.call(t);const a=t.serializeEditorState(n,r);if(a==null){i==null||i.warn("LoadStatePlugin: serializedEditorState was null or undefined. Skipping editor update.");return}try{const l=s.parseEditorState(a);s.update(()=>{s.setEditorState(l),s.dispatchCommand(zm,void 0)},{tag:pf})}catch{i==null||i.error("LoadStatePlugin: error parsing or setting editor state.")}},[s,t,i,n,r]),null}function YS({expandedNoteKeyRef:n,nodeOptions:e,viewOptions:t,logger:r}){const[i]=ke();return XS(e,r),QS(i,n,t,r),null}function XS(n,e){const t=T.useRef(void 0),r=n.noteCallers;T.useEffect(()=>{let i=r;(!i||i.length<=0)&&(i=m1),t.current!==i&&(t.current=i,oT("note-callers",i,e))},[e,r])}function QS(n,e,t,r){T.useEffect(()=>{if(!n.hasNodes([et,jt,Kn]))throw new Error("NoteNodePlugin: CharNode, NoteNode or ImmutableNoteCallerNode not registered on editor!");const i=s=>n.update(()=>sT(s));return vt(n.registerNodeTransform(jt,s=>ZS(s,t)),n.registerNodeTransform(et,eT),n.registerNodeTransform(xn,tT),n.registerNodeTransform(Kn,nT),n.registerMutationListener(Kn,(s,{prevEditorState:o})=>rT(s,o)),n.registerCommand(Vi,()=>iT(n,e,t,r),Xi),n.registerRootListener((s,o)=>{o!==null&&o.removeEventListener("dblclick",i),s!==null&&s.addEventListener("dblclick",i)}))},[n,e,r,t])}function ZS(n,e){const t=n.getChildren();if(!t.some(r=>gi(r))&&(e==null?void 0:e.markerMode)!=="editable"&&n.remove(),t.length>0){const r=t[0];Z(r)&&!Xo(r)&&n.insertBefore(r)}}function eT(n){const e=n.getParentOrThrow(),t=e.getChildren(),r=t.find(o=>gi(o));if(!st(n)||!$e(e)||!r)return;const i=kf(t);r.getPreviewText()!==i&&r.setPreviewText(i);const s=n.getNextSibling();Z(s)?s.getTextContent()!==Ve&&s.setTextContent(Ve):n.insertAfter(we(Ve))}function tT(n){const e=Xb(n),t=e==null?void 0:e.getChildren(),r=t==null?void 0:t.find(s=>gi(s));if(!Z(n)||!$e(e)||!r||!t)return;const i=kf(t);r.getPreviewText()!==i&&r.setPreviewText(i),!(Xo(n)||!$e(n.getParent()))&&n.getTextContent()!==Ve&&(n.setTextContent(Ve),n.selectEnd())}function nT(n){if(!gi(n))return;const e=n.getNextSibling();!Z(e)||Xo(e)?n.insertAfter(we(Ve)):e.getTextContent()!==Ve&&e.setTextContent(Ve)}function rT(n,e){for(const[t,r]of n){if(r!=="destroyed")continue;const i=e.read(()=>{const o=xe(t),a=o==null?void 0:o.getParent();return gi(o)&&$e(a)&&a.getCaller()===Ui}),s=document.querySelector(".editor-input");!i||!s||(s.classList.add("reset-counters"),s.offsetHeight,s.classList.remove("reset-counters"))}}function iT(n,e,t,r){var i;if((t==null?void 0:t.noteMode)!=="expandInline")return!1;const s=ne();if(!G(s)||!s.isCollapsed())return!1;const o=s.anchor,a=o.getNode();if(e.current){const l=Gn(a,u=>$e(u));if(l)e.current!==l.getKey()&&(e.current=l.getKey());else{const u=xe(e.current);u&&!u.getIsCollapsed()&&(r==null||r.debug("Cursor moved away from NoteNode, collapsing it"),oo(n,e.current,r)),e.current=void 0}}if(o.offset===0){const l=a.getPreviousSibling();if($e(l)){r==null||r.debug("Cursor is just after a NoteNode");const u=l.getKey();l.getIsCollapsed()?e.current=u:e.current=void 0,oo(n,u,r)}}if(o.offset===a.getTextContentSize()){const l=a.getNextSibling();if($e(l)){r==null||r.debug("Cursor is just before a NoteNode");const u=l.getKey();l.getIsCollapsed()?e.current=u:e.current=void 0,oo(n,u,r)}else if(!l){const u=Gn(a,c=>$e(c));if(u&&u.getIsCollapsed()&&Un(u.getParent())&&u.is((i=u.getParent())==null?void 0:i.getLastChild())){r==null||r.debug("Cursor is at end of note at end of para");const c=u.getKey();e.current=c,oo(n,c,r)}}}if(Un(a)){const l=a.getChildAtIndex(o.offset),u=l==null?void 0:l.getPreviousSibling();if(Qo(u)&&$e(l)){r==null||r.debug("Cursor is between verse and NoteNode");const c=l.getKey();l.getIsCollapsed()?e.current=c:e.current=void 0,oo(n,c,r)}}return!1}function oo(n,e,t){const r=xe(e);try{r==null||r.toggleIsCollapsed()}catch(i){if(i instanceof Error&&i.message.includes("read only"))t==null||t.warn("Fallback triggered after stabilization - edge case"),setTimeout(()=>{n.update(()=>{r==null||r.toggleIsCollapsed()})},0);else throw i}}function sT(n){const e=ne();if(!G(e))return;const t=e.anchor,r=e.focus,i=t.getNode(),s=r.getNode();if($e(i)&&Z(s)){n.preventDefault();const o=jo();o.anchor.set(s.getKey(),0,"text"),o.focus.set(s.getKey(),r.offset,"text"),Ot(o)}}function oT(n,e,t){for(const r of document.styleSheets)try{const i=r.cssRules||r.rules;for(const s of i)if(aT(s,n)){const o=e.map(a=>`"${a}"`).join(" ");s.symbols=o;return}}catch{continue}t==null||t.warn(`Editor: counter style "${n}" not found.`)}function aT(n,e){return typeof n=="object"&&n!==null&&"name"in n&&n.name===e&&"symbols"in n&&typeof n.symbols=="string"}function lT({onChange:n}){const[e]=ke();return T.useEffect(()=>e.registerCommand(Vi,()=>{const t=e.read(()=>u0());return n==null||n(t),!1},Xi),[e,n]),null}function uT(){const[n]=ke();return cT(n),null}function cT(n){T.useEffect(()=>{if(!n.hasNodes([ln]))throw new Error("ParaNodePlugin: ParaNode not registered on editor!");return n.registerNodeTransform(ln,e=>dT(e,n))},[n])}function dT(n,e){Mf(e,n.getKey())&&h0(n.getFirstChild()),!(!Bt(n)||n.getMarker()!=="b"||n.isEmpty()||!e.getEditorState().read(()=>{const t=xe(n.getKey());return Bt(t)&&((t==null?void 0:t.isEmpty())??!1)}))&&n.clear()}function fT({textDirection:n}){const[e]=ke();return hT(e,n),pT(e),null}function hT(n,e){T.useEffect(()=>{function t(){const r=n.getRootElement();if(!r||e==="auto")return;r.dir=e;const i=n._config.theme.placeholder,s=document.getElementsByClassName(i)[0];s&&(s.dir=e)}return t(),n.registerUpdateListener(({dirtyElements:r})=>{r.size>0&&t()})},[n,e])}function pT(n){T.useEffect(()=>{const e=t=>{if(t.key!=="ArrowLeft"&&t.key!=="ArrowRight")return!1;const r=ne();if(!G(r))return!1;const i=r.anchor.getNode(),s=Gn(i,f=>Gk(f,n)==="p");if(!s)return!1;const o=n.getElementByKey(s.getKey());if(!o)return!1;const a=o.parentElement,l=o.dir||"ltr",u=((a==null?void 0:a.dir)??"")||"ltr";if(!a||l===u)return!1;const c=a.dir==="rtl"&&t.key==="ArrowLeft"||a.dir==="ltr"&&t.key==="ArrowRight";return r.modify("move",c,"character"),t.preventDefault(),!0};return n.registerCommand(Ps,e,Ul)},[n])}function gT(){const[n]=ke();return mT(n),null}function mT(n){T.useEffect(()=>{if(!n.hasNodes([et,Xt,jt,xn,Yt]))throw new Error("TextSpacingPlugin: CharNode, ImmutableVerseNode, NoteNode, TextNode or VerseNode not registered on editor!");return vt(n.registerNodeTransform(xn,yT),n.registerNodeTransform(xn,e=>_T(e,n)),n.registerNodeTransform(Yt,bg),n.registerNodeTransform(Xt,bg))},[n])}function yT(n){if(!n.isAttached())return;const e=n.getTextContent(),t=n.getNextSibling(),r=n.getParent();n.getMode()!=="normal"||e.endsWith(" ")&&e.length>1||$e(t)||st(r)||Mt(r)||Jo(r)||(e===" "&&!Mn(t)?n.setTextContent(""):Nf(n))}function _T(n,e){const t=n.getParent();!Jo(t)||!n.isAttached()||Mf(e,n.getKey())&&t.insertAfter(n)}function bg(n){if(!n.isAttached())return;const e=n.getPreviousSibling();e&&!Mn(e)&&!Z(e)&&!Jo(e)&&n.insertBefore(we(" "))}function bT({trigger:n,scriptureReference:e,contextMarker:t,getMarkerAction:r}){const{markersMenuItems:i}=K1({scriptureReference:e,contextMarker:t,getMarkerAction:r});return I.jsx(H1,{trigger:n,items:i})}function vT({trigger:n,scrRef:e,getMarkerAction:t}){const{book:r,chapterNum:i,verseNum:s,verse:o}=e,a=T.useMemo(()=>e,[r,i,s,o]),[l]=ke(),[u]=CT(l);return ET(l),I.jsx(bT,{trigger:n,scriptureReference:a,contextMarker:u,getMarkerAction:t})}function CT(n){const[e,t]=T.useState();return T.useEffect(()=>n.registerCommand(Vi,()=>(n.read(()=>{const r=ne();if(!G(r)){e&&t(void 0);return}const i=xe(r.anchor.key),s=xe(r.focus.key);if(!i||!s){e&&t(void 0);return}const o=zk(i,s);if(!o||!T1(o)){e&&t(void 0);return}const a=o.getMarker();e!==a&&t(a)}),!1),Xi),[e,n]),[e]}function ET(n){T.useEffect(()=>{if(!n.hasNodes([Yt,Xt]))throw new Error("UsjNodesMenuPlugin: VerseNode or ImmutableVerseNode not registered on editor!");const e={},t={};return vt(n.registerNodeTransform(Xt,r=>vg(r,n,e)),n.registerNodeTransform(Yt,r=>vg(r,n,e)),n.registerMutationListener(Xt,r=>xg(r,n,e,t)),n.registerMutationListener(Yt,r=>xg(r,n,e,t)))},[n])}function vg(n,e,t){j2(pf)||Mf(e,n.getKey())&&kT(n,t)}function Cg(n){return RegExp(/(\d+)([a-zA-Z]+)?(-(\d+)([a-zA-Z]+)?)?/).exec(n)}const Eg=2,wT=3,wg=4,xT=5;function kT(n,e){var t;const r=Ef(n),i=r==null?void 0:r.getNumber();if(!i)return;const s=e[i];if(!s)return;let o=parseInt(n.getNumber()),a=((t=Cg(n.getNumber()))==null?void 0:t[Eg])??"";s.forEach(l=>{const u=xe(l);if(!u)return;const c=u.getNumber(),f=parseInt(c),d=Cg(c),h=!!(d!=null&&d[wT]),p=h?parseInt(d[wg]):f;if(p<o||f>o||p===o&&a)return;const m=(d==null?void 0:d[Eg])??"",_=(d==null?void 0:d[xT])??"",C=h?Zc(parseInt(d[wg]),void 0):"";let v=`${m}`;v+=h?`-${C}${_}`:"";const x=Zc(f,void 0);u.setNumber(`${x}${v}`),o=parseInt(h?C:x),a=h?_:m})}function xg(n,e,t,r){e.getEditorState().read(()=>{for(const[i,s]of n){const o=xe(i);if(Mn(o)){if(s==="created"){const a=Ef(o);if(!a)continue;const l=a.getNumber();t[l]||(t[l]=[]),t[l].push(i),r[i]=l}else if(s==="destroyed"){const a=r[i],l=t[a];if(!l)continue;const u=l.findIndex(c=>c===i);if(u===-1)continue;l.splice(u,1),Reflect.deleteProperty(r,i)}}}})}const x0="formatted",ST="unformatted";let If;function TT(n){const e=AT(n);if(!e)throw new Error(`Invalid view mode: ${n}`);If=e}TT(x0);const Zo=()=>If;function AT(n){let e;switch(n){case x0:e={markerMode:"hidden",noteMode:"collapsed",hasSpacing:!0,isFormattedFont:!0};break;case ST:e={markerMode:"editable",noteMode:"expanded",hasSpacing:!1,isFormattedFont:!1};break}return e}function DT(n){if(n)return n.markerMode==="editable"?Yt:Xt}function NT(n){const e=[],t=n??If;return t&&(e.push(`${_k}${t.markerMode}`),t.hasSpacing&&e.push(mk),t.isFormattedFont&&e.push(yk)),e}function MT({scrRef:n,onScrRefChange:e}){const[t]=ke(),r=T.useRef(!1),i=T.useRef(!1),{book:s,chapterNum:o,verseNum:a}=n;return T.useEffect(()=>t.registerMutationListener(In,l=>{t.update(()=>{for(const[u,c]of l){const f=xe(u);f&&fr(f)&&c==="created"&&kg(o,a,i)}},{tag:Gc})},{skipInitialization:!0}),[t,o,a]),T.useEffect(()=>{r.current?r.current=!1:t.update(()=>kg(o,a,i),{tag:Gc})},[t,o,a]),T.useEffect(()=>t.registerCommand(Vi,()=>(i.current?i.current=!1:OT(s,o,a,e,r),!1),Xi),[t,s,o,a,e]),null}function kg(n,e,t){var r;const i=e0(ne()),s=(r=f0(i))==null?void 0:r.getNumber();if(Yk(s)&&Sf(e,s))return;const o=Ne().getChildren(),a=Bk(o,n),l=Vk(o,a),u=qk(l,!!a);if(u&&!a||!a)return;Kk(l,u);const c=S1(l,e);if(c){if(Bt(c)){const f=c.getFirstChild();Z(f)?f.select(0,0):c.select(0,0)}else c.selectNext(0,0);t.current=!0}}function OT(n,e,t,r,i){const s=e0(ne());if(!s)return;const o=Ef(s),a=parseInt((o==null?void 0:o.getNumber())??"1",10),l=f0(s),u=l==null?void 0:l.getNumber(),c=parseInt(u??"0",10),f=u?Sf(t,u):t===c;if(i.current=!!(o&&a!==e||!f),i.current){const d={book:n,chapterNum:a,verseNum:c};u!=null&&c.toString()!==u&&(d.verse=u),r(d)}}function IT(n){return fr(n)?`${n.__code}`:mf(n)?`${n.__marker} "${n.__number}"`:st(n)?`${n.__marker}`:Go(n)?`${n.__marker} "${n.__number}"`:gi(n)?`${n.__caller}`:Qo(n)?`${n.__marker} "${n.__number}"`:$e(n)?`${n.__marker} "${n.__caller}"`+(n.__isCollapsed?" (collapsed)":" (expanded)"):Bt(n)?`${n.__marker}`:Mt(n)?`ids: [ ${JSON.stringify(n.getTypedIDs())} ]`:Cf(n)?`${n.__marker} "${n.__number}"`:""}function RT(){const[n]=ke();return I.jsx(kE,{viewClassName:"tree-view-output",treeTypeButtonClassName:"debug-treetype-button",timeTravelPanelClassName:"debug-timetravel-panel",timeTravelButtonClassName:"debug-timetravel-button",timeTravelPanelSliderClassName:"debug-timetravel-panel-slider",timeTravelPanelButtonClassName:"debug-timetravel-panel-button",customPrintNode:IT,editor:n})}const Sg={type:Fi,version:Bi,content:[]};let id;function PT(n){n&&(id=n)}function LT(n){if(n.isEmpty())return Sg;const e=n.toJSON();if(!e.root||!e.root.children)return;const t=e.root.children;if(t.length===1&&_f(t[0])&&(!t[0].children||t[0].children.length===0))return Sg;const r=k0(t),i=Ur(r);return i?{type:Fi,version:Bi,content:i}:void 0}function $T(n,e){const{type:t,marker:r,unknownAttributes:i}=n;let s;return n.code!==""&&(s=n.code),ht({type:t,marker:r,code:s,...i,content:e})}function FT(n){const{marker:e,number:t,sid:r,altnumber:i,pubnumber:s,unknownAttributes:o}=n;return ht({type:Xn.getType(),marker:e,number:t,sid:r,altnumber:i,pubnumber:s,...o})}function BT(n,e){const{marker:t,sid:r,altnumber:i,pubnumber:s,unknownAttributes:o}=n,a=e&&typeof e[0]=="string"?e[0]:void 0;let{number:l}=n;return l=Qb(t,a,l),ht({type:Xn.getType(),marker:t,number:l,sid:r,altnumber:i,pubnumber:s,...o})}function qT(n){const{marker:e,sid:t,altnumber:r,pubnumber:i,unknownAttributes:s}=n,{text:o}=n;let{number:a}=n;return a=Qb(e,o,a),ht({type:Yt.getType(),marker:e,number:a,sid:t,altnumber:r,pubnumber:i,...s})}function jT(n,e){const{type:t,marker:r,unknownAttributes:i}=n;return e==null||e.forEach((s,o)=>{typeof s=="string"&&s.startsWith(Ve)&&(e[o]=s.slice(1))}),ht({type:t,marker:r,...i,content:e})}function UT(n,e){const{type:t,marker:r,unknownAttributes:i}=n;return ht({type:t,marker:r,...i,content:e})}function WT(n,e){const{type:t,marker:r,caller:i,category:s,unknownAttributes:o}=n;return ht({type:t,marker:r,caller:i,category:s,...o,content:e})}function ds(n){const{type:e,marker:t,sid:r,eid:i,unknownAttributes:s}=n;return ht({type:e,marker:t,sid:r,eid:i,...s})}function zT(n){return n.text}function HT(n,e){const{tag:t,marker:r,unknownAttributes:i}=n;return ht({type:t,marker:r,...i,content:e})}function KT(n){const{marker:e}=n;return{type:Ml,marker:e}}function Tg(n,e){const t=n[n.length-1];t&&typeof t=="string"?n[n.length-1]=t+e:n.push(e)}function VT(n,e,t,r,i){const s=hr.getType(),o=e.filter(a=>!t.includes(a));if(t.filter(a=>!e.includes(a)).forEach(a=>{const l=ds({type:s,marker:ys,eid:a});i.push(l)}),o.forEach(a=>{const l=ds({type:s,marker:Wi,sid:a});i.push(l)}),e.length===0){const a=ds({type:s,marker:Wi});i.push(a)}if(i.push(...n),e.length===0){const a=ds({type:s,marker:ys});i.push(a)}(!r||!t1(r))&&e.forEach(a=>{const l=ds({type:s,marker:ys,eid:a});i.push(l)})}function Ur(n,e){const t=[];let r,i=[];return n.forEach((s,o)=>{const a=s,l=s,u=s,c=s,f=s,d=s,h=s,p=s;switch(s.type){case In.getType():t.push($T(a,Ur(a.children)));break;case $r.getType():t.push(FT(s));break;case Xn.getType():t.push(BT(l,Ur(l.children)));break;case Xt.getType():case Yt.getType():t.push(qT(s));break;case et.getType():t.push(jT(u,Ur(u.children)));break;case ln.getType():t.push(UT(c,Ur(c.children)));break;case jt.getType():t.push(WT(f,Ur(f.children,f.caller)));break;case hi.getType():case Kn.getType():case Yi.getType():case es.getType():break;case Dt.getType():if(r=Ur(h.children),r){const m=h.typedIDs[Gr];if(m)VT(r,m,i,n[o+1],t),i=m;else{const _=r.shift();_&&(typeof _=="string"?Tg(t,_):t.push(_)),r.length>0&&t.push(...r)}}break;case hr.getType():t.push(ds(s));break;case xn.getType():d.text&&d.text!==Ve&&!d.text.startsWith(Ib)&&(!e||d.text!==xf(e))&&Tg(t,zT(d));break;case Zi.getType():t.push(HT(p,Ur(p.children)));break;case pi.getType():t.push(KT(s));break;default:id==null||id.error(`Unexpected node type '${s.type}'!`)}}),t&&t.length>0?t:void 0}function k0(n){const e=n.findIndex(t=>_f(t));if(e>=0){const t=n.slice(0,e),r=n[e].children,i=k0(n.slice(e+1));n=[...t,...r,...i]}return n}const nc={initialize:PT,deserializeEditorState:LT},Ag=S0([]),JT={type:Yi.getType(),version:1};let Il=[],ve,Za,sd,Ke;function GT(n,e){Il=[],QT(n),ZT(e)}function YT(n=0){}function XT(n,e){ve=e??Zo();let t;return n?(n.type!==Fi&&(Ke==null||Ke.warn(`This USJ type '${n.type}' didn't match the expected type '${Fi}'.`)),n.version!==Bi&&(Ke==null||Ke.warn(`This USJ version '${n.version}' didn't match the expected version '${Bi}'.`)),n.content.length>0?t=ad(po(n.content)):t=[Ag]):t=[Ag],sd==null||sd(Il),{root:{children:t,direction:null,format:"",indent:0,type:"root",version:1}}}function QT(n){n&&(Za=n),n!=null&&n.addMissingComments&&(sd=n.addMissingComments)}function ZT(n){n&&(Ke=n)}function eA(n){return!n||n.length!==1||typeof n[0]!="string"?"":n[0]}function tA(n){const{marker:e,code:t}=n;e!==nu&&(Ke==null||Ke.warn(`Unexpected book marker '${e}'!`)),(!t||!In.isValidBookCode(t))&&(Ke==null||Ke.warn(`Unexpected book code '${t}'!`));const r=[];((ve==null?void 0:ve.markerMode)==="editable"||(ve==null?void 0:ve.markerMode)==="visible")&&r.push(Hi("marker",fi(e)+" "+t+Ve)),r.push(zi(eA(n.content)));const i=Et(n);return ht({type:In.getType(),marker:e,code:t??"",unknownAttributes:i,children:r,direction:null,format:"",indent:0,version:Mb})}function nA(n){const{marker:e,number:t,sid:r,altnumber:i,pubnumber:s}=n;e!==gf&&(Ke==null||Ke.warn(`Unexpected chapter marker '${e}'!`));const o=Et(n);let a;return(ve==null?void 0:ve.markerMode)==="visible"&&(a=!0),(ve==null?void 0:ve.markerMode)==="editable"?ht({type:Xn.getType(),marker:e,number:t??"",sid:r,altnumber:i,pubnumber:s,unknownAttributes:o,children:[zi(Yo(e,t)??"")],direction:null,format:"",indent:0,version:Pb}):ht({type:$r.getType(),marker:e,number:t??"",showMarker:a,sid:r,altnumber:i,pubnumber:s,unknownAttributes:o,version:qb})}function rA(n){const{marker:e,number:t,sid:r,altnumber:i,pubnumber:s}=n;e!==vf&&(Ke==null||Ke.warn(`Unexpected verse marker '${e}'!`));const o=(DT(ve)??Xt).getType(),a=(ve==null?void 0:ve.markerMode)==="editable"?Gb:l0;let l,u;(ve==null?void 0:ve.markerMode)==="editable"?l=Yo(e,t):(ve==null?void 0:ve.markerMode)==="visible"&&(u=!0);const c=Et(n);return ht({type:o,text:l,marker:e,number:t??"",sid:r,altnumber:i,pubnumber:s,showMarker:u,unknownAttributes:c,version:a})}function iA(n,e=[]){const{marker:t}=n;et.isValidMarker(t)||Ke==null||Ke.warn(`Unexpected char marker '${t}'!`),(ve==null?void 0:ve.markerMode)==="editable"&&e.forEach(i=>{wf(i)&&(i.text=Ve+i.text)});const r=Et(n);return ht({type:et.getType(),marker:t,unknownAttributes:r,children:[...e],direction:null,format:"",indent:0,textFormat:0,textStyle:"",version:Bb})}function S0(n){return{type:si.getType(),children:n,direction:null,format:"",indent:0,textFormat:0,textStyle:"",version:Wb}}function sA(n,e=[]){const{marker:t}=n;ln.isValidMarker(t)||Ke==null||Ke.warn(`Unexpected para marker '${t}'!`);const r=[];(ve==null?void 0:ve.markerMode)==="editable"?r.push(Rs(t),zi(Ve)):(ve==null?void 0:ve.markerMode)==="visible"&&r.push(Hi("marker",fi(t)+Ve)),r.push(...e);const i=Et(n);return ht({type:ln.getType(),marker:t,unknownAttributes:i,children:r,direction:null,format:"",indent:0,textFormat:0,textStyle:"",version:Jb})}function oA(n,e){const t=Jk(e);let r=()=>{};return Za!=null&&Za.noteCallerOnClick&&(r=Za.noteCallerOnClick),ht({type:Kn.getType(),caller:n,previewText:t,onClick:r,version:o0})}function aA(n,e){const{marker:t,category:r}=n;jt.isValidMarker(t)||Ke==null||Ke.warn(`Unexpected note marker '${t}'!`);const i=n.caller??"*",s=(ve==null?void 0:ve.noteMode)!=="expanded",o=Et(n);let a,l;(ve==null?void 0:ve.markerMode)==="editable"?(a=Rs(t),l=Rs(t,"closing")):(ve==null?void 0:ve.markerMode)==="visible"&&(a=Hi("marker",fi(t)+Ve),l=Hi("marker",Lo(t)+Ve));const u=[];let c;if(a&&u.push(a),(ve==null?void 0:ve.markerMode)==="editable")c=zi(xf(i)),u.push(c,...e);else{const f=zi(Ve);c=oA(i,e),u.push(c,f,...e.flatMap(lA(f)))}return l&&u.push(l),ht({type:jt.getType(),marker:t,caller:i,isCollapsed:s,category:r,unknownAttributes:o,children:u,direction:null,format:"",indent:0,version:Vb})}function lA(n){return e=>s1(e)?[e]:[e,n]}function uA(n){const{marker:e,sid:t,eid:r}=n;(!e||!hr.isValidMarker(e))&&(Ke==null||Ke.warn(`Unexpected milestone marker '${e}'!`));const i=Et(n);return ht({type:hr.getType(),marker:e,sid:t,eid:r,unknownAttributes:i,version:zb})}function Dg(n,e=[]){return{type:Dt.getType(),typedIDs:{[Gr]:e},children:n,direction:null,format:"",indent:0,version:1}}function cA(n,e){const{marker:t}=n,r=n.type,i=Et(n),s=[...e];return s.forEach(o=>{wf(o)&&(o.mode="token")}),ht({type:Zi.getType(),tag:r,marker:t,unknownAttributes:i,children:s,direction:null,format:"",indent:0,version:Db})}function dA(n){return{type:pi.getType(),marker:n,version:i0}}function Rs(n,e="opening"){return{type:es.getType(),marker:n,markerSyntax:e,text:"",detail:0,format:0,mode:"normal",style:"",version:1}}function zi(n,e="normal"){return{type:xn.getType(),text:n,detail:0,format:0,mode:e,style:"",version:1}}function Hi(n,e){return{type:hi.getType(),text:e,textType:n,version:r0}}function Ng(n,e){(ve==null?void 0:ve.markerMode)==="editable"?e.push(Rs(n)):(ve==null?void 0:ve.markerMode)==="visible"&&e.push(Hi("marker",fi(n)))}function Mg(n,e,t=!1){et.isValidFootnoteMarker(n)||et.isValidCrossReferenceMarker(n)||((ve==null?void 0:ve.markerMode)==="editable"?t?e.push(Rs("","selfClosing")):e.push(Rs(n,"closing")):(ve==null?void 0:ve.markerMode)==="visible"&&e.push(Hi("marker",Lo(t?"":n))))}function fA(n,e){if(n.type!=="ms")return;const t=[];if(n.sid&&t.push(`sid="${n.sid}"`),n.eid&&t.push(`eid="${n.eid}"`),t.length<=0)return;const r=Ib+t.join(" ");(ve==null?void 0:ve.markerMode)==="editable"?e.push(zi(r)):(ve==null?void 0:ve.markerMode)==="visible"&&e.push(Hi("attribute",r))}function Og(n,e){return n.length<=0||e===0?n:n.map(t=>t-e)}function hA(n,e){const t=n.indexOf(e,0);t>-1&&n.splice(t,1)}function Ig(n,e){e.marker===Wi&&e.sid!==void 0&&n.push(e.sid),e.marker===ys&&e.eid!==void 0&&hA(n,e.eid)}function od(n,e,t=!1,r=[]){if(e.length<=0||e[0]>=n.length)return n;const i=e.shift(),s=e.length>0?e.shift():n.length-1;if(i===void 0||s===void 0||s>=n.length||n.length<=0)return n;const o=n.slice(0,i),a=t?[Dg(o,[...r])]:o,l=n[i];Ig(r,l);const u=od(n.slice(i+1,s),Og(e,i+1),l.marker===Wi,r),c=Dg(u,[...r]),f=n[s];Ig(r,f);const d=od(n.slice(s+1),Og(e,s+1),f.marker===Wi,r);return[...a,c,...d]}function po(n){const e=[],t=[];return n==null||n.forEach(r=>{if(typeof r=="string")t.push(zi(r));else if(!r.type)Ke==null||Ke.error("Marker type is missing!");else switch(r.type){case In.getType():t.push(tA(r));break;case Xn.getType():t.push(nA(r));break;case Yt.getType():ve!=null&&ve.hasSpacing||t.push(JT),t.push(rA(r));break;case et.getType():Ng(r.marker,t),t.push(iA(r,po(r.content))),Mg(r.marker,t);break;case ln.getType():t.push(sA(r,po(r.content)));break;case jt.getType():t.push(aA(r,po(r.content)));break;case hr.getType():Nk(r.marker)&&(e.push(t.length),r.sid!==void 0&&(Il==null||Il.push(r.sid))),t.push(uA(r)),Ng(r.marker,t),fA(r,t),Mg(r.marker,t,!0);break;case pi.getType():t.push(dA(r.marker));break;default:Ke==null||Ke.warn(`Unknown type-marker '${r.type}-${r.marker}'!`),t.push(cA(r,po(r.content)))}}),od(t,e)}function ad(n){const e=n.findIndex(t=>gk(t)||Fk(t)||Lk(t));if(e>=0){const t=ad(n.slice(0,e)),r=n[e],i=ad(n.slice(e+1));return[...t,r,...i]}else if(n.some(t=>"text"in t&&"mode"in t||v1(t)))return[S0(n)];return n}const ld={initialize:GT,reset:YT,serializeEditorState:XT},rc={action:n=>{const{chapterNum:e,verseNum:t}=n.reference,r=[];return e!==void 0&&t!==void 0&&r.push({type:"char",marker:"fr",content:[`${e}:${t}`]}),n.noteText&&r.push({type:"char",marker:"fq",content:[n.noteText]}),r.push({type:"char",marker:"ft",content:["-"]}),[{type:"note",marker:"f",caller:Ui,content:r}]}},Rg={action:n=>{const{chapterNum:e,verseNum:t}=n.reference,r=[];return e!==void 0&&t!==void 0&&r.push({type:"char",marker:"xo",content:[`${e}:${t}`]}),r.push({type:"char",marker:"xt",content:["-"]}),[{type:"note",marker:"x",caller:hf,content:r}]}},pA={c:{action:n=>{const{chapterNum:e}=n.reference;return[{type:"chapter",marker:"c",number:`${e+1}`}]}},v:{action:n=>{const{verseNum:e,verse:t}=n.reference;return[{type:"verse",marker:"v",number:`${Zc(e,t)}`}]}},f:rc,fe:rc,ef:rc,x:Rg,xe:Rg};function gA(n,e,t,r,i){const s=mA(n);return{action:o=>{o.editor.update(()=>{var a;const l=ne();G(l)&&(o.noteText=l.getTextContent());const u=(a=s==null?void 0:s.action)==null?void 0:a.call(s,o);if(!u)return;const c=ug(u,ld,r),f=Zu(c);if(G(l)){const d=l.anchor.getNode();if($e(f))c0(f,l,r),f.getIsCollapsed()||(e.current=f.getKey());else if(l.getTextContent().length>0)yA(l,()=>Zu(c));else if(V(f)&&!f.isInline()){const h=l.insertParagraph();if(h){const p=h.getChildren();f.append(...p),h.replace(f),f.selectStart()}}else if(Z(d)&&!Xo(d)&&$e(d.getParent())&&l.isCollapsed()){let h=d.insertAfter(f);if(Nl(f)){const p={...r||Zo(),markerMode:"hidden"},m=ug(u,ld,p),_=Zu(m);h=h.insertAfter(_)}h.insertAfter(we(Ve))}else{l.insertNodes([f]),EA(f);const h=f.getNextSibling();h?h.selectStart():f.selectStart()}}else l==null||l.insertNodes([f])},i)},label:s==null?void 0:s.label}}function mA(n){let e=pA[n];return e||(ln.isValidMarker(n)?e={action:()=>[{type:ln.getType(),marker:n,content:[]}]}:et.isValidMarker(n)&&(e={action:()=>[{type:et.getType(),marker:n,content:["-"]}]})),e}function yA(n,e){const t=n.getNodes(),[r,i]=_A(n);let s;t.forEach((o,a)=>{if(V(s)&&s.isParentOf(o))return;const l=bA(o,a===0,a===t.length-1,r,i);if(!l){s=void 0;return}s||(s=e(),l.insertBefore(s)),CA(l,s)}),(Z(s)||V(s))&&s.selectEnd()}function _A(n){const e=n.anchor.offset,t=n.focus.offset;return n.isBackward()?[t,e]:[e,t]}function bA(n,e,t,r,i){if(!(Mt(n)||$e(n)||$e(n.getParent()))){if(Z(n))return vA(n,e,t,r,i);if(V(n)&&n.isInline())return n}}function vA(n,e,t,r,i){const s=n.getTextContentSize(),o=e?r:0,a=t?i:s;if(o===0&&a===0)return;const l=n.splitText(o,a);return l.length===1?l[0]:l.length===3||a===s?l[1]:l[0]}function CA(n,e){var t;if(Z(e)){const r=Pg(n,e);e.setTextContent(r),n.remove()}else if(V(e)){const r=e.getChildrenSize();e.append(n);for(let i=0;i<r;i++)(t=e.getFirstChild())==null||t.remove();Pg(n,e)}}function Pg(n,e){let t=n.getTextContent();if(Z(n)&&e.isInline()&&t.startsWith(" ")){t=t.trimStart(),n.setTextContent(t);const r=e.getPreviousSibling();Nf(r),Z(r)||e.insertBefore(we(" "))}return t}function EA(n){Mn(n)&&(Nf(n.getPreviousSibling()),h0(n.getNextSibling()))}const T0={chapter:"chapter",verse:"verse",char:"char",para:"para",typedMark:"editor-typed-mark",typedMarkOverlap:"editor-typed-markOverlap",mark:"editor-mark",markOverlap:"editor-markOverlap",placeholder:"editor-placeholder",paragraph:"editor-paragraph",quote:"editor-quote",heading:{h1:"editor-heading-h1",h2:"editor-heading-h2",h3:"editor-heading-h3",h4:"editor-heading-h4",h5:"editor-heading-h5"},list:{nested:{listitem:"editor-nested-listitem"},ol:"editor-list-ol",ul:"editor-list-ul",listitem:"editor-listitem"},image:"editor-image",link:"editor-link",text:{bold:"editor-text-bold",italic:"editor-text-italic",overflowed:"editor-text-overflowed",hashtag:"editor-text-hashtag",underline:"editor-text-underline",strikethrough:"editor-text-strikethrough",underlineStrikethrough:"editor-text-underlineStrikethrough"}},A0=T.createContext(null),Lg=4;function wA({children:n,className:e,onClick:t,title:r}){const i=T.useRef(null),s=T.useContext(A0);if(s===null)throw new Error("DropDownItem must be used within a DropDown");const{registerItem:o}=s;return T.useEffect(()=>{i&&i.current&&o(i)},[i,o]),I.jsx("button",{className:e,onClick:t,ref:i,title:r,type:"button",children:n})}function xA({children:n,dropDownRef:e,onClose:t}){const[r,i]=T.useState(),[s,o]=T.useState(),a=T.useCallback(c=>{i(f=>f?[...f,c]:[c])},[i]),l=c=>{if(!r)return;const f=c.key;["Escape","ArrowUp","ArrowDown","Tab"].includes(f)&&c.preventDefault(),f==="Escape"||f==="Tab"?t():f==="ArrowUp"?o(d=>{if(!d)return r[0];const h=r.indexOf(d)-1;return r[h===-1?r.length-1:h]}):f==="ArrowDown"&&o(d=>d?r[r.indexOf(d)+1]:r[0])},u=T.useMemo(()=>({registerItem:a}),[a]);return T.useEffect(()=>{r&&!s&&o(r[0]),s&&s.current&&s.current.focus()},[r,s]),I.jsx(A0.Provider,{value:u,children:I.jsx("div",{className:"dropdown",ref:e,onKeyDown:l,children:n})})}function kA({disabled:n=!1,buttonLabel:e,buttonAriaLabel:t,buttonClassName:r,buttonIconClassName:i,children:s,stopCloseOnClickSelf:o}){const a=T.useRef(null),l=T.useRef(null),[u,c]=T.useState(!1),f=()=>{c(!1),l&&l.current&&l.current.focus()};return T.useEffect(()=>{const d=l.current,h=a.current;if(u&&d!==null&&h!==null){const{top:p,left:m}=d.getBoundingClientRect();h.style.top=`${p+d.offsetHeight+Lg}px`,h.style.left=`${Math.min(m,window.innerWidth-h.offsetWidth-20)}px`}},[a,l,u]),T.useEffect(()=>{const d=l.current;if(d!==null&&u){const h=p=>{const m=p.target;o&&a.current&&a.current.contains(m)||d.contains(m)||c(!1)};return document.addEventListener("click",h),()=>{document.removeEventListener("click",h)}}return()=>{}},[a,l,u,o]),T.useEffect(()=>{const d=()=>{if(u){const h=l.current,p=a.current;if(h!==null&&p!==null){const{top:m}=h.getBoundingClientRect(),_=m+h.offsetHeight+Lg;_!==p.getBoundingClientRect().top&&(p.style.top=`${_}px`)}}};return document.addEventListener("scroll",d),()=>{document.removeEventListener("scroll",d)}},[l,a,u]),I.jsxs(I.Fragment,{children:[I.jsxs("button",{type:"button",disabled:n,"aria-label":t||e,className:r,onClick:()=>c(!u),ref:l,children:[i&&I.jsx("span",{className:i}),e&&I.jsx("span",{className:"text dropdown-button-text",children:e}),I.jsx("i",{className:"chevron-down"})]}),u&&En.createPortal(I.jsx(xA,{dropDownRef:a,onClose:f,children:s}),document.body)]})}const ud={m:"m - Paragraph - Margin - No First Line Indent",ms:"ms - Heading - Major Section Level 1",nb:"nb - Paragraph - No Break with Previous Paragraph",p:"p - Paragraph - Normal - First Line Indent",pi:"pi - Paragraph - Indented - Level 1 - First Line Indent",q1:"q1 - Poetry - Indent Level 1",q2:"q2 - Poetry - Indent Level 2",r:"r - Heading - Parallel References",s:"s - Heading - Section Level 1"},cd={...ud,ide:"ide - File - Encoding",h:"h - File - Header",h1:"h1 - File - Header",h2:"h2 - File - Left Header",h3:"h3 - File - Right Header",toc1:"toc1 - File - Long Table of Contents Text",toc2:"toc2 - File - Short Table of Contents Text",toc3:"toc3 - File - Book Abbreviation",cl:"cl - Chapter - Publishing Label",mt:"mt - Title - Major Title Level 1",mt1:"mt1 - Title - Major Title Level 1",mt2:"mt2 - Title - Major Title Level 2",mt3:"mt3 - Title - Major Title Level 3",mt4:"mt4 - Title - Major Title Level 4",ms1:"ms1 - Heading - Major Section Level 1",ms2:"ms2 - Heading - Major Section Level 2",ms3:"ms3 - Heading - Major Section Level 3",b:"b - Poetry - Stanza Break (Blank Line)"};function SA(n){return n in cd?n:"ban"}function TA(n){return n in cd?cd[n]:"No Style"}function AA(n){return n?"active dropdown-item-active":""}function DA({editor:n,blockMarker:e,disabled:t=!1}){const r=i=>{n.update(()=>{const s=ne();G(s)&&TC(s,()=>Po(i))})};return I.jsx(kA,{disabled:t,buttonClassName:"toolbar-item block-controls",buttonIconClassName:"icon block-marker "+SA(e),buttonLabel:TA(e),buttonAriaLabel:"Formatting options for block type",children:Object.keys(ud).map(i=>I.jsxs(wA,{className:"item block-marker "+AA(e===i),onClick:()=>r(i),children:[I.jsx("i",{className:"icon block-marker "+i}),I.jsx("span",{className:"text usfm_"+i,children:ud[i]})]},i))})}function $g(){return I.jsx("div",{className:"divider"})}const NA=T.forwardRef(function(n,e){const[t]=ke(),[r,i]=T.useState(t),[s,o]=T.useState(""),[a,l]=T.useState(!1),[u,c]=T.useState(!1),[f,d]=T.useState(()=>t.isEditable()),h=T.useCallback(()=>{const p=ne();if(G(p)){const m=p.anchor.getNode();let _=m.getKey()==="root"?m:Gn(m,v=>{const x=v.getParent();return x!==null&&gr(x)});_===null&&(_=m.getTopLevelElementOrThrow());const C=_.getKey();r.getElementByKey(C)!==null&&(Bt(_)||fr(_)||Go(_))&&o(_.getMarker())}},[r]);return T.useEffect(()=>t.registerCommand(Vi,(p,m)=>(h(),i(m),!1),_o),[t,h]),T.useEffect(()=>vt(t.registerEditableListener(p=>{d(p)}),r.registerUpdateListener(({editorState:p})=>{p.read(()=>{h()})}),r.registerCommand(uo,p=>(l(p),!1),_o),r.registerCommand(lo,p=>(c(p),!1),_o)),[h,r,t]),I.jsxs("div",{className:"toolbar",children:[I.jsx("button",{disabled:!a||!f,onClick:()=>{r.dispatchCommand($l,void 0)},title:Nc?"Undo (⌘Z)":"Undo (Ctrl+Z)",type:"button",className:"toolbar-item spaced","aria-label":"Undo",children:I.jsx("i",{className:"format undo"})}),I.jsx("button",{disabled:!u||!f,onClick:()=>{r.dispatchCommand(Fl,void 0)},title:Nc?"Redo (⌘Y)":"Redo (Ctrl+Y)",type:"button",className:"toolbar-item","aria-label":"Redo",children:I.jsx("i",{className:"format redo"})}),I.jsx($g,{}),r===t&&I.jsxs(I.Fragment,{children:[I.jsx(DA,{disabled:!f,blockMarker:s,editor:t}),I.jsx($g,{})]}),I.jsx("div",{ref:e,className:"end-container"})]})}),Fg={namespace:"platformEditor",theme:T0,editable:!0,editorState:void 0,onError(n){throw n},nodes:[Dt,...A1]},MA=Zo(),OA={},IA={};function RA(){return I.jsx("div",{className:"editor-placeholder",children:"Enter some Scripture..."})}const D0=T.forwardRef(function({defaultUsj:n,scrRef:e,onScrRefChange:t,onSelectionChange:r,onUsjChange:i,options:s,logger:o,children:a},l){const u=T.useRef(null),c=T.useRef(null),f=T.useRef(null),d=T.useRef(n),h=T.useRef(),[p,m]=T.useState(n),{isReadonly:_=!1,hasSpellCheck:C=!1,textDirection:v="ltr",markerMenuTrigger:x="\\",view:M=MA,nodes:$=OA,debug:k=!1}=s??IA;Fg.editable=!_,nc.initialize(o),T.useImperativeHandle(l,()=>({focus(){var D;(D=u.current)==null||D.focus()},getUsj(){return d.current},setUsj(D){Wr(d.current,D)||(d.current=D,m(D))},applyUpdate(D,O="remote"){var z,w;(z=u.current)==null||z.update(()=>{O==="remote"&&Py(Xc),yS(D,M,$,o)},{discrete:!0});const q=(w=u.current)==null?void 0:w.getEditorState();if(!q)return;const S=nc.deserializeEditorState(q);if(S){const H=!Wr(d.current,S);H&&(d.current=S),(H||!Wr(p,S))&&(i==null||i(S,D,O))}},getSelection(){var D;return(D=u.current)==null?void 0:D.read(u0)},setSelection(D){var O;(O=u.current)==null||O.update(()=>{const z=Df(D);z!==void 0&&Ot(z)},{tag:Rb})},addAnnotation(D,O,z){var w;(w=c.current)==null||w.addAnnotation(D,ag(O),z)},removeAnnotation(D,O){var z;(z=c.current)==null||z.removeAnnotation(ag(D),O)},insertNote(D,O,z){var w;(w=u.current)==null||w.update(()=>{const q=C1(D,O,z,e,M,$);q&&!q.getIsCollapsed()&&(h.current=q.getKey())})},get toolbarEndRef(){return f}}));const P=T.useCallback((D,O,z,w)=>{if(bk.some(S=>z.has(S)))return;const q=nc.deserializeEditorState(D);if(q){const S=!Wr(d.current,q);S&&(d.current=q);const H=z.has(Xc)?"remote":"local";(S||!Wr(p,q))&&(i==null||i(q,w,H))}},[p,i]);return I.jsxs(T_,{initialConfig:Fg,children:[I.jsx(JS,{isEditable:!_}),I.jsxs("div",{className:"editor-container",children:[I.jsx("div",{className:"editor-toolbar-container"+(_?"-readonly":"-editable"),children:I.jsx(NA,{ref:f})}),I.jsxs("div",{className:"editor-inner",children:[I.jsx(O_,{editorRef:u}),I.jsx(JE,{contentEditable:I.jsx(M_,{className:`editor-input ${NT(M).join(" ")}`,spellCheck:C}),placeholder:I.jsx(RA,{}),ErrorBoundary:I_}),I.jsx(R_,{}),e&&t&&I.jsx(MT,{scrRef:e,onScrRefChange:t}),e&&I.jsx(vT,{trigger:x,scrRef:e,getMarkerAction:(D,O)=>gA(D,h,O,M)}),I.jsx(fk,{options:{view:M,nodes:$},editedUsjRef:d,usj:p,setUsj:m}),I.jsx(GS,{scripture:p,nodeOptions:$,editorAdaptor:ld,viewOptions:M,logger:o}),I.jsx(lT,{onChange:r}),I.jsx(oS,{onChange:P,ignoreSelectionChange:!0,ignoreHistoryMergeTagChange:!0}),I.jsx(J1,{ref:c,logger:o}),I.jsx(IS,{viewOptions:M}),I.jsx(BS,{}),I.jsx(US,{}),I.jsx(WS,{logger:o}),I.jsx(VS,{}),I.jsx(YS,{expandedNoteKeyRef:h,nodeOptions:$,viewOptions:M,logger:o}),I.jsx(uT,{}),I.jsx(fT,{textDirection:v}),I.jsx(gT,{}),a]}),k&&I.jsx(RT,{})]})]})}),Fr=T.forwardRef(function(n,e){const{children:t,...r}=n;return I.jsx(D0,{ref:e,...r})});function N0(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}function Rl(n,e,t,r,i){return{author:e,content:n,deleted:i===void 0?!1:i,id:t===void 0?N0():t,timeStamp:r===void 0?performance.timeOrigin+performance.now():r,type:"comment"}}function M0(n,e,t){return{comments:e,id:t===void 0?N0():t,quote:n,type:"thread"}}function Bg(n){return{comments:Array.from(n.comments),id:n.id,quote:n.quote,type:"thread"}}function PA(n){return{author:n.author,content:"[Deleted Comment]",deleted:!0,id:n.id,timeStamp:n.timeStamp,type:"comment"}}function ic(n){const e=n._changeListeners;for(const t of e)t()}class LA{constructor(e,t){fe(this,"_editor"),fe(this,"_comments"),fe(this,"_changeListeners"),fe(this,"_collabProvider"),fe(this,"logger"),this._comments=[],this._editor=e,this.logger=t,this._collabProvider=null,this._changeListeners=new Set}isCollaborative(){return this._collabProvider!==null}getComments(){return this._comments}setComments(e){this._comments=e,ic(this)}addComment(e,t,r){const i=Array.from(this._comments),s=this._getCollabComments();if(t!==void 0&&e.type==="comment")for(let o=0;o<i.length;o++){const a=i[o];if(a.type==="thread"&&a.id===t.id){const l=Bg(a);i.splice(o,1,l);const u=r!==void 0?r:l.comments.length;if(this.isCollaborative()&&s!==null){const c=s.get(o).get("comments");this._withRemoteTransaction(()=>{const f=this._createCollabSharedMap(e);c.insert(u,[f])})}l.comments.splice(u,0,e);break}}else{const o=r!==void 0?r:i.length;this.isCollaborative()&&s!==null&&this._withRemoteTransaction(()=>{const a=this._createCollabSharedMap(e);s.insert(o,[a])}),i.splice(o,0,e)}this._comments=i,ic(this)}deleteCommentOrThread(e,t){const r=Array.from(this._comments),i=this._getCollabComments();let s=null;if(t!==void 0)for(let o=0;o<r.length;o++){const a=r[o];if(a.type==="thread"&&a.id===t.id){const l=Bg(a);r.splice(o,1,l);const u=l.comments;if(s=u.indexOf(e),this.isCollaborative()&&i!==null){const c=i.get(o).get("comments"),f=s;this._withRemoteTransaction(()=>{c.delete(f)})}u.splice(s,1);break}}else s=r.indexOf(e),this.isCollaborative()&&i!==null&&this._withRemoteTransaction(()=>{i.delete(s)}),r.splice(s,1);return this._comments=r,ic(this),e.type==="comment"?{index:s,markedComment:PA(e)}:null}registerOnChange(e){const t=this._changeListeners;return t.add(e),()=>{t.delete(e)}}_withRemoteTransaction(e){const t=this._collabProvider;t!==null&&t.doc.transact(e,this)}_withLocalTransaction(e){const t=this._collabProvider;try{this._collabProvider=null,e()}finally{this._collabProvider=t}}_getCollabComments(){const e=this._collabProvider;return e!==null?e.doc.get("comments",Mi):null}_createCollabSharedMap(e){const t=new Ns,r=e.type,i=e.id;if(t.set("type",r),t.set("id",i),r==="comment")t.set("author",e.author),t.set("content",e.content),t.set("deleted",e.deleted),t.set("timeStamp",e.timeStamp);else{t.set("quote",e.quote);const s=new Mi;e.comments.forEach((o,a)=>{const l=this._createCollabSharedMap(o);s.insert(a,[l])}),t.set("comments",s)}return t}registerCollaboration(e){this._collabProvider=e;const t=this._getCollabComments(),r=()=>{e.connect()},i=()=>{try{e.disconnect()}catch{}},s=this._editor.registerCommand(uk,a=>{var l,u;return r!==void 0&&i!==void 0&&(a?((l=this.logger)==null||l.info("Comments connected!"),r()):((u=this.logger)==null||u.info("Comments disconnected!"),i())),!1},Xi),o=(a,l)=>{if(l.origin!==this){for(const u of a)if(u instanceof vb){const c=u.target,f=u.delta;let d=0;for(const h of f){const p=h.insert,m=h.retain,_=h.delete,C=c.parent,v=c===t?void 0:C instanceof Ns&&this._comments.find(x=>x.id===C.get("id"));if(Array.isArray(p)){const x=d;p.slice().reverse().forEach(M=>{const $=M.get("id"),k=M.get("type")==="thread"?M0(M.get("quote"),M.get("comments").toArray().map(P=>Rl(P.get("content"),P.get("author"),P.get("id"),P.get("timeStamp"),P.get("deleted"))),$):Rl(M.get("content"),M.get("author"),$,M.get("timeStamp"),M.get("deleted"));this._withLocalTransaction(()=>{this.addComment(k,v,x)})})}else if(typeof m=="number")d+=m;else if(typeof _=="number")for(let x=0;x<_;x++){const M=v===void 0||v===!1?this._comments[d]:v.comments[d];this._withLocalTransaction(()=>{this.deleteCommentOrThread(M,v)}),d++}}}}};return t===null?()=>null:(t.observeDeep(o),r(),()=>{t.unobserveDeep(o),s(),this._collabProvider=null})}}function $A(n){const[e,t]=T.useState(n.getComments());return T.useEffect(()=>n.registerOnChange(()=>{t(n.getComments())}),[n]),e}function FA({onClose:n,children:e,title:t,closeOnClickOutside:r}){const i=T.useRef(null);return T.useEffect(()=>{i.current!==null&&i.current.focus()},[]),T.useEffect(()=>{let s=null;const o=u=>{u.key==="Escape"&&n()},a=u=>{const c=u.target;i.current!==null&&!i.current.contains(c)&&r&&n()},l=i.current;return l!==null&&(s=l.parentElement,s!==null&&s.addEventListener("click",a)),window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o),s!==null&&(s==null||s.removeEventListener("click",a))}},[r,n]),I.jsx("div",{className:"Modal__overlay",role:"dialog",children:I.jsxs("div",{className:"Modal__modal",tabIndex:-1,ref:i,children:[I.jsx("h2",{className:"Modal__title",children:t}),I.jsx("button",{className:"Modal__closeButton","aria-label":"Close modal",type:"button",onClick:n,children:"X"}),I.jsx("div",{className:"Modal__content",children:e})]})})}function BA({onClose:n,children:e,title:t,closeOnClickOutside:r=!1}){return En.createPortal(I.jsx(FA,{onClose:n,title:t,closeOnClickOutside:r,children:e}),document.body)}function O0(){const[n,e]=T.useState(null),t=T.useCallback(()=>{e(null)},[]),r=T.useMemo(()=>{if(n===null)return null;const{title:s,content:o,closeOnClickOutside:a}=n;return I.jsx(BA,{onClose:t,title:s,closeOnClickOutside:a,children:o})},[n,t]),i=T.useCallback((s,o,a=!1)=>{e({closeOnClickOutside:a,content:o(t),title:s})},[t]);return[r,i]}const qA={...T0,paragraph:"CommentEditorTheme__paragraph"};function jA(...n){return n.filter(Boolean).join(" ")}function ai({"data-test-id":n,children:e,className:t,onClick:r,disabled:i,small:s,title:o}){return I.jsx("button",{disabled:i,className:jA("Button__root",i&&"Button__disabled",s&&"Button__small",t),onClick:r,title:o,"aria-label":o,...n&&{"data-test-id":n},children:e})}function UA({className:n}){return I.jsx(M_,{className:n||"ContentEditable__root"})}function WA({children:n,className:e}){return I.jsx("div",{className:e||"Placeholder__root",children:n})}const qg=be("INSERT_INLINE_COMMAND");function zA({anchorKey:n,editor:e,showComments:t,onAddComment:r}){const i=T.useRef(null),s=T.useCallback(()=>{const o=i.current,a=e.getRootElement(),l=e.getElementByKey(n);if(o!==null&&a!==null&&l!==null){const{right:u}=a.getBoundingClientRect(),{top:c}=l.getBoundingClientRect();o.style.left=`${u-20}px`,o.style.top=`${c-30}px`}},[n,e]);return T.useEffect(()=>(window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}),[e,s]),T.useLayoutEffect(()=>{s()},[n,e,t,s]),I.jsx("div",{className:"CommentPlugin_AddCommentBox",ref:i,children:I.jsx("button",{className:"CommentPlugin_AddCommentBox_button",onClick:r,children:I.jsx("i",{className:"icon add-comment"})})})}function HA({onEscape:n}){const[e]=ke();return T.useEffect(()=>e.registerCommand(Bl,t=>n(t),Ha),[e,n]),null}function I0({className:n,autoFocus:e,onEscape:t,onChange:r,editorRef:i,placeholder:s="Type a comment..."}){return I.jsx(T_,{initialConfig:{namespace:"Commenting",nodes:[],onError:o=>{throw o},theme:qA},children:I.jsxs("div",{className:"CommentPlugin_CommentInputBox_EditorContainer",children:[I.jsx(_w,{contentEditable:I.jsx(UA,{className:n}),placeholder:I.jsx(WA,{children:s}),ErrorBoundary:I_}),I.jsx(dw,{onChange:r}),I.jsx(R_,{}),e!==!1&&I.jsx(ow,{}),I.jsx(HA,{onEscape:t}),I.jsx(lw,{}),i!==void 0&&I.jsx(O_,{editorRef:i})]})})}function R0(n,e){return T.useCallback((t,r)=>{t.read(()=>{n(A_()),e(!D_(r.isComposing(),!0))})},[e,n])}function KA({editor:n,cancelAddComment:e,submitAddComment:t}){const[r,i]=T.useState(""),[s,o]=T.useState(!1),a=T.useRef(null),l=T.useMemo(()=>({container:document.createElement("div"),elements:[]}),[]),u=T.useRef(null),c=L0(),f=T.useCallback(()=>{n.getEditorState().read(()=>{const m=ne();if(G(m)){u.current=m.clone();const _=m.anchor,C=m.focus,v=EC(n,_.getNode(),_.offset,C.getNode(),C.offset),x=a.current;if(v!==null&&x!==null){const{left:M,bottom:$,width:k}=v.getBoundingClientRect(),P=wC(n,v);let D=P.length===1?M+k/2-125:M-125;D<10&&(D=10),x.style.left=`${D}px`,x.style.top=`${$+20+(window.pageYOffset||document.documentElement.scrollTop)}px`;const O=P.length,{container:z}=l,w=l.elements,q=w.length;for(let S=0;S<O;S++){const H=P[S];let A=w[S];A===void 0&&(A=document.createElement("span"),w[S]=A,z.appendChild(A));const L=`position:absolute;top:${H.top+(window.pageYOffset||document.documentElement.scrollTop)}px;left:${H.left}px;height:${H.height}px;width:${H.width}px;background-color:rgba(255, 212, 0, 0.3);pointer-events:none;z-index:5;`;A.style.cssText=L}for(let S=q-1;S>=O;S--){const H=w[S];z.removeChild(H),w.pop()}}}})},[n,l]);T.useLayoutEffect(()=>{f();const m=l.container,_=document.body;return _!==null?(_.appendChild(m),()=>{_.removeChild(m)}):()=>{}},[l.container,f]),T.useEffect(()=>(window.addEventListener("resize",f),()=>{window.removeEventListener("resize",f)}),[f]);const d=m=>(m.preventDefault(),e(),!0),h=()=>{if(s){let m=n.getEditorState().read(()=>{const _=u.current;return _?_.getTextContent():""});m.length>100&&(m=m.slice(0,99)+"…"),t(M0(m,[Rl(r,c)]),!0,void 0,u.current),u.current=null}},p=R0(i,o);return I.jsxs("div",{className:"CommentPlugin_CommentInputBox",ref:a,children:[I.jsx(I0,{className:"CommentPlugin_CommentInputBox_Editor",onEscape:d,onChange:p}),I.jsxs("div",{className:"CommentPlugin_CommentInputBox_Buttons",children:[I.jsx(ai,{onClick:e,className:"CommentPlugin_CommentInputBox_Button",children:"Cancel"}),I.jsx(ai,{onClick:h,disabled:!s,className:"CommentPlugin_CommentInputBox_Button primary",children:"Comment"})]})]})}function VA({submitAddComment:n,thread:e,placeholder:t}){const[r,i]=T.useState(""),[s,o]=T.useState(!1),a=T.useRef(null),l=L0(),u=R0(i,o);return I.jsxs(I.Fragment,{children:[I.jsx(I0,{className:"CommentPlugin_CommentsPanel_Editor",autoFocus:!1,onEscape:()=>!0,onChange:u,editorRef:a,placeholder:t}),I.jsx(ai,{className:"CommentPlugin_CommentsPanel_SendButton",onClick:()=>{if(s){n(Rl(r,l),!1,e);const c=a.current;c!==null&&c.dispatchCommand(Td,void 0)}},disabled:!s,children:I.jsx("i",{className:"send"})})]})}function P0({commentOrThread:n,deleteCommentOrThread:e,onClose:t,thread:r=void 0}){return I.jsxs(I.Fragment,{children:["Are you sure you want to delete this ",n.type,"?",I.jsxs("div",{className:"Modal__content",children:[I.jsx(ai,{onClick:()=>{e(n,r),t()},children:"Delete"})," ",I.jsx(ai,{onClick:()=>{t()},children:"Cancel"})]})]})}function jg({comment:n,deleteComment:e,thread:t,rtf:r}){const i=Math.round((n.timeStamp-(performance.timeOrigin+performance.now()))/1e3),s=Math.round(i/60),[o,a]=O0();return I.jsxs("li",{className:"CommentPlugin_CommentsPanel_List_Comment",children:[I.jsxs("div",{className:"CommentPlugin_CommentsPanel_List_Details",children:[I.jsx("span",{className:"CommentPlugin_CommentsPanel_List_Comment_Author",children:n.author}),I.jsxs("span",{className:"CommentPlugin_CommentsPanel_List_Comment_Time",children:["· ",i>-10?"Just now":r.format(s,"minute")]})]}),I.jsx("p",{className:n.deleted?"CommentPlugin_CommentsPanel_DeletedComment":"",children:n.content}),!n.deleted&&I.jsxs(I.Fragment,{children:[I.jsx(ai,{onClick:()=>{a("Delete Comment",l=>I.jsx(P0,{commentOrThread:n,deleteCommentOrThread:e,thread:t,onClose:l}))},className:"CommentPlugin_CommentsPanel_List_DeleteButton",children:I.jsx("i",{className:"delete"})}),o]})]})}function JA({activeIDs:n,comments:e,deleteCommentOrThread:t,listRef:r,submitAddComment:i,markNodeMap:s}){const[o]=ke(),[a,l]=T.useState(0),[u,c]=O0(),f=T.useMemo(()=>new Intl.RelativeTimeFormat("en",{localeMatcher:"best fit",numeric:"auto",style:"short"}),[]);return T.useEffect(()=>{const d=setTimeout(()=>{l(a+1)},1e4);return()=>{clearTimeout(d)}},[a]),I.jsx("ul",{className:"CommentPlugin_CommentsPanel_List",ref:r,children:e.map(d=>{const h=d.id;return d.type==="thread"?I.jsxs("li",{onClick:()=>{const p=s.get(h);if(p!==void 0&&(n===null||n.indexOf(h)===-1)){const m=document.activeElement;o.update(()=>{const _=Array.from(p)[0],C=xe(_);Mt(C)&&C.selectStart()},{onUpdate(){m!==null&&m.focus()}})}},className:`CommentPlugin_CommentsPanel_List_Thread ${s.has(h)?"interactive":""} ${n.indexOf(h)===-1?"":"active"}`,children:[I.jsxs("div",{className:"CommentPlugin_CommentsPanel_List_Thread_QuoteBox",children:[I.jsxs("blockquote",{className:"CommentPlugin_CommentsPanel_List_Thread_Quote",children:["> ",I.jsx("span",{children:d.quote})]}),I.jsx(ai,{onClick:()=>{c("Delete Thread",p=>I.jsx(P0,{commentOrThread:d,deleteCommentOrThread:t,onClose:p}))},className:"CommentPlugin_CommentsPanel_List_DeleteButton",children:I.jsx("i",{className:"delete"})}),u]}),I.jsx("ul",{className:"CommentPlugin_CommentsPanel_List_Thread_Comments",children:d.comments.map(p=>I.jsx(jg,{comment:p,deleteComment:t,thread:d,rtf:f},p.id))}),I.jsx("div",{className:"CommentPlugin_CommentsPanel_List_Thread_Editor",children:I.jsx(VA,{submitAddComment:i,thread:d,placeholder:"Reply to comment..."})})]},h):I.jsx(jg,{comment:d,deleteComment:t,rtf:f},h)})})}function GA({activeIDs:n,deleteCommentOrThread:e,comments:t,submitAddComment:r,markNodeMap:i}){const s=T.useRef(null),o=t.length===0;return I.jsxs("div",{className:"CommentPlugin_CommentsPanel",children:[I.jsx("h2",{className:"CommentPlugin_CommentsPanel_Heading",children:"Comments"}),o?I.jsx("div",{className:"CommentPlugin_CommentsPanel_Empty",children:"No Comments"}):I.jsx(JA,{activeIDs:n,comments:t,deleteCommentOrThread:e,listRef:s,submitAddComment:r,markNodeMap:i})]})}function L0(){const n=q_(),{yjsDocMap:e,name:t}=n;return e.has("comments")?t:"Scripture User"}function YA({providerFactory:n,setCommentStore:e,onChange:t,showCommentsContainerRef:r,commentContainerRef:i,logger:s}){const o=q_(),[a]=ke(),l=T.useMemo(()=>{const D=new LA(a,s);return t&&D.registerOnChange(t),e==null||e(D),D},[a,s,t,e]),u=$A(l),c=T.useMemo(()=>new Map,[]),[f,d]=T.useState(),[h,p]=T.useState([]),[m,_]=T.useState(!1),[C,v]=T.useState(!1),{yjsDocMap:x}=o;T.useEffect(()=>{if(n){const D=n("comments",x);return l.registerCollaboration(D)}return()=>{}},[l,n,x]);const M=T.useCallback(()=>{a.update(()=>{const D=ne();D!==null&&(D.dirty=!0)}),_(!1)},[a]),$=T.useCallback((D,O)=>{if(D.type==="comment"){const z=l.deleteCommentOrThread(D,O);if(!z)return;const{markedComment:w,index:q}=z;l.addComment(w,O,q)}else{l.deleteCommentOrThread(D);const z=O!==void 0?O.id:D.id,w=c.get(z);w!==void 0&&setTimeout(()=>{a.update(()=>{for(const q of w){const S=xe(q);Mt(S)&&(S.deleteID(Gr,z),S.hasNoIDsForEveryType()&&t0(S))}})})}},[l,a,c]),k=T.useCallback((D,O,z,w)=>{l.addComment(D,z),O&&(a.update(()=>{G(w)&&n0(w,Gr,D.id)}),_(!1))},[l,a]);T.useEffect(()=>{const D=[];for(const O of h){const z=c.get(O);if(z!==void 0)for(const w of z){const q=a.getElementByKey(w);q!==null&&(q.classList.add("selected"),D.push(q),v(!0))}}return()=>{for(const O of D)O.classList.remove("selected")}},[h,a,c]),T.useEffect(()=>{if(!a.hasNodes([Dt]))throw new Error("CommentPlugin: TypedMarkNode not registered on editor!");const D=new Map;return vt(Xy(a,Dt,O=>$o(O.getTypedIDs()),(O,z)=>{for(const[w,q]of Object.entries(O.getTypedIDs()))q.forEach(S=>{z.addID(w,S)})}),a.registerMutationListener(Dt,O=>{a.getEditorState().read(()=>{for(const[z,w]of O){const q=xe(z);let S=[];w==="destroyed"?S=D.get(z)??[]:Mt(q)&&(S=q.getTypedIDs()[Gr]??[]);for(const H of S){let A=c.get(H);D.set(z,S),w==="destroyed"?A!==void 0&&(A.delete(z),A.size===0&&c.delete(H)):(A===void 0&&(A=new Set,c.set(H,A)),A.has(z)||A.add(z))}}})},{skipInitialization:!1}),a.registerUpdateListener(({editorState:O,tags:z})=>{O.read(()=>{const w=ne();let q=!1,S=!1;if(G(w)){const H=w.anchor.getNode();if(Z(H)){const A=n1(H,Gr,w.anchor.offset)??[];A!==null&&(p(A),q=!0),w.isCollapsed()||(d(H.getKey()),S=!0)}}q||p(H=>H.length===0?H:[]),S||d(null),!z.has("collaboration")&&G(w)&&_(!1)})}),a.registerCommand(qg,()=>{const O=window.getSelection();return O!==null&&O.removeAllRanges(),_(!0),!0},ye))},[a,c]);const P=()=>{a.dispatchCommand(qg,void 0)};return I.jsxs(I.Fragment,{children:[m&&En.createPortal(I.jsx(KA,{editor:a,cancelAddComment:M,submitAddComment:k}),document.body),f!=null&&!m&&En.createPortal(I.jsx(zA,{anchorKey:f,editor:a,showComments:C,onAddComment:P}),document.body),r!==null&&En.createPortal(I.jsx(ai,{className:`CommentPlugin_ShowCommentsButton ${C?"active":""}`,onClick:()=>v(!C),title:C?"Hide Comments":"Show Comments",children:I.jsx("i",{className:"comments"})}),(r==null?void 0:r.current)??document.body),C&&En.createPortal(I.jsx(GA,{comments:u,submitAddComment:k,deleteCommentOrThread:$,activeIDs:h,markNodeMap:c}),(i==null?void 0:i.current)??document.body)]})}function XA(){const n=T.useRef(void 0),e=T.useCallback(t=>{n.current=t},[]);return[n,e]}function QA(n,e){var t,r;const i=((t=e.current)==null?void 0:t.getComments())??[],s=i==null?void 0:i.map(a=>a.id),o=n.map(a=>{const l=s.findIndex(u=>u===a);return l!==void 0&&l>=0?i[l]:{comments:[{author:"unknown",content:"Comment not found",deleted:!1,id:"",timeStamp:0,type:"comment"}],id:a,quote:"",type:"thread"}});i.forEach(a=>{n.includes(a.id)||o.push(a)}),o&&((r=e.current)==null||r.setComments(o))}function ZA(n,e){T.useEffect(()=>{var t;n.options??(n.options={}),(t=n.options).nodes??(t.nodes={}),n.options.nodes.addMissingComments=r=>{QA(r,e)}},[e,n])}T.forwardRef(function(n,e){const t=T.useRef(null),r=T.useRef(!0),i=T.useRef(null),[s,o]=T.useState(null),{children:a,onCommentChange:l,onUsjChange:u,...c}=n,{options:{isReadonly:f}={}}=n,[d,h]=XA();ZA(c,d),T.useImperativeHandle(e,()=>({focus(){var _;(_=t.current)==null||_.focus()},getUsj(){var _;return(_=t.current)==null?void 0:_.getUsj()},setUsj(_){var C;(C=t.current)==null||C.setUsj(_)},applyUpdate(_,C){var v;(v=t.current)==null||v.applyUpdate(_,C)},getSelection(){var _;return(_=t.current)==null?void 0:_.getSelection()},setSelection(_){var C;(C=t.current)==null||C.setSelection(_)},addAnnotation(_,C,v){var x;(x=t.current)==null||x.addAnnotation(_,C,v)},removeAnnotation(_,C){var v;(v=t.current)==null||v.removeAnnotation(_,C)},insertNote(_,C,v){var x;(x=t.current)==null||x.insertNote(_,C,v)},setComments(_){var C;(C=d.current)==null||C.setComments(_),r.current=!0},get toolbarEndRef(){return s}}));const p=T.useCallback((_,C,v)=>{var x;if(!u)return;const M=(x=d.current)==null?void 0:x.getComments();u(_,M,C,v)},[d,u]),m=T.useCallback(()=>{var _;if(!l||r.current){r.current=!1;return}const C=(_=d.current)==null?void 0:_.getComments();l(C)},[d,r,l]);return T.useEffect(()=>{var _;return o(((_=t.current)==null?void 0:_.toolbarEndRef)??null),()=>o(null)},[]),I.jsxs(D0,{ref:t,onUsjChange:p,...c,children:[I.jsx(YA,{setCommentStore:h,onChange:m,showCommentsContainerRef:f?null:s,commentContainerRef:i,logger:c.logger}),I.jsx("div",{ref:i,className:"comment-container"})]})});const mi=T.memo(function({viewMode:e,description:t,children:r}){const i=e==="story",s=T.useMemo(()=>!i||typeof t!="string"||!t.trim()?null:I.jsxs(K0,{className:"tw-w-full",children:[I.jsx(V0,{className:"tw-pb-2",children:I.jsx(J0,{className:"tw-text-sm tw-font-medium tw-text-muted-foreground",children:"Story Description"})}),I.jsx(G0,{className:"tw-pt-2",children:I.jsx(H0,{className:"tw-prose-sm tw-max-w-none tw-text-muted-foreground",markdown:t})})]}),[t,i]);return I.jsxs("div",{style:{display:"grid",gap:8},children:[r,s]})});mi.__docgenInfo={description:"",methods:[],displayName:"CanvasWithDescription",props:{viewMode:{required:!1,tsType:{name:"string"},description:""},description:{required:!1,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""}}};function el({onClick:n,title:e,ariaLabel:t,children:r}){return I.jsx("button",{type:"button",onClick:n,title:e,"aria-label":t,style:{padding:"8px",backgroundColor:"#007acc",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"36px",height:"36px"},onMouseOver:i=>{i.currentTarget.style.backgroundColor="#005a9e"},onMouseOut:i=>{i.currentTarget.style.backgroundColor="#007acc"},onFocus:i=>{i.currentTarget.style.backgroundColor="#005a9e"},onBlur:i=>{i.currentTarget.style.backgroundColor="#007acc"},children:r})}el.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},title:{required:!0,tsType:{name:"string"},description:""},ariaLabel:{required:!0,tsType:{name:"string"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""}}};function $0({editorRef:n}){const e=()=>{var i;(i=n.current)==null||i.insertNote("f")},t=()=>{var i;(i=n.current)==null||i.insertNote("x")},r=()=>{var i;(i=n.current)==null||i.insertNote("fe")};return I.jsxs("div",{title:"External Toolbar",style:{padding:"8px 12px",backgroundColor:"#f5f5f5",borderBottom:"1px solid #ddd",display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[I.jsx(el,{onClick:e,title:"Insert Footnote",ariaLabel:"Insert Footnote",children:I.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-superscript",viewBox:"0 0 16 16",children:I.jsx("path",{d:"m4.266 12.496.96-2.853H8.76l.96 2.853H11L7.62 3H6.38L3 12.496zm2.748-8.063 1.419 4.23h-2.88l1.426-4.23zm5.132-1.797v-.075c0-.332.234-.618.619-.618.354 0 .618.256.618.58 0 .362-.271.649-.52.898l-1.788 1.832V6h3.59v-.958h-1.923v-.045l.973-1.04c.415-.438.867-.845.867-1.547 0-.8-.701-1.41-1.787-1.41C11.565 1 11 1.8 11 2.576v.06z"})})}),I.jsx(el,{onClick:t,title:"Insert Cross Reference",ariaLabel:"Insert Cross Reference",children:I.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-shuffle",viewBox:"0 0 16 16",children:[I.jsx("path",{fillRule:"evenodd",d:"M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.6 9.6 0 0 0 7.556 8a9.6 9.6 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.6 10.6 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.6 9.6 0 0 0 6.444 8a9.6 9.6 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5"}),I.jsx("path",{d:"M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192"})]})}),I.jsx(el,{onClick:r,title:"Insert Endnote",ariaLabel:"Insert Endnote",children:I.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-window-fullscreen",viewBox:"0 0 16 16",style:{transform:"scaleY(-1)"},children:[I.jsx("path",{d:"M3 3.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0m1.5 0a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0m1 .5a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),I.jsx("path",{d:"M.5 1a.5.5 0 0 0-.5.5v13a.5.5 0 0 0 .5.5h15a.5.5 0 0 0 .5-.5v-13a.5.5 0 0 0-.5-.5zM1 5V2h14v3zm0 1h14v8H1z"})]})})]})}$0.__docgenInfo={description:"",methods:[],displayName:"ExternalToolbar",props:{editorRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"EditorRef | null",elements:[{name:"EditorRef"},{name:"null"}]}],raw:"RefObject<EditorRef | null>"},description:""}}};const eD='<usx version="3.1" />',tD=Yd(eD),nD=`<?xml version="1.0" encoding="utf-8"?>
<usx version="3.1">
  <book code="PSA" style="id">World English Bible (WEB)</book>
  <para style="mt1">The Psalms</para>
  <chapter number="1" style="c" sid="PSA 1" />
  <para style="q1">
    <verse number="1" style="v" sid="PSA 1:1" />Blessed is the man who doesn’t walk in the counsel of the wicked<note caller="+" style="f"><char style="fr">1:1 </char><char style="ft">Or "sinful"</char></note>,</para>
  <para style="q2" vid="PSA 1:1">nor stand on the path<note caller="+" style="f"><char style="fr">1:1 </char><char style="ft">Hebrew: "way"</char></note> of sinners,</para>
  <para style="q2" vid="PSA 1:1">nor sit in the seat of scoffers;<verse eid="PSA 1:1" /></para>
  <para style="q1">
    <verse number="2" style="v" sid="PSA 1:2" /><note caller="+" style="f"><char style="fr" closed="false">1:2 </char><char style="ft" closed="false">After verse</char></note> but his delight is in Yahweh’s<note caller="+" style="f"><char style="fr" closed="false">1:2 </char><char style="ft" closed="false">“Yahweh” is God’s proper Name, sometimes rendered “LORD” (all caps) in other translations.</char></note> law.<note caller="+" style="f"><char style="fr" closed="false">1:2 </char><char style="ft" closed="false">End of Para</char></note></para>
  <para style="q2" vid="PSA 1:2">On his law he meditates day and night.<note caller="+" style="f"><char style="fr" closed="false">1:2 </char><char style="ft" closed="false">End of Doc</char></note><verse eid="PSA 1:2" /></para>
</usx>
`,Br=Yd(nD),rD={start:{jsonPath:"$.content[3].content[1]",offset:15},end:{jsonPath:"$.content[3].content[1]",offset:18}},iD={start:{jsonPath:"$.content[3].content[1]",offset:15},end:{jsonPath:"$.content[3].content[1]",offset:22}},sD=`<?xml version="1.0" encoding="utf-8"?>
<usx version="3.1">
  <book code="PSA" style="id">תהילים</book>
  <para style="mt1">תהילים</para>
  <chapter number="1" style="c" sid="PSA 1" />
  <para style="q1">
    <verse number="1" style="v" sid="PSA 1:1" />אשרי האיש אשר לא הלך בעצת רשעים,</para>
  <para style="q2" vid="PSA 1:1">ובדרך חטאים לא עמד,</para>
  <para style="q2" vid="PSA 1:1">ובמושב לצים לא ישב.<verse eid="PSA 1:1" /></para>
  <para style="q1">
    <verse number="2" style="v" sid="PSA 1:2" />כי אם בתורת יהוה חפצו,</para>
  <para style="q2" vid="PSA 1:2">ובתורתו יהגה יומם ולילה.<verse eid="PSA 1:2" /></para>
</usx>
`,oD=Yd(sD),Rn={book:"PSA",chapterNum:1,verseNum:1},AD={title:"Demo/Editorial",component:Fr,tags:["autodocs"],parameters:{docs:{description:{component:`
**Demo Only:** This component is provided for demonstration purposes only. For production applications, developers should import the Scripture Editor component directly from:
- npm [@eten-tech-foundation/platform-editor](https://www.npmjs.com/package/@eten-tech-foundation/platform-editor)
- github [@eten-tech-foundation/platform-editor](https://github.com/eten-tech-foundation/scripture-editors/tree/main/packages/platform)

This demo version is included in Storybook to showcase the component's functionality and usage patterns.

**Known Limitation:** In the Docs view, all story examples may show the same note caller style due to global state management in the editor component. To see the correct note caller behavior for each story (default lowercase letters vs custom symbols), please view the individual stories in the Canvas view instead of the Docs view.
        `}}},argTypes:{ref:{control:"object",description:"Reference to the editor instance",defaultValue:null},defaultUsj:{control:"object",description:"Default USJ object to initialize the editor with",defaultValue:{type:Fi,version:Bi,content:[""]}},scrRef:{control:"object",description:"Scripture reference",defaultValue:Rn},options:{control:"object",description:"Options to configure the editor (EditorOptions)",defaultValue:{},table:{type:{summary:"EditorOptions",detail:'{ isReadonly?: boolean; hasSpellCheck?: boolean; textDirection?: "ltr" | "rtl" | "auto"; markerMenuTrigger?: string; nodes?: UsjNodeOptions; }'}}}}},Na={args:{defaultUsj:Br,scrRef:Rn}},Ma={args:{defaultUsj:tD,scrRef:Rn}},Oa={args:{defaultUsj:Br,scrRef:Rn,options:{isReadonly:!0}}},Ia={render:(n,e)=>{var t,r,i,s;return I.jsx(mi,{viewMode:e.viewMode,description:((i=(r=(t=e.parameters)==null?void 0:t.docs)==null?void 0:r.description)==null?void 0:i.story)??((s=e.parameters)==null?void 0:s.description),children:I.jsx(Fr,{...n})})},parameters:{docs:{description:{story:'Right-to-left example using a Hebrew snippet (Psalm 1:1). The editor is set to RTL via _options.textDirection = "rtl"_. If you want the UI (editor toolbar) to be RTL click **Switch direction** in the Storybook toolbar.'}}},args:{defaultUsj:oD,scrRef:Rn,options:{textDirection:"rtl"}}},Ra={render:n=>{const e=T.useRef(null);return T.useEffect(()=>{e.current&&(e.current.addAnnotation(rD,"spelling","annotationId"),e.current.addAnnotation(iD,"grammar","abc123"))},[]),I.jsx(Fr,{...n,ref:e})},args:{defaultUsj:Br,scrRef:Rn}},aD={view:{...Zo(),noteMode:"expandInline"},nodes:{noteCallerOnClick:(n,e,t,r,i)=>{t||(r()===Ui?i(hf):i(Ui))}}},Pa={render:(n,e)=>{var t,r,i,s;return I.jsx(mi,{viewMode:e.viewMode,description:((i=(r=(t=e.parameters)==null?void 0:t.docs)==null?void 0:r.description)==null?void 0:i.story)??((s=e.parameters)==null?void 0:s.description),children:I.jsx(Fr,{...n})})},parameters:{docs:{description:{story:"This story demonstrates editing notes inline. Move your cursor to a note caller and the note will expand and can be edited. Move the cursor out of the note and it will collapse. Click the expanded note caller to toggle between the auto-generated caller and the hidden caller."}}},args:{defaultUsj:Br,scrRef:Rn,options:aD}},lD={view:{...Zo(),noteMode:"expandInline"}},La={render:(n,e)=>{var r,i,s,o;const t=T.useRef(null);return I.jsxs(mi,{viewMode:e.viewMode,description:((s=(i=(r=e.parameters)==null?void 0:r.docs)==null?void 0:i.description)==null?void 0:s.story)??((o=e.parameters)==null?void 0:o.description),children:[I.jsx($0,{editorRef:t}),I.jsx(Fr,{...n,ref:t})]})},parameters:{docs:{description:{story:"This story demonstrates inserting notes. Use the buttons above the editor to insert footnotes, cross-references, and endnotes at the current cursor position. Selecting text before inserting a footnote will use that text as the footnote quote."}}},args:{defaultUsj:Br,scrRef:Rn,options:lD}},uD={nodes:{noteCallers:["①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩"],noteCallerOnClick:n=>{console.log("Note caller clicked:",n),alert("Note caller clicked! Check console for details.")}}},$a={render:(n,e)=>{var t,r,i,s;return I.jsx(mi,{viewMode:e.viewMode,description:((i=(r=(t=e.parameters)==null?void 0:t.docs)==null?void 0:r.description)==null?void 0:i.story)??((s=e.parameters)==null?void 0:s.description),children:I.jsx(Fr,{...n})})},parameters:{docs:{description:{story:"This story demonstrates custom note callers and click handling. **Try clicking on the circled number footnote markers (① ②) in the text to see the click handler in action!** The click event will show an alert and log details to the browser console."}}},args:{defaultUsj:Br,scrRef:Rn,options:uD}},Fa={render:(n,e)=>{var t,r,i,s;return I.jsx(mi,{viewMode:e.viewMode,description:((i=(r=(t=e.parameters)==null?void 0:t.docs)==null?void 0:r.description)==null?void 0:i.story)??((s=e.parameters)==null?void 0:s.description),children:I.jsx(Fr,{...n})})},parameters:{docs:{description:{story:'This story demonstrates using a custom marker menu trigger key. **Try typing "?" (question mark) anywhere in the editor text to open the marker menu!** The default trigger is "\\\\" (backslash), but this story changes it to "?" for demonstration. The marker menu allows you to insert USFM markers into the text.'}}},args:{defaultUsj:Br,scrRef:Rn,options:{markerMenuTrigger:"?"}}},Ba={render:(n,e)=>{var u,c,f,d;const t=T.useRef(null),[r,i]=T.useState(null),[s,o]=T.useState(!1),a=T.useMemo(()=>({...n.options??{},view:{markerMode:s?"visible":"hidden",hasSpacing:!0,isFormattedFont:!0}}),[n.options,s]);T.useEffect(()=>{var p,m;const h=(m=(p=t.current)==null?void 0:p.toolbarEndRef)==null?void 0:m.current;if(h)i(h);else{const _=window.setTimeout(()=>{var v,x;const C=(x=(v=t.current)==null?void 0:v.toolbarEndRef)==null?void 0:x.current;C&&i(C)},0);return()=>window.clearTimeout(_)}},[a]);const l=T.useCallback(()=>o(h=>!h),[]);return I.jsxs(mi,{viewMode:e.viewMode,description:((f=(c=(u=e.parameters)==null?void 0:u.docs)==null?void 0:c.description)==null?void 0:f.story)??((d=e.parameters)==null?void 0:d.description),children:[I.jsx(Fr,{...n,options:a,ref:t}),r&&En.createPortal(I.jsx("button",{type:"button",title:"Show/hide markers","aria-label":"Show/hide markers","aria-pressed":s,className:`toolbar-item ${s?"active":""}`,onClick:l,children:I.jsx("span",{className:"icon pilcrow-icon","aria-hidden":"true",children:"¶"})}),r)]})},parameters:{docs:{description:{story:"This story demonstrates the Markers view, which shows USFM markers inline with the text. Click the **Show/hide markers** (¶) button in the editor toolbar to toggle the Markers view on and off. "}}},args:{defaultUsj:Br,scrRef:Rn}},qa={name:"View Options",render:(n,e)=>{var t,r,i,s;return I.jsx(mi,{viewMode:e.viewMode,description:((i=(r=(t=e.parameters)==null?void 0:t.docs)==null?void 0:r.description)==null?void 0:i.story)??((s=e.parameters)==null?void 0:s.description),children:I.jsx(Fr,{...n})})},parameters:{docs:{description:{story:'Demonstrates the editor view options (marker visibility, spacing, and formatted font) using USX input. Below in the **Controls** tab, try changing the **options.view** values to see how they affect the editor display. Valid values for **markerMode** are _"hidden"_, _"visible"_, and _"editable"_.'}}},args:{defaultUsj:Br,scrRef:Rn,options:{view:{markerMode:"hidden",hasSpacing:!0,isFormattedFont:!0}}}};var Ug,Wg,zg;Na.parameters={...Na.parameters,docs:{...(Ug=Na.parameters)==null?void 0:Ug.docs,source:{originalSource:`{
  args: {
    defaultUsj: usjWeb,
    scrRef: defaultScrRef
  }
}`,...(zg=(Wg=Na.parameters)==null?void 0:Wg.docs)==null?void 0:zg.source}}};var Hg,Kg,Vg;Ma.parameters={...Ma.parameters,docs:{...(Hg=Ma.parameters)==null?void 0:Hg.docs,source:{originalSource:`{
  args: {
    defaultUsj: usjEmpty,
    scrRef: defaultScrRef
  }
}`,...(Vg=(Kg=Ma.parameters)==null?void 0:Kg.docs)==null?void 0:Vg.source}}};var Jg,Gg,Yg;Oa.parameters={...Oa.parameters,docs:{...(Jg=Oa.parameters)==null?void 0:Jg.docs,source:{originalSource:`{
  args: {
    defaultUsj: usjWeb,
    scrRef: defaultScrRef,
    options: {
      isReadonly: true
    }
  }
}`,...(Yg=(Gg=Oa.parameters)==null?void 0:Gg.docs)==null?void 0:Yg.source}}};var Xg,Qg,Zg;Ia.parameters={...Ia.parameters,docs:{...(Xg=Ia.parameters)==null?void 0:Xg.docs,source:{originalSource:`{
  render: (args, context) => <CanvasWithDescription viewMode={context.viewMode} description={context.parameters?.docs?.description?.story ?? context.parameters?.description}>
      <Editorial {...args} />
    </CanvasWithDescription>,
  parameters: {
    docs: {
      description: {
        story: 'Right-to-left example using a Hebrew snippet (Psalm 1:1). ' + 'The editor is set to RTL via _options.textDirection = "rtl"_. If you want the UI ' + '(editor toolbar) to be RTL click **Switch direction** in the Storybook toolbar.'
      }
    }
  },
  args: {
    defaultUsj: usjHebrew,
    scrRef: defaultScrRef,
    options: {
      textDirection: 'rtl'
    }
  }
}`,...(Zg=(Qg=Ia.parameters)==null?void 0:Qg.docs)==null?void 0:Zg.source}}};var em,tm,nm;Ra.parameters={...Ra.parameters,docs:{...(em=Ra.parameters)==null?void 0:em.docs,source:{originalSource:`{
  render: args => {
    // eslint-disable-next-line no-null/no-null
    const editorRef = useRef<EditorRef | null>(null);
    useEffect(() => {
      if (editorRef.current) {
        editorRef.current.addAnnotation(annotationRangeWeb1, 'spelling', 'annotationId');
        editorRef.current.addAnnotation(annotationRangeWeb2, 'grammar', 'abc123');
      }
    }, []);
    return <Editorial {...args} ref={editorRef} />;
  },
  args: {
    defaultUsj: usjWeb,
    scrRef: defaultScrRef
  }
}`,...(nm=(tm=Ra.parameters)==null?void 0:tm.docs)==null?void 0:nm.source}}};var rm,im,sm;Pa.parameters={...Pa.parameters,docs:{...(rm=Pa.parameters)==null?void 0:rm.docs,source:{originalSource:`{
  render: (args, context) => <CanvasWithDescription viewMode={context.viewMode} description={context.parameters?.docs?.description?.story ?? context.parameters?.description}>
      <Editorial {...args} />
    </CanvasWithDescription>,
  parameters: {
    docs: {
      description: {
        story: 'This story demonstrates editing notes inline. Move your cursor to a note caller and ' + 'the note will expand and can be edited. Move the cursor out of the note and it will ' + 'collapse. Click the expanded note caller to toggle between the auto-generated caller ' + 'and the hidden caller.'
      }
    }
  },
  args: {
    defaultUsj: usjWeb,
    scrRef: defaultScrRef,
    options: inlineNoteOptions
  }
}`,...(sm=(im=Pa.parameters)==null?void 0:im.docs)==null?void 0:sm.source}}};var om,am,lm;La.parameters={...La.parameters,docs:{...(om=La.parameters)==null?void 0:om.docs,source:{originalSource:`{
  render: (args, context) => {
    // eslint-disable-next-line no-null/no-null
    const editorRef = useRef<EditorRef | null>(null);
    return <CanvasWithDescription viewMode={context.viewMode} description={context.parameters?.docs?.description?.story ?? context.parameters?.description}>
        <ExternalToolbar editorRef={editorRef} />
        <Editorial {...args} ref={editorRef} />
      </CanvasWithDescription>;
  },
  parameters: {
    docs: {
      description: {
        story: 'This story demonstrates inserting notes. Use the buttons above the editor to insert ' + 'footnotes, cross-references, and endnotes at the current cursor position. Selecting ' + 'text before inserting a footnote will use that text as the footnote quote.'
      }
    }
  },
  args: {
    defaultUsj: usjWeb,
    scrRef: defaultScrRef,
    options: insertNoteOptions
  }
}`,...(lm=(am=La.parameters)==null?void 0:am.docs)==null?void 0:lm.source}}};var um,cm,dm;$a.parameters={...$a.parameters,docs:{...(um=$a.parameters)==null?void 0:um.docs,source:{originalSource:`{
  render: (args, context) => <CanvasWithDescription viewMode={context.viewMode} description={context.parameters?.docs?.description?.story ?? context.parameters?.description}>
      <Editorial {...args} />
    </CanvasWithDescription>,
  parameters: {
    docs: {
      description: {
        story: 'This story demonstrates custom note callers and click handling. **Try clicking on the ' + 'circled number footnote markers (① ②) in the text to see the click handler in ' + 'action!** The click event will show an alert and log details to the browser console.'
      }
    }
  },
  args: {
    defaultUsj: usjWeb,
    scrRef: defaultScrRef,
    options: customNodeOptions
  }
}`,...(dm=(cm=$a.parameters)==null?void 0:cm.docs)==null?void 0:dm.source}}};var fm,hm,pm;Fa.parameters={...Fa.parameters,docs:{...(fm=Fa.parameters)==null?void 0:fm.docs,source:{originalSource:`{
  render: (args, context) => <CanvasWithDescription viewMode={context.viewMode} description={context.parameters?.docs?.description?.story ?? context.parameters?.description}>
      <Editorial {...args} />
    </CanvasWithDescription>,
  parameters: {
    docs: {
      description: {
        story: 'This story demonstrates using a custom marker menu trigger key. **Try typing "?" ' + '(question mark) anywhere in the editor text to open the marker menu!** The default ' + 'trigger is "\\\\\\\\" (backslash), but this story changes it to "?" for demonstration. ' + 'The marker menu allows you to insert USFM markers into the text.'
      }
    }
  },
  args: {
    defaultUsj: usjWeb,
    scrRef: defaultScrRef,
    options: {
      markerMenuTrigger: '?'
    }
  }
}`,...(pm=(hm=Fa.parameters)==null?void 0:hm.docs)==null?void 0:pm.source}}};var gm,mm,ym;Ba.parameters={...Ba.parameters,docs:{...(gm=Ba.parameters)==null?void 0:gm.docs,source:{originalSource:`{
  render: (args, context) => {
    // eslint-disable-next-line no-null/no-null
    const editorRef = useRef<EditorRef | null>(null);
    // eslint-disable-next-line no-null/no-null
    const [toolbarEndEl, setToolbarEndEl] = useState<HTMLElement | null>(null);
    const [showMarkers, setShowMarkers] = useState(false);
    const mergedOptions = useMemo(() => {
      const base = args.options ?? {};
      const view: ViewOptions = {
        markerMode: showMarkers ? 'visible' : 'hidden',
        hasSpacing: true,
        isFormattedFont: true
      };
      return {
        ...base,
        view
      };
    }, [args.options, showMarkers]);
    useEffect(() => {
      const el = editorRef.current?.toolbarEndRef?.current;
      if (el) setToolbarEndEl(el);else {
        // Retry once on next tick in case the toolbar mounts after the ref effect
        const id = window.setTimeout(() => {
          const el2 = editorRef.current?.toolbarEndRef?.current;
          if (el2) setToolbarEndEl(el2);
        }, 0);
        return () => window.clearTimeout(id);
      }
      return undefined;
    }, [mergedOptions]);
    const handleShowMarkerToggle = useCallback(() => setShowMarkers(v => !v), []);
    return <CanvasWithDescription viewMode={context.viewMode} description={context.parameters?.docs?.description?.story ?? context.parameters?.description}>
        <Editorial {...args} options={mergedOptions} ref={editorRef} />
        {toolbarEndEl && createPortal(<button type="button" title="Show/hide markers" aria-label="Show/hide markers" aria-pressed={showMarkers} className={\`toolbar-item \${showMarkers ? 'active' : ''}\`} onClick={handleShowMarkerToggle}>
              <span className="icon pilcrow-icon" aria-hidden="true">
                ¶
              </span>
            </button>, toolbarEndEl)}
      </CanvasWithDescription>;
  },
  parameters: {
    docs: {
      description: {
        story: 'This story demonstrates the Markers view, which shows USFM markers inline with the ' + 'text. Click the **Show/hide markers** (¶) button in the editor toolbar to toggle the ' + 'Markers view on and off. '
      }
    }
  },
  args: {
    defaultUsj: usjWeb,
    scrRef: defaultScrRef
  }
}`,...(ym=(mm=Ba.parameters)==null?void 0:mm.docs)==null?void 0:ym.source}}};var _m,bm,vm;qa.parameters={...qa.parameters,docs:{...(_m=qa.parameters)==null?void 0:_m.docs,source:{originalSource:`{
  name: 'View Options',
  render: (args, context) => <CanvasWithDescription viewMode={context.viewMode} description={context.parameters?.docs?.description?.story ?? context.parameters?.description}>
      <Editorial {...args} />
    </CanvasWithDescription>,
  parameters: {
    docs: {
      description: {
        story: 'Demonstrates the editor view options (marker visibility, spacing, and formatted font) ' + 'using USX input. Below in the **Controls** tab, try changing the **options.view** ' + 'values to see how they affect the editor display. Valid values for **markerMode** are ' + '_"hidden"_, _"visible"_, and _"editable"_.'
      }
    }
  },
  args: {
    defaultUsj: usjWeb,
    scrRef: defaultScrRef,
    options: {
      view: {
        markerMode: 'hidden',
        hasSpacing: true,
        isFormattedFont: true
      }
    }
  }
}`,...(vm=(bm=qa.parameters)==null?void 0:bm.docs)==null?void 0:vm.source}}};const DD=["Default","Empty","ReadOnly","RTL","Annotated","InlineNoteEditing","InsertNote","CustomNoteOptions","CustomMarkerTrigger","MarkersView","ViewOptionsStory"];export{Ra as Annotated,Fa as CustomMarkerTrigger,$a as CustomNoteOptions,Na as Default,Ma as Empty,Pa as InlineNoteEditing,La as InsertNote,Ba as MarkersView,Ia as RTL,Oa as ReadOnly,qa as ViewOptionsStory,DD as __namedExportsOrder,AD as default};
