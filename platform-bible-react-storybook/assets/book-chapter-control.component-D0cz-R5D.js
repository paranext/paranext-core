import{j as r}from"./jsx-runtime-CvGToidP.js";import{d as fe,A as q,e as Ve,a as Me,c as Y,b as ce,B as $e,f as He}from"./book-item.utils-C-lDUZz1.js";import{B as K}from"./button-cud2eTA2.js";import{C as ge,c as we,e as B,d as z,a as Se}from"./command-D3tc6HP1.js";import{P as ye,a as ke,b as be}from"./popover-CevumqeB.js";import{r as n,a as Pe}from"./iframe-FHgAwj54.js";import{c as Z}from"./shadcn-ui.util-DMJ19wEV.js";import{m as D}from"./index.es-D4jfZzAn.js";import{U as Ke,z as T,x as W,M as Be}from"./index-Bf4Kv1PK.js";import{c as ee}from"./createLucideIcon-B4WsWZHQ.js";import{C as ue}from"./chevron-left-bdRDGp6P.js";import{C as me}from"./chevron-right-Cncp9OTI.js";import{A as Fe,a as Re}from"./arrow-right-DKiik7w5.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],le=ee("ChevronsLeft",Ue);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],pe=ee("ChevronsRight",Ge);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],de=ee("Clock",Qe);function Ce({recentSearches:t,onSearchItemSelect:o,renderItem:d=p=>String(p),getItemKey:l=p=>String(p),ariaLabel:a="Show recent searches",groupHeading:i="Recent",id:m}){const[p,y]=n.useState(!1);if(t.length===0)return;const b=u=>{o(u),y(!1)};return r.jsxs(ye,{open:p,onOpenChange:y,children:[r.jsx(ke,{asChild:!0,children:r.jsx(K,{variant:"ghost",size:"icon",className:"tw-absolute tw-right-0 tw-top-0 tw-h-full tw-px-3 tw-py-2","aria-label":a,children:r.jsx(de,{className:"tw-h-4 tw-w-4"})})}),r.jsx(be,{id:m,className:"tw-w-[300px] tw-p-0",align:"start",children:r.jsx(ge,{children:r.jsx(we,{children:r.jsx(B,{heading:i,children:t.map(u=>r.jsxs(z,{onSelect:()=>b(u),className:"tw-flex tw-items-center",children:[r.jsx(de,{className:"tw-mr-2 tw-h-4 tw-w-4 tw-opacity-50"}),r.jsx("span",{children:d(u)})]},l(u)))})})})})]})}function lt(t,o,d=(a,i)=>a===i,l=15){return a=>{const i=t.filter(p=>!d(p,a)),m=[a,...i.slice(0,l-1)];o(m)}}Ce.__docgenInfo={description:`Generic component that displays a button to show recent searches in a popover. Only renders if
there are recent searches available. Works with any data type T.`,methods:[],displayName:"RecentSearches",props:{recentSearches:{required:!0,tsType:{name:"Array",elements:[{name:"T"}],raw:"T[]"},description:"Array of recent search items"},onSearchItemSelect:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: T) => void",signature:{arguments:[{type:{name:"T"},name:"item"}],return:{name:"void"}}},description:"Callback when a recent search item is selected"},renderItem:{required:!1,tsType:{name:"signature",type:"function",raw:"(item: T) => string",signature:{arguments:[{type:{name:"T"},name:"item"}],return:{name:"string"}}},description:"Function to render each search item as a string for display",defaultValue:{value:"(item) => String(item)",computed:!1}},getItemKey:{required:!1,tsType:{name:"signature",type:"function",raw:"(item: T) => string",signature:{arguments:[{type:{name:"T"},name:"item"}],return:{name:"string"}}},description:"Function to create a unique key for each item",defaultValue:{value:"(item) => String(item)",computed:!1}},ariaLabel:{required:!1,tsType:{name:"string"},description:"Aria label for the recent searches button",defaultValue:{value:"'Show recent searches'",computed:!1}},groupHeading:{required:!1,tsType:{name:"string"},description:"Heading text for the recent searches group",defaultValue:{value:"'Recent'",computed:!1}},id:{required:!1,tsType:{name:"string"},description:"Optional ID for the popover content for accessibility"}}};const X={BOOK_ONLY:/^([^:\s]+(?:\s+[^:\s]+)*)$/i,BOOK_CHAPTER:/^([^:\s]+(?:\s+[^:\s]+)*)\s+(\d+)$/i,BOOK_CHAPTER_VERSE:/^([^:\s]+(?:\s+[^:\s]+)*)\s+(\d+):(\d*)$/i},Ye=[X.BOOK_ONLY,X.BOOK_CHAPTER,X.BOOK_CHAPTER_VERSE];function he(t){const o=/^[a-zA-Z]$/.test(t),d=/^[0-9]$/.test(t);return{isLetter:o,isDigit:d}}function I(t){return Ke(D.bookIdToNumber(t))}function We(t,o,d){if(!t.trim()||o.length===0)return;const l=Ye.reduce((a,i)=>{if(a)return a;const m=i.exec(t.trim());if(m){const[p,y=void 0,b=void 0]=m.slice(1);let u;const L=o.filter(f=>fe(f,p,d));if(L.length===1&&([u]=L),!u&&y){if(D.isBookIdValid(p)){const f=p.toUpperCase();o.includes(f)&&(u=f)}if(!u&&d){const f=Array.from(d.entries()).find(([,v])=>v.localizedId.toLowerCase()===p.toLowerCase());f&&o.includes(f[0])&&([u]=f)}}if(!u&&y){const v=(C=>Object.keys(q).find(x=>q[x].toLowerCase()===C.toLowerCase()))(p);if(v&&o.includes(v)&&(u=v),!u&&d){const C=Array.from(d.entries()).find(([,x])=>x.localizedName.toLowerCase()===p.toLowerCase());C&&o.includes(C[0])&&([u]=C)}}if(u){let f=y?parseInt(y,10):void 0;f&&f>I(u)&&(f=Math.max(I(u),1));const v=b?parseInt(b,10):void 0;return{book:u,chapterNum:f,verseNum:v}}}},void 0);if(l)return l}function Xe(t,o,d,l){const a=n.useCallback(()=>{if(t.chapterNum>1)l({book:t.book,chapterNum:t.chapterNum-1,verseNum:1});else{const y=o.indexOf(t.book);if(y>0){const b=o[y-1],u=Math.max(I(b),1);l({book:b,chapterNum:u,verseNum:1})}}},[t,o,l]),i=n.useCallback(()=>{const y=I(t.book);if(t.chapterNum<y)l({book:t.book,chapterNum:t.chapterNum+1,verseNum:1});else{const b=o.indexOf(t.book);if(b<o.length-1){const u=o[b+1];l({book:u,chapterNum:1,verseNum:1})}}},[t,o,l]),m=n.useCallback(()=>{l({book:t.book,chapterNum:t.chapterNum,verseNum:t.verseNum>1?t.verseNum-1:0})},[t,l]),p=n.useCallback(()=>{l({book:t.book,chapterNum:t.chapterNum,verseNum:t.verseNum+1})},[t,l]);return n.useMemo(()=>[{onClick:a,disabled:o.length===0||t.chapterNum===1&&o.indexOf(t.book)===0,title:"Previous chapter",icon:d==="ltr"?le:pe},{onClick:m,disabled:o.length===0||t.verseNum===0,title:"Previous verse",icon:d==="ltr"?ue:me},{onClick:p,disabled:o.length===0,title:"Next verse",icon:d==="ltr"?me:ue},{onClick:i,disabled:o.length===0||(t.chapterNum===I(t.book)||I(t.book)===-1)&&o.indexOf(t.book)===o.length-1,title:"Next chapter",icon:d==="ltr"?pe:le}],[t,o,d,a,m,p,i])}function J({bookId:t,scrRef:o,onChapterSelect:d,setChapterRef:l,isChapterDimmed:a,className:i}){if(t)return r.jsx(B,{children:r.jsx("div",{className:Z("tw-grid tw-grid-cols-6 tw-gap-1",i),children:Array.from({length:I(t)},(m,p)=>p+1).map(m=>r.jsx(z,{value:`${t} ${q[t]||""} ${m}`,onSelect:()=>d(m),ref:l(m),className:Z("tw-h-8 tw-w-8 tw-cursor-pointer tw-justify-center tw-rounded-md tw-text-center tw-text-sm",{"tw-bg-primary tw-text-primary-foreground":t===o.book&&m===o.chapterNum},{"tw-bg-muted/50 tw-text-muted-foreground/50":(a==null?void 0:a(m))??!1}),children:m},m))})})}J.__docgenInfo={description:`Renders a grid of chapter numbers for a given book, with highlighting for the current chapter and
optional dimmed chapters based on state logic.`,methods:[],displayName:"ChapterGrid",props:{bookId:{required:!0,tsType:{name:"string"},description:"The book ID to render chapters for"},scrRef:{required:!0,tsType:{name:"signature",type:"object",raw:"{ book: string; chapterNum: number }",signature:{properties:[{key:"book",value:{name:"string",required:!0}},{key:"chapterNum",value:{name:"number",required:!0}}]}},description:"Current scripture reference for highlighting"},onChapterSelect:{required:!0,tsType:{name:"signature",type:"function",raw:"(chapter: number) => void",signature:{arguments:[{type:{name:"number"},name:"chapter"}],return:{name:"void"}}},description:"Callback when a chapter is selected"},setChapterRef:{required:!0,tsType:{name:"signature",type:"function",raw:"(chapter: number) => (element: HTMLDivElement | null) => void",signature:{arguments:[{type:{name:"number"},name:"chapter"}],return:{name:"signature",type:"function",raw:"(element: HTMLDivElement | null) => void",signature:{arguments:[{type:{name:"union",raw:"HTMLDivElement | null",elements:[{name:"HTMLDivElement"},{name:"null"}]},name:"element"}],return:{name:"void"}}}}},description:"Function to set chapter refs for keyboard navigation"},isChapterDimmed:{required:!1,tsType:{name:"signature",type:"function",raw:"(chapter: number) => boolean",signature:{arguments:[{type:{name:"number"},name:"chapter"}],return:{name:"boolean"}}},description:"Optional function to determine if a chapter should be dimmed"},className:{required:!1,tsType:{name:"string"},description:"Optional additional class name for styling"}}};function Ze({scrRef:t,handleSubmit:o,className:d,getActiveBookIds:l,localizedBookNames:a,localizedStrings:i,recentSearches:m,onAddRecentSearch:p,id:y}){const b=Pe(),[u,L]=n.useState(!1),[f,v]=n.useState(""),[C,x]=n.useState(""),[g,A]=n.useState("books"),[N,V]=n.useState(void 0),[xe,F]=n.useState(!1),R=n.useRef(void 0),E=n.useRef(void 0),M=n.useRef(void 0),U=n.useRef(void 0),G=n.useRef({}),_=n.useCallback(e=>{o(e),p&&p(e)},[o,p]),$=n.useMemo(()=>l?l():Ve,[l]),H=n.useMemo(()=>({[T.OT]:$.filter(c=>D.isBookOT(c)),[T.NT]:$.filter(c=>D.isBookNT(c)),[T.DC]:$.filter(c=>D.isBookDC(c)),[T.Extra]:$.filter(c=>D.extraBooks().includes(c))}),[$]),Q=n.useMemo(()=>Object.values(H).flat(),[H]),Ne=n.useMemo(()=>{if(!C.trim())return H;const e={[T.OT]:[],[T.NT]:[],[T.DC]:[],[T.Extra]:[]};return[T.OT,T.NT,T.DC,T.Extra].forEach(h=>{e[h]=H[h].filter(w=>fe(w,C,a))}),e},[H,C,a]),s=n.useMemo(()=>We(C,Q,a),[C,Q,a]),ve=n.useCallback(()=>{s&&(_({book:s.book,chapterNum:s.chapterNum??1,verseNum:s.verseNum??1}),L(!1),x(""),v(""))},[_,s]),Te=n.useCallback(e=>{if(I(e)<=1){_({book:e,chapterNum:1,verseNum:1}),L(!1),x("");return}V(e),A("chapters")},[_]),te=n.useCallback(e=>{const c=g==="chapters"?N:s==null?void 0:s.book;c&&(_({book:c,chapterNum:e,verseNum:1}),L(!1),A("books"),V(void 0),x(""))},[_,g,N,s]),Ie=n.useCallback(e=>{_(e),L(!1),x("")},[_]),je=Xe(t,Q,b,o),S=n.useCallback(()=>{A("books"),V(void 0),setTimeout(()=>{E.current&&E.current.focus()},0)},[]),Le=n.useCallback(e=>{if(!e&&g==="chapters"){S();return}L(e),e&&(A("books"),V(void 0),x(""))},[g,S]),{otLong:re,ntLong:ne,dcLong:oe,extraLong:se}={otLong:i==null?void 0:i["%scripture_section_ot_long%"],ntLong:i==null?void 0:i["%scripture_section_nt_long%"],dcLong:i==null?void 0:i["%scripture_section_dc_long%"],extraLong:i==null?void 0:i["%scripture_section_extra_long%"]},_e=n.useCallback(e=>Me(e,re,ne,oe,se),[re,ne,oe,se]),Oe=n.useCallback(e=>s?!!s.chapterNum&&!e.toString().includes(s.chapterNum.toString()):!1,[s]),Ee=n.useMemo(()=>W(t,a?Y(t.book,a):"English"),[t,a]),ae=n.useCallback(e=>c=>{G.current[e]=c},[]),De=n.useCallback(e=>{(e.key==="Home"||e.key==="End")&&e.stopPropagation()},[]),qe=n.useCallback(e=>{if(e.ctrlKey)return;const{isLetter:c,isDigit:h}=he(e.key);if(g==="chapters"){if(e.key==="Backspace"){e.preventDefault(),e.stopPropagation(),S();return}if(c||h){if(e.preventDefault(),e.stopPropagation(),A("books"),V(void 0),h&&N){const w=q[N];x(`${w} ${e.key}`)}else x(e.key);setTimeout(()=>{E.current&&E.current.focus()},0);return}}if((g==="chapters"||g==="books"&&s)&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)){const w=g==="chapters"?N:s==null?void 0:s.book;if(!w)return;const k=(()=>{if(!f)return 1;const P=f.match(/(\d+)$/);return P?parseInt(P[1],10):0})(),O=I(w);if(!O)return;let j=k;const ie=6;switch(e.key){case"ArrowLeft":k!==0&&(j=k>1?k-1:O);break;case"ArrowRight":k!==0&&(j=k<O?k+1:1);break;case"ArrowUp":j=k===0?O:Math.max(1,k-ie);break;case"ArrowDown":j=k===0?1:Math.min(O,k+ie);break;default:return}j!==k&&(e.preventDefault(),e.stopPropagation(),v(ce(w,a,j)),setTimeout(()=>{const P=G.current[j];P&&P.scrollIntoView({block:"nearest",behavior:"smooth"})},0))}},[g,s,S,N,f,a]),Ae=n.useCallback(e=>{if(e.shiftKey||e.key==="Tab"||e.key===" ")return;const{isLetter:c,isDigit:h}=he(e.key);(c||h)&&(e.preventDefault(),x(w=>w+e.key),E.current.focus(),F(!1))},[]);return n.useLayoutEffect(()=>{const e=setTimeout(()=>{if(u&&g==="books"&&M.current&&U.current){const c=M.current,h=U.current,w=h.offsetTop,k=c.clientHeight,O=h.clientHeight,j=w-k/2+O/2;c.scrollTo({top:Math.max(0,j),behavior:"smooth"}),v(ce(t.book))}},0);return()=>{clearTimeout(e)}},[u,g,C,s,t.book]),n.useLayoutEffect(()=>{if(g==="chapters"&&N){const e=N===t.book;setTimeout(()=>{if(M.current)if(e){const c=G.current[t.chapterNum];c&&c.scrollIntoView({block:"center",behavior:"smooth"})}else M.current.scrollTo({top:0});R.current&&R.current.focus()},0)}},[g,N,s,t.book,t.chapterNum]),r.jsxs(ye,{open:u,onOpenChange:Le,children:[r.jsx(ke,{asChild:!0,children:r.jsx(K,{"aria-label":"book-chapter-trigger",variant:"outline",role:"combobox","aria-expanded":u,className:Z("tw-h-8 tw-w-full tw-min-w-16 tw-max-w-48 tw-overflow-hidden tw-px-1",d),children:r.jsx("span",{className:"tw-truncate",children:Ee})})}),r.jsx(be,{id:y,forceMount:!0,className:"tw-w-[280px] tw-p-0",align:"center",children:r.jsxs(ge,{ref:R,onKeyDown:qe,loop:!0,value:f,onValueChange:v,shouldFilter:!1,children:[g==="books"?r.jsxs("div",{className:"tw-flex tw-items-end",children:[r.jsxs("div",{className:"tw-relative tw-flex-1",children:[r.jsx(Se,{ref:E,value:C,onValueChange:x,onKeyDown:De,onFocus:()=>F(!1),className:m&&m.length>0?"!tw-pr-10":""}),m&&m.length>0&&r.jsx(Ce,{recentSearches:m,onSearchItemSelect:Ie,renderItem:e=>W(e,"English"),getItemKey:e=>`${e.book}-${e.chapterNum}-${e.verseNum}`,ariaLabel:i==null?void 0:i["%history_recentSearches_ariaLabel%"],groupHeading:i==null?void 0:i["%history_recent%"]})]}),r.jsx("div",{className:"tw-flex tw-items-center tw-gap-1 tw-border-b tw-pe-2",children:je.map(({onClick:e,disabled:c,title:h,icon:w})=>r.jsx(K,{variant:"ghost",size:"sm",onClick:()=>{F(!0),e()},disabled:c,className:"tw-h-10 tw-w-4 tw-p-0",title:h,onKeyDown:Ae,children:r.jsx(w,{})},h))})]}):r.jsxs("div",{className:"tw-flex tw-items-center tw-border-b tw-px-3 tw-py-2",children:[r.jsx(K,{variant:"ghost",size:"sm",onClick:S,className:"tw-mr-2 tw-h-6 tw-w-6 tw-p-0",tabIndex:-1,children:b==="ltr"?r.jsx(Fe,{className:"tw-h-4 tw-w-4"}):r.jsx(Re,{className:"tw-h-4 tw-w-4"})}),N&&r.jsx("span",{tabIndex:-1,className:"tw-text-sm tw-font-medium",children:Y(N,a)})]}),!xe&&r.jsxs(we,{ref:M,children:[g==="books"&&r.jsxs(r.Fragment,{children:[!s&&Object.entries(Ne).map(([e,c])=>{if(c.length!==0)return r.jsx(B,{heading:_e(e),children:c.map(h=>r.jsx($e,{bookId:h,onSelect:w=>Te(w),section:Be(h),commandValue:`${h} ${q[h]}`,ref:h===t.book?U:void 0,localizedBookNames:a},h))},e)}),s&&r.jsx(B,{children:r.jsx(z,{value:`${s.book} ${q[s.book]} ${s.chapterNum||""}:${s.verseNum||""})}`,onSelect:ve,className:"tw-font-semibold tw-text-primary",children:W({book:s.book,chapterNum:s.chapterNum??1,verseNum:s.verseNum??1},a?He(s.book,a):void 0)},"top-match")}),s&&I(s.book)>1&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"tw-mb-2 tw-px-3 tw-text-sm tw-font-medium tw-text-muted-foreground",children:Y(s.book,a)}),r.jsx(J,{bookId:s.book,scrRef:t,onChapterSelect:te,setChapterRef:ae,isChapterDimmed:Oe,className:"tw-px-4 tw-pb-4"})]})]}),g==="chapters"&&N&&r.jsx(J,{bookId:N,scrRef:t,onChapterSelect:te,setChapterRef:ae,className:"tw-p-4"})]})]})})]})}Ze.__docgenInfo={description:`\`BookChapterControl\` is a component that provides an interactive UI for selecting book chapters.
It allows users to input a search query to find specific books and chapters, navigate through
options with keyboard interactions, and submit selections. The component handles various
interactions such as opening and closing the dropdown menu, filtering book lists based on search
input, and managing highlighted selections. It also integrates with external handlers for
submitting selected references and retrieving active book IDs.`,methods:[],displayName:"BookChapterControl",props:{scrRef:{required:!0,tsType:{name:"SerializedVerseRef"},description:"The current scripture reference"},handleSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(scrRef: SerializedVerseRef) => void",signature:{arguments:[{type:{name:"SerializedVerseRef"},name:"scrRef"}],return:{name:"void"}}},description:"Callback to handle the submission of a selected reference"},className:{required:!1,tsType:{name:"string"},description:"Optional additional class name for styling"},getActiveBookIds:{required:!1,tsType:{name:"signature",type:"function",raw:"() => string[]",signature:{arguments:[],return:{name:"Array",elements:[{name:"string"}],raw:"string[]"}}},description:"Callback to retrieve book IDs that are available in the current context"},localizedBookNames:{required:!1,tsType:{name:"Map",elements:[{name:"string"},{name:"signature",type:"object",raw:"{ localizedId: string; localizedName: string }",signature:{properties:[{key:"localizedId",value:{name:"string",required:!0}},{key:"localizedName",value:{name:"string",required:!0}}]}}],raw:"Map<string, { localizedId: string; localizedName: string }>"},description:`Optional map of localized book IDs/short names and full names. The key is the standard book ID
(e.g., "2CH"), the value contains a localized version of the ID and related book name (e.g. {
localizedId: '2CR', localizedName: '2 CrÃ³nicas' })`},localizedStrings:{required:!1,tsType:{name:"LanguageStrings"},description:"Optional localized strings for the component"},recentSearches:{required:!1,tsType:{name:"Array",elements:[{name:"SerializedVerseRef"}],raw:"SerializedVerseRef[]"},description:"Array of recent scripture references for quick access"},onAddRecentSearch:{required:!1,tsType:{name:"signature",type:"function",raw:"(scrRef: SerializedVerseRef) => void",signature:{arguments:[{type:{name:"SerializedVerseRef"},name:"scrRef"}],return:{name:"void"}}},description:"Callback to add a new recent scripture reference"},id:{required:!1,tsType:{name:"string"},description:"Optional ID for the popover content for accessibility"}}};export{Ze as B,lt as u};
