import{j as n}from"./jsx-runtime-CmmzXrJH.js";import{B as L}from"./badge-B2y7FMRz.js";import{B as C}from"./button-ChiQlUI2.js";import{d as H,C as Q,a as J,c as Z,b as ee,e as te,f as ne}from"./command-C-DxzeGy.js";import{P as re,a as se,b as oe}from"./popover-B8Y2kLQ2.js";import{m as c}from"./index.es-D4jfZzAn.js";import{r as h}from"./iframe-BsWDzEyf.js";import{c as V}from"./shadcn-ui.util-DMJ19wEV.js";import{C as ae}from"./check-Cgcd5_F1.js";import{C as ie}from"./chevrons-up-down-Bi3Fo9nq.js";import{L as B}from"./label-DgqGWOsJ.js";import{R as le,a as ce}from"./radio-group-Db4hGuTJ.js";var x=(e=>(e.OT="OT",e.NT="NT",e.DC="DC",e.Extra="Extra",e))(x||{});const ue=(e,t,o,s,a)=>{switch(e){case"OT":return t??"Old Testament";case"NT":return o??"New Testament";case"DC":return s??"Deuterocanon";case"Extra":return a??"Extra Materials";default:throw new Error(`Unknown section: ${e}`)}},me=(e,t,o,s,a)=>{switch(e){case"OT":return t??"OT";case"NT":return o??"NT";case"DC":return s??"DC";case"Extra":return a??"Extra";default:throw new Error(`Unknown section: ${e}`)}},v=e=>{if(c.isBookOT(e))return"OT";if(c.isBookNT(e))return"NT";if(c.isBookDC(e))return"DC";if(c.isExtraMaterial(e))return"Extra";throw new Error(`Unknown section for book: ${e}`)},I=(e,t)=>e.filter(o=>{try{return v(o)===t}catch{return!1}}),M=(e,t,o)=>I(e,t).every(s=>o.includes(s));function K({bookId:e,selectedBookIds:t,toggleBook:o,lastKeyEventShiftKey:s,localizedBookNames:a}){var w,g;const u=h.useRef(!1),i=h.useRef();return n.jsxs(H,{value:e,className:"tw-flex tw-items-center",onSelect:()=>{u.current||(o(e,s.current),s.current=!1),i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{u.current=!1},100)},onMouseDown:f=>{f.preventDefault(),u.current=!0,o(e,f.shiftKey)},role:"option","aria-selected":t.includes(e),"aria-label":`${c.bookIdToEnglishName(e)} (${e.toLocaleUpperCase()})`,children:[n.jsx(ae,{className:V("tw-me-2 tw-h-4 tw-w-4",t.includes(e)?"tw-opacity-100":"tw-opacity-0")}),n.jsx("span",{className:V("tw-flex-1 tw-border-b-0 tw-border-e-0 tw-border-s-2 tw-border-t-0 tw-border-solid tw-px-2",{"tw-border-s-red-200":v(e)===x.OT,"tw-border-s-purple-200":v(e)===x.NT,"tw-border-s-indigo-200":v(e)===x.DC,"tw-border-s-yellow-200":v(e)===x.Extra}),children:a&&((w=a.get(e))==null?void 0:w.localizedName)||c.bookIdToEnglishName(e)}),n.jsx("span",{className:"tw-ml-2 tw-text-xs tw-text-muted-foreground",children:a&&((g=a.get(e))==null?void 0:g.localizedId)||e.toLocaleUpperCase()})]},e)}K.__docgenInfo={description:`A component that represents a single book item in the book selector. Handles both keyboard and
mouse interactions for book selection, including shift-click for range selection. The component
shows the book's localized name, its ID, and visually indicates its testament (OT/NT/DC/Extra)
through color coding.`,methods:[],displayName:"BookItem",props:{bookId:{required:!0,tsType:{name:"string"},description:"The book ID (e.g., 'GEN', 'EXO')"},selectedBookIds:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Array of currently selected book IDs"},toggleBook:{required:!0,tsType:{name:"signature",type:"function",raw:"(bookId: string, shiftKey: boolean) => void",signature:{arguments:[{type:{name:"string"},name:"bookId"},{type:{name:"boolean"},name:"shiftKey"}],return:{name:"void"}}},description:"Callback function to handle book selection/deselection with optional shift-key support"},lastKeyEventShiftKey:{required:!0,tsType:{name:"MutableRefObject",elements:[{name:"boolean"}],raw:"MutableRefObject<boolean>"},description:"Reference to track if the last key event included the shift key"},localizedBookNames:{required:!1,tsType:{name:"Map",elements:[{name:"string"},{name:"signature",type:"object",raw:"{ localizedId: string; localizedName: string }",signature:{properties:[{key:"localizedId",value:{name:"string",required:!0}},{key:"localizedName",value:{name:"string",required:!0}}]}}],raw:"Map<string, { localizedId: string; localizedName: string }>"},description:`Optional map of localized book IDs/short names and full names. Key is the (English) book ID,
value contains localized versions of the ID and full book name`}}};function P({section:e,availableBookIds:t,selectedBookIds:o,onToggle:s,localizedStrings:a}){const u=I(t,e).length===0,i=a["%scripture_section_ot_short%"],w=a["%scripture_section_nt_short%"],g=a["%scripture_section_dc_short%"],f=a["%scripture_section_extra_short%"];return n.jsx(C,{variant:"outline",size:"sm",onClick:()=>s(e),className:V(M(t,e,o)&&!u&&"tw-bg-primary tw-text-primary-foreground hover:tw-bg-primary/70 hover:tw-text-primary-foreground"),disabled:u,children:me(e,i,w,g,f)})}P.__docgenInfo={description:`A button component that represents a scripture section (testament) in the book selector. The
button shows a different state when all books in its section are selected and becomes disabled
when no books are available in its section.`,methods:[],displayName:"SectionButton",props:{section:{required:!0,tsType:{name:"Section"},description:""},availableBookIds:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},selectedBookIds:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},onToggle:{required:!0,tsType:{name:"signature",type:"function",raw:"(section: Section) => void",signature:{arguments:[{type:{name:"Section"},name:"section"}],return:{name:"void"}}},description:""},localizedStrings:{required:!0,tsType:{name:"LanguageStrings"},description:""}}};const R=5,A=6;function G({availableBookInfo:e,selectedBookIds:t,onChangeSelectedBookIds:o,localizedStrings:s,localizedBookNames:a}){const u=s["%webView_book_selector_books_selected%"],i=s["%webView_book_selector_select_books%"],w=s["%webView_book_selector_search_books%"],g=s["%webView_book_selector_select_all%"],f=s["%webView_book_selector_clear_all%"],E=s["%webView_book_selector_no_book_found%"],S=s["%webView_book_selector_more%"],O=s["%scripture_section_ot_long%"],D=s["%scripture_section_nt_long%"],q=s["%scripture_section_dc_long%"],N=s["%scripture_section_extra_long%"],[j,T]=h.useState(!1),k=h.useRef(void 0),_=h.useRef(!1);if(e.length!==c.allBookIds.length)throw new Error("availableBookInfo length must match Canon.allBookIds length");const m=h.useMemo(()=>c.allBookIds.filter((r,l)=>e[l]==="1"&&!c.isObsolete(c.bookIdToNumber(r))),[e]),$=h.useCallback((r,l=!1)=>{if(!l||!k.current){o(t.includes(r)?t.filter(d=>d!==r):[...t,r]),k.current=r;return}const p=m.findIndex(d=>d===k.current),b=m.findIndex(d=>d===r);if(p===-1||b===-1)return;const[W,X]=[Math.min(p,b),Math.max(p,b)],z=m.slice(W,X+1).map(d=>d);o(t.includes(r)?t.filter(d=>!z.includes(d)):[...new Set([...t,...z])])},[t,o,m]),U=h.useCallback(r=>{const l=I(m,r).map(p=>p);o(M(m,r,t)?t.filter(p=>!l.includes(p)):[...new Set([...t,...l])])},[t,o,m]),F=()=>{o(m.map(r=>r))},Y=()=>{o([])};return n.jsxs("div",{className:"tw-space-y-2",children:[n.jsx("div",{className:"tw-flex tw-flex-wrap tw-gap-2",children:Object.values(x).map(r=>n.jsx(P,{section:r,availableBookIds:m,selectedBookIds:t,onToggle:U,localizedStrings:s},r))}),n.jsxs(re,{open:j,onOpenChange:T,children:[n.jsx(se,{asChild:!0,children:n.jsxs(C,{variant:"outline",role:"combobox","aria-expanded":j,className:"tw-max-w-64 tw-justify-between",children:[t.length>0?`${u}: ${t.length}`:i,n.jsx(ie,{className:"tw-ml-2 tw-h-4 tw-w-4 tw-shrink-0 tw-opacity-50"})]})}),n.jsx(oe,{className:"tw-w-full tw-p-0",align:"start",children:n.jsxs(Q,{onKeyDown:r=>{r.key==="Enter"&&(_.current=r.shiftKey)},children:[n.jsx(J,{placeholder:w}),n.jsxs("div",{className:"tw-flex tw-justify-between tw-border-b tw-p-2",children:[n.jsx(C,{variant:"ghost",size:"sm",onClick:F,children:g}),n.jsx(C,{variant:"ghost",size:"sm",onClick:Y,children:f})]}),n.jsxs(Z,{children:[n.jsx(ee,{children:E}),Object.values(x).map((r,l)=>{const p=m.filter(b=>v(b)===r);if(p.length!==0)return n.jsxs(h.Fragment,{children:[n.jsx(te,{heading:ue(r,O,D,q,N),children:p.map(b=>n.jsx(K,{bookId:b,selectedBookIds:t,toggleBook:$,lastKeyEventShiftKey:_,localizedBookNames:a},b))}),l<Object.values(x).length-1&&n.jsx(ne,{})]},r)})]})]})})]}),t.length>0&&n.jsxs("div",{className:"tw-mt-2 tw-flex tw-flex-wrap tw-gap-1",children:[t.slice(0,t.length===A?A:R).map(r=>{var l;return n.jsx(L,{className:"hover:tw-bg-secondary",variant:"secondary",children:a&&((l=a.get(r))==null?void 0:l.localizedName)||c.bookIdToEnglishName(r)||r},r)}),t.length>A&&n.jsx(L,{className:"hover:tw-bg-secondary",variant:"secondary",children:`+${t.length-R} ${S}`})]})]})}G.__docgenInfo={description:`A component for selecting multiple books from the Bible canon. It provides:

- Quick selection buttons for major sections (OT, NT, DC, Extra)
- A searchable dropdown with all available books
- Support for shift-click range selection
- Visual feedback with badges showing selected books`,methods:[],displayName:"BookSelector",props:{availableBookInfo:{required:!0,tsType:{name:"string"},description:`Information about available books, formatted as a 123 character long string as defined in a
projects BooksPresent setting`},selectedBookIds:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Array of currently selected book IDs"},onChangeSelectedBookIds:{required:!0,tsType:{name:"signature",type:"function",raw:"(books: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"books"}],return:{name:"void"}}},description:"Callback function that is executed when the book selection changes"},localizedStrings:{required:!0,tsType:{name:"LanguageStrings"},description:"Object containing the localized strings for the component"},localizedBookNames:{required:!1,tsType:{name:"Map",elements:[{name:"string"},{name:"signature",type:"object",raw:"{ localizedId: string; localizedName: string }",signature:{properties:[{key:"localizedId",value:{name:"string",required:!0}},{key:"localizedName",value:{name:"string",required:!0}}]}}],raw:"Map<string, { localizedId: string; localizedName: string }>"},description:`Optional map of localized book IDs/short names and full names. Key is the (English) book ID,
value contains localized versions of the ID and full book name`}}};const y=(e,t)=>e[t]??t;function pe({scope:e,availableScopes:t,onScopeChange:o,availableBookInfo:s,selectedBookIds:a,onSelectedBookIdsChange:u,localizedStrings:i,localizedBookNames:w}){const g=y(i,"%webView_scope_selector_selected_text%"),f=y(i,"%webView_scope_selector_current_verse%"),E=y(i,"%webView_scope_selector_current_chapter%"),S=y(i,"%webView_scope_selector_current_book%"),O=y(i,"%webView_scope_selector_choose_books%"),D=y(i,"%webView_scope_selector_scope%"),q=y(i,"%webView_scope_selector_select_books%"),N=[{value:"selectedText",label:g,id:"scope-selected-text"},{value:"verse",label:f,id:"scope-verse"},{value:"chapter",label:E,id:"scope-chapter"},{value:"book",label:S,id:"scope-book"},{value:"selectedBooks",label:O,id:"scope-selected"}],j=t?N.filter(T=>t.includes(T.value)):N;return n.jsxs("div",{className:"tw-grid tw-gap-4",children:[n.jsxs("div",{className:"tw-grid tw-gap-2",children:[n.jsx(B,{children:D}),n.jsx(le,{value:e,onValueChange:o,className:"tw-flex tw-flex-col tw-space-y-1",children:j.map(({value:T,label:k,id:_})=>n.jsxs("div",{className:"tw-flex tw-items-center",children:[n.jsx(ce,{className:"tw-me-2",value:T,id:_}),n.jsx(B,{htmlFor:_,children:k})]},_))})]}),e==="selectedBooks"&&n.jsxs("div",{className:"tw-grid tw-gap-2",children:[n.jsx(B,{children:q}),n.jsx(G,{availableBookInfo:s,selectedBookIds:a,onChangeSelectedBookIds:u,localizedStrings:i,localizedBookNames:w})]})]})}pe.__docgenInfo={description:`A component that allows users to select the scope of their search or operation. Available scopes
are defined in the Scope type. When 'selectedBooks' is chosen as the scope, a BookSelector
component is displayed to allow users to choose specific books.`,methods:[],displayName:"ScopeSelector",props:{scope:{required:!0,tsType:{name:"union",raw:"'selectedText' | 'verse' | 'chapter' | 'book' | 'selectedBooks'",elements:[{name:"literal",value:"'selectedText'"},{name:"literal",value:"'verse'"},{name:"literal",value:"'chapter'"},{name:"literal",value:"'book'"},{name:"literal",value:"'selectedBooks'"}]},description:"The current scope selection"},availableScopes:{required:!1,tsType:{name:"Array",elements:[{name:"union",raw:"'selectedText' | 'verse' | 'chapter' | 'book' | 'selectedBooks'",elements:[{name:"literal",value:"'selectedText'"},{name:"literal",value:"'verse'"},{name:"literal",value:"'chapter'"},{name:"literal",value:"'book'"},{name:"literal",value:"'selectedBooks'"}]}],raw:"Scope[]"},description:`Optional array of scopes that should be available in the selector. If not provided, all scopes
will be shown as defined in the Scope type`},onScopeChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(scope: Scope) => void",signature:{arguments:[{type:{name:"union",raw:"'selectedText' | 'verse' | 'chapter' | 'book' | 'selectedBooks'",elements:[{name:"literal",value:"'selectedText'"},{name:"literal",value:"'verse'"},{name:"literal",value:"'chapter'"},{name:"literal",value:"'book'"},{name:"literal",value:"'selectedBooks'"}]},name:"scope"}],return:{name:"void"}}},description:"Callback function that is executed when the user changes the scope selection"},availableBookInfo:{required:!0,tsType:{name:"string"},description:`Information about available books, formatted as a 123 character long string as defined in a
projects BooksPresent setting`},selectedBookIds:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"Array of currently selected book IDs"},onSelectedBookIdsChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(books: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"books"}],return:{name:"void"}}},description:"Callback function that is executed when the user changes the book selection"},localizedStrings:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  [localizedInventoryKey in (typeof SCOPE_SELECTOR_STRING_KEYS)[number]]?: LocalizedStringValue;
}`,signature:{properties:[{key:{name:"unknown[number]",raw:"(typeof SCOPE_SELECTOR_STRING_KEYS)[number]",required:!1},value:{name:"LocalizedStringValue"}}]}},description:`Object with all localized strings that the component needs to work well across multiple
languages. When using this component with Platform.Bible, you can import
\`SCOPE_SELECTOR_STRING_KEYS\` from this library, pass it in to the Platform's localization hook,
and pass the localized keys that are returned by the hook into this prop.`},localizedBookNames:{required:!1,tsType:{name:"Map",elements:[{name:"string"},{name:"signature",type:"object",raw:"{ localizedId: string; localizedName: string }",signature:{properties:[{key:"localizedId",value:{name:"string",required:!0}},{key:"localizedName",value:{name:"string",required:!0}}]}}],raw:"Map<string, { localizedId: string; localizedName: string }>"},description:`Optional map of localized book IDs/short names and full names. Key is the (English) book ID,
value contains localized versions of the ID and full book name`}}};export{pe as S};
