import{j as f}from"./jsx-runtime-IhsRMfz-.js";import{M as W,a as z,b as G,c as J,d as Q,g as U,h as V,i as X,e as Y}from"./menubar-DyOlnBVu.js";import{a as Z,T as ee,b as te,c as re}from"./tooltip-CeDSIjXJ.js";import{r as d}from"./iframe-BEkIYDFd.js";import{g as ne}from"./menu.util-Dxh7JGT4.js";import{M as B}from"./menu-icon.component-D5PBi3rh.js";function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},A.apply(null,arguments)}var q=["shift","alt","meta","mod","ctrl"],oe={esc:"escape",return:"enter",".":"period",",":"comma","-":"slash"," ":"space","`":"backquote","#":"backslash","+":"bracketright",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function w(e){return(e&&oe[e]||e||"").trim().toLowerCase().replace(/key|digit|numpad|arrow/,"")}function ae(e){return q.includes(e)}function j(e,t){return t===void 0&&(t=","),e.split(t)}function R(e,t,n){t===void 0&&(t="+");var a=e.toLocaleLowerCase().split(t).map(function(i){return w(i)}),l={alt:a.includes("alt"),ctrl:a.includes("ctrl")||a.includes("control"),shift:a.includes("shift"),meta:a.includes("meta"),mod:a.includes("mod")},u=a.filter(function(i){return!q.includes(i)});return A({},l,{keys:u,description:n,hotkey:e})}(function(){typeof document<"u"&&(document.addEventListener("keydown",function(e){e.key!==void 0&&_([w(e.key),w(e.code)])}),document.addEventListener("keyup",function(e){e.key!==void 0&&$([w(e.key),w(e.code)])})),typeof window<"u"&&window.addEventListener("blur",function(){E.clear()})})();var E=new Set;function H(e){return Array.isArray(e)}function ue(e,t){t===void 0&&(t=",");var n=H(e)?e:e.split(t);return n.every(function(a){return E.has(a.trim().toLowerCase())})}function _(e){var t=Array.isArray(e)?e:[e];E.has("meta")&&E.forEach(function(n){return!ae(n)&&E.delete(n.toLowerCase())}),t.forEach(function(n){return E.add(n.toLowerCase())})}function $(e){var t=Array.isArray(e)?e:[e];e==="meta"?E.clear():t.forEach(function(n){return E.delete(n.toLowerCase())})}function ie(e,t,n){(typeof n=="function"&&n(e,t)||n===!0)&&e.preventDefault()}function se(e,t,n){return typeof n=="function"?n(e,t):n===!0||n===void 0}function le(e){return D(e,["input","textarea","select"])}function D(e,t){t===void 0&&(t=!1);var n=e.target,a=e.composed,l=null;return ce(n)&&a?l=e.composedPath()[0]&&e.composedPath()[0].tagName:l=n&&n.tagName,H(t)?!!(l&&t&&t.some(function(u){var i;return u.toLowerCase()===((i=l)==null?void 0:i.toLowerCase())})):!!(l&&t&&t)}function ce(e){return!!e.tagName&&!e.tagName.startsWith("-")&&e.tagName.includes("-")}function de(e,t){return e.length===0&&t?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):t?e.some(function(n){return t.includes(n)})||e.includes("*"):!0}var fe=function(t,n,a){a===void 0&&(a=!1);var l=n.alt,u=n.meta,i=n.mod,v=n.shift,g=n.ctrl,o=n.keys,s=t.key,p=t.code,r=t.ctrlKey,y=t.metaKey,h=t.shiftKey,b=t.altKey,k=w(p),m=s.toLowerCase();if(!(o!=null&&o.includes(k))&&!(o!=null&&o.includes(m))&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(k))return!1;if(!a){if(l===!b&&m!=="alt"||v===!h&&m!=="shift")return!1;if(i){if(!y&&!r)return!1}else if(u===!y&&m!=="meta"&&m!=="os"||g===!r&&m!=="ctrl"&&m!=="control")return!1}return o&&o.length===1&&(o.includes(m)||o.includes(k))?!0:o?ue(o):!o},pe=d.createContext(void 0),me=function(){return d.useContext(pe)};function ye(e,t){return e===t}var ve=d.createContext({hotkeys:[],enabledScopes:[],toggleScope:function(){},enableScope:function(){},disableScope:function(){}}),he=function(){return d.useContext(ve)};function be(e){var t=d.useRef(void 0);return ye(t.current,e)||(t.current=e),t.current}var N=function(t){t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation()},ge=typeof window<"u"?d.useLayoutEffect:d.useEffect;function ke(e,t,n,a){var l=d.useState(null),u=l[0],i=l[1],v=d.useRef(!1),g=n instanceof Array?a instanceof Array?void 0:a:n,o=H(e)?e.join(void 0):e,s=d.useCallback(t,[]),p=d.useRef(s);p.current=t;var r=be(g),y=he(),h=y.enabledScopes,b=me();return ge(function(){if(!((r==null?void 0:r.enabled)===!1||!de(h,r==null?void 0:r.scopes))){var k=function(c,L){var T;if(L===void 0&&(L=!1),!(le(c)&&!D(c,r==null?void 0:r.enableOnFormTags))){if(u!==null){var P=u.getRootNode();if((P instanceof Document||P instanceof ShadowRoot)&&P.activeElement!==u&&!u.contains(P.activeElement)){N(c);return}}(T=c.target)!=null&&T.isContentEditable&&!(r!=null&&r.enableOnContentEditable)||j(o,r==null?void 0:r.splitKey).forEach(function(O){var I,M=R(O,r==null?void 0:r.combinationKey);if(fe(c,M,r==null?void 0:r.ignoreModifiers)||(I=M.keys)!=null&&I.includes("*")){if(r!=null&&r.ignoreEventWhen!=null&&r.ignoreEventWhen(c)||L&&v.current)return;if(ie(c,M,r==null?void 0:r.preventDefault),!se(c,M,r==null?void 0:r.enabled)){N(c);return}p.current(c,M),L||(v.current=!0)}})}},m=function(c){c.key!==void 0&&(_(w(c.code)),((r==null?void 0:r.keydown)===void 0&&(r==null?void 0:r.keyup)!==!0||r!=null&&r.keydown)&&k(c))},K=function(c){c.key!==void 0&&($(w(c.code)),v.current=!1,r!=null&&r.keyup&&k(c,!0))},S=u||void 0||document;return S.addEventListener("keyup",K),S.addEventListener("keydown",m),b&&j(o,r==null?void 0:r.splitKey).forEach(function(C){return b.addHotkey(R(C,r==null?void 0:r.combinationKey,r==null?void 0:r.description))}),function(){S.removeEventListener("keyup",K),S.removeEventListener("keydown",m),b&&j(o,r==null?void 0:r.splitKey).forEach(function(C){return b.removeHotkey(R(C,r==null?void 0:r.combinationKey,r==null?void 0:r.description))})}}},[u,o,r,h]),i}const x=(e,t)=>{setTimeout(()=>{t.forEach(n=>{var a;(a=e.current)==null||a.dispatchEvent(new KeyboardEvent("keydown",n))})},0)},F=(e,t,n,a)=>{if(!n)return;const l=Object.entries(e).filter(([u,i])=>"column"in i&&i.column===n||u===n).sort(([,u],[,i])=>u.order-i.order);return l.flatMap(([u],i)=>{const v=t.filter(o=>o.group===u).sort((o,s)=>o.order-s.order).map(o=>f.jsxs(ee,{children:[f.jsx(te,{asChild:!0,children:"command"in o?f.jsxs(Q,{onClick:()=>{a(o)},children:[o.iconPathBefore&&f.jsx(B,{icon:o.iconPathBefore,menuLabel:o.label,leading:!0}),o.label,o.iconPathAfter&&f.jsx(B,{icon:o.iconPathAfter,menuLabel:o.label})]},`menubar-item-${o.label}-${o.command}`):f.jsxs(U,{children:[f.jsx(V,{children:o.label}),f.jsx(X,{children:F(e,t,ne(e,o.id),a)})]},`menubar-sub-${o.label}-${o.id}`)}),o.tooltip&&f.jsx(re,{children:o.tooltip})]},`tooltip-${o.label}-${"command"in o?o.command:o.id}`)),g=[...v];return v.length>0&&i<l.length-1&&g.push(f.jsx(Y,{},`separator-${u}`)),g})};function we({menuData:e,onSelectMenuItem:t,onOpenChange:n,variant:a}){const l=d.useRef(void 0),u=d.useRef(void 0),i=d.useRef(void 0),v=d.useRef(void 0),g=d.useRef(void 0),o=s=>{switch(s){case"platform.app":return u;case"platform.window":return i;case"platform.layout":return v;case"platform.help":return g;default:return}};if(ke(["alt","alt+p","alt+l","alt+n","alt+h"],(s,p)=>{var h,b,k,m;s.preventDefault();const r={key:"Escape",code:"Escape",keyCode:27,bubbles:!0},y={key:" ",code:"Space",keyCode:32,bubbles:!0};switch(p.hotkey){case"alt":x(u,[r]);break;case"alt+p":(h=u.current)==null||h.focus(),x(u,[r,y]);break;case"alt+l":(b=i.current)==null||b.focus(),x(i,[r,y]);break;case"alt+n":(k=v.current)==null||k.focus(),x(v,[r,y]);break;case"alt+h":(m=g.current)==null||m.focus(),x(g,[r,y]);break}}),d.useEffect(()=>{if(!n||!l.current)return;const s=new MutationObserver(y=>{y.forEach(h=>{if(h.attributeName==="data-state"&&h.target instanceof HTMLElement){const b=h.target.getAttribute("data-state");n(b==="open")}})});return l.current.querySelectorAll("[data-state]").forEach(y=>{s.observe(y,{attributes:!0})}),()=>s.disconnect()},[n]),!!e)return f.jsx(W,{ref:l,className:"pr-twp tw-border-0 tw-bg-transparent",variant:a,children:Object.entries(e.columns).filter(([,s])=>typeof s=="object").sort(([,s],[,p])=>typeof s=="boolean"||typeof p=="boolean"?0:s.order-p.order).map(([s,p])=>f.jsxs(z,{children:[f.jsx(G,{ref:o(s),children:typeof p=="object"&&"label"in p&&p.label}),f.jsx(J,{className:"tw-z-[250]",children:f.jsx(Z,{children:F(e.groups,e.items,s,t)})})]},s))})}we.__docgenInfo={description:"Menubar component tailored to work with Platform.Bible menu data",methods:[],displayName:"PlatformMenubar",props:{menuData:{required:!0,tsType:{name:"Localized",elements:[{name:"MultiColumnMenu"}],raw:"Localized<MultiColumnMenu>"},description:"Menu data that is used to populate the Menubar component."},onSelectMenuItem:{required:!0,tsType:{name:"SelectMenuItemHandler"},description:"The handler to use for menu commands."},onOpenChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(isOpen: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isOpen"}],return:{name:"void"}}},description:`Optional callback function that is executed whenever a menu on the Menubar is opened or closed.
Helpful for handling updates to the menu, as changing menu data when the menu is opened is not
desirable.`},variant:{required:!1,tsType:{name:"union",raw:"'default' | 'muted'",elements:[{name:"literal",value:"'default'"},{name:"literal",value:"'muted'"}]},description:"Style variant for the app menubar component."}}};export{we as P};
