import{j as d}from"./jsx-runtime-CvGToidP.js";import{M as G,a as J,b as Q,c as U,d as V,g as X,h as Y,i as Z,e as ee}from"./menubar-DPj-s1IO.js";import{a as te,T as re,b as ne,c as oe}from"./tooltip-Cs5ADqQk.js";import{r as f}from"./iframe-FHgAwj54.js";import{g as ae}from"./menu.util-Dxh7JGT4.js";import{M as N}from"./menu-icon.component-CLDThtQX.js";function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},A.apply(null,arguments)}var q=["shift","alt","meta","mod","ctrl"],ue={esc:"escape",return:"enter",".":"period",",":"comma","-":"slash"," ":"space","`":"backquote","#":"backslash","+":"bracketright",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function w(e){return(e&&ue[e]||e||"").trim().toLowerCase().replace(/key|digit|numpad|arrow/,"")}function ie(e){return q.includes(e)}function P(e,t){return t===void 0&&(t=","),e.split(t)}function R(e,t,r){t===void 0&&(t="+");var a=e.toLocaleLowerCase().split(t).map(function(s){return w(s)}),l={alt:a.includes("alt"),ctrl:a.includes("ctrl")||a.includes("control"),shift:a.includes("shift"),meta:a.includes("meta"),mod:a.includes("mod")},u=a.filter(function(s){return!q.includes(s)});return A({},l,{keys:u,description:r,hotkey:e})}(function(){typeof document<"u"&&(document.addEventListener("keydown",function(e){e.key!==void 0&&$([w(e.key),w(e.code)])}),document.addEventListener("keyup",function(e){e.key!==void 0&&O([w(e.key),w(e.code)])})),typeof window<"u"&&window.addEventListener("blur",function(){E.clear()})})();var E=new Set;function K(e){return Array.isArray(e)}function se(e,t){t===void 0&&(t=",");var r=K(e)?e:e.split(t);return r.every(function(a){return E.has(a.trim().toLowerCase())})}function $(e){var t=Array.isArray(e)?e:[e];E.has("meta")&&E.forEach(function(r){return!ie(r)&&E.delete(r.toLowerCase())}),t.forEach(function(r){return E.add(r.toLowerCase())})}function O(e){var t=Array.isArray(e)?e:[e];e==="meta"?E.clear():t.forEach(function(r){return E.delete(r.toLowerCase())})}function le(e,t,r){(typeof r=="function"&&r(e,t)||r===!0)&&e.preventDefault()}function ce(e,t,r){return typeof r=="function"?r(e,t):r===!0||r===void 0}function fe(e){return D(e,["input","textarea","select"])}function D(e,t){t===void 0&&(t=!1);var r=e.target,a=e.composed,l=null;return de(r)&&a?l=e.composedPath()[0]&&e.composedPath()[0].tagName:l=r&&r.tagName,K(t)?!!(l&&t&&t.some(function(u){var s;return u.toLowerCase()===((s=l)==null?void 0:s.toLowerCase())})):!!(l&&t&&t)}function de(e){return!!e.tagName&&!e.tagName.startsWith("-")&&e.tagName.includes("-")}function pe(e,t){return e.length===0&&t?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):t?e.some(function(r){return t.includes(r)})||e.includes("*"):!0}var me=function(t,r,a){a===void 0&&(a=!1);var l=r.alt,u=r.meta,s=r.mod,v=r.shift,p=r.ctrl,o=r.keys,i=t.key,m=t.code,h=t.ctrlKey,n=t.metaKey,g=t.shiftKey,k=t.altKey,b=w(m),y=i.toLowerCase();if(!(o!=null&&o.includes(b))&&!(o!=null&&o.includes(y))&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(b))return!1;if(!a){if(l===!k&&y!=="alt"||v===!g&&y!=="shift")return!1;if(s){if(!n&&!h)return!1}else if(u===!n&&y!=="meta"&&y!=="os"||p===!h&&y!=="ctrl"&&y!=="control")return!1}return o&&o.length===1&&(o.includes(y)||o.includes(b))?!0:o?se(o):!o},ye=f.createContext(void 0),he=function(){return f.useContext(ye)};function F(e,t){return e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce(function(r,a){return r&&F(e[a],t[a])},!0):e===t}var ve=f.createContext({hotkeys:[],enabledScopes:[],toggleScope:function(){},enableScope:function(){},disableScope:function(){}}),be=function(){return f.useContext(ve)};function ge(e){var t=f.useRef(void 0);return F(t.current,e)||(t.current=e),t.current}var _=function(t){t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation()},ke=typeof window<"u"?f.useLayoutEffect:f.useEffect;function we(e,t,r,a){var l=f.useState(null),u=l[0],s=l[1],v=f.useRef(!1),p=r instanceof Array?a instanceof Array?void 0:a:r,o=K(e)?e.join(p==null?void 0:p.splitKey):e,i=r instanceof Array?r:a instanceof Array?a:void 0,m=f.useCallback(t,i??[]),h=f.useRef(m);i?h.current=m:h.current=t;var n=ge(p),g=be(),k=g.enabledScopes,b=he();return ke(function(){if(!((n==null?void 0:n.enabled)===!1||!pe(k,n==null?void 0:n.scopes))){var y=function(c,S){var I;if(S===void 0&&(S=!1),!(fe(c)&&!D(c,n==null?void 0:n.enableOnFormTags))){if(u!==null){var L=u.getRootNode();if((L instanceof Document||L instanceof ShadowRoot)&&L.activeElement!==u&&!u.contains(L.activeElement)){_(c);return}}(I=c.target)!=null&&I.isContentEditable&&!(n!=null&&n.enableOnContentEditable)||P(o,n==null?void 0:n.splitKey).forEach(function(z){var B,M=R(z,n==null?void 0:n.combinationKey);if(me(c,M,n==null?void 0:n.ignoreModifiers)||(B=M.keys)!=null&&B.includes("*")){if(n!=null&&n.ignoreEventWhen!=null&&n.ignoreEventWhen(c)||S&&v.current)return;if(le(c,M,n==null?void 0:n.preventDefault),!ce(c,M,n==null?void 0:n.enabled)){_(c);return}h.current(c,M),S||(v.current=!0)}})}},H=function(c){c.key!==void 0&&($(w(c.code)),((n==null?void 0:n.keydown)===void 0&&(n==null?void 0:n.keyup)!==!0||n!=null&&n.keydown)&&y(c))},T=function(c){c.key!==void 0&&(O(w(c.code)),v.current=!1,n!=null&&n.keyup&&y(c,!0))},x=u||(p==null?void 0:p.document)||document;return x.addEventListener("keyup",T),x.addEventListener("keydown",H),b&&P(o,n==null?void 0:n.splitKey).forEach(function(C){return b.addHotkey(R(C,n==null?void 0:n.combinationKey,n==null?void 0:n.description))}),function(){x.removeEventListener("keyup",T),x.removeEventListener("keydown",H),b&&P(o,n==null?void 0:n.splitKey).forEach(function(C){return b.removeHotkey(R(C,n==null?void 0:n.combinationKey,n==null?void 0:n.description))})}}},[u,o,n,k]),s}const j=(e,t)=>{setTimeout(()=>{t.forEach(r=>{var a;(a=e.current)==null||a.dispatchEvent(new KeyboardEvent("keydown",r))})},0)},W=(e,t,r,a)=>{if(!r)return;const l=Object.entries(e).filter(([u,s])=>"column"in s&&s.column===r||u===r).sort(([,u],[,s])=>u.order-s.order);return l.flatMap(([u],s)=>{const v=t.filter(o=>o.group===u).sort((o,i)=>o.order-i.order).map(o=>d.jsxs(re,{children:[d.jsx(ne,{asChild:!0,children:"command"in o?d.jsxs(V,{onClick:()=>{a(o)},children:[o.iconPathBefore&&d.jsx(N,{icon:o.iconPathBefore,menuLabel:o.label,leading:!0}),o.label,o.iconPathAfter&&d.jsx(N,{icon:o.iconPathAfter,menuLabel:o.label})]},`menubar-item-${o.label}-${o.command}`):d.jsxs(X,{children:[d.jsx(Y,{children:o.label}),d.jsx(Z,{children:W(e,t,ae(e,o.id),a)})]},`menubar-sub-${o.label}-${o.id}`)}),o.tooltip&&d.jsx(oe,{children:o.tooltip})]},`tooltip-${o.label}-${"command"in o?o.command:o.id}`)),p=[...v];return v.length>0&&s<l.length-1&&p.push(d.jsx(ee,{},`separator-${u}`)),p})};function Ee({menuData:e,onSelectMenuItem:t,onOpenChange:r,variant:a}){const l=f.useRef(void 0),u=f.useRef(void 0),s=f.useRef(void 0),v=f.useRef(void 0),p=f.useRef(void 0),o=i=>{switch(i){case"platform.app":return u;case"platform.window":return s;case"platform.layout":return v;case"platform.help":return p;default:return}};if(we(["alt","alt+p","alt+l","alt+n","alt+h"],(i,m)=>{var g,k,b,y;i.preventDefault();const h={key:"Escape",code:"Escape",keyCode:27,bubbles:!0},n={key:" ",code:"Space",keyCode:32,bubbles:!0};switch(m.hotkey){case"alt":j(u,[h]);break;case"alt+p":(g=u.current)==null||g.focus(),j(u,[h,n]);break;case"alt+l":(k=s.current)==null||k.focus(),j(s,[h,n]);break;case"alt+n":(b=v.current)==null||b.focus(),j(v,[h,n]);break;case"alt+h":(y=p.current)==null||y.focus(),j(p,[h,n]);break}}),f.useEffect(()=>{if(!r||!l.current)return;const i=new MutationObserver(n=>{n.forEach(g=>{if(g.attributeName==="data-state"&&g.target instanceof HTMLElement){const k=g.target.getAttribute("data-state");r(k==="open")}})});return l.current.querySelectorAll("[data-state]").forEach(n=>{i.observe(n,{attributes:!0})}),()=>i.disconnect()},[r]),!!e)return d.jsx(G,{ref:l,className:"pr-twp tw-border-0 tw-bg-transparent",variant:a,children:Object.entries(e.columns).filter(([,i])=>typeof i=="object").sort(([,i],[,m])=>typeof i=="boolean"||typeof m=="boolean"?0:i.order-m.order).map(([i,m])=>d.jsxs(J,{children:[d.jsx(Q,{ref:o(i),children:typeof m=="object"&&"label"in m&&m.label}),d.jsx(U,{className:"tw-z-[250]",children:d.jsx(te,{children:W(e.groups,e.items,i,t)})})]},i))})}Ee.__docgenInfo={description:"Menubar component tailored to work with Platform.Bible menu data",methods:[],displayName:"PlatformMenubar",props:{menuData:{required:!0,tsType:{name:"Localized",elements:[{name:"MultiColumnMenu"}],raw:"Localized<MultiColumnMenu>"},description:"Menu data that is used to populate the Menubar component."},onSelectMenuItem:{required:!0,tsType:{name:"SelectMenuItemHandler"},description:"The handler to use for menu commands."},onOpenChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(isOpen: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isOpen"}],return:{name:"void"}}},description:`Optional callback function that is executed whenever a menu on the Menubar is opened or closed.
Helpful for handling updates to the menu, as changing menu data when the menu is opened is not
desirable.`},variant:{required:!1,tsType:{name:"union",raw:"'default' | 'muted'",elements:[{name:"literal",value:"'default'"},{name:"literal",value:"'muted'"}]},description:"Style variant for the app menubar component."}}};export{Ee as P};
