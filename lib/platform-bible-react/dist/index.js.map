{"version":3,"file":"index.js","sources":["../src/utils/shadcn-ui.util.ts","../src/utils/dir-helper.util.ts","../src/components/shadcn-ui/dialog.tsx","../src/components/shadcn-ui/command.tsx","../src/components/shared/book.utils.ts","../src/components/shared/book-item.component.tsx","../src/components/shadcn-ui/button.tsx","../src/components/shadcn-ui/popover.tsx","../src/components/shared/book-item.utils.ts","../src/components/advanced/recent-searches.component.tsx","../src/components/advanced/book-chapter-control/book-chapter-control.utils.ts","../src/components/advanced/book-chapter-control/book-chapter-control.navigation.ts","../src/components/advanced/book-chapter-control/chapter-grid.component.tsx","../src/components/advanced/book-chapter-control/book-chapter-control.component.tsx","../src/components/advanced/book-chapter-control/book-chapter-control.types.ts","../src/components/shadcn-ui/label.tsx","../src/components/shadcn-ui/radio-group.tsx","../src/components/basics/combo-box.component.tsx","../src/components/basics/chapter-range-selector.component.tsx","../src/components/advanced/book-selector.component.tsx","../../../node_modules/@lexical/react/LexicalComposerContext.prod.mjs","../../../node_modules/@lexical/react/LexicalComposer.prod.mjs","../../../node_modules/@lexical/react/LexicalOnChangePlugin.prod.mjs","../src/components/advanced/editor/themes/editor-theme.ts","../src/components/shadcn-ui/tooltip.tsx","../src/components/advanced/editor/nodes.ts","../../../node_modules/react-error-boundary/dist/react-error-boundary.js","../../../node_modules/@lexical/react/LexicalErrorBoundary.prod.mjs","../../../node_modules/@lexical/react/useLexicalEditable.prod.mjs","../../../node_modules/@lexical/selection/LexicalSelection.prod.mjs","../../../node_modules/@lexical/utils/LexicalUtils.prod.mjs","../../../node_modules/@lexical/extension/LexicalExtension.prod.mjs","../../../node_modules/@lexical/react/LexicalReactProviderExtension.prod.mjs","../../../node_modules/@lexical/text/LexicalText.prod.mjs","../../../node_modules/@lexical/dragon/LexicalDragon.prod.mjs","../../../node_modules/@lexical/react/LexicalRichTextPlugin.prod.mjs","../../../node_modules/@lexical/react/LexicalAutoFocusPlugin.prod.mjs","../../../node_modules/@lexical/react/LexicalClearEditorPlugin.prod.mjs","../../../node_modules/@lexical/react/LexicalContentEditable.prod.mjs","../src/components/advanced/editor/editor-ui/content-editable.tsx","../src/components/advanced/editor/context/toolbar-context.tsx","../src/components/advanced/editor/editor-hooks/use-modal.tsx","../src/components/advanced/editor/plugins/toolbar/toolbar-plugin.tsx","../src/components/advanced/editor/editor-hooks/use-update-toolbar.ts","../src/components/shadcn-ui/toggle.tsx","../src/components/shadcn-ui/toggle-group.tsx","../src/components/advanced/editor/plugins/toolbar/font-format-toolbar-plugin.tsx","../src/components/advanced/editor/plugins.tsx","../src/components/advanced/editor/editor.tsx","../../../node_modules/@lexical/html/LexicalHtml.prod.mjs","../src/components/advanced/editor/editor-utils.ts","../src/components/advanced/comment-editor/comment-editor.component.tsx","../src/components/advanced/comment-editor/comment-editor.types.ts","../src/components/advanced/comment-list/comment-list.types.ts","../src/hooks/listbox-keyboard-navigation.hook.ts","../src/components/shadcn-ui/badge.tsx","../src/components/shadcn-ui/card.tsx","../src/components/shadcn-ui/separator.tsx","../src/components/shadcn-ui/avatar.tsx","../src/context/menu.context.ts","../src/components/shadcn-ui/dropdown-menu.tsx","../src/components/advanced/comment-list/comment-list.utils.ts","../src/components/advanced/comment-list/comment-item.component.tsx","../src/components/advanced/comment-list/comment-thread.component.tsx","../src/components/advanced/comment-list/comment-list.component.tsx","../src/components/advanced/data-table/data-table-column-toggle.component.tsx","../src/components/shadcn-ui/select.tsx","../src/components/advanced/data-table/data-table-pagination.component.tsx","../src/utils/focus.util.ts","../src/components/shadcn-ui/table.tsx","../src/components/shadcn-ui/skeleton.tsx","../src/components/advanced/data-table/data-table.component.tsx","../src/components/advanced/extension-marketplace/markdown-renderer.component.tsx","../src/components/basics/error-dump.component.tsx","../src/components/advanced/error-popover.component.tsx","../src/components/advanced/extension-marketplace/filter-dropdown.component.tsx","../src/components/advanced/extension-marketplace/more-info.component.tsx","../src/components/advanced/extension-marketplace/version-history.component.tsx","../src/components/advanced/extension-marketplace/footer.component.tsx","../src/components/advanced/multi-select-combo-box.component.tsx","../src/components/advanced/filter.component.tsx","../src/components/shadcn-ui/input.tsx","../src/components/advanced/footnote-editor/footnote-caller-dropdown.component.tsx","../src/components/advanced/footnote-editor/footnote-type-dropdown.component.tsx","../src/components/advanced/footnote-editor/footnote-editor.component.tsx","../src/components/advanced/footnote-editor/footnote-editor.types.ts","../src/components/advanced/footnotes/footnote-item.component.tsx","../src/components/advanced/footnotes/footnote-list.component.tsx","../src/components/advanced/inventory/occurrences-table.component.tsx","../src/components/shadcn-ui/checkbox.tsx","../src/components/advanced/inventory/inventory-columns.tsx","../src/components/advanced/inventory/inventory-utils.ts","../src/components/advanced/inventory/inventory.component.tsx","../src/components/advanced/marker-menu.component.tsx","../src/components/shadcn-ui/sidebar.tsx","../src/components/advanced/settings-components/settings-sidebar.component.tsx","../src/components/basics/search-bar.component.tsx","../src/components/advanced/settings-components/settings-sidebar-content-search.component.tsx","../src/components/advanced/scripture-results-viewer/scripture-results-viewer.component.tsx","../src/components/advanced/scope-selector/scope-selector.utils.ts","../src/components/advanced/scope-selector/section-button.component.tsx","../src/components/advanced/scope-selector/book-selector.component.tsx","../src/components/advanced/scope-selector/scope-selector.component.tsx","../src/components/advanced/scroll-group-selector.component.tsx","../src/components/advanced/settings-components/settings-list.component.tsx","../src/components/advanced/menus/menu.util.ts","../src/components/advanced/menus/menu-icon.component.tsx","../src/components/advanced/menus/tab-dropdown-menu.component.tsx","../src/components/advanced/tab-toolbar/tab-toolbar-container.component.tsx","../src/components/advanced/tab-toolbar/tab-toolbar.component.tsx","../src/components/advanced/tab-toolbar/tab-floating-menu.component.tsx","../src/components/basics/tabs-vertical.tsx","../src/components/advanced/tab-navigation-content-search.component.tsx","../src/components/shadcn-ui/menubar.tsx","../src/components/advanced/menus/platform-menubar.component.tsx","../src/components/advanced/toolbar.component.tsx","../src/components/advanced/ui-language-selector.component.tsx","../src/components/basics/smart-label.component.tsx","../src/components/basics/checklist.component.tsx","../src/components/basics/results-card.component.tsx","../src/components/basics/spinner.component.tsx","../src/components/basics/text-field.component.tsx","../src/components/shadcn-ui/alert.tsx","../src/components/shadcn-ui/context-menu.tsx","../src/components/shadcn-ui/drawer.tsx","../src/components/shadcn-ui/progress.tsx","../src/components/shadcn-ui/resizable.tsx","../src/components/shadcn-ui/sonner.tsx","../src/components/shadcn-ui/slider.tsx","../src/components/shadcn-ui/switch.tsx","../src/components/shadcn-ui/tabs.tsx","../src/components/shadcn-ui/textarea.tsx","../src/hooks/use-event.hook.ts","../src/hooks/use-promise.hook.ts","../src/hooks/use-event-async.hook.ts","../src/hooks/use-stylesheet.hook.ts"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx';\nimport { extendTailwindMerge } from 'tailwind-merge';\n\nconst twMergeCustom = extendTailwindMerge({ prefix: 'tw-' });\n\n/**\n * Tailwind and CSS class application helper function. Uses\n * [`clsx`](https://www.npmjs.com/package/clsx) to make it easy to apply classes conditionally using\n * object syntax, and uses [`tailwind-merge`](https://www.npmjs.com/package/tailwind-merge) to make\n * it easy to merge/overwrite Tailwind classes in a programmer-logic-friendly way.\n *\n * Note: `tailwind-merge` is configured to use the prefix `tw-`, so you must use the same prefix\n * with any Tailwind classes you use with this function to successfully overwrite other Tailwind\n * classes. `platform-bible-react` is configured to use `tw-` as its Tailwind prefix, so any\n * Tailwind classes you pass into `platform-bible-react` components will be compared using the `tw-`\n * prefix.\n *\n * This function was popularized by\n * [shadcn/ui](https://ui.shadcn.com/docs/installation/manual#add-a-cn-helper). See [ByteGrad's\n * explanation video](https://www.youtube.com/watch?v=re2JFITR7TI) for more information.\n *\n * @example\n *\n * ```typescript\n * const borderShouldBeBlue = true;\n * const textShouldBeRed = true;\n * const heightShouldBe20 = false;\n * const classString = cn(\n *   'tw-bg-primary tw-h-10 tw-text-primary-foreground',\n *   'tw-bg-secondary',\n *   {\n *     'tw-border-blue-500': borderShouldBeBlue,\n *     'tw-text-red-500': textShouldBeRed,\n *     'tw-h-20': heightShouldBe20,\n *   },\n *   'some-class',\n * );\n * ```\n *\n * The resulting `classString` is `'tw-h-10 tw-bg-secondary tw-border-blue-500 tw-text-red-500\n * some-class'`\n *\n * - Notice that `'tw-bg-secondary'`, specified later, overwrote `'tw-bg-primary'`, specified earlier,\n *   because they are Tailwind classes that affect the same css property\n * - Notice that `'tw-text-red-500'`, specified later, overwrote `'tw-text-primary-foreground'`,\n *   specified earlier, because they are Tailwind classes that affect the same css property\n * - Notice that `'tw-h-20'`, specified later, did not overwrite `'tw-h-10'`, specified earlier,\n *   because `'tw-h-20'` is part of a conditional class object and its value evaluated to `false`;\n *   therefore it was not applied\n * - Notice that `'some-class'` was applied. This function is not limited only to Tailwind classes.\n *\n *\n * @param inputs Class strings or `clsx` conditional class objects to merge. Tailwind classes\n *   specified later in the arguments overwrite similar Tailwind classes specified earlier in the\n *   arguments\n * @returns Class string containing all applicable classes from the arguments based on the rules\n *   described above\n */\nexport function cn(...inputs: ClassValue[]) {\n  return twMergeCustom(clsx(inputs));\n}\n","/** Text and layout direction */\nexport type Direction = 'rtl' | 'ltr';\n\nconst STORAGE_KEY: string = 'layoutDirection';\n\n/** Read layout direction from localStorage or return 'ltr' */\nexport function readDirection(): Direction {\n  const retrieved = localStorage.getItem(STORAGE_KEY);\n  if (retrieved === 'rtl') {\n    return retrieved;\n  }\n  return 'ltr';\n}\n\n/** Write layout direction to localStorage */\nexport function persistDirection(dir: Direction): void {\n  localStorage.setItem(STORAGE_KEY, dir);\n}\n","import React from 'react';\nimport * as DialogPrimitive from '@radix-ui/react-dialog';\nimport { X } from 'lucide-react';\n\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { readDirection } from '@/utils/dir-helper.util';\n\nconst Dialog = DialogPrimitive.Root;\n\nconst DialogTrigger = DialogPrimitive.Trigger;\n\nconst DialogPortal = DialogPrimitive.Portal;\n\nconst DialogClose = DialogPrimitive.Close;\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      'tw-fixed tw-inset-0 tw-z-50 tw-bg-black/80 data-[state=open]:tw-animate-in data-[state=closed]:tw-animate-out data-[state=closed]:tw-fade-out-0 data-[state=open]:tw-fade-in-0',\n      className,\n    )}\n    {...props}\n  />\n));\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName;\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => {\n  const dir = readDirection();\n  return (\n    <DialogPortal>\n      <DialogOverlay />\n      <DialogPrimitive.Content\n        ref={ref}\n        className={cn(\n          'pr-twp tw-fixed tw-left-[50%] tw-top-[50%] tw-z-50 tw-grid tw-w-full tw-max-w-lg tw-translate-x-[-50%] tw-translate-y-[-50%] tw-gap-4 tw-border tw-bg-background tw-p-6 tw-shadow-lg tw-duration-200 data-[state=open]:tw-animate-in data-[state=closed]:tw-animate-out data-[state=closed]:tw-fade-out-0 data-[state=open]:tw-fade-in-0 data-[state=closed]:tw-zoom-out-95 data-[state=open]:tw-zoom-in-95 data-[state=closed]:tw-slide-out-to-left-1/2 data-[state=closed]:tw-slide-out-to-top-[48%] data-[state=open]:tw-slide-in-from-left-1/2 data-[state=open]:tw-slide-in-from-top-[48%] sm:tw-rounded-lg',\n          className,\n        )}\n        {...props}\n        dir={dir}\n      >\n        {children}\n        <DialogPrimitive.Close\n          className={cn(\n            'tw-absolute tw-top-4 tw-rounded-sm tw-opacity-70 tw-ring-offset-background tw-transition-opacity hover:tw-opacity-100 focus:tw-outline-none focus:tw-ring-2 focus:tw-ring-ring focus:tw-ring-offset-2 disabled:tw-pointer-events-none data-[state=open]:tw-bg-accent data-[state=open]:tw-text-muted-foreground',\n            { 'tw-right-4': dir === 'ltr' },\n            { 'tw-left-4': dir === 'rtl' },\n          )}\n        >\n          <X className=\"tw-h-4 tw-w-4\" />\n          <span className=\"tw-sr-only\">Close</span>\n        </DialogPrimitive.Close>\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  );\n});\nDialogContent.displayName = DialogPrimitive.Content.displayName;\nfunction DialogHeader({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\n        'tw-flex tw-flex-col tw-space-y-1.5 tw-text-center sm:tw-text-start',\n        className,\n      )}\n      {...props}\n    />\n  );\n}\nDialogHeader.displayName = 'DialogHeader';\n\nfunction DialogFooter({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\n        'tw-flex tw-flex-col-reverse sm:tw-flex-row sm:tw-justify-end sm:tw-space-x-2',\n        className,\n      )}\n      {...props}\n    />\n  );\n}\nDialogFooter.displayName = 'DialogFooter';\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn('tw-text-lg tw-font-semibold tw-leading-none tw-tracking-tight', className)}\n    {...props}\n  />\n));\nDialogTitle.displayName = DialogPrimitive.Title.displayName;\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn('tw-text-sm tw-text-muted-foreground', className)}\n    {...props}\n  />\n));\nDialogDescription.displayName = DialogPrimitive.Description.displayName;\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n};\n","import React from 'react';\nimport { type DialogProps } from '@radix-ui/react-dialog';\nimport { Command as CommandPrimitive } from 'cmdk';\nimport { Search } from 'lucide-react';\n\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Dialog, DialogContent } from '@/components/shadcn-ui/dialog';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\n\n/**\n * Command menu for React. These components are built on cmdk and styled with Shadcn UI. See Shadcn\n * UI documentation: https://ui.shadcn.com/docs/components/command See cmdk documentation:\n * https://cmdk.paco.me/\n */\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      'tw-flex tw-h-full tw-w-full tw-flex-col tw-overflow-hidden tw-rounded-md tw-bg-popover tw-text-popover-foreground',\n      className,\n    )}\n    {...props}\n  />\n));\nCommand.displayName = CommandPrimitive.displayName;\n\ninterface CommandDialogProps extends DialogProps {}\n\n/** @inheritdoc Command */\nfunction CommandDialog({ children, ...props }: CommandDialogProps) {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"tw-overflow-hidden tw-p-0 tw-shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:tw-px-2 [&_[cmdk-group-heading]]:tw-font-medium [&_[cmdk-group-heading]]:tw-text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:tw-pt-0 [&_[cmdk-group]]:tw-px-2 [&_[cmdk-input-wrapper]_svg]:tw-h-5 [&_[cmdk-input-wrapper]_svg]:tw-w-5 [&_[cmdk-input]]:tw-h-12 [&_[cmdk-item]]:tw-px-2 [&_[cmdk-item]]:tw-py-3 [&_[cmdk-item]_svg]:tw-h-5 [&_[cmdk-item]_svg]:tw-w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\n/** @inheritdoc Command */\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <div className=\"tw-flex tw-items-center tw-border-b tw-px-3\" dir={dir}>\n      <Search className=\"tw-me-2 tw-h-4 tw-w-4 tw-shrink-0 tw-opacity-50\" />\n      <CommandPrimitive.Input\n        ref={ref}\n        className={cn(\n          'tw-flex tw-h-11 tw-w-full tw-rounded-md tw-bg-transparent tw-py-3 tw-text-sm tw-outline-none placeholder:tw-text-muted-foreground disabled:tw-cursor-not-allowed disabled:tw-opacity-50',\n          className,\n        )}\n        {...props}\n      />\n    </div>\n  );\n});\n\nCommandInput.displayName = CommandPrimitive.Input.displayName;\n\n/** @inheritdoc Command */\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn('tw-max-h-[300px] tw-overflow-y-auto tw-overflow-x-hidden', className)}\n    {...props}\n  />\n));\n\nCommandList.displayName = CommandPrimitive.List.displayName;\n\n/** @inheritdoc Command */\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty ref={ref} className=\"tw-py-6 tw-text-center tw-text-sm\" {...props} />\n));\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName;\n\n/** @inheritdoc Command */\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      'tw-overflow-hidden tw-p-1 tw-text-foreground [&_[cmdk-group-heading]]:tw-px-2 [&_[cmdk-group-heading]]:tw-py-1.5 [&_[cmdk-group-heading]]:tw-text-xs [&_[cmdk-group-heading]]:tw-font-medium [&_[cmdk-group-heading]]:tw-text-muted-foreground',\n      className,\n    )}\n    {...props}\n  />\n));\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName;\n\n/** @inheritdoc Command */\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn('tw--mx-1 tw-h-px tw-bg-border', className)}\n    {...props}\n  />\n));\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName;\n\n/** @inheritdoc Command */\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      'tw-relative tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-px-2 tw-py-1.5 tw-text-sm tw-outline-none data-[disabled=true]:tw-pointer-events-none data-[selected=true]:tw-bg-accent data-[selected=true]:tw-text-accent-foreground data-[disabled=true]:tw-opacity-50',\n      className,\n    )}\n    {...props}\n  />\n));\n\nCommandItem.displayName = CommandPrimitive.Item.displayName;\n\n/** @inheritdoc Command */\nfunction CommandShortcut({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) {\n  return (\n    <span\n      className={cn('tw-ms-auto tw-text-xs tw-tracking-widest tw-text-muted-foreground', className)}\n      {...props}\n    />\n  );\n}\nCommandShortcut.displayName = 'CommandShortcut';\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n};\n","import { Canon } from '@sillsdev/scripture';\nimport { includes, Section } from 'platform-bible-utils';\n\n/**\n * Gets the long name of a Bible section from its enum value\n *\n * @param section - The section enum value to get the name for\n * @param otLongName - Optional localized name for Old Testament section\n * @param ntLongName - Optional localized name for New Testament section\n * @param dcLongName - Optional localized name for Deuterocanonical section\n * @param extraLongName - Optional localized name for Extra Materials section\n * @returns {string} The human-readable localized name of the section. Defaults to English names\n * @throws {Error} When the section enum value is not recognized\n */\nexport const getSectionLongName = (\n  section: Section,\n  otLongName?: string,\n  ntLongName?: string,\n  dcLongName?: string,\n  extraLongName?: string,\n): string => {\n  switch (section) {\n    case Section.OT:\n      return otLongName ?? 'Old Testament';\n    case Section.NT:\n      return ntLongName ?? 'New Testament';\n    case Section.DC:\n      return dcLongName ?? 'Deuterocanon';\n    case Section.Extra:\n      return extraLongName ?? 'Extra Materials';\n    default:\n      throw new Error(`Unknown section: ${section}`);\n  }\n};\n\n/**\n * Gets the short name of a Bible section from its enum value\n *\n * @param section - The section enum value to get the short name for\n * @param otShortName - Optional localized short name for Old Testament section\n * @param ntShortName - Optional localized short name for New Testament section\n * @param dcShortName - Optional localized short name for Deuterocanonical section\n * @param extraShortName - Optional localized short name for Extra Materials section\n * @returns {string} The short name of the section. Defaults to English\n * @throws {Error} When the section enum value is not recognized\n */\nexport const getSectionShortName = (\n  section: Section,\n  otShortName?: string,\n  ntShortName?: string,\n  dcShortName?: string,\n  extraShortName?: string,\n): string => {\n  switch (section) {\n    case Section.OT:\n      return otShortName ?? 'OT';\n    case Section.NT:\n      return ntShortName ?? 'NT';\n    case Section.DC:\n      return dcShortName ?? 'DC';\n    case Section.Extra:\n      return extraShortName ?? 'Extra';\n    default:\n      throw new Error(`Unknown section: ${section}`);\n  }\n};\n\n/**\n * Gets the localized name for a book from the localized book names map, with fallback to English\n * name\n *\n * @param bookId - The book ID to get the localized name for\n * @param localizedBookNames - Optional map of localized book names\n * @returns The localized name, English name, or fallback value\n */\nexport function getLocalizedBookName(\n  bookId: string,\n  localizedBookNames?: Map<string, { localizedId: string; localizedName: string }>,\n): string {\n  const localizedName = localizedBookNames?.get(bookId)?.localizedName;\n  return localizedName ?? Canon.bookIdToEnglishName(bookId);\n}\n\n/**\n * Gets the localized ID for a book from the localized book names map, with fallback to uppercase\n * book ID\n *\n * @param bookId - The book ID to get the localized ID for\n * @param localizedBookNames - Optional map of localized book names\n * @returns The localized ID, uppercase book ID, or fallback value\n */\nexport function getLocalizedBookId(\n  bookId: string,\n  localizedBookNames?: Map<string, { localizedId: string; localizedName: string }>,\n): string {\n  const localizedId = localizedBookNames?.get(bookId)?.localizedId;\n  return localizedId ?? bookId.toUpperCase();\n}\n\n/** Book IDs for all books that are not considered obsolete in the SIL Canon library */\nexport const ALL_BOOK_IDS = Canon.allBookIds.filter(\n  (bookId) => !Canon.isObsolete(Canon.bookIdToNumber(bookId)),\n);\n\n/** English names for all books that are not considered obsolete in the SIL Canon library */\nexport const ALL_ENGLISH_BOOK_NAMES = Object.fromEntries(\n  ALL_BOOK_IDS.map((bookId) => [bookId, Canon.bookIdToEnglishName(bookId)]),\n);\n\n/**\n * Checks if a book matches a search query by comparing against English and localized book names/IDs\n *\n * @example\n *\n * ```typescript\n * // Optional localized names/IDs map\n * const localized = new Map<string, { localizedId: string; localizedName: string }>([\n *   ['GEN', { localizedId: 'GEN', localizedName: 'Gênesis' }],\n *   ['PSA', { localizedId: 'SAL', localizedName: 'Salmos' }],\n * ]);\n *\n * // Matches by English name (partial, case-insensitive)\n * doesBookMatchQuery('GEN', 'genes'); // true\n *\n * // Matches by 3-letter book ID (case-insensitive)\n * doesBookMatchQuery('PSA', 'PSA'); // true\n *\n * // Matches by localized name when provided\n * doesBookMatchQuery('GEN', 'gên', localized); // true (The localized book name \"Gênesis\" includes \"gên\")\n *\n * // Matches by localized ID when provided\n * doesBookMatchQuery('PSA', 'sal', localized); // true (The localized book ID is \"SAL\")\n *\n * // Leading/trailing whitespace is ignored\n * doesBookMatchQuery('PSA', '  psal  '); // true\n *\n * // Empty or whitespace-only queries don't match\n * doesBookMatchQuery('PSA', '   '); // false\n *\n * // No match example\n * doesBookMatchQuery('PSA', 'john'); // false\n * ```\n *\n * @param bookId - The book ID to check\n * @param query - The string search query\n * @param localizedBookNames - Optional map of localized book IDs/short names and full names. The\n *   key is the standard book ID (e.g., \"2CH\"), the value contains a localized version of the ID and\n *   related book name (e.g. { localizedId: '2CR', localizedName: '2 Crónicas' })\n * @returns True if the query (partially) matches one of the book's names or IDs, in either English\n *   or localized form\n */\nexport function doesBookMatchQuery(\n  bookId: string,\n  query: string,\n  localizedBookNames?: Map<string, { localizedId: string; localizedName: string }>,\n): boolean {\n  const normalizedQuery = query.trim().toLowerCase();\n  if (!normalizedQuery) return false;\n\n  const englishName = Canon.bookIdToEnglishName(bookId);\n  const localizedBook = localizedBookNames?.get(bookId);\n\n  // Check English name and ID\n  const matchesEnglishNameOrId =\n    includes(englishName.toLowerCase(), normalizedQuery) ||\n    includes(bookId.toLowerCase(), normalizedQuery);\n\n  if (matchesEnglishNameOrId) return true;\n\n  // Check localized name and ID if available\n\n  const matchesLocalizedNameOrId = localizedBook\n    ? includes(localizedBook.localizedName.toLowerCase(), normalizedQuery) ||\n      includes(localizedBook.localizedId.toLowerCase(), normalizedQuery)\n    : false;\n\n  if (matchesLocalizedNameOrId) return true;\n\n  return false;\n}\n","import { CommandItem } from '@/components/shadcn-ui/command';\nimport { getLocalizedBookId, getLocalizedBookName } from '@/components/shared/book.utils';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Canon } from '@sillsdev/scripture';\nimport { Check } from 'lucide-react';\nimport { Section } from 'platform-bible-utils';\nimport { forwardRef, MouseEvent, useMemo, useRef } from 'react';\n\ntype BookItemProps = {\n  /** The book ID (e.g., 'GEN', 'EXO') */\n  bookId: string;\n  /** Whether this book is currently selected */\n  isSelected?: boolean;\n  /** Callback function to handle book selection/deselection */\n  onSelect?: (bookId: string) => void;\n  /** Optional custom mouse down handler */\n  onMouseDown?: (e: MouseEvent) => void;\n  /** The section this book belongs to */\n  section: Section;\n  /** Additional CSS classes for the wrapper CommandItem */\n  className?: string;\n  /** Whether to show the check icon (for multiselect mode) */\n  showCheck?: boolean;\n  /**\n   * Optional map of localized book IDs/short names and full names. Key is the (English) book ID,\n   * value contains localized versions of the ID and full book name\n   */\n  localizedBookNames?: Map<string, { localizedId: string; localizedName: string }>;\n  /** Value to use for Command component matching */\n  commandValue?: string;\n};\n\n/**\n * A reusable component that represents a single book item in book selectors. The component shows\n * the book's localized name, its ID, and visually indicates its testament (OT/NT/DC/Extra) through\n * color coding.\n *\n * For simple selection, use the `onSelect` prop. For complex interactions (like shift-click range\n * selection), implement custom `onSelect` and `onMouseDown` handlers that manage the logic\n * externally.\n */\nexport const BookItem = forwardRef<HTMLDivElement, BookItemProps>(\n  (\n    {\n      bookId,\n      isSelected,\n      onSelect,\n      onMouseDown,\n      section,\n      className,\n      showCheck = false,\n      localizedBookNames,\n      commandValue,\n    },\n    ref,\n  ) => {\n    const isMouseClick = useRef(false);\n\n    const handleSelect = () => {\n      if (!isMouseClick.current) {\n        onSelect?.(bookId);\n      }\n      // Reset the mouse flag after a short delay\n      setTimeout(() => {\n        isMouseClick.current = false;\n      }, 100);\n    };\n\n    const handleMouseDown = (e: MouseEvent) => {\n      isMouseClick.current = true;\n\n      if (onMouseDown) {\n        onMouseDown(e);\n      } else {\n        // If no custom mouse handler, fall back to calling onSelect\n        onSelect?.(bookId);\n      }\n    };\n\n    const bookDisplayName = useMemo(\n      () => getLocalizedBookName(bookId, localizedBookNames),\n      [bookId, localizedBookNames],\n    );\n\n    const bookDisplayId = useMemo(\n      () => getLocalizedBookId(bookId, localizedBookNames),\n      [bookId, localizedBookNames],\n    );\n\n    return (\n      <div\n        className={cn(\n          'tw-mx-1 tw-my-1 tw-border-b-0 tw-border-e-0 tw-border-s-2 tw-border-t-0 tw-border-solid',\n          {\n            'tw-border-s-red-200': section === Section.OT,\n            'tw-border-s-purple-200': section === Section.NT,\n            'tw-border-s-indigo-200': section === Section.DC,\n            'tw-border-s-amber-200': section === Section.Extra,\n          },\n        )}\n      >\n        <CommandItem\n          ref={ref}\n          value={commandValue || `${bookId} ${Canon.bookIdToEnglishName(bookId)}`}\n          onSelect={handleSelect}\n          onMouseDown={handleMouseDown}\n          role=\"option\"\n          aria-selected={isSelected}\n          aria-label={`${Canon.bookIdToEnglishName(bookId)} (${bookId.toLocaleUpperCase()})`}\n          className={className}\n        >\n          {showCheck && (\n            <Check\n              className={cn(\n                'tw-me-2 tw-h-4 tw-w-4 tw-flex-shrink-0',\n                isSelected ? 'tw-opacity-100' : 'tw-opacity-0',\n              )}\n            />\n          )}\n          <span className=\"tw-min-w-0 tw-flex-1\">{bookDisplayName}</span>\n          <span className=\"tw-ms-2 tw-flex-shrink-0 tw-text-xs tw-text-muted-foreground\">\n            {bookDisplayId}\n          </span>\n        </CommandItem>\n      </div>\n    );\n  },\n);\n","import React from 'react';\nimport { Slot } from '@radix-ui/react-slot';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Style variants for the Button component.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/button}\n */\nexport const buttonVariants = cva(\n  'pr-twp tw-inline-flex tw-items-center tw-justify-center tw-gap-2 tw-whitespace-nowrap tw-rounded-md tw-text-sm tw-font-medium tw-ring-offset-background tw-transition-colors focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2 disabled:tw-pointer-events-none disabled:tw-opacity-50 [&_svg]:tw-pointer-events-none [&_svg]:tw-size-4 [&_svg]:tw-shrink-0',\n  {\n    variants: {\n      variant: {\n        default: 'tw-bg-primary tw-text-primary-foreground hover:tw-bg-primary/90',\n        destructive: 'tw-bg-destructive tw-text-destructive-foreground hover:tw-bg-destructive/90',\n        outline:\n          'tw-border tw-border-input tw-bg-background hover:tw-bg-accent hover:tw-text-accent-foreground',\n        secondary: 'tw-bg-secondary tw-text-secondary-foreground hover:tw-bg-secondary/80',\n        ghost: 'hover:tw-bg-accent hover:tw-text-accent-foreground',\n        link: 'tw-text-primary tw-underline-offset-4 hover:tw-underline',\n      },\n      size: {\n        default: 'tw-h-10 tw-px-4 tw-py-2',\n        sm: 'tw-h-9 tw-rounded-md tw-px-3',\n        lg: 'tw-h-11 tw-rounded-md tw-px-8',\n        icon: 'tw-h-10 tw-w-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n);\n\n/**\n * Props for Button component\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/button}\n */\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean;\n}\n\n/**\n * The Button component displays a button or a component that looks like a button. The component is\n * built and styled by Shadcn UI.\n *\n * @param ButtonProps\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/button}\n */\nexport const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : 'button';\n    return (\n      <Comp className={cn(buttonVariants({ variant, size, className }))} ref={ref} {...props} />\n    );\n  },\n);\nButton.displayName = 'Button';\n","import React from 'react';\nimport * as PopoverPrimitive from '@radix-ui/react-popover';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * The Popover component displays rich content in a portal, triggered by a button. This popover is\n * built on Radix UI's Popover component and styled by Shadcn UI.\n *\n * See Shadcn UI Documentation https://ui.shadcn.com/docs/components/popover See Radix UI\n * Documentation https://www.radix-ui.com/docs/primitives/components/popover\n */\nconst Popover = PopoverPrimitive.Root;\n\n/** @inheritdoc Popover */\nconst PopoverTrigger = PopoverPrimitive.Trigger;\n\n/** @inheritdoc Popover */\nconst PopoverAnchor = PopoverPrimitive.Anchor;\n\n/** @inheritdoc Popover */\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = 'center', sideOffset = 4, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <PopoverPrimitive.Portal>\n      <PopoverPrimitive.Content\n        ref={ref}\n        align={align}\n        sideOffset={sideOffset}\n        className={cn(\n          // CUSTOM Changed z-order from 50 to 250 to make them appear on floating tabs (200)\n          'tw-z-[250]',\n          'pr-twp tw-w-72 tw-rounded-md tw-border tw-bg-popover tw-p-4 tw-text-popover-foreground tw-shadow-md tw-outline-none data-[state=open]:tw-animate-in data-[state=closed]:tw-animate-out data-[state=closed]:tw-fade-out-0 data-[state=open]:tw-fade-in-0 data-[state=closed]:tw-zoom-out-95 data-[state=open]:tw-zoom-in-95 data-[side=bottom]:tw-slide-in-from-top-2 data-[side=left]:tw-slide-in-from-right-2 data-[side=right]:tw-slide-in-from-left-2 data-[side=top]:tw-slide-in-from-bottom-2',\n          className,\n        )}\n        {...props}\n        dir={dir}\n      />\n    </PopoverPrimitive.Portal>\n  );\n});\nPopoverContent.displayName = PopoverPrimitive.Content.displayName;\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor };\n","import {\n  ALL_ENGLISH_BOOK_NAMES,\n  getLocalizedBookId,\n  getLocalizedBookName,\n} from '@/components/shared/book.utils';\n\nexport function generateCommandValue(\n  bookId: string,\n  localizedBookNames?: Map<string, { localizedId: string; localizedName: string }>,\n  chapter?: number,\n): string {\n  return `${bookId} ${ALL_ENGLISH_BOOK_NAMES[bookId]}${localizedBookNames ? ` ${getLocalizedBookId(bookId, localizedBookNames)} ${getLocalizedBookName(bookId, localizedBookNames)}` : ''}${chapter ? ` ${chapter}` : ''}`;\n}\n","import { Clock } from 'lucide-react';\nimport { Button } from '@/components/shadcn-ui/button';\nimport { Command, CommandGroup, CommandItem, CommandList } from '@/components/shadcn-ui/command';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/shadcn-ui/popover';\nimport { useState } from 'react';\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/** Interface defining the properties for the RecentSearches component */\nexport interface RecentSearchesProps<T> {\n  /** Array of recent search items */\n  recentSearches: T[];\n  /** Callback when a recent search item is selected */\n  onSearchItemSelect: (item: T) => void;\n  /** Function to render each search item as a string for display */\n  renderItem?: (item: T) => string;\n  /** Function to create a unique key for each item */\n  getItemKey?: (item: T) => string;\n  /** Aria label for the recent searches button */\n  ariaLabel?: string;\n  /** Heading text for the recent searches group */\n  groupHeading?: string;\n  /** Optional ID for the popover content for accessibility */\n  id?: string;\n  /** Class name for styling the `CommandItem` for each recent search result */\n  classNameForItems?: string;\n}\n\n/**\n * Generic component that displays a button to show recent searches in a popover. Only renders if\n * there are recent searches available. Works with any data type T.\n */\nexport default function RecentSearches<T>({\n  recentSearches,\n  onSearchItemSelect,\n  renderItem = (item) => String(item),\n  getItemKey = (item) => String(item),\n  ariaLabel = 'Show recent searches',\n  groupHeading = 'Recent',\n  id,\n  classNameForItems,\n}: RecentSearchesProps<T>) {\n  const [isOpen, setIsOpen] = useState(false);\n\n  if (recentSearches.length === 0) {\n    return undefined;\n  }\n\n  const handleSearchItemSelect = (item: T) => {\n    onSearchItemSelect(item);\n    setIsOpen(false);\n  };\n\n  return (\n    <Popover open={isOpen} onOpenChange={setIsOpen}>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"tw-absolute tw-right-0 tw-top-0 tw-h-full tw-px-3 tw-py-2\"\n          aria-label={ariaLabel}\n        >\n          <Clock className=\"tw-h-4 tw-w-4\" />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent id={id} className=\"tw-w-[300px] tw-p-0\" align=\"start\">\n        <Command>\n          <CommandList>\n            <CommandGroup heading={groupHeading}>\n              {recentSearches.map((item) => (\n                <CommandItem\n                  key={getItemKey(item)}\n                  onSelect={() => handleSearchItemSelect(item)}\n                  className={cn('tw-flex tw-items-center', classNameForItems)}\n                >\n                  <Clock className=\"tw-mr-2 tw-h-4 tw-w-4 tw-opacity-50\" />\n                  <span>{renderItem(item)}</span>\n                </CommandItem>\n              ))}\n            </CommandGroup>\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n}\n\n/** Generic hook for managing recent searches state and operations. */\nexport function useRecentSearches<T>(\n  recentSearches: T[],\n  setRecentSearches: (items: T[]) => void,\n  areItemsEqual: (a: T, b: T) => boolean = (a, b) => a === b,\n  maxItems: number = 15,\n) {\n  return (item: T) => {\n    // Add the current item to recent searches, moving it to the top if it already exists\n    const recentSearchesWithoutCurrent = recentSearches.filter(\n      (existingItem) => !areItemsEqual(existingItem, item),\n    );\n    const updatedRecentSearches = [item, ...recentSearchesWithoutCurrent.slice(0, maxItems - 1)];\n    setRecentSearches(updatedRecentSearches);\n  };\n}\n","import { Canon } from '@sillsdev/scripture';\nimport { getChaptersForBook } from 'platform-bible-utils';\nimport { ALL_ENGLISH_BOOK_NAMES, doesBookMatchQuery } from '@/components/shared/book.utils';\nimport { BookWithOptionalChapterAndVerse } from './book-chapter-control.types';\n\n// Smart parsing regex patterns\nexport const SCRIPTURE_REGEX_PATTERNS = {\n  // Matches start of string (`^`), one or more non-colon/space words, optionally followed by space and more words (`([^:\\s]+(?:\\s+[^:\\s]+)*)`), end of string (`$`), case-insensitive (`i`)\n  BOOK_ONLY: /^([^:\\s]+(?:\\s+[^:\\s]+)*)$/i,\n  // Same as above, but followed by a space and a chapter number (`\\s+(\\d+)`)\n  BOOK_CHAPTER: /^([^:\\s]+(?:\\s+[^:\\s]+)*)\\s+(\\d+)$/i,\n  // Same as above, but followed by a colon and optionally a verse number (`:(\\d*)`)\n  BOOK_CHAPTER_VERSE: /^([^:\\s]+(?:\\s+[^:\\s]+)*)\\s+(\\d+):(\\d*)$/i,\n} as const;\n\nexport const SEARCH_QUERY_FORMATS = [\n  SCRIPTURE_REGEX_PATTERNS.BOOK_ONLY,\n  SCRIPTURE_REGEX_PATTERNS.BOOK_CHAPTER,\n  SCRIPTURE_REGEX_PATTERNS.BOOK_CHAPTER_VERSE,\n];\n\nexport function getKeyCharacterType(key: string) {\n  const isLetter = /^[a-zA-Z]$/.test(key);\n  const isDigit = /^[0-9]$/.test(key);\n  return { isLetter, isDigit };\n}\n\nexport function fetchEndChapter(bookId: string) {\n  // getChaptersForBook returns -1 if not found in scrBookData\n  // scrBookData only includes OT and NT, so all DC will return -1\n  return getChaptersForBook(Canon.bookIdToNumber(bookId));\n}\n\nexport function calculateTopMatch(\n  query: string,\n  availableBooks: string[],\n  localizedBookNames?: Map<string, { localizedId: string; localizedName: string }>,\n): BookWithOptionalChapterAndVerse | undefined {\n  if (!query.trim() || availableBooks.length === 0) return undefined;\n\n  // First try smart parsing with regex patterns\n  const topMatch = SEARCH_QUERY_FORMATS.reduce(\n    (result: BookWithOptionalChapterAndVerse | undefined, format) => {\n      if (result) return result;\n\n      const matches = format.exec(query.trim());\n      if (matches) {\n        const [book, chapter = undefined, verse = undefined] = matches.slice(1);\n\n        let validBookId: string | undefined;\n\n        // Match for partial book name or id\n\n        const allPotentialMatches = availableBooks.filter((bookId) => {\n          return doesBookMatchQuery(bookId, book, localizedBookNames);\n        });\n\n        // Only create a topMatch if exactly one book could match\n        if (allPotentialMatches.length === 1) {\n          [validBookId] = allPotentialMatches;\n        }\n\n        // Match for exact book id (English or localized)\n        // This is only performed when a chapter number is provided, to prevent edge cases where\n        // a search for e.g. `jud` would generate a top match for 'Jude', even though 'Judges' would\n        // also be a valid match\n        if (!validBookId && chapter) {\n          // Check exact English book ID\n          if (Canon.isBookIdValid(book)) {\n            const bookIdUpperCase = book.toUpperCase();\n            if (availableBooks.includes(bookIdUpperCase)) {\n              validBookId = bookIdUpperCase;\n            }\n          }\n\n          // Check exact localized book ID\n          if (!validBookId && localizedBookNames) {\n            const matchingLocalizedBookId = Array.from(localizedBookNames.entries()).find(\n              ([, localizedBook]) => localizedBook.localizedId.toLowerCase() === book.toLowerCase(),\n            );\n            if (matchingLocalizedBookId && availableBooks.includes(matchingLocalizedBookId[0])) {\n              [validBookId] = matchingLocalizedBookId;\n            }\n          }\n        }\n\n        // Match for exact full book name (English or localized)\n        // This is only performed when a chapter number is provided, to prevent edge cases where\n        // a search for e.g. `john` only matches `John` but not `1 John`, `2 John` and `3 John`\n        if (!validBookId && chapter) {\n          // Check exact English book name\n          const getBookIdFromEnglishName = (bookName: string): string | undefined => {\n            return Object.keys(ALL_ENGLISH_BOOK_NAMES).find(\n              (bookId) => ALL_ENGLISH_BOOK_NAMES[bookId].toLowerCase() === bookName.toLowerCase(),\n            );\n          };\n\n          const matchingBookIdForFullName = getBookIdFromEnglishName(book);\n          if (matchingBookIdForFullName && availableBooks.includes(matchingBookIdForFullName)) {\n            validBookId = matchingBookIdForFullName;\n          }\n\n          // Check exact localized book name\n          if (!validBookId && localizedBookNames) {\n            const matchingLocalizedBookName = Array.from(localizedBookNames.entries()).find(\n              ([, localizedBook]) =>\n                localizedBook.localizedName.toLowerCase() === book.toLowerCase(),\n            );\n            if (\n              matchingLocalizedBookName &&\n              availableBooks.includes(matchingLocalizedBookName[0])\n            ) {\n              [validBookId] = matchingLocalizedBookName;\n            }\n          }\n        }\n\n        if (validBookId) {\n          let chapterNum = chapter ? parseInt(chapter, 10) : undefined;\n          if (chapterNum && chapterNum > fetchEndChapter(validBookId))\n            chapterNum = Math.max(fetchEndChapter(validBookId), 1);\n          const verseNum = verse ? parseInt(verse, 10) : undefined;\n\n          return {\n            book: validBookId,\n            chapterNum,\n            verseNum,\n          };\n        }\n      }\n\n      return undefined;\n    },\n    undefined,\n  );\n\n  if (topMatch) return topMatch;\n\n  return undefined;\n}\n","import { Direction } from '@/utils/dir-helper.util';\nimport { SerializedVerseRef } from '@sillsdev/scripture';\nimport { ChevronLeft, ChevronRight, ChevronsLeft, ChevronsRight } from 'lucide-react';\nimport { ComponentType, useCallback, useMemo } from 'react';\nimport { fetchEndChapter } from './book-chapter-control.utils';\n\nexport interface QuickNavButton {\n  onClick: () => void;\n  disabled?: boolean;\n  title: string;\n  icon: ComponentType<{ className?: string }>;\n}\n\nexport function useQuickNavButtons(\n  scrRef: SerializedVerseRef,\n  availableBooks: string[],\n  direction: Direction,\n  handleSubmit: (scrRef: SerializedVerseRef) => void,\n): QuickNavButton[] {\n  const handlePreviousChapter = useCallback(() => {\n    if (scrRef.chapterNum > 1) {\n      handleSubmit({\n        book: scrRef.book,\n        chapterNum: scrRef.chapterNum - 1,\n        verseNum: 1,\n      });\n    } else {\n      // Go to previous book's last chapter\n      const currentBookIndex = availableBooks.indexOf(scrRef.book);\n      if (currentBookIndex > 0) {\n        const previousBook = availableBooks[currentBookIndex - 1];\n        const lastChapter = Math.max(fetchEndChapter(previousBook), 1);\n        handleSubmit({\n          book: previousBook,\n          chapterNum: lastChapter,\n          verseNum: 1,\n        });\n      }\n    }\n  }, [scrRef, availableBooks, handleSubmit]);\n\n  const handleNextChapter = useCallback(() => {\n    const maxChapter = fetchEndChapter(scrRef.book);\n    if (scrRef.chapterNum < maxChapter) {\n      handleSubmit({\n        book: scrRef.book,\n        chapterNum: scrRef.chapterNum + 1,\n        verseNum: 1,\n      });\n    } else {\n      // Go to next book's first chapter\n      const currentBookIndex = availableBooks.indexOf(scrRef.book);\n      if (currentBookIndex < availableBooks.length - 1) {\n        const nextBook = availableBooks[currentBookIndex + 1];\n        handleSubmit({\n          book: nextBook,\n          chapterNum: 1,\n          verseNum: 1,\n        });\n      }\n    }\n  }, [scrRef, availableBooks, handleSubmit]);\n\n  const handlePreviousVerse = useCallback(() => {\n    handleSubmit({\n      book: scrRef.book,\n      chapterNum: scrRef.chapterNum,\n      verseNum: scrRef.verseNum > 1 ? scrRef.verseNum - 1 : 0,\n    });\n  }, [scrRef, handleSubmit]);\n\n  const handleNextVerse = useCallback(() => {\n    handleSubmit({\n      book: scrRef.book,\n      chapterNum: scrRef.chapterNum,\n      verseNum: scrRef.verseNum + 1,\n    });\n  }, [scrRef, handleSubmit]);\n\n  return useMemo(() => {\n    return [\n      {\n        onClick: handlePreviousChapter,\n        disabled:\n          availableBooks.length === 0 ||\n          (scrRef.chapterNum === 1 && availableBooks.indexOf(scrRef.book) === 0),\n        title: 'Previous chapter',\n        icon: direction === 'ltr' ? ChevronsLeft : ChevronsRight,\n      },\n      {\n        onClick: handlePreviousVerse,\n        disabled: availableBooks.length === 0 || scrRef.verseNum === 0,\n        title: 'Previous verse',\n        icon: direction === 'ltr' ? ChevronLeft : ChevronRight,\n      },\n      {\n        onClick: handleNextVerse,\n        disabled: availableBooks.length === 0,\n        title: 'Next verse',\n        icon: direction === 'ltr' ? ChevronRight : ChevronLeft,\n      },\n      {\n        onClick: handleNextChapter,\n        disabled:\n          availableBooks.length === 0 ||\n          ((scrRef.chapterNum === fetchEndChapter(scrRef.book) ||\n            fetchEndChapter(scrRef.book) <= 0) &&\n            availableBooks.indexOf(scrRef.book) === availableBooks.length - 1),\n        title: 'Next chapter',\n        icon: direction === 'ltr' ? ChevronsRight : ChevronsLeft,\n      },\n    ];\n  }, [\n    scrRef,\n    availableBooks,\n    direction,\n    handlePreviousChapter,\n    handlePreviousVerse,\n    handleNextVerse,\n    handleNextChapter,\n  ]);\n}\n","import { CommandGroup, CommandItem } from '@/components/shadcn-ui/command';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { ALL_ENGLISH_BOOK_NAMES } from '@/components/shared/book.utils';\nimport { fetchEndChapter } from './book-chapter-control.utils';\n\nexport interface ChapterGridProps {\n  /** The book ID to render chapters for */\n  bookId: string;\n  /** Current scripture reference for highlighting */\n  scrRef: { book: string; chapterNum: number };\n  /** Callback when a chapter is selected */\n  onChapterSelect: (chapter: number) => void;\n  /** Function to set chapter refs for keyboard navigation */\n  setChapterRef: (chapter: number) => (element: HTMLDivElement | null) => void;\n  /** Optional function to determine if a chapter should be dimmed */\n  isChapterDimmed?: (chapter: number) => boolean;\n  /** Optional additional class name for styling */\n  className?: string;\n}\n\n/**\n * Renders a grid of chapter numbers for a given book, with highlighting for the current chapter and\n * optional dimmed chapters based on state logic.\n */\nexport function ChapterGrid({\n  bookId,\n  scrRef,\n  onChapterSelect,\n  setChapterRef,\n  isChapterDimmed,\n  className,\n}: ChapterGridProps) {\n  if (!bookId) return undefined;\n\n  return (\n    <CommandGroup>\n      <div className={cn('tw-grid tw-grid-cols-6 tw-gap-1', className)}>\n        {Array.from({ length: fetchEndChapter(bookId) }, (_, i) => i + 1).map((chapter) => (\n          <CommandItem\n            key={chapter}\n            value={`${bookId} ${ALL_ENGLISH_BOOK_NAMES[bookId] || ''} ${chapter}`}\n            onSelect={() => onChapterSelect(chapter)}\n            ref={setChapterRef(chapter)}\n            className={cn(\n              'tw-h-8 tw-w-8 tw-cursor-pointer tw-justify-center tw-rounded-md tw-text-center tw-text-sm',\n              {\n                'tw-bg-primary tw-text-primary-foreground':\n                  bookId === scrRef.book && chapter === scrRef.chapterNum,\n              },\n              {\n                'tw-bg-muted/50 tw-text-muted-foreground/50': isChapterDimmed?.(chapter) ?? false,\n              },\n            )}\n          >\n            {chapter}\n          </CommandItem>\n        ))}\n      </div>\n    </CommandGroup>\n  );\n}\n","import { BookItem } from '@/components/shared/book-item.component';\nimport { Button } from '@/components/shadcn-ui/button';\nimport {\n  Command,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from '@/components/shadcn-ui/command';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/shadcn-ui/popover';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Canon, SerializedVerseRef } from '@sillsdev/scripture';\nimport { ArrowLeft, ArrowRight } from 'lucide-react';\nimport { formatScrRef, getSectionForBook, Section } from 'platform-bible-utils';\nimport {\n  getSectionLongName,\n  getLocalizedBookName,\n  getLocalizedBookId,\n  ALL_BOOK_IDS,\n  ALL_ENGLISH_BOOK_NAMES,\n  doesBookMatchQuery,\n} from '@/components/shared/book.utils';\nimport { KeyboardEvent, useCallback, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { generateCommandValue } from '@/components/shared/book-item.utils';\nimport RecentSearches from '../recent-searches.component';\nimport { useQuickNavButtons } from './book-chapter-control.navigation';\nimport { BookChapterControlProps, ViewMode } from './book-chapter-control.types';\nimport {\n  calculateTopMatch,\n  fetchEndChapter,\n  getKeyCharacterType,\n} from './book-chapter-control.utils';\nimport { ChapterGrid } from './chapter-grid.component';\n\n/**\n * `BookChapterControl` is a component that provides an interactive UI for selecting book chapters.\n * It allows users to input a search query to find specific books and chapters, navigate through\n * options with keyboard interactions, and submit selections. The component handles various\n * interactions such as opening and closing the dropdown menu, filtering book lists based on search\n * input, and managing highlighted selections. It also integrates with external handlers for\n * submitting selected references and retrieving active book IDs.\n */\nexport function BookChapterControl({\n  scrRef,\n  handleSubmit,\n  className,\n  getActiveBookIds,\n  localizedBookNames,\n  localizedStrings,\n  recentSearches,\n  onAddRecentSearch,\n  id,\n}: BookChapterControlProps) {\n  const direction: Direction = readDirection();\n\n  // Indicates if the Command popover is open or not\n  const [isCommandOpen, setIsCommandOpen] = useState(false);\n  // The value of the Command, mainly needed for reliable keyboard navigation\n  const [commandValue, setCommandValue] = useState('');\n  // The value of the Input inside the Command\n  const [inputValue, setInputValue] = useState('');\n  // The current view mode (books or chapters)\n  const [viewMode, setViewMode] = useState<ViewMode>('books');\n  // The book currently selected for chapter view, if any\n  const [selectedBookForChaptersView, setSelectedBookForChaptersView] = useState<\n    string | undefined\n  >(undefined);\n  const [isCommandListHidden, setIsCommandListHidden] = useState(false);\n\n  // Reference to the Command component\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const commandRef = useRef<HTMLDivElement>(undefined!);\n  // Reference to the Input component inside the Command\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const commandInputRef = useRef<HTMLInputElement>(undefined!);\n  // Reference to the CommandList inside the Command\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const commandListRef = useRef<HTMLDivElement>(undefined!);\n  // Reference to the selected book item in the CommandList\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const selectedBookItemRef = useRef<HTMLDivElement>(undefined!);\n  // References to the chapters that are shown as CommandItems\n  const chapterRefs = useRef<Record<number, HTMLDivElement | null>>({});\n\n  // Wrapper function to handle submit and add to recent searches\n  const handleSubmitAndAddToRecent = useCallback(\n    (newScrRef: SerializedVerseRef) => {\n      handleSubmit(newScrRef);\n      if (onAddRecentSearch) {\n        onAddRecentSearch(newScrRef);\n      }\n    },\n    [handleSubmit, onAddRecentSearch],\n  );\n\n  // #region Available books, filtering and top match logic\n\n  const activeBookIds = useMemo(() => {\n    return getActiveBookIds ? getActiveBookIds() : ALL_BOOK_IDS;\n  }, [getActiveBookIds]);\n\n  const availableBooksByType = useMemo(() => {\n    const grouped: Record<Section, string[]> = {\n      [Section.OT]: activeBookIds.filter((bookId) => Canon.isBookOT(bookId)),\n      [Section.NT]: activeBookIds.filter((bookId) => Canon.isBookNT(bookId)),\n      [Section.DC]: activeBookIds.filter((bookId) => Canon.isBookDC(bookId)),\n      [Section.Extra]: activeBookIds.filter((bookId) => Canon.extraBooks().includes(bookId)),\n    };\n    return grouped;\n  }, [activeBookIds]);\n\n  const availableBooks = useMemo(() => {\n    return Object.values(availableBooksByType).flat();\n  }, [availableBooksByType]);\n\n  // Filter books based on search input\n  const filteredBooksByType = useMemo(() => {\n    if (!inputValue.trim()) return availableBooksByType;\n\n    const filteredBooks: Record<Section, string[]> = {\n      [Section.OT]: [],\n      [Section.NT]: [],\n      [Section.DC]: [],\n      [Section.Extra]: [],\n    };\n\n    const bookTypes: Section[] = [Section.OT, Section.NT, Section.DC, Section.Extra];\n    bookTypes.forEach((type) => {\n      filteredBooks[type] = availableBooksByType[type].filter((bookId) => {\n        return doesBookMatchQuery(bookId, inputValue, localizedBookNames);\n      });\n    });\n\n    return filteredBooks;\n  }, [availableBooksByType, inputValue, localizedBookNames]);\n\n  // Get the current top match\n  const topMatch = useMemo(\n    () => calculateTopMatch(inputValue, availableBooks, localizedBookNames),\n    [inputValue, availableBooks, localizedBookNames],\n  );\n\n  // #endregion\n\n  // #region Submitting references\n\n  const handleTopMatchSelect = useCallback(() => {\n    // If we have a top match (smart parsed or single book filter), use its specific chapter/verse\n    if (topMatch) {\n      handleSubmitAndAddToRecent({\n        book: topMatch.book,\n        chapterNum: topMatch.chapterNum ?? 1,\n        verseNum: topMatch.verseNum ?? 1,\n      });\n      setIsCommandOpen(false);\n      setInputValue('');\n      setCommandValue(''); // Reset command value\n    }\n  }, [handleSubmitAndAddToRecent, topMatch]);\n\n  const handleBookSelect = useCallback(\n    (bookId: string) => {\n      // Check if book has chapters - if not, submit immediately\n      const endChapter = fetchEndChapter(bookId);\n      if (endChapter <= 1) {\n        handleSubmitAndAddToRecent({\n          book: bookId,\n          chapterNum: 1,\n          verseNum: 1,\n        });\n        setIsCommandOpen(false);\n        setInputValue('');\n        return;\n      }\n\n      // Book has multiple chapters - transition to chapter view\n      setSelectedBookForChaptersView(bookId);\n      setViewMode('chapters');\n    },\n    [handleSubmitAndAddToRecent],\n  );\n\n  const handleChapterSelect = useCallback(\n    (chapterNumber: number) => {\n      // Determine which book we're selecting a chapter for\n      const bookId = viewMode === 'chapters' ? selectedBookForChaptersView : topMatch?.book;\n      if (!bookId) return;\n\n      handleSubmitAndAddToRecent({\n        book: bookId,\n        chapterNum: chapterNumber,\n        verseNum: 1,\n      });\n      setIsCommandOpen(false);\n      setViewMode('books');\n      setSelectedBookForChaptersView(undefined);\n      setInputValue('');\n    },\n    [handleSubmitAndAddToRecent, viewMode, selectedBookForChaptersView, topMatch],\n  );\n\n  const handleRecentItemSelect = useCallback(\n    (item: SerializedVerseRef) => {\n      handleSubmitAndAddToRecent(item);\n      setIsCommandOpen(false);\n      setInputValue('');\n    },\n    [handleSubmitAndAddToRecent],\n  );\n\n  // #endregion\n\n  // #region Navigation and view changes\n\n  // Hook that provides navigation buttons for quick chapter/verse navigation\n  const quickNavButtons = useQuickNavButtons(scrRef, availableBooks, direction, handleSubmit);\n\n  const handleBackToBooks = useCallback(() => {\n    setViewMode('books');\n    setSelectedBookForChaptersView(undefined);\n\n    // Focus the search input when returning to book view\n    setTimeout(() => {\n      if (commandInputRef.current) {\n        commandInputRef.current.focus();\n      }\n    }, 0);\n  }, []);\n\n  // Reset view state when popover opens\n  const handleOpenChange = useCallback(\n    (shouldCommandBeOpen: boolean) => {\n      // If we're closing from chapter view, don't close popover but go back to books view instead\n      if (!shouldCommandBeOpen && viewMode === 'chapters') {\n        handleBackToBooks();\n        return;\n      }\n\n      setIsCommandOpen(shouldCommandBeOpen);\n\n      if (shouldCommandBeOpen) {\n        // Reset Command state when opening\n        setViewMode('books');\n        setSelectedBookForChaptersView(undefined);\n        setInputValue('');\n      }\n    },\n    [viewMode, handleBackToBooks],\n  );\n\n  // #endregion\n\n  // #region Helper functions and variables\n\n  const { otLong, ntLong, dcLong, extraLong } = {\n    otLong: localizedStrings?.['%scripture_section_ot_long%'],\n    ntLong: localizedStrings?.['%scripture_section_nt_long%'],\n    dcLong: localizedStrings?.['%scripture_section_dc_long%'],\n    extraLong: localizedStrings?.['%scripture_section_extra_long%'],\n  };\n\n  const getSectionLabel = useCallback(\n    (section: Section): string => {\n      return getSectionLongName(section, otLong, ntLong, dcLong, extraLong);\n    },\n    [otLong, ntLong, dcLong, extraLong],\n  );\n\n  const doesChapterMatch = useCallback(\n    (chapter: number) => {\n      if (!topMatch) return false;\n      return !!topMatch.chapterNum && !chapter.toString().includes(topMatch.chapterNum.toString());\n    },\n    [topMatch],\n  );\n\n  const currentDisplayValue = useMemo(\n    () =>\n      formatScrRef(\n        scrRef,\n        localizedBookNames ? getLocalizedBookName(scrRef.book, localizedBookNames) : 'English',\n      ),\n    [scrRef, localizedBookNames],\n  );\n\n  const setChapterRef = useCallback((chapter: number) => {\n    return (element: HTMLDivElement | null) => {\n      chapterRefs.current[chapter] = element;\n    };\n  }, []);\n\n  // #endregion\n\n  // #region Keyboard handling\n\n  // Handle keyboard navigation for CommandInput\n  const handleInputKeyDown = useCallback((event: KeyboardEvent<HTMLInputElement>) => {\n    // Override default Home and End key behavior to work normally for cursor movement.\n    // Default behavior was to jump to the start/end of the list of items in the Command\n    if (event.key === 'Home' || event.key === 'End') {\n      event.stopPropagation(); // Prevent Command component from handling these\n    }\n  }, []);\n\n  // Grid-aware keyboard navigation using Command's controlled value\n  const handleCommandKeyDown = useCallback(\n    (event: KeyboardEvent<HTMLDivElement | HTMLButtonElement>) => {\n      if (event.ctrlKey) return;\n\n      const { isLetter, isDigit } = getKeyCharacterType(event.key);\n\n      // Handle keypresses in chapter viewmode\n      if (viewMode === 'chapters') {\n        // Handle backspace for going back to books\n        if (event.key === 'Backspace') {\n          event.preventDefault();\n          event.stopPropagation();\n          handleBackToBooks();\n          return;\n        }\n\n        if (isLetter || isDigit) {\n          event.preventDefault();\n          event.stopPropagation();\n          setViewMode('books');\n          setSelectedBookForChaptersView(undefined);\n\n          if (isDigit && selectedBookForChaptersView) {\n            // Digit pressed: go back to book list and start search with current book name + digit\n            const currentBookName = ALL_ENGLISH_BOOK_NAMES[selectedBookForChaptersView];\n            setInputValue(`${currentBookName} ${event.key}`);\n          } else {\n            setInputValue(event.key);\n          }\n\n          setTimeout(() => {\n            if (commandInputRef.current) {\n              commandInputRef.current.focus();\n            }\n          }, 0);\n          return;\n        }\n      }\n\n      // Handle grid navigation for arrow keys in chapter views\n      if (\n        (viewMode === 'chapters' || (viewMode === 'books' && topMatch)) &&\n        ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(event.key)\n      ) {\n        // Extract current chapter from commandValue\n        const currentBookId =\n          viewMode === 'chapters' ? selectedBookForChaptersView : topMatch?.book;\n        if (!currentBookId) return;\n\n        // Parse chapter from current command value\n        const currentChapter = (() => {\n          if (!commandValue) return 1;\n          const match = commandValue.match(/(\\d+)$/);\n          return match ? parseInt(match[1], 10) : 0;\n        })();\n\n        const maxChapter = fetchEndChapter(currentBookId);\n\n        if (!maxChapter) return;\n\n        let targetChapter = currentChapter;\n        const GRID_COLS = 6;\n\n        switch (event.key) {\n          case 'ArrowLeft':\n            if (currentChapter !== 0)\n              targetChapter = currentChapter > 1 ? currentChapter - 1 : maxChapter;\n            break;\n          case 'ArrowRight':\n            if (currentChapter !== 0)\n              targetChapter = currentChapter < maxChapter ? currentChapter + 1 : 1;\n            break;\n          case 'ArrowUp':\n            targetChapter =\n              currentChapter === 0 ? maxChapter : Math.max(1, currentChapter - GRID_COLS);\n            break;\n          case 'ArrowDown':\n            targetChapter =\n              currentChapter === 0 ? 1 : Math.min(maxChapter, currentChapter + GRID_COLS);\n            break;\n          default:\n            return;\n        }\n\n        if (targetChapter !== currentChapter) {\n          event.preventDefault();\n          event.stopPropagation();\n\n          // Update the command value to the target chapter\n          setCommandValue(generateCommandValue(currentBookId, localizedBookNames, targetChapter));\n\n          // Scroll the target chapter into view using refs\n          setTimeout(() => {\n            const targetElement = chapterRefs.current[targetChapter];\n            if (targetElement) {\n              targetElement.scrollIntoView({ block: 'nearest', behavior: 'smooth' });\n            }\n          }, 0);\n        }\n      }\n    },\n    [\n      viewMode,\n      topMatch,\n      handleBackToBooks,\n      selectedBookForChaptersView,\n      commandValue,\n      localizedBookNames,\n    ],\n  );\n\n  const handleQuickNavButtonKeyDown = useCallback((event: KeyboardEvent<HTMLButtonElement>) => {\n    if (event.shiftKey || event.key === 'Tab' || event.key === ' ') return;\n\n    const { isLetter, isDigit } = getKeyCharacterType(event.key);\n\n    if (isLetter || isDigit) {\n      event.preventDefault();\n\n      setInputValue((prevValue) => prevValue + event.key);\n      commandInputRef.current.focus();\n\n      setIsCommandListHidden(false);\n    }\n  }, []);\n\n  // #endregion\n\n  // #region Auto-scroll\n\n  // Auto-scroll to currently selected book when dropdown opens in book view\n  useLayoutEffect(() => {\n    const scrollTimeout = setTimeout(() => {\n      if (\n        isCommandOpen &&\n        viewMode === 'books' &&\n        commandListRef.current &&\n        selectedBookItemRef.current\n      ) {\n        const listElement = commandListRef.current;\n        const itemElement = selectedBookItemRef.current;\n\n        // Calculate scroll position to center the selected item\n        const itemOffsetTop = itemElement.offsetTop;\n        const listHeight = listElement.clientHeight;\n        const itemHeight = itemElement.clientHeight;\n        const scrollPosition = itemOffsetTop - listHeight / 2 + itemHeight / 2;\n\n        listElement.scrollTo({\n          top: Math.max(0, scrollPosition),\n          behavior: 'smooth',\n        });\n\n        // Set the selected book as the active item for keyboard navigation\n        setCommandValue(generateCommandValue(scrRef.book));\n      }\n    }, 0);\n\n    return () => {\n      clearTimeout(scrollTimeout);\n    };\n  }, [isCommandOpen, viewMode, inputValue, topMatch, scrRef.book]);\n\n  // Auto-scroll to appropriate chapter\n  useLayoutEffect(() => {\n    if (viewMode === 'chapters' && selectedBookForChaptersView) {\n      // Check if we're entering chapter view for the currently selected book\n      const isCurrentlySelectedBook = selectedBookForChaptersView === scrRef.book;\n\n      // Reset scroll position to top, except when viewing the currently selected book\n      setTimeout(() => {\n        if (commandListRef.current) {\n          if (isCurrentlySelectedBook) {\n            // Scroll to the currently selected chapter\n            const targetElement = chapterRefs.current[scrRef.chapterNum];\n            if (targetElement) {\n              targetElement.scrollIntoView({ block: 'center', behavior: 'smooth' });\n            }\n          } else {\n            // Reset to top for other books\n            commandListRef.current.scrollTo({ top: 0 });\n          }\n        }\n\n        // Ensure Command component has focus for keyboard navigation\n        if (commandRef.current) {\n          commandRef.current.focus();\n        }\n      }, 0);\n    }\n  }, [viewMode, selectedBookForChaptersView, topMatch, scrRef.book, scrRef.chapterNum]);\n\n  // #endregion\n\n  return (\n    <Popover open={isCommandOpen} onOpenChange={handleOpenChange}>\n      <PopoverTrigger asChild>\n        <Button\n          aria-label=\"book-chapter-trigger\"\n          variant=\"outline\"\n          role=\"combobox\"\n          aria-expanded={isCommandOpen}\n          className={cn(\n            'tw-h-8 tw-w-full tw-min-w-16 tw-max-w-48 tw-overflow-hidden tw-px-1',\n            className,\n          )}\n        >\n          <span className=\"tw-truncate\">{currentDisplayValue}</span>\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent id={id} forceMount className=\"tw-w-[280px] tw-p-0\" align=\"center\">\n        <Command\n          ref={commandRef}\n          onKeyDown={handleCommandKeyDown}\n          loop\n          value={commandValue}\n          onValueChange={setCommandValue}\n          shouldFilter={false}\n        >\n          {/* Header: Input (with quick nav buttons) for book view, fixed header for chapter view */}\n          {viewMode === 'books' ? (\n            <div className=\"tw-flex tw-items-end\">\n              <div className=\"tw-relative tw-flex-1\">\n                <CommandInput\n                  ref={commandInputRef}\n                  value={inputValue}\n                  onValueChange={setInputValue}\n                  onKeyDown={handleInputKeyDown}\n                  onFocus={() => setIsCommandListHidden(false)}\n                  className={recentSearches && recentSearches.length > 0 ? '!tw-pr-10' : ''}\n                />\n                {recentSearches && recentSearches.length > 0 && (\n                  <RecentSearches\n                    recentSearches={recentSearches}\n                    onSearchItemSelect={handleRecentItemSelect}\n                    renderItem={(verseRef) => formatScrRef(verseRef, 'English')}\n                    getItemKey={(verseRef) =>\n                      `${verseRef.book}-${verseRef.chapterNum}-${verseRef.verseNum}`\n                    }\n                    ariaLabel={localizedStrings?.['%history_recentSearches_ariaLabel%']}\n                    groupHeading={localizedStrings?.['%history_recent%']}\n                  />\n                )}\n              </div>\n              {/* Navigation buttons for previous/next chapter/book */}\n              <div className=\"tw-flex tw-items-center tw-gap-1 tw-border-b tw-pe-2\">\n                {quickNavButtons.map(({ onClick, disabled, title, icon: Icon }) => (\n                  <Button\n                    key={title}\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => {\n                      setIsCommandListHidden(true);\n                      onClick();\n                    }}\n                    disabled={disabled}\n                    className=\"tw-h-10 tw-w-4 tw-p-0\"\n                    title={title}\n                    onKeyDown={handleQuickNavButtonKeyDown}\n                  >\n                    <Icon />\n                  </Button>\n                ))}\n              </div>\n            </div>\n          ) : (\n            <div className=\"tw-flex tw-items-center tw-border-b tw-px-3 tw-py-2\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleBackToBooks}\n                className=\"tw-mr-2 tw-h-6 tw-w-6 tw-p-0\"\n                tabIndex={-1}\n              >\n                {direction === 'ltr' ? (\n                  <ArrowLeft className=\"tw-h-4 tw-w-4\" />\n                ) : (\n                  <ArrowRight className=\"tw-h-4 tw-w-4\" />\n                )}\n              </Button>\n              {selectedBookForChaptersView && (\n                <span tabIndex={-1} className=\"tw-text-sm tw-font-medium\">\n                  {getLocalizedBookName(selectedBookForChaptersView, localizedBookNames)}\n                </span>\n              )}\n            </div>\n          )}\n\n          {/** Body */}\n          {!isCommandListHidden && (\n            <CommandList ref={commandListRef}>\n              {/** Book list mode (also used in case of top matches) */}\n              {viewMode === 'books' && (\n                <>\n                  {/* Book List - Show when we don't have a top match */}\n                  {!topMatch &&\n                    Object.entries(filteredBooksByType).map(([type, books]) => {\n                      if (books.length === 0) return undefined;\n\n                      return (\n                        // We are mapping over filteredBooksByType, which uses Section as key type\n                        // eslint-disable-next-line no-type-assertion/no-type-assertion\n                        <CommandGroup key={type} heading={getSectionLabel(type as Section)}>\n                          {books.map((bookId) => (\n                            <BookItem\n                              key={bookId}\n                              bookId={bookId}\n                              onSelect={(selectedBookId: string) =>\n                                handleBookSelect(selectedBookId)\n                              }\n                              section={getSectionForBook(bookId)}\n                              commandValue={`${bookId} ${ALL_ENGLISH_BOOK_NAMES[bookId]}`}\n                              ref={bookId === scrRef.book ? selectedBookItemRef : undefined}\n                              localizedBookNames={localizedBookNames}\n                            />\n                          ))}\n                        </CommandGroup>\n                      );\n                    })}\n\n                  {/* Top match scripture reference */}\n                  {topMatch && (\n                    <CommandGroup>\n                      <CommandItem\n                        key=\"top-match\"\n                        value={`${topMatch.book} ${ALL_ENGLISH_BOOK_NAMES[topMatch.book]} ${\n                          topMatch.chapterNum || ''\n                        }:${topMatch.verseNum || ''})}`}\n                        onSelect={handleTopMatchSelect}\n                        className=\"tw-font-semibold tw-text-primary\"\n                      >\n                        {formatScrRef(\n                          {\n                            book: topMatch.book,\n                            chapterNum: topMatch.chapterNum ?? 1,\n                            verseNum: topMatch.verseNum ?? 1,\n                          },\n                          localizedBookNames\n                            ? getLocalizedBookId(topMatch.book, localizedBookNames)\n                            : undefined,\n                        )}\n                      </CommandItem>\n                    </CommandGroup>\n                  )}\n\n                  {/* Chapter Selector - Show when we have a top match */}\n                  {topMatch && fetchEndChapter(topMatch.book) > 1 && (\n                    <>\n                      <div className=\"tw-mb-2 tw-px-3 tw-text-sm tw-font-medium tw-text-muted-foreground\">\n                        {getLocalizedBookName(topMatch.book, localizedBookNames)}\n                      </div>\n                      <ChapterGrid\n                        bookId={topMatch.book}\n                        scrRef={scrRef}\n                        onChapterSelect={handleChapterSelect}\n                        setChapterRef={setChapterRef}\n                        isChapterDimmed={doesChapterMatch}\n                        className=\"tw-px-4 tw-pb-4\"\n                      />\n                    </>\n                  )}\n                </>\n              )}\n\n              {/* Basic chapter view mode */}\n              {viewMode === 'chapters' && selectedBookForChaptersView && (\n                <ChapterGrid\n                  bookId={selectedBookForChaptersView}\n                  scrRef={scrRef}\n                  onChapterSelect={handleChapterSelect}\n                  setChapterRef={setChapterRef}\n                  className=\"tw-p-4\"\n                />\n              )}\n            </CommandList>\n          )}\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n}\n\nexport default BookChapterControl;\n","import { SerializedVerseRef } from '@sillsdev/scripture';\nimport { LanguageStrings } from 'platform-bible-utils';\n\n/**\n * Object containing all keys used for localization in the BookChapterControl component. If you're\n * using this component in an extension, you can pass it into the useLocalizedStrings hook to easily\n * obtain the localized strings and pass them into the localizedStrings prop of this component\n */\nexport const BOOK_CHAPTER_CONTROL_STRING_KEYS = Object.freeze([\n  '%scripture_section_ot_long%',\n  '%scripture_section_nt_long%',\n  '%scripture_section_dc_long%',\n  '%scripture_section_extra_long%',\n  '%history_recent%',\n  '%history_recentSearches_ariaLabel%',\n] as const);\n\n/** Type definition for the localized strings used in the BookChapterControl component */\nexport type BookChapterControlLocalizedStrings = {\n  [localizedKey in (typeof BOOK_CHAPTER_CONTROL_STRING_KEYS)[number]]?: string;\n};\n\nexport type BookWithOptionalChapterAndVerse = Omit<SerializedVerseRef, 'chapterNum' | 'verseNum'> &\n  Partial<Pick<SerializedVerseRef, 'chapterNum' | 'verseNum'>>;\n\nexport type ViewMode = 'books' | 'chapters';\n\nexport type BookChapterControlProps = {\n  /** The current scripture reference */\n  scrRef: SerializedVerseRef;\n  /** Callback to handle the submission of a selected reference */\n  handleSubmit: (scrRef: SerializedVerseRef) => void;\n  /** Optional additional class name for styling */\n  className?: string;\n  /** Callback to retrieve book IDs that are available in the current context */\n  getActiveBookIds?: () => string[];\n  /**\n   * Optional map of localized book IDs/short names and full names. The key is the standard book ID\n   * (e.g., \"2CH\"), the value contains a localized version of the ID and related book name (e.g. {\n   * localizedId: '2CR', localizedName: '2 Crónicas' })\n   */\n  localizedBookNames?: Map<string, { localizedId: string; localizedName: string }>;\n  /** Optional localized strings for the component */\n  localizedStrings?: LanguageStrings;\n  /** Array of recent scripture references for quick access */\n  recentSearches?: SerializedVerseRef[];\n  /** Callback to add a new recent scripture reference */\n  onAddRecentSearch?: (scrRef: SerializedVerseRef) => void;\n  /** Optional ID for the popover content for accessibility */\n  id?: string;\n};\n","import React from 'react';\nimport * as LabelPrimitive from '@radix-ui/react-label';\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Style variants for the Label component.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/label}\n * @see Radix UI Documentation: {@link https://www.radix-ui.com/primitives/docs/components/label}\n */\nconst labelVariants = cva(\n  'tw-text-sm tw-font-medium tw-leading-none peer-disabled:tw-cursor-not-allowed peer-disabled:tw-opacity-70',\n);\n\n/**\n * The Label component renders an accessible label associated with controls. This components is\n * built on Radix UI primitives and styled with Shadcn UI.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/label}\n * @see Radix UI Documentation: {@link https://www.radix-ui.com/primitives/docs/components/label}\n */\nexport const Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> & VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root ref={ref} className={cn('pr-twp', labelVariants(), className)} {...props} />\n));\nLabel.displayName = LabelPrimitive.Root.displayName;\n","import React from 'react';\nimport * as RadioGroupPrimitive from '@radix-ui/react-radio-group';\nimport { Circle } from 'lucide-react';\n\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\n\n/**\n * Radio Group components providing a set of checkable buttons—known as radio buttons—where no more\n * than one of the buttons can be checked at a time. These components are built on Radix UI\n * primitives and styled with Shadcn UI.\n *\n * See Shadcn UI Documentation: https://ui.shadcn.com/docs/components/radio-group See Radix UI\n * Documentation: https://www.radix-ui.com/primitives/docs/components/radio-group\n */\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn('pr-twp tw-grid tw-gap-2', className)}\n      {...props}\n      ref={ref}\n      dir={dir}\n    />\n  );\n});\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName;\n\n/** @inheritdoc RadioGroup */\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        'pr-twp tw-aspect-square tw-h-4 tw-w-4 tw-rounded-full tw-border tw-border-primary tw-text-primary tw-ring-offset-background focus:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2 disabled:tw-cursor-not-allowed disabled:tw-opacity-50',\n        className,\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"tw-flex tw-items-center tw-justify-center\">\n        <Circle className=\"tw-h-2.5 tw-w-2.5 tw-fill-current tw-text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  );\n});\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName;\n\nexport { RadioGroup, RadioGroupItem };\n","import { ReactNode, useState } from 'react';\nimport { Check, ChevronDown } from 'lucide-react';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Button, ButtonProps } from '@/components/shadcn-ui/button';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/shadcn-ui/popover';\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from '@/components/shadcn-ui/command';\nimport { PopoverProps } from '@radix-ui/react-popover';\n\nexport type ComboBoxLabelOption = { label: string; secondaryLabel?: string };\nexport type ComboBoxOption = string | number | ComboBoxLabelOption;\n\n/** Represents a group of options with an optional heading */\nexport type ComboBoxGroup<T> = {\n  /** The heading text for this group of options */\n  groupHeading: string;\n  /** The options within this group */\n  options: readonly T[];\n};\n\nexport type ComboBoxProps<T> = {\n  /** Optional unique identifier */\n  id?: string;\n  /**\n   * List of available options for the dropdown menu. Can be either:\n   *\n   * - A flat array of options (single group, no heading)\n   * - An array of group objects. Each group has a heading and an array of options\n   */\n  options?: readonly T[] | readonly ComboBoxGroup<T>[];\n  /** @deprecated 3 December 2024. Renamed to `buttonClassName` */\n  className?: string;\n  /** Additional css classes to help with unique styling of the combo box button */\n  buttonClassName?: string;\n  /** Additional css classes to help with unique styling of the combo box popover */\n  popoverContentClassName?: string;\n  /**\n   * The selected value that the combo box currently holds. Must be shallow equal to one of the\n   * options entries.\n   */\n  value?: T;\n  /** Triggers when content of textfield is changed */\n  onChange?: (newValue: T) => void;\n  /** Used to determine the string value for a given option. */\n  getOptionLabel?: (option: T) => string;\n  /**\n   * Used to determine the string value to display on the button for the selected value. If not\n   * provided, falls back to `getOptionLabel`.\n   */\n  getButtonLabel?: (option: T) => string;\n  /** Icon to be displayed on the trigger */\n  icon?: ReactNode;\n  /** Text displayed on button if `value` is undefined */\n  buttonPlaceholder?: string;\n  /** Placeholder text for text field */\n  textPlaceholder?: string;\n  /** Text to display when no options match input */\n  commandEmptyMessage?: string;\n  /** Variant of button */\n  buttonVariant?: ButtonProps['variant'];\n  /** Control how the popover menu should be aligned. Defaults to start */\n  alignDropDown?: 'start' | 'center' | 'end';\n  /** Optional boolean to set if trigger should be disabled */\n  isDisabled?: boolean;\n  /** Optional aria-label for the trigger button for accessibility */\n  ariaLabel?: string;\n} & PopoverProps;\n\nfunction getOptionLabelDefault(option: ComboBoxOption): string {\n  if (typeof option === 'string') {\n    return option;\n  }\n  if (typeof option === 'number') {\n    return option.toString();\n  }\n  return option.label;\n}\n\n/**\n * Autocomplete input and command palette with a list of suggestions.\n *\n * Thanks to Shadcn for heavy inspiration and documentation\n * https://ui.shadcn.com/docs/components/combobox\n */\nexport function ComboBox<T extends ComboBoxOption = ComboBoxOption>({\n  id,\n  options = [],\n  className,\n  buttonClassName,\n  popoverContentClassName,\n  value,\n  onChange = () => {},\n  getOptionLabel = getOptionLabelDefault,\n  getButtonLabel,\n  icon = undefined,\n  buttonPlaceholder = '',\n  textPlaceholder = '',\n  commandEmptyMessage = 'No option found',\n  buttonVariant = 'outline',\n  alignDropDown = 'start',\n  isDisabled = false,\n  ariaLabel,\n  ...props\n}: ComboBoxProps<T>) {\n  const [open, setOpen] = useState(false);\n\n  const buttonLabel = getButtonLabel ?? getOptionLabel;\n\n  const isGroupedOptions = (\n    groupOptions: readonly T[] | readonly ComboBoxGroup<T>[],\n  ): groupOptions is readonly ComboBoxGroup<T>[] => {\n    return Boolean(\n      groupOptions.length > 0 &&\n        typeof groupOptions[0] === 'object' &&\n        'options' in groupOptions[0],\n    );\n  };\n\n  const renderCommandItem = (option: T, groupHeading?: string) => {\n    const optionLabel = getOptionLabel(option);\n    const secondaryLabel =\n      typeof option === 'object' && 'secondaryLabel' in option ? option.secondaryLabel : undefined;\n\n    const key = `${groupHeading ?? ''}${optionLabel}${secondaryLabel ?? ''}`;\n\n    return (\n      <CommandItem\n        key={key}\n        value={optionLabel}\n        onSelect={() => {\n          onChange(option);\n          setOpen(false);\n        }}\n        className=\"tw-flex tw-items-center\"\n      >\n        <Check\n          className={cn('tw-me-2 tw-h-4 tw-w-4 tw-shrink-0', {\n            'tw-opacity-0': !value || getOptionLabel(value) !== optionLabel,\n          })}\n        />\n        <span className=\"tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap\">\n          {optionLabel}\n          {secondaryLabel && <span className=\"tw-text-muted-foreground\"> · {secondaryLabel}</span>}\n        </span>\n      </CommandItem>\n    );\n  };\n\n  return (\n    <Popover open={open} onOpenChange={setOpen} {...props}>\n      <PopoverTrigger asChild>\n        <Button\n          variant={buttonVariant}\n          role=\"combobox\"\n          aria-expanded={open}\n          aria-label={ariaLabel}\n          id={id}\n          className={cn(\n            'tw-flex tw-w-[200px] tw-items-center tw-justify-between tw-overflow-hidden',\n            buttonClassName ?? className,\n          )}\n          disabled={isDisabled}\n        >\n          <div className=\"tw-flex tw-min-w-0 tw-flex-1 tw-items-center tw-overflow-hidden\">\n            {icon && <div className=\"tw-shrink-0 tw-pe-2\">{icon}</div>}\n            <span\n              className={cn(\n                'tw-min-w-0 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-text-start',\n              )}\n            >\n              {value ? buttonLabel(value) : buttonPlaceholder}\n            </span>\n          </div>\n\n          <ChevronDown className=\"tw-ms-2 tw-h-4 tw-w-4 tw-shrink-0 tw-opacity-50\" />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent\n        align={alignDropDown}\n        className={cn('tw-w-[200px] tw-p-0', popoverContentClassName)}\n      >\n        <Command>\n          <CommandInput placeholder={textPlaceholder} className=\"tw-text-inherit\" />\n          <CommandEmpty>{commandEmptyMessage}</CommandEmpty>\n          <CommandList>\n            {isGroupedOptions(options)\n              ? options.map((group) => (\n                  <CommandGroup key={group.groupHeading} heading={group.groupHeading}>\n                    {group.options.map((option) => renderCommandItem(option, group.groupHeading))}\n                  </CommandGroup>\n                ))\n              : options.map((option) => renderCommandItem(option))}\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n}\n\nexport default ComboBox;\n","import { ComboBox } from '@/components/basics/combo-box.component';\nimport { Label } from '@/components/shadcn-ui/label';\nimport { useMemo } from 'react';\n\nexport type ChapterRangeSelectorProps = {\n  /** The selected start chapter */\n  startChapter: number;\n  /** The selected end chapter */\n  endChapter: number;\n  /** Callback function to handle the selection of the start chapter */\n  handleSelectStartChapter: (chapter: number) => void;\n  /** Callback function to handle the selection of the end chapter */\n  handleSelectEndChapter: (chapter: number) => void;\n  /** Flag to disable the component */\n  isDisabled?: boolean;\n  /** The total number of chapters available */\n  chapterCount: number;\n};\n\n/**\n * ChapterRangeSelector is a component that provides a UI for selecting a range of chapters. It\n * consists of two combo boxes for selecting the start and end chapters. The component ensures that\n * the selected start chapter is always less than or equal to the end chapter, and vice versa.\n *\n * @deprecated Jul 18 2025. This component is no longer supported or tested. Use of this component\n *   is discouraged and it may be removed in the future.\n * @param {ChapterRangeSelectorProps} props - The props for the component.\n */\n\nexport function ChapterRangeSelector({\n  startChapter,\n  endChapter,\n  handleSelectStartChapter,\n  handleSelectEndChapter,\n  isDisabled = false,\n  chapterCount,\n}: ChapterRangeSelectorProps) {\n  const chapterOptions = useMemo(\n    () => Array.from({ length: chapterCount }, (_, index) => index + 1),\n    [chapterCount],\n  );\n\n  const onChangeStartChapter = (value: number) => {\n    handleSelectStartChapter(value);\n    if (value > endChapter) {\n      handleSelectEndChapter(value);\n    }\n  };\n\n  const onChangeEndChapter = (value: number) => {\n    handleSelectEndChapter(value);\n    if (value < startChapter) {\n      handleSelectStartChapter(value);\n    }\n  };\n\n  return (\n    <>\n      <Label htmlFor=\"start-chapters-combobox\">Chapters</Label>\n      <ComboBox\n        isDisabled={isDisabled}\n        onChange={onChangeStartChapter}\n        buttonClassName=\"tw-me-2 tw-ms-2 tw-w-20\"\n        key=\"start chapter\"\n        options={chapterOptions}\n        getOptionLabel={(option) => option.toString()}\n        value={startChapter}\n      />\n\n      <Label htmlFor=\"end-chapters-combobox\">to</Label>\n      <ComboBox\n        isDisabled={isDisabled}\n        onChange={onChangeEndChapter}\n        buttonClassName=\"tw-ms-2 tw-w-20\"\n        key=\"end chapter\"\n        options={chapterOptions}\n        getOptionLabel={(option) => option.toString()}\n        value={endChapter}\n      />\n    </>\n  );\n}\n\nexport default ChapterRangeSelector;\n","import { Button } from '@/components/shadcn-ui/button';\nimport { Label } from '@/components/shadcn-ui/label';\nimport { RadioGroup, RadioGroupItem } from '@/components/shadcn-ui/radio-group';\nimport { Canon } from '@sillsdev/scripture';\nimport { LocalizedStringValue } from 'platform-bible-utils';\nimport { useState } from 'react';\nimport {\n  ChapterRangeSelector,\n  ChapterRangeSelectorProps,\n} from '../basics/chapter-range-selector.component';\n\n/** Enumeration of possible book selection modes */\nexport enum BookSelectionMode {\n  CURRENT_BOOK = 'current book',\n  CHOOSE_BOOKS = 'choose books',\n}\n\n/**\n * Object containing all keys used for localization in this component. If you're using this\n * component in an extension, you can pass it into the useLocalizedStrings hook to easily obtain the\n * localized strings and pass them into the localizedStrings prop of this component\n */\nexport const BOOK_SELECTOR_STRING_KEYS = Object.freeze([\n  '%webView_bookSelector_currentBook%',\n  '%webView_bookSelector_choose%',\n  '%webView_bookSelector_chooseBooks%',\n] as const);\n\nexport type BookSelectorLocalizedStrings = {\n  [localizedBookSelectorKey in (typeof BOOK_SELECTOR_STRING_KEYS)[number]]?: LocalizedStringValue;\n};\n\n/**\n * Gets the localized value for the provided key\n *\n * @param strings Object containing localized string\n * @param key Key for a localized string\n * @returns The localized value for the provided key, if available. Returns the key if no localized\n *   value is available\n */\nconst localizeString = (\n  strings: BookSelectorLocalizedStrings,\n  key: keyof BookSelectorLocalizedStrings,\n) => {\n  return strings[key] ?? key;\n};\n\ntype BookSelectorProps = ChapterRangeSelectorProps & {\n  handleBookSelectionModeChange: (newMode: BookSelectionMode) => void;\n  currentBookName: string;\n  onSelectBooks: () => void;\n  selectedBookIds: string[];\n  localizedStrings: BookSelectorLocalizedStrings;\n};\n\n/**\n * BookSelector is a component that provides an interactive UI for selecting books. It can be set to\n * either allow the user to select a single book or to choose multiple books. In the former case, it\n * will display the range of chapters in the selected book, and in the latter case it will display a\n * list of the selected books.\n *\n * @deprecated Jul 18 2025. This component is no longer supported or tested. Use of this component\n *   is discouraged and it may be removed in the future.\n * @param {BookSelectorProps} props\n * @param {function} props.handleBookSelectionModeChange - Callback function to handle changes in\n *   book selection mode.\n * @param {string} props.currentBookName - The name of the currently selected book.\n * @param {function} props.onSelectBooks - Callback function to handle book selection.\n * @param {string[]} props.selectedBookIds - An array of book IDs that have been selected.\n * @param {BookSelectorLocalizedStrings} props.localizedStrings - Object containing localized\n *   strings for the component.\n */\nexport function BookSelector({\n  handleBookSelectionModeChange,\n  currentBookName,\n  onSelectBooks,\n  selectedBookIds,\n  chapterCount,\n  endChapter,\n  handleSelectEndChapter,\n  startChapter,\n  handleSelectStartChapter,\n  localizedStrings,\n}: BookSelectorProps) {\n  const currentBookText = localizeString(localizedStrings, '%webView_bookSelector_currentBook%');\n  const chooseText = localizeString(localizedStrings, '%webView_bookSelector_choose%');\n  const chooseBooksText = localizeString(localizedStrings, '%webView_bookSelector_chooseBooks%');\n\n  const [bookSelectionMode, setBookSelectionMode] = useState<BookSelectionMode>(\n    BookSelectionMode.CURRENT_BOOK,\n  );\n\n  const onSelectionModeChange = (newMode: BookSelectionMode) => {\n    setBookSelectionMode(newMode);\n    handleBookSelectionModeChange(newMode);\n  };\n\n  return (\n    <RadioGroup\n      className=\"pr-twp tw-flex\"\n      value={bookSelectionMode}\n      // value is always a string but we need it to be BookSelectionMode\n      // eslint-disable-next-line no-type-assertion/no-type-assertion\n      onValueChange={(value: string) => onSelectionModeChange(value as BookSelectionMode)}\n    >\n      <div className=\"tw-flex tw-w-full tw-flex-col tw-gap-4\">\n        <div className=\"tw-grid tw-grid-cols-[25%,25%,50%]\">\n          <div className=\"tw-flex tw-items-center\">\n            <RadioGroupItem value={BookSelectionMode.CURRENT_BOOK} />\n            <Label className=\"tw-ms-1\">{currentBookText}</Label>\n          </div>\n          <Label className=\"tw-flex tw-items-center\">{currentBookName}</Label>\n          <div className=\"tw-flex tw-items-center tw-justify-end\">\n            <ChapterRangeSelector\n              isDisabled={bookSelectionMode === BookSelectionMode.CHOOSE_BOOKS}\n              handleSelectStartChapter={handleSelectStartChapter}\n              handleSelectEndChapter={handleSelectEndChapter}\n              chapterCount={chapterCount}\n              startChapter={startChapter}\n              endChapter={endChapter}\n            />\n          </div>\n        </div>\n        <div className=\"tw-grid tw-grid-cols-[25%,50%,25%]\">\n          <div className=\"tw-flex tw-items-center\">\n            <RadioGroupItem value={BookSelectionMode.CHOOSE_BOOKS} />\n            <Label className=\"tw-ms-1\">{chooseBooksText}</Label>\n          </div>\n          <Label className=\"tw-flex tw-items-center\">\n            {selectedBookIds.map((bookId: string) => Canon.bookIdToEnglishName(bookId)).join(', ')}\n          </Label>\n          <Button\n            disabled={bookSelectionMode === BookSelectionMode.CURRENT_BOOK}\n            onClick={() => onSelectBooks()}\n          >\n            {chooseText}\n          </Button>\n        </div>\n      </div>\n    </RadioGroup>\n  );\n}\n\nexport default BookSelector;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{createContext as n,useContext as e}from\"react\";const r=n(null);function t(n,e){let r=null;return null!=n&&(r=n[1]),{getTheme:function(){return null!=e?e:null!=r?r.getTheme():null}}}function o(){const n=e(r);return null==n&&function(n,...e){const r=new URL(\"https://lexical.dev/docs/error\"),t=new URLSearchParams;t.append(\"code\",n);for(const n of e)t.append(\"v\",n);throw r.search=t.toString(),Error(`Minified Lexical error #${n}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(8),n}export{r as LexicalComposerContext,t as createLexicalComposerContext,o as useLexicalComposerContext};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{createLexicalComposerContext as e,LexicalComposerContext as t}from\"@lexical/react/LexicalComposerContext\";import{createEditor as o,$getRoot as n,$createParagraphNode as i,$getSelection as r,HISTORY_MERGE_TAG as a}from\"lexical\";import{useLayoutEffect as c,useEffect as l,useMemo as d}from\"react\";import{jsx as s}from\"react/jsx-runtime\";const m=\"undefined\"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,u=m?c:l,p={tag:a};function f({initialConfig:a,children:c}){const l=d(()=>{const{theme:t,namespace:c,nodes:l,onError:d,editorState:s,html:u}=a,f=e(null,t),E=o({editable:a.editable,html:u,namespace:c,nodes:l,onError:e=>d(e,E),theme:t});return function(e,t){if(null===t)return;if(void 0===t)e.update(()=>{const t=n();if(t.isEmpty()){const o=i();t.append(o);const n=m?document.activeElement:null;(null!==r()||null!==n&&n===e.getRootElement())&&o.select()}},p);else if(null!==t)switch(typeof t){case\"string\":{const o=e.parseEditorState(t);e.setEditorState(o,p);break}case\"object\":e.setEditorState(t,p);break;case\"function\":e.update(()=>{n().isEmpty()&&t(e)},p)}}(E,s),[E,f]},[]);return u(()=>{const e=a.editable,[t]=l;t.setEditable(void 0===e||e)},[]),s(t.Provider,{value:l,children:c})}export{f as LexicalComposer};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{useLexicalComposerContext as e}from\"@lexical/react/LexicalComposerContext\";import{HISTORY_MERGE_TAG as t}from\"lexical\";import{useLayoutEffect as o,useEffect as i}from\"react\";const r=\"undefined\"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?o:i;function n({ignoreHistoryMergeTagChange:o=!0,ignoreSelectionChange:i=!1,onChange:n}){const[a]=e();return r(()=>{if(n)return a.registerUpdateListener(({editorState:e,dirtyElements:r,dirtyLeaves:d,prevEditorState:s,tags:c})=>{i&&0===r.size&&0===d.size||o&&c.has(t)||s.isEmpty()||n(e,a,c)})},[a,o,i,n]),null}export{n as OnChangePlugin};\n","/**\n * This file was automatically generated on installation of the Shadcn/Lexical editor. The default\n * location of this file has been changed to integrate better with our project structure. Also,\n * modifications have been made to integrate with our codebase.\n *\n * Original file location: src/components/editor/themes/editor-theme.ts\n *\n * Shadcn/Lexical Editor Documentation: https://shadcn-editor.vercel.app/docs/\n */\n\nimport { EditorThemeClasses } from 'lexical';\n\nimport './editor-theme.css';\n\nexport const editorTheme: EditorThemeClasses = {\n  ltr: 'tw-text-left',\n  rtl: 'tw-text-right',\n  heading: {\n    h1: 'tw-scroll-m-20 tw-text-4xl tw-font-extrabold tw-tracking-tight lg:tw-text-5xl',\n    h2: 'tw-scroll-m-20 tw-border-b tw-pb-2 tw-text-3xl tw-font-semibold tw-tracking-tight first:tw-mt-0',\n    h3: 'tw-scroll-m-20 tw-text-2xl tw-font-semibold tw-tracking-tight',\n    h4: 'tw-scroll-m-20 tw-text-xl tw-font-semibold tw-tracking-tight',\n    h5: 'tw-scroll-m-20 tw-text-lg tw-font-semibold tw-tracking-tight',\n    h6: 'tw-scroll-m-20 tw-text-base tw-font-semibold tw-tracking-tight',\n  },\n  paragraph: 'tw-outline-none',\n  quote: 'tw-mt-6 tw-border-l-2 tw-pl-6 tw-italic',\n  link: 'tw-text-blue-600 hover:tw-underline hover:tw-cursor-pointer',\n  list: {\n    checklist: 'tw-relative',\n    listitem: 'tw-mx-8',\n    listitemChecked:\n      'tw-relative tw-mx-2 tw-px-6 tw-list-none tw-outline-none tw-line-through before:tw-content-[\"\"] before:tw-w-4 before:tw-h-4 before:tw-top-0.5 before:tw-left-0 before:tw-cursor-pointer before:tw-block before:tw-bg-cover before:tw-absolute before:tw-border before:tw-border-primary before:tw-rounded before:tw-bg-primary before:tw-bg-no-repeat after:tw-content-[\"\"] after:tw-cursor-pointer after:tw-border-white after:tw-border-solid after:tw-absolute after:tw-block after:tw-top-[6px] after:tw-w-[3px] after:tw-left-[7px] after:tw-right-[7px] after:tw-h-[6px] after:tw-rotate-45 after:tw-border-r-2 after:tw-border-b-2 after:tw-border-l-0 after:tw-border-t-0',\n    listitemUnchecked:\n      'tw-relative tw-mx-2 tw-px-6 tw-list-none tw-outline-none before:tw-content-[\"\"] before:tw-w-4 before:tw-h-4 before:tw-top-0.5 before:tw-left-0 before:tw-cursor-pointer before:tw-block before:tw-bg-cover before:tw-absolute before:tw-border before:tw-border-primary before:tw-rounded',\n    nested: {\n      listitem: 'tw-list-none before:tw-hidden after:tw-hidden',\n    },\n    ol: 'tw-m-0 tw-p-0 tw-list-decimal [&>li]:tw-mt-2',\n    olDepth: [\n      'tw-list-outside !tw-list-decimal',\n      'tw-list-outside !tw-list-[upper-roman]',\n      'tw-list-outside !tw-list-[lower-roman]',\n      'tw-list-outside !tw-list-[upper-alpha]',\n      'tw-list-outside !tw-list-[lower-alpha]',\n    ],\n    ul: 'tw-m-0 tw-p-0 tw-list-outside [&>li]:tw-mt-2',\n    ulDepth: [\n      'tw-list-outside !tw-list-disc',\n      'tw-list-outside !tw-list-disc',\n      'tw-list-outside !tw-list-disc',\n      'tw-list-outside !tw-list-disc',\n      'tw-list-outside !tw-list-disc',\n    ],\n  },\n  hashtag: 'tw-text-blue-600 tw-bg-blue-100 tw-rounded-md tw-px-1',\n  text: {\n    bold: 'tw-font-bold',\n    code: 'tw-bg-gray-100 tw-p-1 tw-rounded-md',\n    italic: 'tw-italic',\n    strikethrough: 'tw-line-through',\n    subscript: 'tw-sub',\n    superscript: 'tw-sup',\n    underline: 'tw-underline',\n    underlineStrikethrough: 'tw-underline tw-line-through',\n  },\n  image: 'tw-relative tw-inline-block tw-user-select-none tw-cursor-default editor-image',\n  inlineImage:\n    'tw-relative tw-inline-block tw-user-select-none tw-cursor-default inline-editor-image',\n  keyword: 'tw-text-purple-900 tw-font-bold',\n  code: 'EditorTheme__code',\n  codeHighlight: {\n    atrule: 'EditorTheme__tokenAttr',\n    attr: 'EditorTheme__tokenAttr',\n    boolean: 'EditorTheme__tokenProperty',\n    builtin: 'EditorTheme__tokenSelector',\n    cdata: 'EditorTheme__tokenComment',\n    char: 'EditorTheme__tokenSelector',\n    class: 'EditorTheme__tokenFunction',\n    'class-name': 'EditorTheme__tokenFunction',\n    comment: 'EditorTheme__tokenComment',\n    constant: 'EditorTheme__tokenProperty',\n    deleted: 'EditorTheme__tokenProperty',\n    doctype: 'EditorTheme__tokenComment',\n    entity: 'EditorTheme__tokenOperator',\n    function: 'EditorTheme__tokenFunction',\n    important: 'EditorTheme__tokenVariable',\n    inserted: 'EditorTheme__tokenSelector',\n    keyword: 'EditorTheme__tokenAttr',\n    namespace: 'EditorTheme__tokenVariable',\n    number: 'EditorTheme__tokenProperty',\n    operator: 'EditorTheme__tokenOperator',\n    prolog: 'EditorTheme__tokenComment',\n    property: 'EditorTheme__tokenProperty',\n    punctuation: 'EditorTheme__tokenPunctuation',\n    regex: 'EditorTheme__tokenVariable',\n    selector: 'EditorTheme__tokenSelector',\n    string: 'EditorTheme__tokenSelector',\n    symbol: 'EditorTheme__tokenProperty',\n    tag: 'EditorTheme__tokenProperty',\n    url: 'EditorTheme__tokenOperator',\n    variable: 'EditorTheme__tokenVariable',\n  },\n  characterLimit: '!tw-bg-destructive/50',\n  table: 'EditorTheme__table tw-w-fit tw-overflow-scroll tw-border-collapse',\n  tableCell:\n    'EditorTheme__tableCell tw-w-24 tw-relative tw-border tw-px-4 tw-py-2 tw-text-left [&[align=center]]:tw-text-center [&[align=right]]:tw-text-right',\n  tableCellActionButton:\n    'EditorTheme__tableCellActionButton tw-bg-background tw-block tw-border-0 tw-rounded-2xl tw-w-5 tw-h-5 tw-text-foreground tw-cursor-pointer',\n  tableCellActionButtonContainer:\n    'EditorTheme__tableCellActionButtonContainer tw-block tw-right-1 tw-top-1.5 tw-absolute tw-z-10 tw-w-5 tw-h-5',\n  tableCellEditing: 'EditorTheme__tableCellEditing tw-rounded-sm tw-shadow-sm',\n  tableCellHeader:\n    'EditorTheme__tableCellHeader tw-bg-muted tw-border tw-px-4 tw-py-2 tw-text-left tw-font-bold [&[align=center]]:tw-text-center [&[align=right]]:tw-text-right',\n  tableCellPrimarySelected:\n    'EditorTheme__tableCellPrimarySelected tw-border tw-border-primary tw-border-solid tw-block tw-h-[calc(100%-2px)] tw-w-[calc(100%-2px)] tw-absolute tw--left-[1px] tw--top-[1px] tw-z-10 ',\n  tableCellResizer:\n    'EditorTheme__tableCellResizer tw-absolute tw--right-1 tw-h-full tw-w-2 tw-cursor-ew-resize tw-z-10 tw-top-0',\n  tableCellSelected: 'EditorTheme__tableCellSelected tw-bg-muted',\n  tableCellSortedIndicator:\n    'EditorTheme__tableCellSortedIndicator tw-block tw-opacity-50 tw-absolute tw-bottom-0 tw-left-0 tw-w-full tw-h-1 tw-bg-muted',\n  tableResizeRuler:\n    'EditorTheme__tableCellResizeRuler tw-block tw-absolute tw-w-[1px] tw-h-full tw-bg-primary tw-top-0',\n  tableRowStriping: 'EditorTheme__tableRowStriping tw-m-0 tw-border-t tw-p-0 even:tw-bg-muted',\n  tableSelected: 'EditorTheme__tableSelected tw-ring-2 tw-ring-primary tw-ring-offset-2',\n  tableSelection: 'EditorTheme__tableSelection tw-bg-transparent',\n  layoutItem: 'tw-border tw-border-dashed tw-px-4 tw-py-2',\n  layoutContainer: 'tw-grid tw-gap-2.5 tw-my-2.5 tw-mx-0',\n  autocomplete: 'tw-text-muted-foreground',\n  blockCursor: '',\n  embedBlock: {\n    base: 'tw-user-select-none',\n    focus: 'tw-ring-2 tw-ring-primary tw-ring-offset-2',\n  },\n  hr: 'tw-p-0.5 tw-border-none tw-my-1 tw-mx-0 tw-cursor-pointer after:tw-content-[\"\"] after:tw-block after:tw-h-0.5 after:tw-bg-muted selected:tw-ring-2 selected:tw-ring-primary selected:tw-ring-offset-2 selected:tw-user-select-none',\n  indent: '[--lexical-indent-base-value:40px]',\n  mark: '',\n  markOverlap: '',\n};\n","import React from 'react';\nimport * as TooltipPrimitive from '@radix-ui/react-tooltip';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/** @inheritdoc Tooltip */\nconst TooltipProvider = TooltipPrimitive.Provider;\n\n/**\n * Tooltip components provide a popover that displays information related to an element when hovered\n * or focused. These components are built on Radix UI primitives and styled with Shadcn UI. See\n * Shadcn UI Documentation: https://ui.shadcn.com/docs/components/tooltip See Radix UI\n * Documentation: https://www.radix-ui.com/primitives/docs/components/tooltip\n */\nconst Tooltip = TooltipPrimitive.Root;\n\n/** @inheritdoc Tooltip */\nconst TooltipTrigger = TooltipPrimitive.Trigger;\n\n/** @inheritdoc Tooltip */\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      'pr-twp tw-z-50 tw-overflow-hidden tw-rounded-md tw-border tw-bg-popover tw-px-3 tw-py-1.5 tw-text-sm tw-text-popover-foreground tw-shadow-md tw-animate-in tw-fade-in-0 tw-zoom-in-95 data-[state=closed]:tw-animate-out data-[state=closed]:tw-fade-out-0 data-[state=closed]:tw-zoom-out-95 data-[side=bottom]:tw-slide-in-from-top-2 data-[side=left]:tw-slide-in-from-right-2 data-[side=right]:tw-slide-in-from-left-2 data-[side=top]:tw-slide-in-from-bottom-2',\n      className,\n    )}\n    {...props}\n  />\n));\nTooltipContent.displayName = TooltipPrimitive.Content.displayName;\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };\n","/**\n * This file was automatically generated on installation of the Shadcn/Lexical editor. The default\n * location of this file has been changed to integrate better with our project structure.\n *\n * Original file location: src/components/blocks/editor-00/nodes.ts\n *\n * Shadcn/Lexical Editor Documentation: https://shadcn-editor.vercel.app/docs/\n */\n\nimport { HeadingNode, QuoteNode } from '@lexical/rich-text';\nimport { Klass, LexicalNode, LexicalNodeReplacement, ParagraphNode, TextNode } from 'lexical';\n\nexport const nodes: ReadonlyArray<Klass<LexicalNode> | LexicalNodeReplacement> = [\n  HeadingNode,\n  ParagraphNode,\n  TextNode,\n  QuoteNode,\n];\n","'use client';\nimport { createContext, Component, createElement, useContext, useState, useMemo, forwardRef } from 'react';\n\nconst ErrorBoundaryContext = createContext(null);\n\nconst initialState = {\n  didCatch: false,\n  error: null\n};\nclass ErrorBoundary extends Component {\n  constructor(props) {\n    super(props);\n    this.resetErrorBoundary = this.resetErrorBoundary.bind(this);\n    this.state = initialState;\n  }\n  static getDerivedStateFromError(error) {\n    return {\n      didCatch: true,\n      error\n    };\n  }\n  resetErrorBoundary() {\n    const {\n      error\n    } = this.state;\n    if (error !== null) {\n      var _this$props$onReset, _this$props;\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      (_this$props$onReset = (_this$props = this.props).onReset) === null || _this$props$onReset === void 0 ? void 0 : _this$props$onReset.call(_this$props, {\n        args,\n        reason: \"imperative-api\"\n      });\n      this.setState(initialState);\n    }\n  }\n  componentDidCatch(error, info) {\n    var _this$props$onError, _this$props2;\n    (_this$props$onError = (_this$props2 = this.props).onError) === null || _this$props$onError === void 0 ? void 0 : _this$props$onError.call(_this$props2, error, info);\n  }\n  componentDidUpdate(prevProps, prevState) {\n    const {\n      didCatch\n    } = this.state;\n    const {\n      resetKeys\n    } = this.props;\n\n    // There's an edge case where if the thing that triggered the error happens to *also* be in the resetKeys array,\n    // we'd end up resetting the error boundary immediately.\n    // This would likely trigger a second error to be thrown.\n    // So we make sure that we don't check the resetKeys on the first call of cDU after the error is set.\n\n    if (didCatch && prevState.error !== null && hasArrayChanged(prevProps.resetKeys, resetKeys)) {\n      var _this$props$onReset2, _this$props3;\n      (_this$props$onReset2 = (_this$props3 = this.props).onReset) === null || _this$props$onReset2 === void 0 ? void 0 : _this$props$onReset2.call(_this$props3, {\n        next: resetKeys,\n        prev: prevProps.resetKeys,\n        reason: \"keys\"\n      });\n      this.setState(initialState);\n    }\n  }\n  render() {\n    const {\n      children,\n      fallbackRender,\n      FallbackComponent,\n      fallback\n    } = this.props;\n    const {\n      didCatch,\n      error\n    } = this.state;\n    let childToRender = children;\n    if (didCatch) {\n      const props = {\n        error,\n        resetErrorBoundary: this.resetErrorBoundary\n      };\n      if (typeof fallbackRender === \"function\") {\n        childToRender = fallbackRender(props);\n      } else if (FallbackComponent) {\n        childToRender = createElement(FallbackComponent, props);\n      } else if (fallback !== undefined) {\n        childToRender = fallback;\n      } else {\n        throw error;\n      }\n    }\n    return createElement(ErrorBoundaryContext.Provider, {\n      value: {\n        didCatch,\n        error,\n        resetErrorBoundary: this.resetErrorBoundary\n      }\n    }, childToRender);\n  }\n}\nfunction hasArrayChanged() {\n  let a = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let b = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return a.length !== b.length || a.some((item, index) => !Object.is(item, b[index]));\n}\n\nfunction assertErrorBoundaryContext(value) {\n  if (value == null || typeof value.didCatch !== \"boolean\" || typeof value.resetErrorBoundary !== \"function\") {\n    throw new Error(\"ErrorBoundaryContext not found\");\n  }\n}\n\nfunction useErrorBoundary() {\n  const context = useContext(ErrorBoundaryContext);\n  assertErrorBoundaryContext(context);\n  const [state, setState] = useState({\n    error: null,\n    hasError: false\n  });\n  const memoized = useMemo(() => ({\n    resetBoundary: () => {\n      context.resetErrorBoundary();\n      setState({\n        error: null,\n        hasError: false\n      });\n    },\n    showBoundary: error => setState({\n      error,\n      hasError: true\n    })\n  }), [context.resetErrorBoundary]);\n  if (state.hasError) {\n    throw state.error;\n  }\n  return memoized;\n}\n\nfunction withErrorBoundary(component, errorBoundaryProps) {\n  const Wrapped = forwardRef((props, ref) => createElement(ErrorBoundary, errorBoundaryProps, createElement(component, {\n    ...props,\n    ref\n  })));\n\n  // Format for display in DevTools\n  const name = component.displayName || component.name || \"Unknown\";\n  Wrapped.displayName = \"withErrorBoundary(\".concat(name, \")\");\n  return Wrapped;\n}\n\nexport { ErrorBoundary, ErrorBoundaryContext, useErrorBoundary, withErrorBoundary };\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{ErrorBoundary as r}from\"react-error-boundary\";import{jsx as o}from\"react/jsx-runtime\";function n({children:n,onError:e}){return o(r,{fallback:o(\"div\",{style:{border:\"1px solid #f00\",color:\"#f00\",padding:\"8px\"},children:\"An error was thrown.\"}),onError:e,children:n})}export{n as LexicalErrorBoundary};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{useLexicalComposerContext as e}from\"@lexical/react/LexicalComposerContext\";import{useLayoutEffect as n,useEffect as t,useMemo as i,useState as r,useRef as o}from\"react\";const c=\"undefined\"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?n:t;function u(e){return{initialValueFn:()=>e.isEditable(),subscribe:n=>e.registerEditableListener(n)}}function a(){return function(n){const[t]=e(),u=i(()=>n(t),[t,n]),[a,l]=r(()=>u.initialValueFn()),d=o(a);return c(()=>{const{initialValueFn:e,subscribe:n}=u,t=e();return d.current!==t&&(d.current=t,l(t)),n(e=>{d.current=e,l(e)})},[u,n]),a}(u)}export{a as useLexicalEditable};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{$isTextNode as e,$getEditor as t,$isRootNode as n,$isElementNode as o,$getNodeByKey as l,$getPreviousSelection as r,$createTextNode as s,$isRangeSelection as i,$getSelection as c,$caretRangeFromSelection as f,$isTokenOrSegmented as u,$getCharacterOffsets as g,$cloneWithPropertiesEphemeral as a,$createRangeSelection as d,$findMatchingParent as p,INTERNAL_$isBlock as h,$setSelection as y,$caretFromPoint as m,$isExtendableTextPointCaret as S,$extendCaretToRange as x,$isChildCaret as T,$isDecoratorNode as w,$isRootOrShadowRoot as N,$hasAncestor as v,$isLeafNode as C}from\"lexical\";export{$cloneWithProperties,$selectAll}from\"lexical\";function K(e,...t){const n=new URL(\"https://lexical.dev/docs/error\"),o=new URLSearchParams;o.append(\"code\",e);for(const e of t)o.append(\"v\",e);throw n.search=o.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const E=new Map;function P(e){let t=e;for(;null!=t;){if(t.nodeType===Node.TEXT_NODE)return t;t=t.firstChild}return null}function k(e){const t=e.parentNode;if(null==t)throw new Error(\"Should never happen\");return[t,Array.from(t.childNodes).indexOf(e)]}function I(t,n,o,l,r){const s=n.getKey(),i=l.getKey(),c=document.createRange();let f=t.getElementByKey(s),u=t.getElementByKey(i),g=o,a=r;if(e(n)&&(f=P(f)),e(l)&&(u=P(u)),void 0===n||void 0===l||null===f||null===u)return null;\"BR\"===f.nodeName&&([f,g]=k(f)),\"BR\"===u.nodeName&&([u,a]=k(u));const d=f.firstChild;f===u&&null!=d&&\"BR\"===d.nodeName&&0===g&&0===a&&(a=1);try{c.setStart(f,g),c.setEnd(u,a)}catch(e){return null}return!c.collapsed||g===a&&s===i||(c.setStart(u,a),c.setEnd(f,g)),c}function B(e,t){const n=e.getRootElement();if(null===n)return[];const o=n.getBoundingClientRect(),l=getComputedStyle(n),r=parseFloat(l.paddingLeft)+parseFloat(l.paddingRight),s=Array.from(t.getClientRects());let i,c=s.length;s.sort((e,t)=>{const n=e.top-t.top;return Math.abs(n)<=3?e.left-t.left:n});for(let e=0;e<c;e++){const t=s[e],n=i&&i.top<=t.top&&i.top+i.height>t.top&&i.left+i.width>t.left,l=t.width+r===o.width;n||l?(s.splice(e--,1),c--):i=t}return s}function F(e){const t={};if(!e)return t;const n=e.split(\";\");for(const e of n)if(\"\"!==e){const[n,o]=e.split(/:([^]+)/);n&&o&&(t[n.trim()]=o.trim())}return t}function b(e){let t=E.get(e);return void 0===t&&(t=F(e),E.set(e,t)),t}function R(e){let t=\"\";for(const n in e)n&&(t+=`${n}: ${e[n]};`);return t}function z(e){const n=t().getElementByKey(e.getKey());if(null===n)return null;const o=n.ownerDocument.defaultView;return null===o?null:o.getComputedStyle(n)}function O(e){return z(n(e)?e:e.getParentOrThrow())}function A(e){const t=O(e);return null!==t&&\"rtl\"===t.direction}function M(e,t,n=\"self\"){const o=e.getStartEndPoints();if(t.isSelected(e)&&!u(t)&&null!==o){const[l,r]=o,s=e.isBackward(),i=l.getNode(),c=r.getNode(),f=t.is(i),u=t.is(c);if(f||u){const[o,l]=g(e),r=i.is(c),f=t.is(s?c:i),u=t.is(s?i:c);let d,p=0;if(r)p=o>l?l:o,d=o>l?o:l;else if(f){p=s?l:o,d=void 0}else if(u){p=0,d=s?o:l}const h=t.__text.slice(p,d);h!==t.__text&&(\"clone\"===n&&(t=a(t)),t.__text=h)}}return t}function _(e){if(\"text\"===e.type)return e.offset===e.getNode().getTextContentSize();const t=e.getNode();return o(t)||K(177),e.offset===t.getChildrenSize()}function L(t,c,f){let u=c.getNode(),g=f;if(o(u)){const e=u.getDescendantByIndex(c.offset);null!==e&&(u=e)}for(;g>0&&null!==u;){if(o(u)){const e=u.getLastDescendant();null!==e&&(u=e)}let f=u.getPreviousSibling(),a=0;if(null===f){let e=u.getParentOrThrow(),t=e.getPreviousSibling();for(;null===t;){if(e=e.getParent(),null===e){f=null;break}t=e.getPreviousSibling()}null!==e&&(a=e.isInline()?0:2,f=t)}let d=u.getTextContent();\"\"===d&&o(u)&&!u.isInline()&&(d=\"\\n\\n\");const p=d.length;if(!e(u)||g>=p){const e=u.getParent();u.remove(),null==e||0!==e.getChildrenSize()||n(e)||e.remove(),g-=p+a,u=f}else{const n=u.getKey(),o=t.getEditorState().read(()=>{const t=l(n);return e(t)&&t.isSimpleText()?t.getTextContent():null}),f=p-g,a=d.slice(0,f);if(null!==o&&o!==d){const e=r();let t=u;if(u.isSimpleText())u.setTextContent(o);else{const e=s(o);u.replace(e),t=e}if(i(e)&&e.isCollapsed()){const n=e.anchor.offset;t.select(n,n)}}else if(u.isSimpleText()){const e=c.key===n;let t=c.offset;t<g&&(t=p);const o=e?t-g:0,l=e?t:f;if(e&&0===o){const[e]=u.splitText(o,l);e.remove()}else{const[,e]=u.splitText(o,l);e.remove()}}else{const e=s(a);u.replace(e)}g=0}}}function $(e){const t=e.getStyle(),n=F(t);E.set(t,n)}function D(t,n){(i(t)?t.isCollapsed():e(t)||o(t))||K(280);const l=b(i(t)?t.style:e(t)?t.getStyle():t.getTextStyle()),r=Object.entries(n).reduce((e,[n,o])=>(\"function\"==typeof o?e[n]=o(l[n],t):null===o?delete e[n]:e[n]=o,e),{...l}),s=R(r);i(t)||e(t)?t.setStyle(s):t.setTextStyle(s),E.set(s,r)}function U(e,t){if(i(e)&&e.isCollapsed()){D(e,t);const n=e.anchor.getNode();o(n)&&n.isEmpty()&&D(n,t)}j(e=>{D(e,t)});const n=e.getNodes();if(n.length>0){const e=new Set;for(const l of n){if(!o(l)||!l.canBeEmpty()||0!==l.getChildrenSize())continue;const n=l.getKey();e.has(n)||(e.add(n),D(l,t))}}}function j(t){const n=c();if(!n)return;const o=new Map,l=e=>o.get(e.getKey())||[0,e.getTextContentSize()];if(i(n))for(const e of f(n).getTextSlices())e&&o.set(e.caret.origin.getKey(),e.getSliceIndices());const r=n.getNodes();for(const n of r){if(!e(n)||!n.canHaveFormat())continue;const[o,r]=l(n);if(r!==o)if(u(n)||0===o&&r===n.getTextContentSize())t(n);else{t(n.splitText(o,r)[0===o?0:1])}}i(n)&&\"text\"===n.anchor.type&&\"text\"===n.focus.type&&n.anchor.key===n.focus.key&&H(n)}function H(e){if(e.isBackward()){const{anchor:t,focus:n}=e,{key:o,offset:l,type:r}=t;t.set(n.key,n.offset,n.type),n.set(o,l,r)}}function V(e,t){const n=e.getFormatType(),o=e.getIndent();n!==t.getFormatType()&&t.setFormat(n),o!==t.getIndent()&&t.setIndent(o)}function W(e,t,n=V){if(null===e)return;const l=e.getStartEndPoints(),r=new Map;let s=null;if(l){const[e,t]=l;s=d(),s.anchor.set(e.key,e.offset,e.type),s.focus.set(t.key,t.offset,t.type);const n=p(e.getNode(),h),i=p(t.getNode(),h);o(n)&&r.set(n.getKey(),n),o(i)&&r.set(i.getKey(),i)}for(const t of e.getNodes())if(o(t)&&h(t))r.set(t.getKey(),t);else if(null===l){const e=p(t,h);o(e)&&r.set(e.getKey(),e)}for(const[e,o]of r){const l=t();n(o,l),o.replace(l,!0),s&&(e===s.anchor.key&&s.anchor.set(l.getKey(),s.anchor.offset,s.anchor.type),e===s.focus.key&&s.focus.set(l.getKey(),s.focus.offset,s.focus.type))}s&&e.is(c())&&y(s)}function X(e){return e.getNode().isAttached()}function q(e){let t=e;for(;null!==t&&!N(t);){const e=t.getLatest(),n=t.getParent();0===e.getChildrenSize()&&t.remove(!0),t=n}}function G(e,t,n=null){const o=e.getStartEndPoints(),l=o?o[0]:null,r=e.getNodes(),s=r.length;if(null!==l&&(0===s||1===s&&\"element\"===l.type&&0===l.getNode().getChildrenSize())){const e=\"text\"===l.type?l.getNode().getParentOrThrow():l.getNode(),o=e.getChildren();let r=t();return r.setFormat(e.getFormatType()),r.setIndent(e.getIndent()),o.forEach(e=>r.append(e)),n&&(r=n.append(r)),void e.replace(r)}let i=null,c=[];for(let o=0;o<s;o++){const l=r[o];N(l)?(J(e,c,c.length,t,n),c=[],i=l):null===i||null!==i&&v(l,i)?c.push(l):(J(e,c,c.length,t,n),c=[l])}J(e,c,c.length,t,n)}function J(e,t,n,l,s=null){if(0===t.length)return;const c=t[0],f=new Map,u=[];let g=o(c)?c:c.getParentOrThrow();g.isInline()&&(g=g.getParentOrThrow());let a=!1;for(;null!==g;){const e=g.getPreviousSibling();if(null!==e){g=e,a=!0;break}if(g=g.getParentOrThrow(),N(g))break}const d=new Set;for(let e=0;e<n;e++){const n=t[e];o(n)&&0===n.getChildrenSize()&&d.add(n.getKey())}const p=new Set;for(let e=0;e<n;e++){const n=t[e];let r=n.getParent();if(null!==r&&r.isInline()&&(r=r.getParent()),null!==r&&C(n)&&!p.has(n.getKey())){const e=r.getKey();if(void 0===f.get(e)){const t=l();t.setFormat(r.getFormatType()),t.setIndent(r.getIndent()),u.push(t),f.set(e,t),r.getChildren().forEach(e=>{t.append(e),p.add(e.getKey()),o(e)&&e.getChildrenKeys().forEach(e=>p.add(e))}),q(r)}}else if(d.has(n.getKey())){o(n)||K(179);const e=l();e.setFormat(n.getFormatType()),e.setIndent(n.getIndent()),u.push(e),n.remove(!0)}}if(null!==s)for(let e=0;e<u.length;e++){const t=u[e];s.append(t)}let h=null;if(N(g))if(a)if(null!==s)g.insertAfter(s);else for(let e=u.length-1;e>=0;e--){const t=u[e];g.insertAfter(t)}else{const e=g.getFirstChild();if(o(e)&&(g=e),null===e)if(s)g.append(s);else for(let e=0;e<u.length;e++){const t=u[e];g.append(t),h=t}else if(null!==s)e.insertBefore(s);else for(let t=0;t<u.length;t++){const n=u[t];e.insertBefore(n),h=n}}else if(s)g.insertAfter(s);else for(let e=u.length-1;e>=0;e--){const t=u[e];g.insertAfter(t),h=t}const m=r();i(m)&&X(m.anchor)&&X(m.focus)?y(m.clone()):null!==h?h.selectEnd():e.dirty=!0}function Q(e){const t=Y(e);return null!==t&&\"vertical-rl\"===t.writingMode}function Y(e){const t=e.anchor.getNode();return o(t)?z(t):O(t)}function Z(e,t){let n=Q(e)?!t:t;te(e)&&(n=!n);const l=m(e.focus,n?\"previous\":\"next\");if(S(l))return!1;for(const e of x(l)){if(T(e))return!e.origin.isInline();if(!o(e.origin)){if(w(e.origin))return!0;break}}return!1}function ee(e,t,n,o){e.modify(t?\"extend\":\"move\",n,o)}function te(e){const t=Y(e);return null!==t&&\"rtl\"===t.direction}function ne(e,t,n){const o=te(e);let l;l=Q(e)||o?!n:n,ee(e,t,l,\"character\")}function oe(e,t,n){const o=b(e.getStyle());return null!==o&&o[t]||n}function le(t,n,o=\"\"){let l=null;const r=t.getNodes(),s=t.anchor,c=t.focus,f=t.isBackward(),u=f?c.offset:s.offset,g=f?c.getNode():s.getNode();if(i(t)&&t.isCollapsed()&&\"\"!==t.style){const e=b(t.style);if(null!==e&&n in e)return e[n]}for(let t=0;t<r.length;t++){const s=r[t];if((0===t||0!==u||!s.is(g))&&e(s)){const e=oe(s,n,o);if(null===l)l=e;else if(l!==e){l=\"\";break}}}return null===l?o:l}const re=L;export{$ as $addNodeStyle,V as $copyBlockFormatIndent,H as $ensureForwardRangeSelection,j as $forEachSelectedTextNode,z as $getComputedStyleForElement,O as $getComputedStyleForParent,le as $getSelectionStyleValueForProperty,_ as $isAtNodeEnd,te as $isParentElementRTL,A as $isParentRTL,ee as $moveCaretSelection,ne as $moveCharacter,U as $patchStyleText,W as $setBlocksType,Z as $shouldOverrideDefaultCharacterSelection,M as $sliceSelectedTextNodeContent,L as $trimTextContentFromAnchor,G as $wrapNodes,I as createDOMRange,B as createRectsFromDOMRange,R as getCSSFromStyleObject,b as getStyleObjectFromCSS,re as trimTextContentFromAnchor};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{isHTMLElement as t,mergeRegister as e,$getSelection as n,$isRangeSelection as o,$isElementNode as r,getDOMTextNode as i,$getAdjacentSiblingOrParentSiblingCaret as l,$getSiblingCaret as u,$getChildCaretOrSelf as s,$findMatchingParent as c,$cloneWithProperties as a,$setSelection as d,$getPreviousSelection as f,$caretFromPoint as g,$getChildCaret as p,$getRoot as m,$createParagraphNode as h,$getAdjacentChildCaret as v,$isChildCaret as y,$normalizeCaret as w,$setSelectionFromCaretRange as E,$getCollapsedCaretRange as x,$getCaretInDirection as S,$splitAtPointCaretNext as C,$isTextPointCaret as A,$rewindSiblingCaret as b,$getState as N,$setState as P,makeStepwiseIterator as L,$isSiblingCaret as M}from\"lexical\";export{$findMatchingParent,$getAdjacentSiblingOrParentSiblingCaret,$splitNode,addClassNamesToElement,isBlockDomNode,isHTMLAnchorElement,isHTMLElement,isInlineDomNode,mergeRegister,removeClassNamesFromElement}from\"lexical\";import{createRectsFromDOMRange as R}from\"@lexical/selection\";function T(t,...e){const n=new URL(\"https://lexical.dev/docs/error\"),o=new URLSearchParams;o.append(\"code\",t);for(const t of e)o.append(\"v\",t);throw n.search=o.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const B=\"undefined\"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,_=B&&\"documentMode\"in document?document.documentMode:null,k=B&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),$=B&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),K=!(!B||!(\"InputEvent\"in window)||_)&&\"getTargetRanges\"in new window.InputEvent(\"input\"),O=B&&/Version\\/[\\d.]+.*Safari/.test(navigator.userAgent),H=B&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,j=B&&/Android/.test(navigator.userAgent),D=B&&/^(?=.*Chrome).*/i.test(navigator.userAgent),F=B&&j&&D,I=B&&/AppleWebKit\\/[\\d.]+/.test(navigator.userAgent)&&k&&!D;function U(t){return`${t}px`}const z={attributes:!0,characterData:!0,childList:!0,subtree:!0};function V(e,n,o){let r=null,i=null,l=null,u=[];const s=document.createElement(\"div\");function c(){null===r&&T(182),null===i&&T(183);const{left:t,top:l}=i.getBoundingClientRect(),c=R(e,n);var a,d;s.isConnected||(d=s,(a=i).insertBefore(d,a.firstChild));let f=!1;for(let e=0;e<c.length;e++){const n=c[e],o=u[e]||document.createElement(\"div\"),r=o.style;\"absolute\"!==r.position&&(r.position=\"absolute\",f=!0);const i=U(n.left-t);r.left!==i&&(r.left=i,f=!0);const a=U(n.top-l);r.top!==a&&(o.style.top=a,f=!0);const d=U(n.width);r.width!==d&&(o.style.width=d,f=!0);const g=U(n.height);r.height!==g&&(o.style.height=g,f=!0),o.parentNode!==s&&(s.append(o),f=!0),u[e]=o}for(;u.length>c.length;)u.pop();f&&o(u)}function a(){i=null,r=null,null!==l&&l.disconnect(),l=null,s.remove();for(const t of u)t.remove();u=[]}s.style.position=\"relative\";const d=e.registerRootListener(function n(){const o=e.getRootElement();if(null===o)return a();const u=o.parentElement;if(!t(u))return a();a(),r=o,i=u,l=new MutationObserver(t=>{const o=e.getRootElement(),l=o&&o.parentElement;if(o!==r||l!==i)return n();for(const e of t)if(!s.contains(e.target))return c()}),l.observe(u,z),c()});return()=>{d(),a()}}function W(t,e,n){if(\"text\"!==t.type&&r(e)){const o=e.getDOMSlot(n);return[o.element,o.getFirstChildOffset()+t.offset]}return[i(n)||n,t.offset]}function G(t,r){let i=null,l=null,u=null,s=null,c=null,a=null,d=()=>{};function f(e){e.read(()=>{const e=n();if(!o(e))return i=null,u=null,s=null,a=null,d(),void(d=()=>{});const[f,g]=function(t){const e=t.getStartEndPoints();return t.isBackward()?[e[1],e[0]]:e}(e),p=f.getNode(),m=p.getKey(),h=f.offset,v=g.getNode(),y=v.getKey(),w=g.offset,E=t.getElementByKey(m),x=t.getElementByKey(y),S=null===i||E!==l||h!==u||m!==i.getKey(),C=null===s||x!==c||w!==a||y!==s.getKey();if((S||C)&&null!==E&&null!==x){const e=function(t,e,n,o,r,i,l){const u=(t._window?t._window.document:document).createRange();return u.setStart(...W(e,n,o)),u.setEnd(...W(r,i,l)),u}(t,f,p,E,g,v,x);d(),d=V(t,e,t=>{if(void 0===r)for(const e of t){const t=e.style;\"Highlight\"!==t.background&&(t.background=\"Highlight\"),\"HighlightText\"!==t.color&&(t.color=\"HighlightText\"),t.marginTop!==U(-1.5)&&(t.marginTop=U(-1.5)),t.paddingTop!==U(4)&&(t.paddingTop=U(4)),t.paddingBottom!==U(0)&&(t.paddingBottom=U(0))}else r(t)})}i=p,l=E,u=h,s=v,c=x,a=w})}return f(t.getEditorState()),e(t.registerUpdateListener(({editorState:t})=>f(t)),()=>{d()})}function q(t,e){let n=null;const o=()=>{const o=getSelection(),r=o&&o.anchorNode,i=t.getRootElement();null!==r&&null!==i&&i.contains(r)?null!==n&&(n(),n=null):null===n&&(n=G(t,e))};return document.addEventListener(\"selectionchange\",o),()=>{null!==n&&n(),document.removeEventListener(\"selectionchange\",o)}}const J=K,Q=B,X=j,Y=F,Z=k,tt=I,et=D,nt=$,ot=H,rt=O;function it(t,e){for(const n of e)if(t.type.startsWith(n))return!0;return!1}function lt(t,e){const n=t[Symbol.iterator]();return new Promise((t,o)=>{const r=[],i=()=>{const{done:l,value:u}=n.next();if(l)return t(r);const s=new FileReader;s.addEventListener(\"error\",o),s.addEventListener(\"load\",()=>{const t=s.result;\"string\"==typeof t&&r.push({file:u,result:t}),i()}),it(u,e)?s.readAsDataURL(u):i()};i()})}function ut(t,e){return Array.from(at(t,e))}function st(t){return t?t.getAdjacentCaret():null}function ct(t,e){return Array.from(ht(t,e))}function at(t,e){return ft(\"next\",t,e)}function dt(t,e){const n=l(u(t,e));return n&&n[0]}function ft(t,e,n){const o=m(),i=e||o,c=r(i)?p(i,t):u(i,t),a=pt(i),d=n?v(s(u(n,t)))||dt(n,t):dt(i,t);let f=a;return L({hasNext:t=>null!==t,initial:c,map:t=>({depth:f,node:t.origin}),step:t=>{if(t.isSameNodeCaret(d))return null;y(t)&&f++;const e=l(t);return!e||e[0].isSameNodeCaret(d)?null:(f+=e[1],e[0])}})}function gt(t){const e=l(u(t,\"next\"));return e&&[e[0].origin,e[1]]}function pt(t){let e=-1;for(let n=t;null!==n;n=n.getParent())e++;return e}function mt(t){const e=s(u(t,\"previous\")),n=l(e,\"root\");return n&&n[0].origin}function ht(t,e){return ft(\"previous\",t,e)}function vt(t,e){let n=t;for(;null!=n;){if(n instanceof e)return n;n=n.getParent()}return null}function yt(t){const e=c(t,t=>r(t)&&!t.isInline());return r(e)||T(4,t.__key),e}function wt(t,e,n,o){const r=t=>t instanceof e;return t.registerNodeTransform(e,t=>{const e=(t=>{const e=t.getChildren();for(let t=0;t<e.length;t++){const n=e[t];if(r(n))return null}let n=t,o=t;for(;null!==n;)if(o=n,n=n.getParent(),r(n))return{child:o,parent:n};return null})(t);if(null!==e){const{child:r,parent:i}=e;if(r.is(t)){o(i,t);const e=r.getNextSiblings(),l=e.length;if(i.insertAfter(r),0!==l){const t=n(i);r.insertAfter(t);for(let n=0;n<l;n++)t.append(e[n])}i.canBeEmpty()||0!==i.getChildrenSize()||i.remove()}}})}function Et(t,e){const n=new Map,o=t._pendingEditorState;for(const[t,o]of e._nodeMap)n.set(t,a(o));o&&(o._nodeMap=n),t._dirtyType=2;const r=e._selection;d(null===r?null:r.clone())}function xt(t){const e=n()||f();let r;if(o(e))r=g(e.focus,\"next\");else{if(null!=e){const t=e.getNodes(),n=t[t.length-1];n&&(r=u(n,\"next\"))}r=r||p(m(),\"previous\").getFlipped().insert(h())}const i=St(t,r),l=v(i),s=y(l)?w(l):i;return E(x(s)),t.getLatest()}function St(t,e,n){let o=S(e,\"next\");for(let t=o;t;t=C(t,n))o=t;return A(o)&&T(283),o.insert(t.isInline()?h().append(t):t),S(u(t.getLatest(),\"next\"),e.direction)}function Ct(t,e){const n=e();return t.replace(n),n.append(t),n}function At(t,e){return null!==t&&Object.getPrototypeOf(t).constructor.name===e.name}function bt(t,e){const n=[];for(let o=0;o<t.length;o++){const r=e(t[o]);null!==r&&n.push(r)}return n}function Nt(t,e){p(t,\"next\").insert(e)}let Pt=!(nt||!Q)&&void 0;function Lt(t,e=!1){let n=1;if(function(){if(void 0===Pt){const t=document.createElement(\"div\");t.style.cssText=\"position: absolute; opacity: 0; width: 100px; left: -1000px;\",document.body.appendChild(t);const e=t.getBoundingClientRect();t.style.setProperty(\"zoom\",\"2\"),Pt=t.getBoundingClientRect().width===e.width,document.body.removeChild(t)}return Pt}()||e)for(;t;)n*=Number(window.getComputedStyle(t).getPropertyValue(\"zoom\")),t=t.parentElement;return n}function Mt(t){return null!==t._parentEditor}function Rt(t,e){return Tt(t,e,null)}function Tt(t,e,n){let o=!1;for(const i of kt(t))e(i)?null!==n&&n(i):(o=!0,r(i)&&Tt(i,e,n||(t=>i.insertAfter(t))),i.remove());return o}function Bt(t,e){const n=[],o=Array.from(t).reverse();for(let t=o.pop();void 0!==t;t=o.pop())if(e(t))n.push(t);else if(r(t))for(const e of kt(t))o.push(e);return n}function _t(t){return $t(p(t,\"next\"))}function kt(t){return $t(p(t,\"previous\"))}function $t(t){return L({hasNext:M,initial:t.getAdjacentCaret(),map:t=>t.origin.getLatest(),step:t=>t.getAdjacentCaret()})}function Kt(t){b(u(t,\"next\")).splice(1,t.getChildren())}function Ot(t){const e=e=>N(e,t),n=(e,n)=>P(e,t,n);return{$get:e,$set:n,accessors:[e,n],makeGetterMethod:()=>function(){return e(this)},makeSetterMethod:()=>function(t){return n(this,t)},stateConfig:t}}export{Bt as $descendantsMatching,ut as $dfs,at as $dfsIterator,bt as $filter,_t as $firstToLastIterator,st as $getAdjacentCaret,pt as $getDepth,yt as $getNearestBlockElementAncestorOrThrow,vt as $getNearestNodeOfType,mt as $getNextRightPreorderNode,gt as $getNextSiblingOrParentSibling,Nt as $insertFirst,xt as $insertNodeToNearestRoot,St as $insertNodeToNearestRootAtCaret,Mt as $isEditorIsNestedEditor,kt as $lastToFirstIterator,Et as $restoreEditorState,ct as $reverseDfs,ht as $reverseDfsIterator,Rt as $unwrapAndFilterDescendants,Kt as $unwrapNode,Ct as $wrapNodeInElement,J as CAN_USE_BEFORE_INPUT,Q as CAN_USE_DOM,X as IS_ANDROID,Y as IS_ANDROID_CHROME,Z as IS_APPLE,tt as IS_APPLE_WEBKIT,et as IS_CHROME,nt as IS_FIREFOX,ot as IS_IOS,rt as IS_SAFARI,Lt as calculateZoomLevel,it as isMimeType,Ot as makeStateWrapper,G as markSelection,lt as mediaFileReader,At as objectKlassEquals,V as positionNodeOnRange,wt as registerNestedElementResolver,q as selectionAlwaysOnDisplay};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{defineExtension as t,safeCast as e,CLEAR_EDITOR_COMMAND as n,COMMAND_PRIORITY_EDITOR as i,$getRoot as o,$getSelection as s,$createParagraphNode as r,$isRangeSelection as c,shallowMergeConfig as d,RootNode as a,TextNode as f,LineBreakNode as u,TabNode as h,ParagraphNode as l,$isEditorState as g,HISTORY_MERGE_TAG as p,createEditor as m,mergeRegister as v,$getNodeByKey as x,createCommand as y,$create as S,CLICK_COMMAND as E,isDOMNode as b,$getNodeFromDOMNode as w,COMMAND_PRIORITY_LOW as N,DecoratorNode as O,addClassNamesToElement as R,$isNodeSelection as M,$createNodeSelection as C,$setSelection as D,removeClassNamesFromElement as _,KEY_TAB_COMMAND as I,OUTDENT_CONTENT_COMMAND as j,INDENT_CONTENT_COMMAND as A,INSERT_TAB_COMMAND as P,COMMAND_PRIORITY_CRITICAL as K,$isBlockElementNode as k,$createRangeSelection as $,$normalizeSelection__EXPERIMENTAL as z}from\"lexical\";export{configExtension,declarePeerDependency,defineExtension,safeCast,shallowMergeConfig}from\"lexical\";import{$getNearestBlockElementAncestorOrThrow as U}from\"@lexical/utils\";const L=Symbol.for(\"preact-signals\");function T(){if(W>1)return void W--;let t,e=!1;for(;void 0!==G;){let n=G;for(G=void 0,Z++;void 0!==n;){const i=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&X(n))try{n.c()}catch(n){e||(t=n,e=!0)}n=i}}if(Z=0,W--,e)throw t}function B(t){if(W>0)return t();W++;try{return t()}finally{T()}}let F,G;function V(t){const e=F;F=void 0;try{return t()}finally{F=e}}let W=0,Z=0,J=0;function H(t){if(void 0===F)return;let e=t.n;return void 0===e||e.t!==F?(e={i:0,S:t,p:F.s,n:void 0,t:F,e:void 0,x:void 0,r:e},void 0!==F.s&&(F.s.n=e),F.s=e,t.n=e,32&F.f&&t.S(e),e):-1===e.i?(e.i=0,void 0!==e.n&&(e.n.p=e.p,void 0!==e.p&&(e.p.n=e.n),e.p=F.s,e.n=void 0,F.s.n=e,F.s=e),e):void 0}function q(t,e){this.v=t,this.i=0,this.n=void 0,this.t=void 0,this.W=null==e?void 0:e.watched,this.Z=null==e?void 0:e.unwatched,this.name=null==e?void 0:e.name}function Q(t,e){return new q(t,e)}function X(t){for(let e=t.s;void 0!==e;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function Y(t){for(let e=t.s;void 0!==e;e=e.n){const n=e.S.n;if(void 0!==n&&(e.r=n),e.S.n=e,e.i=-1,void 0===e.n){t.s=e;break}}}function tt(t){let e,n=t.s;for(;void 0!==n;){const t=n.p;-1===n.i?(n.S.U(n),void 0!==t&&(t.n=n.n),void 0!==n.n&&(n.n.p=t)):e=n,n.S.n=n.r,void 0!==n.r&&(n.r=void 0),n=t}t.s=e}function et(t,e){q.call(this,void 0),this.x=t,this.s=void 0,this.g=J-1,this.f=4,this.W=null==e?void 0:e.watched,this.Z=null==e?void 0:e.unwatched,this.name=null==e?void 0:e.name}function nt(t,e){return new et(t,e)}function it(t){const e=t.u;if(t.u=void 0,\"function\"==typeof e){W++;const n=F;F=void 0;try{e()}catch(e){throw t.f&=-2,t.f|=8,ot(t),e}finally{F=n,T()}}}function ot(t){for(let e=t.s;void 0!==e;e=e.n)e.S.U(e);t.x=void 0,t.s=void 0,it(t)}function st(t){if(F!==this)throw new Error(\"Out-of-order effect\");tt(this),F=t,this.f&=-2,8&this.f&&ot(this),T()}function rt(t,e){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=null==e?void 0:e.name}function ct(t,e){const n=new rt(t,e);try{n.c()}catch(t){throw n.d(),t}const i=n.d.bind(n);return i[Symbol.dispose]=i,i}function dt(t,e={}){const n={};for(const i in t){const o=e[i],s=Q(void 0===o?t[i]:o);n[i]=s}return n}q.prototype.brand=L,q.prototype.h=function(){return!0},q.prototype.S=function(t){const e=this.t;e!==t&&void 0===t.e&&(t.x=e,this.t=t,void 0!==e?e.e=t:V(()=>{var t;null==(t=this.W)||t.call(this)}))},q.prototype.U=function(t){if(void 0!==this.t){const e=t.e,n=t.x;void 0!==e&&(e.x=n,t.e=void 0),void 0!==n&&(n.e=e,t.x=void 0),t===this.t&&(this.t=n,void 0===n&&V(()=>{var t;null==(t=this.Z)||t.call(this)}))}},q.prototype.subscribe=function(t){return ct(()=>{const e=this.value,n=F;F=void 0;try{t(e)}finally{F=n}},{name:\"sub\"})},q.prototype.valueOf=function(){return this.value},q.prototype.toString=function(){return this.value+\"\"},q.prototype.toJSON=function(){return this.value},q.prototype.peek=function(){const t=F;F=void 0;try{return this.value}finally{F=t}},Object.defineProperty(q.prototype,\"value\",{get(){const t=H(this);return void 0!==t&&(t.i=this.i),this.v},set(t){if(t!==this.v){if(Z>100)throw new Error(\"Cycle detected\");this.v=t,this.i++,J++,W++;try{for(let t=this.t;void 0!==t;t=t.x)t.t.N()}finally{T()}}}}),et.prototype=new q,et.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if(32==(36&this.f))return!0;if(this.f&=-5,this.g===J)return!0;if(this.g=J,this.f|=1,this.i>0&&!X(this))return this.f&=-2,!0;const t=F;try{Y(this),F=this;const t=this.x();(16&this.f||this.v!==t||0===this.i)&&(this.v=t,this.f&=-17,this.i++)}catch(t){this.v=t,this.f|=16,this.i++}return F=t,tt(this),this.f&=-2,!0},et.prototype.S=function(t){if(void 0===this.t){this.f|=36;for(let t=this.s;void 0!==t;t=t.n)t.S.S(t)}q.prototype.S.call(this,t)},et.prototype.U=function(t){if(void 0!==this.t&&(q.prototype.U.call(this,t),void 0===this.t)){this.f&=-33;for(let t=this.s;void 0!==t;t=t.n)t.S.U(t)}},et.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(let t=this.t;void 0!==t;t=t.x)t.t.N()}},Object.defineProperty(et.prototype,\"value\",{get(){if(1&this.f)throw new Error(\"Cycle detected\");const t=H(this);if(this.h(),void 0!==t&&(t.i=this.i),16&this.f)throw this.v;return this.v}}),rt.prototype.c=function(){const t=this.S();try{if(8&this.f)return;if(void 0===this.x)return;const t=this.x();\"function\"==typeof t&&(this.u=t)}finally{t()}},rt.prototype.S=function(){if(1&this.f)throw new Error(\"Cycle detected\");this.f|=1,this.f&=-9,it(this),Y(this),W++;const t=F;return F=this,st.bind(this,t)},rt.prototype.N=function(){2&this.f||(this.f|=2,this.o=G,G=this)},rt.prototype.d=function(){this.f|=8,1&this.f||ot(this)},rt.prototype.dispose=function(){this.d()};const at=t({build:(t,e,n)=>dt(e),config:e({defaultSelection:\"rootEnd\",disabled:!1}),name:\"@lexical/extension/AutoFocus\",register(t,e,n){const i=n.getOutput();return ct(()=>i.disabled.value?void 0:t.registerRootListener(e=>{t.focus(()=>{const t=document.activeElement;null===e||null!==t&&e.contains(t)||e.focus({preventScroll:!0})},{defaultSelection:i.defaultSelection.peek()})}))}});function ft(){const t=o(),e=s(),n=r();t.clear(),t.append(n),null!==e&&n.select(),c(e)&&(e.format=0)}function ut(t,e=ft){return t.registerCommand(n,n=>(t.update(e),!0),i)}const ht=t({build:(t,e,n)=>dt(e),config:e({$onClear:ft}),name:\"@lexical/extension/ClearEditor\",register(t,e,n){const{$onClear:i}=n.getOutput();return ct(()=>ut(t,i.value))}});function lt(t){const e=new Set,n=new Set;for(const i of gt(t)){const t=\"function\"==typeof i?i:i.replace;e.add(t.getType()),n.add(t)}return{nodes:n,types:e}}function gt(t){return(\"function\"==typeof t.nodes?t.nodes():t.nodes)||[]}function pt(t,e){let n;return Q(t(),{unwatched(){n&&(n(),n=void 0)},watched(){this.value=t(),n=e(this)}})}const mt=t({build:t=>pt(()=>t.getEditorState(),e=>t.registerUpdateListener(t=>{e.value=t.editorState})),name:\"@lexical/extension/EditorState\"});function vt(t,...e){const n=new URL(\"https://lexical.dev/docs/error\"),i=new URLSearchParams;i.append(\"code\",t);for(const t of e)i.append(\"v\",t);throw n.search=i.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function xt(t,e){if(t&&e&&!Array.isArray(e)&&\"object\"==typeof t&&\"object\"==typeof e){const n=t,i=e;for(const t in i)n[t]=xt(n[t],i[t]);return t}return e}const yt=0,St=1,Et=2,bt=3,wt=4,Nt=5,Ot=6,Rt=7;function Mt(t){return t.id===yt}function Ct(t){return t.id===Et}function Dt(t){return function(t){return t.id===St}(t)||vt(305,String(t.id),String(St)),Object.assign(t,{id:Et})}const _t=new Set;class It{builder;configs;_dependency;_peerNameSet;extension;state;_signal;constructor(t,e){this.builder=t,this.extension=e,this.configs=new Set,this.state={id:yt}}mergeConfigs(){let t=this.extension.config||{};const e=this.extension.mergeConfig?this.extension.mergeConfig.bind(this.extension):d;for(const n of this.configs)t=e(t,n);return t}init(t){const e=this.state;Ct(e)||vt(306,String(e.id));const n={getDependency:this.getInitDependency.bind(this),getDirectDependentNames:this.getDirectDependentNames.bind(this),getPeer:this.getInitPeer.bind(this),getPeerNameSet:this.getPeerNameSet.bind(this)},i={...n,getDependency:this.getDependency.bind(this),getInitResult:this.getInitResult.bind(this),getPeer:this.getPeer.bind(this)},o=function(t,e,n){return Object.assign(t,{config:e,id:bt,registerState:n})}(e,this.mergeConfigs(),n);let s;this.state=o,this.extension.init&&(s=this.extension.init(t,o.config,n)),this.state=function(t,e,n){return Object.assign(t,{id:wt,initResult:e,registerState:n})}(o,s,i)}build(t){const e=this.state;let n;e.id!==wt&&vt(307,String(e.id),String(Nt)),this.extension.build&&(n=this.extension.build(t,e.config,e.registerState));const i={...e.registerState,getOutput:()=>n,getSignal:this.getSignal.bind(this)};this.state=function(t,e,n){return Object.assign(t,{id:Nt,output:e,registerState:n})}(e,n,i)}register(t,e){this._signal=e;const n=this.state;n.id!==Nt&&vt(308,String(n.id),String(Nt));const i=this.extension.register&&this.extension.register(t,n.config,n.registerState);return this.state=function(t){return Object.assign(t,{id:Ot})}(n),()=>{const t=this.state;t.id!==Rt&&vt(309,String(n.id),String(Rt)),this.state=function(t){return Object.assign(t,{id:Nt})}(t),i&&i()}}afterRegistration(t){const e=this.state;let n;return e.id!==Ot&&vt(310,String(e.id),String(Ot)),this.extension.afterRegistration&&(n=this.extension.afterRegistration(t,e.config,e.registerState)),this.state=function(t){return Object.assign(t,{id:Rt})}(e),n}getSignal(){return void 0===this._signal&&vt(311),this._signal}getInitResult(){void 0===this.extension.init&&vt(312,this.extension.name);const t=this.state;return function(t){return t.id>=wt}(t)||vt(313,String(t.id),String(wt)),t.initResult}getInitPeer(t){const e=this.builder.extensionNameMap.get(t);return e?e.getExtensionInitDependency():void 0}getExtensionInitDependency(){const t=this.state;return function(t){return t.id>=bt}(t)||vt(314,String(t.id),String(bt)),{config:t.config}}getPeer(t){const e=this.builder.extensionNameMap.get(t);return e?e.getExtensionDependency():void 0}getInitDependency(t){const e=this.builder.getExtensionRep(t);return void 0===e&&vt(315,this.extension.name,t.name),e.getExtensionInitDependency()}getDependency(t){const e=this.builder.getExtensionRep(t);return void 0===e&&vt(315,this.extension.name,t.name),e.getExtensionDependency()}getState(){const t=this.state;return function(t){return t.id>=Rt}(t)||vt(316,String(t.id),String(Rt)),t}getDirectDependentNames(){return this.builder.incomingEdges.get(this.extension.name)||_t}getPeerNameSet(){let t=this._peerNameSet;return t||(t=new Set((this.extension.peerDependencies||[]).map(([t])=>t)),this._peerNameSet=t),t}getExtensionDependency(){if(!this._dependency){const t=this.state;(function(t){return t.id>=Nt})(t)||vt(317,this.extension.name),this._dependency={config:t.config,init:t.initResult,output:t.output}}return this._dependency}}const jt={tag:p};function At(){const t=o();t.isEmpty()&&t.append(r())}const Pt=t({config:e({setOptions:jt,updateOptions:jt}),init:({$initialEditorState:t=At})=>({$initialEditorState:t,initialized:!1}),afterRegistration(t,{updateOptions:e,setOptions:n},i){const o=i.getInitResult();if(!o.initialized){o.initialized=!0;const{$initialEditorState:i}=o;if(g(i))t.setEditorState(i,n);else if(\"function\"==typeof i)t.update(()=>{i(t)},e);else if(i&&(\"string\"==typeof i||\"object\"==typeof i)){const e=t.parseEditorState(i);t.setEditorState(e,n)}}return()=>{}},name:\"@lexical/extension/InitialState\",nodes:[a,f,u,h,l]}),Kt=Symbol.for(\"@lexical/extension/LexicalBuilder\");function kt(...t){return Tt.fromExtensions(t).buildEditor()}function $t(){}function zt(t){throw t}function Ut(t){return Array.isArray(t)?t:[t]}const Lt=\"0.40.0+prod.esm\";class Tt{roots;extensionNameMap;outgoingConfigEdges;incomingEdges;conflicts;_sortedExtensionReps;PACKAGE_VERSION;constructor(t){this.outgoingConfigEdges=new Map,this.incomingEdges=new Map,this.extensionNameMap=new Map,this.conflicts=new Map,this.PACKAGE_VERSION=Lt,this.roots=t;for(const e of t)this.addExtension(e)}static fromExtensions(t){const e=[Ut(Pt)];for(const n of t)e.push(Ut(n));return new Tt(e)}static maybeFromEditor(t){const e=t[Kt];return e&&(e.PACKAGE_VERSION!==Lt&&vt(292,e.PACKAGE_VERSION,Lt),e instanceof Tt||vt(293)),e}static fromEditor(t){const e=Tt.maybeFromEditor(t);return void 0===e&&vt(294),e}constructEditor(){const{$initialEditorState:t,onError:e,...n}=this.buildCreateEditorArgs(),i=Object.assign(m({...n,...e?{onError:t=>{e(t,i)}}:{}}),{[Kt]:this});for(const t of this.sortedExtensionReps())t.build(i);return i}buildEditor(){let t=$t;function e(){try{t()}finally{t=$t}}const n=Object.assign(this.constructEditor(),{dispose:e,[Symbol.dispose]:e});return t=v(this.registerEditor(n),()=>n.setRootElement(null)),n}hasExtensionByName(t){return this.extensionNameMap.has(t)}getExtensionRep(t){const e=this.extensionNameMap.get(t.name);if(e)return e.extension!==t&&vt(295,t.name),e}addEdge(t,e,n){const i=this.outgoingConfigEdges.get(t);i?i.set(e,n):this.outgoingConfigEdges.set(t,new Map([[e,n]]));const o=this.incomingEdges.get(e);o?o.add(t):this.incomingEdges.set(e,new Set([t]))}addExtension(t){void 0!==this._sortedExtensionReps&&vt(296);const e=Ut(t),[n]=e;\"string\"!=typeof n.name&&vt(297,typeof n.name);let i=this.extensionNameMap.get(n.name);if(void 0!==i&&i.extension!==n&&vt(298,n.name),!i){i=new It(this,n),this.extensionNameMap.set(n.name,i);const t=this.conflicts.get(n.name);\"string\"==typeof t&&vt(299,n.name,t);for(const t of n.conflictsWith||[])this.extensionNameMap.has(t)&&vt(299,n.name,t),this.conflicts.set(t,n.name);for(const t of n.dependencies||[]){const e=Ut(t);this.addEdge(n.name,e[0].name,e.slice(1)),this.addExtension(e)}for(const[t,e]of n.peerDependencies||[])this.addEdge(n.name,t,e?[e]:[])}}sortedExtensionReps(){if(this._sortedExtensionReps)return this._sortedExtensionReps;const t=[],e=(n,i)=>{let o=n.state;if(Ct(o))return;const s=n.extension.name;var r;Mt(o)||vt(300,s,i||\"[unknown]\"),Mt(r=o)||vt(304,String(r.id),String(yt)),o=Object.assign(r,{id:St}),n.state=o;const c=this.outgoingConfigEdges.get(s);if(c)for(const t of c.keys()){const n=this.extensionNameMap.get(t);n&&e(n,s)}o=Dt(o),n.state=o,t.push(n)};for(const t of this.extensionNameMap.values())Mt(t.state)&&e(t);for(const e of t)for(const[t,n]of this.outgoingConfigEdges.get(e.extension.name)||[])if(n.length>0){const e=this.extensionNameMap.get(t);if(e)for(const t of n)e.configs.add(t)}for(const[t,...e]of this.roots)if(e.length>0){const n=this.extensionNameMap.get(t.name);void 0===n&&vt(301,t.name);for(const t of e)n.configs.add(t)}return this._sortedExtensionReps=t,this._sortedExtensionReps}registerEditor(t){const e=this.sortedExtensionReps(),n=new AbortController,i=[()=>n.abort()],o=n.signal;for(const n of e){const e=n.register(t,o);e&&i.push(e)}for(const n of e){const e=n.afterRegistration(t);e&&i.push(e)}return v(...i)}buildCreateEditorArgs(){const t={},e=new Set,n=new Map,i=new Map,o={},s={},r=this.sortedExtensionReps();for(const c of r){const{extension:r}=c;if(void 0!==r.onError&&(t.onError=r.onError),void 0!==r.disableEvents&&(t.disableEvents=r.disableEvents),void 0!==r.parentEditor&&(t.parentEditor=r.parentEditor),void 0!==r.editable&&(t.editable=r.editable),void 0!==r.namespace&&(t.namespace=r.namespace),void 0!==r.$initialEditorState&&(t.$initialEditorState=r.$initialEditorState),r.nodes)for(const t of gt(r)){if(\"function\"!=typeof t){const e=n.get(t.replace);e&&vt(302,r.name,t.replace.name,e.extension.name),n.set(t.replace,c)}e.add(t)}if(r.html){if(r.html.export)for(const[t,e]of r.html.export.entries())i.set(t,e);r.html.import&&Object.assign(o,r.html.import)}r.theme&&xt(s,r.theme)}Object.keys(s).length>0&&(t.theme=s),e.size&&(t.nodes=[...e]);const c=Object.keys(o).length>0,d=i.size>0;(c||d)&&(t.html={},c&&(t.html.import=o),d&&(t.html.export=i));for(const e of r)e.init(t);return t.onError||(t.onError=zt),t}}function Bt(t,e){const n=Tt.fromEditor(t).getExtensionRep(e);return void 0===n&&vt(303,e.name),n.getExtensionDependency()}function Ft(t,e){const n=Tt.fromEditor(t).extensionNameMap.get(e);return n?n.getExtensionDependency():void 0}function Gt(t,e){const n=Ft(t,e);return void 0===n&&vt(291,e),n}const Vt=new Set,Wt=t({build(t,e,n){const i=n.getDependency(mt).output,o=Q({watchedNodeKeys:new Map}),r=pt(()=>{},()=>ct(()=>{const t=r.peek(),{watchedNodeKeys:e}=o.value;let n,c=!1;i.value.read(()=>{if(s())for(const[i,o]of e.entries()){if(0===o.size){e.delete(i);continue}const s=x(i),r=s&&s.isSelected()||!1;c=c||r!==(!!t&&t.has(i)),r&&(n=n||new Set,n.add(i))}}),!c&&n&&t&&n.size===t.size||(r.value=n)}));return{watchNodeKey:function(t){const e=nt(()=>(r.value||Vt).has(t)),{watchedNodeKeys:n}=o.peek();let i=n.get(t);const s=void 0!==i;return i=i||new Set,i.add(e),s||(n.set(t,i),o.value={watchedNodeKeys:n}),e}}},dependencies:[mt],name:\"@lexical/extension/NodeSelection\"}),Zt=y(\"INSERT_HORIZONTAL_RULE_COMMAND\");class Jt extends O{static getType(){return\"horizontalrule\"}static clone(t){return new Jt(t.__key)}static importJSON(t){return qt().updateFromJSON(t)}static importDOM(){return{hr:()=>({conversion:Ht,priority:0})}}exportDOM(){return{element:document.createElement(\"hr\")}}createDOM(t){const e=document.createElement(\"hr\");return R(e,t.theme.hr),e}getTextContent(){return\"\\n\"}isInline(){return!1}updateDOM(){return!1}}function Ht(){return{node:qt()}}function qt(){return S(Jt)}function Qt(t){return t instanceof Jt}const Xt=t({dependencies:[mt,Wt],name:\"@lexical/extension/HorizontalRule\",nodes:()=>[Jt],register(t,e,n){const{watchNodeKey:i}=n.getDependency(Wt).output,o=Q({nodeSelections:new Map}),r=t._config.theme.hrSelected??\"selected\";return v(t.registerCommand(E,t=>{if(b(t.target)){const e=w(t.target);if(Qt(e))return function(t,e=!1){const n=s(),i=t.isSelected(),o=t.getKey();let r;e&&M(n)?r=n:(r=C(),D(r)),i?r.delete(o):r.add(o)}(e,t.shiftKey),!0}return!1},N),t.registerMutationListener(Jt,(e,n)=>{B(()=>{let n=!1;const{nodeSelections:s}=o.peek();for(const[o,r]of e.entries())if(\"destroyed\"===r)s.delete(o),n=!0;else{const e=s.get(o),r=t.getElementByKey(o);e?e.domNode.value=r:(n=!0,s.set(o,{domNode:Q(r),selectedSignal:i(o)}))}n&&(o.value={nodeSelections:s})})}),ct(()=>{const t=[];for(const{domNode:e,selectedSignal:n}of o.value.nodeSelections.values())t.push(ct(()=>{const t=e.value;if(t){n.value?R(t,r):_(t,r)}}));return v(...t)}))}});function Yt(t,e){return v(t.registerCommand(I,e=>{const n=s();if(!c(n))return!1;e.preventDefault();const i=function(t){if(t.getNodes().filter(t=>k(t)&&t.canIndent()).length>0)return!0;const e=t.anchor,n=t.focus,i=n.isBefore(e)?n:e,o=i.getNode(),s=U(o);if(s.canIndent()){const t=s.getKey();let e=$();if(e.anchor.set(t,0,\"element\"),e.focus.set(t,0,\"element\"),e=z(e),e.anchor.is(i))return!0}return!1}(n)?e.shiftKey?j:A:P;return t.dispatchCommand(i,void 0)},i),t.registerCommand(A,()=>{const t=\"number\"==typeof e?e:e?e.peek():null;if(null==t)return!1;const n=s();if(!c(n))return!1;const i=n.getNodes().map(t=>U(t).getIndent());return Math.max(...i)+1>=t},K))}const te=t({build:(t,e,n)=>dt(e),config:e({disabled:!1,maxIndent:null}),name:\"@lexical/extension/TabIndentation\",register(t,e,n){const{disabled:i,maxIndent:o}=n.getOutput();return ct(()=>{if(!i.value)return Yt(t,o)})}});export{qt as $createHorizontalRuleNode,Qt as $isHorizontalRuleNode,at as AutoFocusExtension,ht as ClearEditorExtension,mt as EditorStateExtension,Xt as HorizontalRuleExtension,Jt as HorizontalRuleNode,Zt as INSERT_HORIZONTAL_RULE_COMMAND,Pt as InitialStateExtension,Tt as LexicalBuilder,Wt as NodeSelectionExtension,te as TabIndentationExtension,B as batch,kt as buildEditorFromExtensions,nt as computed,ct as effect,Bt as getExtensionDependencyFromEditor,lt as getKnownTypesAndNodes,Ft as getPeerDependencyFromEditor,Gt as getPeerDependencyFromEditorOrThrow,dt as namedSignals,ut as registerClearEditor,Yt as registerTabIndentation,Q as signal,V as untracked,pt as watchedSignal};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{defineExtension as e}from\"lexical\";const r=e({name:\"@lexical/react/ReactProvider\"});export{r as ReactProviderExtension};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{$getRoot as t,$isDecoratorNode as e,$isElementNode as n,$isParagraphNode as r,$isTextNode as i,TextNode as o,$createTextNode as l}from\"lexical\";function s(){return t().getTextContent()}function f(t,e=!0){if(t)return!1;let n=s();return e&&(n=n.trim()),\"\"===n}function u(t,e){return()=>f(t,e)}function c(o){if(!f(o,!1))return!1;const l=t().getChildren(),s=l.length;if(s>1)return!1;for(let t=0;t<s;t++){const o=l[t];if(e(o))return!1;if(n(o)){if(!r(o))return!1;if(0!==o.__indent)return!1;const e=o.getChildren(),n=e.length;for(let r=0;r<n;r++){const n=e[t];if(!i(n))return!1}}}return!0}function g(t){return()=>c(t)}function a(t,e){let r=t.getFirstChild(),o=0;t:for(;null!==r;){if(n(r)){const t=r.getFirstChild();if(null!==t){r=t;continue}}else if(i(r)){const t=r.getTextContentSize();if(o+t>e)return{node:r,offset:e-o};o+=t}const t=r.getNextSibling();if(null!==t){r=t;continue}let l=r.getParent();for(;null!==l;){const t=l.getNextSibling();if(null!==t){r=t;continue t}l=l.getParent()}break}return null}function d(t,...e){const n=new URL(\"https://lexical.dev/docs/error\"),r=new URLSearchParams;r.append(\"code\",t);for(const t of e)r.append(\"v\",t);throw n.search=r.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function x(t,e,n,r){const s=t=>t instanceof n,f=t=>{const e=l(t.getTextContent());e.setFormat(t.getFormat()),t.replace(e)};return[t.registerNodeTransform(o,t=>{if(!t.isSimpleText())return;let n,o=t.getPreviousSibling(),l=t.getTextContent(),u=t;if(i(o)){const n=o.getTextContent(),r=e(n+l);if(s(o)){if(null===r||0!==(t=>t.getLatest().__mode)(o))return void f(o);{const e=r.end-n.length;if(e>0){const r=n+l.slice(0,e);if(o.select(),o.setTextContent(r),e===l.length)t.remove();else{const n=l.slice(e);t.setTextContent(n)}return}}}else if(null===r||r.start<n.length)return}let c=0;for(;;){n=e(l);let t,g=null===n?\"\":l.slice(n.end);if(l=g,\"\"===g){const t=u.getNextSibling();if(i(t)){g=u.getTextContent()+t.getTextContent();const n=e(g);if(null===n)return void(s(t)?f(t):t.markDirty());if(0!==n.start)return}}if(null===n)return;if(0===n.start&&i(o)&&o.isTextEntity()){c+=n.end;continue}0===n.start?[t,u]=u.splitText(n.end):[,t,u]=u.splitText(n.start+c,n.end+c),void 0===t&&d(165,\"nodeToReplace\");const a=r(t);if(a.setFormat(t.getFormat()),t.replace(a),null==u)return;c=0,o=a}}),t.registerNodeTransform(n,t=>{const n=t.getTextContent(),r=e(n);if(null===r||0!==r.start)return void f(t);if(n.length>r.end)return void t.splitText(r.end);const o=t.getPreviousSibling();i(o)&&o.isTextEntity()&&(f(o),f(t));const l=t.getNextSibling();i(l)&&l.isTextEntity()&&(f(l),s(t)&&f(t))})]}export{c as $canShowPlaceholder,g as $canShowPlaceholderCurry,a as $findTextIntersectionFromCharacters,f as $isRootTextContentEmpty,u as $isRootTextContentEmptyCurry,s as $rootTextContent,x as registerLexicalTextEntity};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{effect as e,namedSignals as t}from\"@lexical/extension\";import{defineExtension as n,safeCast as o,$getSelection as i,$isRangeSelection as a,$isTextNode as r}from\"lexical\";function s(e){const t=window.location.origin,n=n=>{if(n.origin!==t)return;const o=e.getRootElement();if(document.activeElement!==o)return;const s=n.data;if(\"string\"==typeof s){let t;try{t=JSON.parse(s)}catch(e){return}if(t&&\"nuanria_messaging\"===t.protocol&&\"request\"===t.type){const o=t.payload;if(o&&\"makeChanges\"===o.functionId){const t=o.args;if(t){const[o,s,d,c,g]=t;e.update(()=>{const e=i();if(a(e)){const t=e.anchor;let i=t.getNode(),a=0,l=0;if(r(i)&&o>=0&&s>=0&&(a=o,l=o+s,e.setTextNodeRange(i,a,i,l)),a===l&&\"\"===d||(e.insertRawText(d),i=t.getNode()),r(i)){a=c,l=c+g;const t=i.getTextContentSize();a=a>t?t:a,l=l>t?t:l,e.setTextNodeRange(i,a,i,l)}n.stopImmediatePropagation()}})}}}}};return window.addEventListener(\"message\",n,!0),()=>{window.removeEventListener(\"message\",n,!0)}}const d=n({build:(e,n,o)=>t(n),config:o({disabled:\"undefined\"==typeof window}),name:\"@lexical/dragon\",register:(t,n,o)=>e(()=>o.getOutput().disabled.value?void 0:s(t))});export{d as DragonExtension,s as registerDragonSupport};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{useLexicalComposerContext as r}from\"@lexical/react/LexicalComposerContext\";import{useLexicalEditable as e}from\"@lexical/react/useLexicalEditable\";import{LexicalBuilder as t}from\"@lexical/extension\";import{ReactProviderExtension as o}from\"@lexical/react/ReactProviderExtension\";import{useLayoutEffect as n,useEffect as i,useState as c,useMemo as a,Suspense as l}from\"react\";import{flushSync as s,createPortal as u}from\"react-dom\";import{jsx as d,jsxs as f,Fragment as m}from\"react/jsx-runtime\";import{$canShowPlaceholderCurry as p}from\"@lexical/text\";import{mergeRegister as x}from\"@lexical/utils\";import{registerDragonSupport as E}from\"@lexical/dragon\";import{registerRichText as h}from\"@lexical/rich-text\";function g(r,...e){const t=new URL(\"https://lexical.dev/docs/error\"),o=new URLSearchParams;o.append(\"code\",r);for(const r of e)o.append(\"v\",r);throw t.search=o.toString(),Error(`Minified Lexical error #${r}; visit ${t.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const y=\"undefined\"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?n:i;function w({editor:r,ErrorBoundary:e}){return function(r,e){const[t,o]=c(()=>r.getDecorators());return y(()=>r.registerDecoratorListener(r=>{s(()=>{o(r)})}),[r]),i(()=>{o(r.getDecorators())},[r]),a(()=>{const o=[],n=Object.keys(t);for(let i=0;i<n.length;i++){const c=n[i],a=d(e,{onError:e=>r._onError(e),children:d(l,{fallback:null,children:t[c]})}),s=r.getElementByKey(c);null!==s&&o.push(u(a,s,c))}return o},[e,t,r])}(r,e)}function v({editor:r,ErrorBoundary:e}){return function(r){const e=t.maybeFromEditor(r);if(e&&e.hasExtensionByName(o.name)){for(const r of[\"@lexical/plain-text\",\"@lexical/rich-text\"])e.hasExtensionByName(r)&&g(320,r);return!0}return!1}(r)?null:d(w,{editor:r,ErrorBoundary:e})}function B(r){return r.getEditorState().read(p(r.isComposing()))}function L({contentEditable:e,placeholder:t=null,ErrorBoundary:o}){const[n]=r();return function(r){y(()=>x(h(r),E(r)),[r])}(n),f(m,{children:[e,d(b,{content:t}),d(v,{editor:n,ErrorBoundary:o})]})}function b({content:t}){const[o]=r(),n=function(r){const[e,t]=c(()=>B(r));return y(()=>{function e(){const e=B(r);t(e)}return e(),x(r.registerUpdateListener(()=>{e()}),r.registerEditableListener(()=>{e()}))},[r]),e}(o),i=e();return n?\"function\"==typeof t?t(i):t:null}export{L as RichTextPlugin};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{useLexicalComposerContext as e}from\"@lexical/react/LexicalComposerContext\";import{useEffect as t}from\"react\";function o({defaultSelection:o}){const[l]=e();return t(()=>{l.focus(()=>{const e=document.activeElement,t=l.getRootElement();null===t||null!==e&&t.contains(e)||t.focus({preventScroll:!0})},{defaultSelection:o})},[o,l]),null}export{o as AutoFocusPlugin};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{registerClearEditor as o}from\"@lexical/extension\";import{useLexicalComposerContext as e}from\"@lexical/react/LexicalComposerContext\";import{useLayoutEffect as n,useEffect as t}from\"react\";const i=\"undefined\"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?n:t;function r({onClear:n}){const[t]=e();return i(()=>o(t,n),[t,n]),null}export{r as ClearEditorPlugin};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{useLexicalComposerContext as e}from\"@lexical/react/LexicalComposerContext\";import{useLayoutEffect as t,useEffect as i,forwardRef as a,useState as r,useCallback as n,useMemo as o}from\"react\";import{jsx as l,jsxs as d,Fragment as c}from\"react/jsx-runtime\";import{$canShowPlaceholderCurry as s}from\"@lexical/text\";import{mergeRegister as u}from\"@lexical/utils\";const m=\"undefined\"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?t:i;function f({editor:e,ariaActiveDescendant:t,ariaAutoComplete:i,ariaControls:a,ariaDescribedBy:d,ariaErrorMessage:c,ariaExpanded:s,ariaInvalid:u,ariaLabel:f,ariaLabelledBy:b,ariaMultiline:p,ariaOwns:x,ariaRequired:E,autoCapitalize:v,className:w,id:y,role:C=\"textbox\",spellCheck:g=!0,style:L,tabIndex:h,\"data-testid\":D,...I},R){const[k,q]=r(e.isEditable()),z=n(t=>{t&&t.ownerDocument&&t.ownerDocument.defaultView?e.setRootElement(t):e.setRootElement(null)},[e]),A=o(()=>function(...e){return t=>{for(const i of e)\"function\"==typeof i?i(t):null!=i&&(i.current=t)}}(R,z),[z,R]);return m(()=>(q(e.isEditable()),e.registerEditableListener(e=>{q(e)})),[e]),l(\"div\",{\"aria-activedescendant\":k?t:void 0,\"aria-autocomplete\":k?i:\"none\",\"aria-controls\":k?a:void 0,\"aria-describedby\":d,...null!=c?{\"aria-errormessage\":c}:{},\"aria-expanded\":k&&\"combobox\"===C?!!s:void 0,...null!=u?{\"aria-invalid\":u}:{},\"aria-label\":f,\"aria-labelledby\":b,\"aria-multiline\":p,\"aria-owns\":k?x:void 0,\"aria-readonly\":!k||void 0,\"aria-required\":E,autoCapitalize:v,className:w,contentEditable:k,\"data-testid\":D,id:y,ref:A,role:C,spellCheck:g,style:L,tabIndex:h,...I})}const b=a(f);function p(e){return e.getEditorState().read(s(e.isComposing()))}const x=a(E);function E(t,i){const{placeholder:a,...r}=t,[n]=e();return d(c,{children:[l(b,{editor:n,...r,ref:i}),null!=a&&l(v,{editor:n,content:a})]})}function v({content:e,editor:i}){const a=function(e){const[t,i]=r(()=>p(e));return m(()=>{function t(){const t=p(e);i(t)}return t(),u(e.registerUpdateListener(()=>{t()}),e.registerEditableListener(()=>{t()}))},[e]),t}(i),[n,o]=r(i.isEditable());if(t(()=>(o(i.isEditable()),i.registerEditableListener(e=>{o(e)})),[i]),!a)return null;let d=null;return\"function\"==typeof e?d=e(n):null!==e&&(d=e),null===d?null:l(\"div\",{\"aria-hidden\":!0,children:d})}export{x as ContentEditable,b as ContentEditableElement};\n","/**\n * This file was automatically generated on installation of the Shadcn/Lexical editor. The default\n * location of this file has been changed to integrate better with our project structure. Also,\n * modifications have been made to integrate with our codebase.\n *\n * Original file location: src/components/editor/editor-ui/content-editable.tsx\n *\n * Shadcn/Lexical Editor Documentation: https://shadcn-editor.vercel.app/docs/\n */\n\nimport { ReactNode } from 'react';\nimport { ContentEditable as LexicalContentEditable } from '@lexical/react/LexicalContentEditable';\n\ntype Props = {\n  placeholder: string;\n  className?: string;\n  placeholderClassName?: string;\n};\n\nexport function ContentEditable({\n  placeholder,\n  className,\n  placeholderClassName,\n}: Props): ReactNode {\n  return (\n    <LexicalContentEditable\n      className={\n        className ??\n        `ContentEditable__root tw-relative tw-block tw-min-h-11 tw-overflow-auto tw-px-3 tw-py-3 tw-text-sm tw-outline-none`\n      }\n      aria-placeholder={placeholder}\n      placeholder={\n        <div\n          className={\n            placeholderClassName ??\n            `tw-pointer-events-none tw-absolute tw-top-0 tw-select-none tw-overflow-hidden tw-text-ellipsis tw-px-3 tw-py-3 tw-text-sm tw-text-muted-foreground`\n          }\n        >\n          {placeholder}\n        </div>\n      }\n    />\n  );\n}\n","/**\n * This file was automatically generated on installation of the Shadcn/Lexical editor. The default\n * location of this file has been changed to integrate better with our project structure.\n *\n * Original file location: src/components/editor/context/toolbar-context.tsx\n *\n * Shadcn/Lexical Editor Documentation: https://shadcn-editor.vercel.app/docs/\n */\n\n'use client';\n\nimport { createContext, ReactNode, useContext, useMemo } from 'react';\nimport { LexicalEditor } from 'lexical';\n\nconst Context = createContext<\n  | {\n      activeEditor: LexicalEditor;\n      $updateToolbar: () => void;\n      blockType: string;\n      setBlockType: (blockType: string) => void;\n      showModal: (title: string, showModal: (onClose: () => void) => ReactNode) => void;\n    }\n  | undefined\n>(undefined);\n\nexport function ToolbarContext({\n  activeEditor,\n  $updateToolbar,\n  blockType,\n  setBlockType,\n  showModal,\n  children,\n}: {\n  activeEditor: LexicalEditor;\n  $updateToolbar: () => void;\n  blockType: string;\n  setBlockType: (blockType: string) => void;\n  showModal: (title: string, showModal: (onClose: () => void) => ReactNode) => void;\n  children: ReactNode;\n}) {\n  const contextValue = useMemo(\n    () => ({\n      activeEditor,\n      $updateToolbar,\n      blockType,\n      setBlockType,\n      showModal,\n    }),\n    [activeEditor, $updateToolbar, blockType, setBlockType, showModal],\n  );\n\n  return <Context.Provider value={contextValue}>{children}</Context.Provider>;\n}\n\nexport function useToolbarContext() {\n  const context = useContext(Context);\n  if (!context) {\n    throw new Error('useToolbarContext must be used within a ToolbarContext provider');\n  }\n  return context;\n}\n","/**\n * This file was automatically generated on installation of the Shadcn/Lexical editor. The default\n * location of this file has been changed to integrate better with our project structure.\n *\n * Original file location: src/components/editor/editor-hooks/use-modal.tsx\n *\n * Shadcn/Lexical Editor Documentation: https://shadcn-editor.vercel.app/docs/\n */\n\nimport { ReactNode, useCallback, useMemo, useState } from 'react';\n\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/shadcn-ui/dialog';\n\nexport function useEditorModal(): [\n  ReactNode | undefined,\n  (title: string, showModal: (onClose: () => void) => ReactNode) => void,\n] {\n  const [modalContent, setModalContent] = useState<\n    | {\n        closeOnClickOutside: boolean;\n        content: ReactNode;\n        title: string;\n      }\n    | undefined\n  >(undefined);\n\n  const onClose = useCallback(() => {\n    setModalContent(undefined);\n  }, []);\n\n  const modal = useMemo(() => {\n    if (modalContent === undefined) {\n      return undefined;\n    }\n    const { title, content } = modalContent;\n    return (\n      <Dialog open onOpenChange={onClose}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{title}</DialogTitle>\n          </DialogHeader>\n          {content}\n        </DialogContent>\n      </Dialog>\n    );\n  }, [modalContent, onClose]);\n\n  const showModal = useCallback(\n    (\n      title: string,\n      getContent: (onClose: () => void) => ReactNode,\n      closeOnClickOutside = false,\n    ) => {\n      setModalContent({\n        closeOnClickOutside,\n        content: getContent(onClose),\n        title,\n      });\n    },\n    [onClose],\n  );\n\n  return [modal, showModal];\n}\n","/**\n * This file was automatically generated on installation of the Shadcn/Lexical editor. The default\n * location of this file has been changed to integrate better with our project structure.\n *\n * Original file location: src/components/editor/plugins/toolbar/toolbar-plugin.tsx\n *\n * Shadcn/Lexical Editor Documentation: https://shadcn-editor.vercel.app/docs/\n *\n * Documentation for the Toolbar Plugin-framework:\n * https://shadcn-editor.vercel.app/docs/plugins/toolbar\n */\n\nimport { ReactNode, useEffect, useState } from 'react';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { COMMAND_PRIORITY_CRITICAL, SELECTION_CHANGE_COMMAND } from 'lexical';\n\nimport { ToolbarContext } from '@/components/advanced/editor/context/toolbar-context';\nimport { useEditorModal } from '@/components/advanced/editor/editor-hooks/use-modal';\n\nexport function ToolbarPlugin({\n  children,\n}: {\n  children: (props: { blockType: string }) => ReactNode;\n}) {\n  const [editor] = useLexicalComposerContext();\n\n  const [activeEditor, setActiveEditor] = useState(editor);\n  const [blockType, setBlockType] = useState<string>('paragraph');\n\n  const [modal, showModal] = useEditorModal();\n\n  const $updateToolbar = () => {};\n\n  useEffect(() => {\n    return activeEditor.registerCommand(\n      SELECTION_CHANGE_COMMAND,\n      (_payload, newEditor) => {\n        setActiveEditor(newEditor);\n        return false;\n      },\n      COMMAND_PRIORITY_CRITICAL,\n    );\n  }, [activeEditor]);\n\n  return (\n    <ToolbarContext\n      activeEditor={activeEditor}\n      $updateToolbar={$updateToolbar}\n      blockType={blockType}\n      setBlockType={setBlockType}\n      showModal={showModal}\n    >\n      {modal}\n\n      {children({ blockType })}\n    </ToolbarContext>\n  );\n}\n","/**\n * This file was automatically generated on installation of the Shadcn/Lexical editor. The default\n * location of this file has been changed to integrate better with our project structure.\n *\n * Original file location: src/components/editor/editor-hooks/use-update-toolbar.ts\n *\n * Shadcn/Lexical Editor Documentation: https://shadcn-editor.vercel.app/docs/\n */\n\nimport { useEffect } from 'react';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport {\n  $getSelection,\n  BaseSelection,\n  COMMAND_PRIORITY_CRITICAL,\n  SELECTION_CHANGE_COMMAND,\n} from 'lexical';\n\nimport { useToolbarContext } from '@/components/advanced/editor/context/toolbar-context';\n\nexport function useUpdateToolbarHandler(callback: (selection: BaseSelection) => void) {\n  const [editor] = useLexicalComposerContext();\n  const { activeEditor } = useToolbarContext();\n\n  useEffect(() => {\n    return activeEditor.registerCommand(\n      SELECTION_CHANGE_COMMAND,\n      () => {\n        const selection = $getSelection();\n        if (selection) {\n          callback(selection);\n        }\n        return false;\n      },\n      COMMAND_PRIORITY_CRITICAL,\n    );\n    /**\n     * We use `editor` (not `activeEditor`) in the dependency array because `activeEditor` can\n     * change frequently. Re-registering the command on every `activeEditor` change would be\n     * unnecessary. We only need to re-register when the main editor instance or callback changes.\n     */\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [editor, callback]);\n\n  useEffect(() => {\n    activeEditor.getEditorState().read(() => {\n      const selection = $getSelection();\n      if (selection) {\n        callback(selection);\n      }\n    });\n  }, [activeEditor, callback]);\n}\n","import React from 'react';\nimport * as TogglePrimitive from '@radix-ui/react-toggle';\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\nconst toggleVariants = cva(\n  'pr-twp tw-inline-flex tw-items-center tw-justify-center tw-rounded-md tw-text-sm tw-font-medium tw-ring-offset-background tw-transition-colors hover:tw-bg-muted hover:tw-text-muted-foreground focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2 disabled:tw-pointer-events-none disabled:tw-opacity-50 data-[state=on]:tw-bg-accent data-[state=on]:tw-text-accent-foreground',\n  {\n    variants: {\n      variant: {\n        default: 'tw-bg-transparent',\n        outline:\n          'tw-border tw-border-input tw-bg-transparent hover:tw-bg-accent hover:tw-text-accent-foreground',\n      },\n      size: {\n        default: 'tw-h-10 tw-px-3',\n        sm: 'tw-h-9 tw-px-2.5',\n        lg: 'tw-h-11 tw-px-5',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n);\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> & VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n));\n\nToggle.displayName = TogglePrimitive.Root.displayName;\n\nexport { Toggle, toggleVariants };\n","import React from 'react';\nimport * as ToggleGroupPrimitive from '@radix-ui/react-toggle-group';\nimport { type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { toggleVariants } from '@/components/shadcn-ui/toggle';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\n\n/** @inheritdoc ToggleGroup */\nconst ToggleGroupContext = React.createContext<VariantProps<typeof toggleVariants>>({\n  size: 'default',\n  variant: 'default',\n});\n\n/**\n * ToggleGroup components provide a set of two-state buttons that can be toggled on or off. These\n * components are built on Radix UI primitives and styled with Shadcn UI. See Shadcn UI\n * Documentation: https://ui.shadcn.com/docs/components/toggle-group See Radix UI Documentation:\n * https://www.radix-ui.com/primitives/docs/components/toggle-group\n */\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <ToggleGroupPrimitive.Root\n      ref={ref}\n      className={cn('pr-twp tw-flex tw-items-center tw-justify-center tw-gap-1', className)}\n      {...props}\n      dir={dir}\n    >\n      <ToggleGroupContext.Provider\n        // Suppress warning produced by imported shadcn code\n        // eslint-disable-next-line react/jsx-no-constructed-context-values\n        value={{ variant, size }}\n      >\n        {children}\n      </ToggleGroupContext.Provider>\n    </ToggleGroupPrimitive.Root>\n  );\n});\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName;\n\n/** @inheritdoc ToggleGroup */\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext);\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className,\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  );\n});\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName;\n\nexport { ToggleGroup, ToggleGroupItem };\n","/**\n * This file was automatically generated on installation of the Shadcn/Lexical editor. The default\n * location of this file has been changed to integrate better with our project structure.\n *\n * Original file location: src/components/editor/plugins/toolbar/font-format-toolbar-plugin.tsx\n *\n * Shadcn/Lexical Editor Documentation: https://shadcn-editor.vercel.app/docs/\n *\n * Documentation for this specific plugin:\n * https://shadcn-editor.vercel.app/docs/plugins/toolbar/font-format-toolbar\n */\n\nimport { useCallback, useState } from 'react';\nimport { $isTableSelection } from '@lexical/table';\nimport { $isRangeSelection, BaseSelection, FORMAT_TEXT_COMMAND } from 'lexical';\nimport { BoldIcon, ItalicIcon, StrikethroughIcon, UnderlineIcon } from 'lucide-react';\n\nimport { useToolbarContext } from '@/components/advanced/editor/context/toolbar-context';\nimport { useUpdateToolbarHandler } from '@/components/advanced/editor/editor-hooks/use-update-toolbar';\nimport { ToggleGroup, ToggleGroupItem } from '@/components/shadcn-ui/toggle-group';\n\nconst FORMATS = [\n  { format: 'bold', icon: BoldIcon, label: 'Bold' },\n  { format: 'italic', icon: ItalicIcon, label: 'Italic' },\n  { format: 'underline', icon: UnderlineIcon, label: 'Underline' },\n  { format: 'strikethrough', icon: StrikethroughIcon, label: 'Strikethrough' },\n] as const;\n\nexport function FontFormatToolbarPlugin() {\n  const { activeEditor } = useToolbarContext();\n  const [activeFormats, setActiveFormats] = useState<string[]>([]);\n\n  const $updateToolbar = useCallback((selection: BaseSelection) => {\n    if ($isRangeSelection(selection) || $isTableSelection(selection)) {\n      const formats: string[] = [];\n      FORMATS.forEach(({ format }) => {\n        if (selection.hasFormat(format)) {\n          formats.push(format);\n        }\n      });\n      setActiveFormats((prev) => {\n        // Only update if formats have changed\n        if (prev.length !== formats.length || !formats.every((f) => prev.includes(f))) {\n          return formats;\n        }\n        return prev;\n      });\n    }\n  }, []);\n\n  useUpdateToolbarHandler($updateToolbar);\n\n  return (\n    <ToggleGroup\n      type=\"multiple\"\n      value={activeFormats}\n      onValueChange={setActiveFormats}\n      variant=\"outline\"\n      size=\"sm\"\n    >\n      {FORMATS.map(({ format, icon: Icon, label }) => (\n        <ToggleGroupItem\n          key={format}\n          value={format}\n          aria-label={label}\n          onClick={() => {\n            activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, format);\n          }}\n        >\n          <Icon className=\"tw-h-4 tw-w-4\" />\n        </ToggleGroupItem>\n      ))}\n    </ToggleGroup>\n  );\n}\n","/**\n * This file was automatically generated on installation of the Shadcn/Lexical editor. The default\n * location of this file has been changed to integrate better with our project structure. Also,\n * modifications have been made to integrate with our codebase.\n *\n * Original file location: src/components/blocks/editor-00/plugins.tsx\n *\n * Shadcn/Lexical Editor Documentation: https://shadcn-editor.vercel.app/docs/\n */\n\nimport { useEffect, useState } from 'react';\nimport { LexicalErrorBoundary } from '@lexical/react/LexicalErrorBoundary';\nimport { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin';\nimport { AutoFocusPlugin } from '@lexical/react/LexicalAutoFocusPlugin';\nimport { ClearEditorPlugin } from '@lexical/react/LexicalClearEditorPlugin';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { CLEAR_EDITOR_COMMAND } from 'lexical';\n\nimport { ContentEditable } from '@/components/advanced/editor/editor-ui/content-editable';\nimport { ToolbarPlugin } from '@/components/advanced/editor/plugins/toolbar/toolbar-plugin';\nimport { FontFormatToolbarPlugin } from '@/components/advanced/editor/plugins/toolbar/font-format-toolbar-plugin';\n\nfunction ClearEditorBridge({ onClear }: { onClear?: (clearFn: () => void) => void }) {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (onClear) {\n      onClear(() => {\n        editor.dispatchCommand(CLEAR_EDITOR_COMMAND, undefined);\n      });\n    }\n  }, [editor, onClear]);\n\n  return undefined;\n}\n\nexport function Plugins({\n  placeholder = 'Start typing ...',\n  autoFocus = false,\n  onClear,\n}: {\n  placeholder?: string;\n  autoFocus?: boolean;\n  onClear?: (clearFn: () => void) => void;\n}) {\n  const [, setFloatingAnchorElem] = useState<HTMLDivElement | undefined>(undefined);\n\n  const onRef = (_floatingAnchorElem: HTMLDivElement) => {\n    if (_floatingAnchorElem !== undefined) {\n      setFloatingAnchorElem(_floatingAnchorElem);\n    }\n  };\n\n  return (\n    <div className=\"tw-relative\">\n      {/* toolbar plugins */}\n      <ToolbarPlugin>\n        {() => (\n          <div className=\"tw-sticky tw-top-0 tw-z-10 tw-flex tw-gap-2 tw-overflow-auto tw-border-b tw-p-1\">\n            <FontFormatToolbarPlugin />\n          </div>\n        )}\n      </ToolbarPlugin>\n\n      <div className=\"tw-relative\">\n        <RichTextPlugin\n          contentEditable={\n            <div ref={onRef}>\n              <ContentEditable placeholder={placeholder} />\n            </div>\n          }\n          ErrorBoundary={LexicalErrorBoundary}\n        />\n        {autoFocus && <AutoFocusPlugin defaultSelection=\"rootEnd\" />}\n\n        <ClearEditorBridge onClear={onClear} />\n        <ClearEditorPlugin />\n        {/* editor plugins */}\n      </div>\n      {/* actions plugins */}\n    </div>\n  );\n}\n","/**\n * This file was automatically generated on installation of the Shadcn/Lexical editor. The default\n * location of this file has been changed to integrate better with our project structure. Also,\n * modifications have been made to integrate with our codebase.\n *\n * Original file location: src/components/blocks/editor-00/editor.tsx\n *\n * Shadcn/Lexical Editor Documentation: https://shadcn-editor.vercel.app/docs/\n */\n\nimport { InitialConfigType, LexicalComposer } from '@lexical/react/LexicalComposer';\nimport { OnChangePlugin } from '@lexical/react/LexicalOnChangePlugin';\nimport { EditorState, SerializedEditorState } from 'lexical';\n\nimport { editorTheme } from '@/components/advanced/editor/themes/editor-theme';\nimport { TooltipProvider } from '@/components/shadcn-ui/tooltip';\nimport { cn } from '@/utils/shadcn-ui.util';\n\nimport { nodes } from './nodes';\nimport { Plugins } from './plugins';\n\nconst editorConfig: InitialConfigType = {\n  namespace: 'commentEditor',\n  theme: editorTheme,\n  nodes,\n  onError: (error: Error) => {\n    console.error(error);\n  },\n};\n\n/**\n * Shadcn UI based Lexical Editor component\n *\n * Documentation: https://shadcn-editor.vercel.app/docs/\n */\nexport function Editor({\n  editorState,\n  editorSerializedState,\n  onChange,\n  onSerializedChange,\n  placeholder = 'Start typing…',\n  autoFocus = false,\n  onClear,\n  className,\n}: {\n  editorState?: EditorState;\n  editorSerializedState?: SerializedEditorState;\n  onChange?: (editorState: EditorState) => void;\n  onSerializedChange?: (editorSerializedState: SerializedEditorState) => void;\n  placeholder?: string;\n  autoFocus?: boolean;\n  onClear?: (clearFn: () => void) => void;\n  className?: string;\n}) {\n  return (\n    // CUSTOM: Added `className` prop\n    <div\n      className={cn(\n        'pr-twp tw-overflow-hidden tw-rounded-lg tw-border tw-bg-background tw-shadow',\n        className,\n      )}\n    >\n      <LexicalComposer\n        initialConfig={{\n          ...editorConfig,\n          ...(editorState ? { editorState } : {}),\n          ...(editorSerializedState ? { editorState: JSON.stringify(editorSerializedState) } : {}),\n        }}\n      >\n        <TooltipProvider>\n          <Plugins placeholder={placeholder} autoFocus={autoFocus} onClear={onClear} />\n\n          <OnChangePlugin\n            ignoreSelectionChange\n            onChange={(latestEditorState) => {\n              onChange?.(latestEditorState);\n              onSerializedChange?.(latestEditorState.toJSON());\n            }}\n          />\n        </TooltipProvider>\n      </LexicalComposer>\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{$sliceSelectedTextNodeContent as e}from\"@lexical/selection\";import{isHTMLElement as n,isBlockDomNode as t}from\"@lexical/utils\";import{isDOMDocumentNode as o,$getRoot as l,$isElementNode as r,$isTextNode as i,getRegisteredNode as s,isDocumentFragment as c,$isRootOrShadowRoot as u,$isBlockElementNode as f,$createLineBreakNode as a,ArtificialNode__DO_NOT_USE as d,isInlineDomNode as p,$createParagraphNode as h}from\"lexical\";function m(e,n){const t=o(n)?n.body.childNodes:n.childNodes;let l=[];const r=[];for(const n of t)if(!w.has(n.nodeName)){const t=y(n,e,r,!1);null!==t&&(l=l.concat(t))}return function(e){for(const n of e)n.getNextSibling()instanceof d&&n.insertAfter(a());for(const n of e){const e=n.getChildren();for(const t of e)n.insertBefore(t);n.remove()}}(r),l}function g(e,n){if(\"undefined\"==typeof document||\"undefined\"==typeof window&&void 0===global.window)throw new Error(\"To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.\");const t=document.createElement(\"div\"),o=l().getChildren();for(let l=0;l<o.length;l++){x(e,o[l],t,n)}return t.innerHTML}function x(t,o,l,u=null){let f=null===u||o.isSelected(u);const a=r(o)&&o.excludeFromCopy(\"html\");let d=o;null!==u&&i(o)&&(d=e(u,o,\"clone\"));const p=r(d)?d.getChildren():[],h=s(t,d.getType());let m;m=h&&void 0!==h.exportDOM?h.exportDOM(t,d):d.exportDOM(t);const{element:g,after:w}=m;if(!g)return!1;const y=document.createDocumentFragment();for(let e=0;e<p.length;e++){const n=p[e],l=x(t,n,y,u);!f&&r(o)&&l&&o.extractWithChild(n,u,\"html\")&&(f=!0)}if(f&&!a){if((n(g)||c(g))&&g.append(y),l.append(g),w){const e=w.call(d,g);e&&(c(g)?g.replaceChildren(e):g.replaceWith(e))}}else l.append(y);return f}const w=new Set([\"STYLE\",\"SCRIPT\"]);function y(e,n,o,l,i=new Map,s){let c=[];if(w.has(e.nodeName))return c;let m=null;const g=function(e,n){const{nodeName:t}=e,o=n._htmlConversions.get(t.toLowerCase());let l=null;if(void 0!==o)for(const n of o){const t=n(e);null!==t&&(null===l||(l.priority||0)<=(t.priority||0))&&(l=t)}return null!==l?l.conversion:null}(e,n),x=g?g(e):null;let b=null;if(null!==x){b=x.after;const n=x.node;if(m=Array.isArray(n)?n[n.length-1]:n,null!==m){for(const[,e]of i)if(m=e(m,s),!m)break;m&&c.push(...Array.isArray(n)?n:[m])}null!=x.forChild&&i.set(e.nodeName,x.forChild)}const S=e.childNodes;let v=[];const N=(null==m||!u(m))&&(null!=m&&f(m)||l);for(let e=0;e<S.length;e++)v.push(...y(S[e],n,o,N,new Map(i),m));return null!=b&&(v=b(v)),t(e)&&(v=C(e,v,N?()=>{const e=new d;return o.push(e),e}:h)),null==m?v.length>0?c=c.concat(v):t(e)&&function(e){if(null==e.nextSibling||null==e.previousSibling)return!1;return p(e.nextSibling)&&p(e.previousSibling)}(e)&&(c=c.concat(a())):r(m)&&m.append(...v),c}function C(e,n,t){const o=e.style.textAlign,l=[];let r=[];for(let e=0;e<n.length;e++){const i=n[e];if(f(i))o&&!i.getFormat()&&i.setFormat(o),l.push(i);else if(r.push(i),e===n.length-1||e<n.length-1&&f(n[e+1])){const e=t();e.setFormat(o),e.append(...r),l.push(e),r=[]}}return l}export{g as $generateHtmlFromNodes,m as $generateNodesFromDOM};\n","import { editorTheme } from '@/components/advanced/editor/themes/editor-theme';\nimport { createHeadlessEditor } from '@lexical/headless';\nimport { $generateHtmlFromNodes, $generateNodesFromDOM } from '@lexical/html';\nimport {\n  $getRoot,\n  $insertNodes,\n  SerializedEditorState,\n  SerializedElementNode,\n  SerializedLexicalNode,\n  SerializedTextNode,\n} from 'lexical';\nimport React from 'react';\nimport { nodes } from './nodes';\n\n/**\n * Focus a content-editable element within a container and move the cursor to the end\n *\n * @param container - The container element to search within\n * @returns True if a content-editable element was found and focused, false otherwise\n */\nexport function focusContentEditable(container: HTMLElement): boolean {\n  const contentEditableField = container.querySelector<HTMLElement>('[contenteditable=\"true\"]');\n  if (!contentEditableField) return false;\n\n  contentEditableField.focus();\n\n  // Move cursor to the end\n  const selection = window.getSelection();\n  const range = document.createRange();\n  range.selectNodeContents(contentEditableField);\n  range.collapse(false); // false = collapse to end\n  selection?.removeAllRanges();\n  selection?.addRange(range);\n\n  return true;\n}\n\n/**\n * Recursively check if any children have meaningful editor content\n *\n * @param children - Array of serialized lexical nodes to check\n * @returns True if any child has content, false otherwise\n */\nfunction doChildrenHaveEditorContent(\n  children: (SerializedLexicalNode | SerializedElementNode | SerializedTextNode)[] | undefined,\n): boolean {\n  if (!children) return false;\n\n  return children.some(\n    (child: SerializedLexicalNode | SerializedElementNode | SerializedTextNode) => {\n      if (child && 'text' in child && child.text.trim().length > 0) return true;\n\n      if (!child || !('children' in child)) return false;\n\n      return doChildrenHaveEditorContent(child.children);\n    },\n  );\n}\n\n/**\n * Check if the editor state has any meaningful content\n *\n * @param editorState - SerializedEditorState to check\n * @returns True if the editor has content, false if it's empty\n */\nexport function hasEditorContent(editorState: SerializedEditorState | undefined): boolean {\n  if (!editorState?.root?.children) return false;\n  return doChildrenHaveEditorContent(editorState.root.children);\n}\n\n/**\n * Convert HTML string to Lexical SerializedEditorState\n *\n * @param html - HTML string to convert\n * @returns SerializedEditorState that can be used with the Editor component\n */\nexport function htmlToEditorState(html: string): SerializedEditorState {\n  if (!html || html.trim() === '') {\n    throw new Error('Input HTML is empty');\n  }\n\n  const editor = createHeadlessEditor({\n    namespace: 'EditorUtils',\n    theme: editorTheme,\n    nodes,\n    onError: (error: Error) => {\n      console.error(error);\n    },\n  });\n\n  let serializedState: SerializedEditorState | undefined;\n\n  editor.update(\n    () => {\n      const parser = new DOMParser();\n      const dom = parser.parseFromString(html, 'text/html');\n      const generatedNodes = $generateNodesFromDOM(editor, dom);\n\n      $getRoot().clear();\n      $insertNodes(generatedNodes);\n    },\n    {\n      discrete: true,\n    },\n  );\n\n  editor.getEditorState().read(() => {\n    serializedState = editor.getEditorState().toJSON();\n  });\n\n  if (!serializedState) {\n    throw new Error('Failed to convert HTML to editor state');\n  }\n\n  return serializedState;\n}\n\n/**\n * Convert Lexical SerializedEditorState to HTML string\n *\n * @param editorState - SerializedEditorState to convert\n * @returns HTML string\n */\nexport function editorStateToHtml(editorState: SerializedEditorState): string {\n  const editor = createHeadlessEditor({\n    namespace: 'EditorUtils',\n    theme: editorTheme,\n    nodes,\n    onError: (error: Error) => {\n      console.error(error);\n    },\n  });\n\n  const parsedEditorState = editor.parseEditorState(JSON.stringify(editorState));\n  editor.setEditorState(parsedEditorState);\n\n  let html = '';\n\n  editor.getEditorState().read(() => {\n    html = $generateHtmlFromNodes(editor);\n  });\n\n  // Clean up the HTML to remove Shadcn/Lexical-specific attributes and simplify structure\n  html = html\n    // Remove style attributes\n    .replace(/\\s+style=\"[^\"]*\"/g, '')\n    // Remove all class attributes (including Tailwind classes)\n    .replace(/\\s+class=\"[^\"]*\"/g, '')\n    // Remove empty spans\n    .replace(/<span>(.*?)<\\/span>/g, '$1')\n    // Simplify nested bold tags (e.g., <b><strong>text</strong></b> -> <b>text</b>)\n    .replace(/<b><strong[^>]*>(.*?)<\\/strong><\\/b>/g, '<b>$1</b>')\n    .replace(/<strong><b[^>]*>(.*?)<\\/b><\\/strong>/g, '<b>$1</b>')\n    // Simplify nested italic tags (e.g., <i><em>text</em></i> -> <i>text</i>)\n    .replace(/<i><em[^>]*>(.*?)<\\/em><\\/i>/g, '<i>$1</i>')\n    .replace(/<em><i[^>]*>(.*?)<\\/i><\\/em>/g, '<i>$1</i>')\n    // Simplify nested underline tags (e.g., <u><span>text</span></u> -> <u>text</u>)\n    .replace(/<u><span[^>]*>(.*?)<\\/span><\\/u>/g, '<u>$1</u>')\n    // Simplify nested strikethrough tags (e.g., <s><span>text</span></s> -> <s>text</s>)\n    .replace(/<s><span[^>]*>(.*?)<\\/span><\\/s>/g, '<s>$1</s>')\n    // Convert all <br> variants to XML-compatible <br/> for Paratext\n    .replace(/<br\\s*\\/?>/gi, '<br/>');\n\n  return html;\n}\n\n/**\n * Handle keyboard events for editor navigation to prevent parent listbox from intercepting\n * navigation keys. This should be used on a container wrapping the Editor component.\n *\n * @param event - The keyboard event\n * @returns True if the event was handled (and should be stopped from propagating), false otherwise\n */\nexport function handleEditorKeyNavigation(event: React.KeyboardEvent<HTMLElement>): boolean {\n  // Keys that should be kept within the editor for navigation\n  const navigationKeys = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Home', 'End'];\n\n  if (navigationKeys.includes(event.key)) {\n    event.stopPropagation();\n    return true;\n  }\n\n  return false;\n}\n","import { Editor } from '@/components/advanced/editor/editor';\nimport {\n  editorStateToHtml,\n  focusContentEditable,\n  handleEditorKeyNavigation,\n  hasEditorContent,\n} from '@/components/advanced/editor/editor-utils';\nimport { Button } from '@/components/shadcn-ui/button';\nimport { Command, CommandItem, CommandList } from '@/components/shadcn-ui/command';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/shadcn-ui/popover';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/shadcn-ui/tooltip';\nimport {\n  SerializedEditorState,\n  SerializedElementNode,\n  SerializedParagraphNode,\n  SerializedTextNode,\n} from 'lexical';\nimport { AtSign, Check, X } from 'lucide-react';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { CommentEditorLocalizedStrings } from './comment-editor.types';\n\nconst initialValue: SerializedEditorState<\n  SerializedParagraphNode & SerializedElementNode<SerializedTextNode>\n> = {\n  root: {\n    children: [\n      {\n        children: [\n          {\n            detail: 0,\n            format: 0,\n            mode: 'normal',\n            style: '',\n            text: '',\n            type: 'text',\n            version: 1,\n          },\n        ],\n        direction: 'ltr',\n        format: '',\n        indent: 0,\n        type: 'paragraph',\n        version: 1,\n        textFormat: 0,\n        textStyle: '',\n      },\n    ],\n    direction: 'ltr',\n    format: '',\n    indent: 0,\n    type: 'root',\n    version: 1,\n  },\n};\n\n/** Interface containing the types of the properties that are passed to the `CommentEditor` */\nexport interface CommentEditorProps {\n  /** List of users that can be assigned to the new comment thread */\n  assignableUsers: string[];\n  /**\n   * External function to handle saving the new comment\n   *\n   * @param contents HTML content of the comment\n   * @param assignedUser Optional user to assign the comment to\n   */\n  onSave: (contents: string, assignedUser?: string) => void;\n  /**\n   * External function to handle closing the comment editor. Gets called when the editor is closed\n   * without saving changes\n   */\n  onClose: () => void;\n  /** Localized strings to be passed to the comment editor component */\n  localizedStrings: CommentEditorLocalizedStrings;\n}\n\n/**\n * Gets the display name for an assigned user\n *\n * @param user The user identifier (empty string for unassigned, \"Team\" for team, or username)\n * @param localizedStrings Localized strings for special values\n * @returns The display name for the user\n */\nfunction getAssignedUserDisplayName(\n  user: string,\n  localizedStrings: CommentEditorLocalizedStrings,\n): string {\n  if (user === '') {\n    return localizedStrings['%commentEditor_unassigned%'] ?? 'Unassigned';\n  }\n  if (user === 'Team') {\n    return localizedStrings['%commentEditor_team%'] ?? 'Team';\n  }\n  return user;\n}\n\n/**\n * Component to create a new project comment from within the scripture editor\n *\n * @param CommentEditorProps - The properties for the comment editor component\n */\nexport default function CommentEditor({\n  assignableUsers,\n  onSave,\n  onClose,\n  localizedStrings,\n}: CommentEditorProps) {\n  const [editorState, setEditorState] = useState<SerializedEditorState>(initialValue);\n  const [selectedUser, setSelectedUser] = useState<string | undefined>(undefined);\n  const [isAssignPopoverOpen, setIsAssignPopoverOpen] = useState<boolean>(false);\n  const clearEditorRef = useRef<(() => void) | undefined>(undefined);\n\n  // Using null for React ref compatibility\n  // eslint-disable-next-line no-null/no-null\n  const editorContainerRef = useRef<HTMLDivElement>(null);\n\n  // Focus the editor after a delay to allow any closing popover/dropdown to finish\n  useEffect(() => {\n    let isMounted = true;\n    const container = editorContainerRef.current;\n    if (!container) return undefined;\n\n    const timeoutId = setTimeout(() => {\n      if (!isMounted) return;\n      focusContentEditable(container);\n    }, 300);\n\n    return () => {\n      isMounted = false;\n      clearTimeout(timeoutId);\n    };\n  }, []);\n\n  const handleSave = useCallback(() => {\n    if (!hasEditorContent(editorState)) return;\n\n    const contents = editorStateToHtml(editorState);\n    onSave(contents, selectedUser);\n  }, [editorState, onSave, selectedUser]);\n\n  const placeholder =\n    localizedStrings['%commentEditor_placeholder%'] ?? 'Type your comment here...';\n  const saveTooltip = localizedStrings['%commentEditor_saveButton_tooltip%'] ?? 'Save comment';\n  const cancelTooltip = localizedStrings['%commentEditor_cancelButton_tooltip%'] ?? 'Cancel';\n  const assignToLabel = localizedStrings['%commentEditor_assignTo_label%'] ?? 'Assign to';\n\n  return (\n    <div className=\"pr-twp tw-grid tw-gap-3\">\n      <div className=\"tw-flex tw-items-center tw-justify-between\">\n        <span className=\"tw-text-sm tw-font-medium\">{assignToLabel}</span>\n        <div className=\"tw-flex tw-gap-2\">\n          <TooltipProvider>\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button onClick={onClose} className=\"tw-h-6 tw-w-6\" size=\"icon\" variant=\"secondary\">\n                  <X />\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>\n                <p>{cancelTooltip}</p>\n              </TooltipContent>\n            </Tooltip>\n          </TooltipProvider>\n          <TooltipProvider>\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button\n                  onClick={handleSave}\n                  className=\"tw-h-6 tw-w-6\"\n                  size=\"icon\"\n                  variant=\"default\"\n                  disabled={!hasEditorContent(editorState)}\n                >\n                  <Check />\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>\n                <p>{saveTooltip}</p>\n              </TooltipContent>\n            </Tooltip>\n          </TooltipProvider>\n        </div>\n      </div>\n\n      <div className=\"tw-flex tw-items-center tw-gap-2\">\n        <Popover open={isAssignPopoverOpen} onOpenChange={setIsAssignPopoverOpen}>\n          <PopoverTrigger asChild>\n            <Button\n              variant=\"outline\"\n              className=\"tw-flex tw-w-full tw-items-center tw-justify-start tw-gap-2\"\n              disabled={assignableUsers.length === 0}\n            >\n              <AtSign className=\"tw-h-4 tw-w-4\" />\n              <span>\n                {selectedUser !== undefined\n                  ? getAssignedUserDisplayName(selectedUser, localizedStrings)\n                  : getAssignedUserDisplayName('', localizedStrings)}\n              </span>\n            </Button>\n          </PopoverTrigger>\n          <PopoverContent\n            className=\"tw-w-auto tw-p-0\"\n            align=\"start\"\n            onKeyDown={(e) => {\n              if (e.key === 'Escape') {\n                e.stopPropagation();\n                setIsAssignPopoverOpen(false);\n              }\n            }}\n          >\n            <Command>\n              <CommandList>\n                {assignableUsers.map((user) => (\n                  <CommandItem\n                    key={user || 'unassigned'}\n                    onSelect={() => {\n                      setSelectedUser(user === '' ? undefined : user);\n                      setIsAssignPopoverOpen(false);\n                    }}\n                    className=\"tw-flex tw-items-center\"\n                  >\n                    <span>{getAssignedUserDisplayName(user, localizedStrings)}</span>\n                  </CommandItem>\n                ))}\n              </CommandList>\n            </Command>\n          </PopoverContent>\n        </Popover>\n      </div>\n\n      <div\n        ref={editorContainerRef}\n        role=\"textbox\"\n        tabIndex={-1}\n        className=\"tw-outline-none\"\n        onKeyDownCapture={(e) => {\n          if (e.key === 'Escape') {\n            e.preventDefault();\n            e.stopPropagation();\n            onClose();\n          } else if (e.key === 'Enter' && e.shiftKey) {\n            e.preventDefault();\n            e.stopPropagation();\n            if (hasEditorContent(editorState)) {\n              handleSave();\n            }\n          }\n        }}\n        onKeyDown={(e) => {\n          handleEditorKeyNavigation(e);\n          if (e.key === 'Enter' || e.key === ' ') {\n            e.stopPropagation();\n          }\n        }}\n      >\n        <Editor\n          editorSerializedState={editorState}\n          onSerializedChange={(value) => setEditorState(value)}\n          placeholder={placeholder}\n          onClear={(clearFn) => {\n            clearEditorRef.current = clearFn;\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n","/**\n * Object containing all keys used for localization in the CommentEditor component. If you're using\n * this component in an extension, you can pass it into the useLocalizedStrings hook to easily\n * obtain the localized strings and pass them into the localizedStrings prop of this component\n */\nexport const COMMENT_EDITOR_STRING_KEYS = Object.freeze([\n  '%commentEditor_placeholder%',\n  '%commentEditor_saveButton_tooltip%',\n  '%commentEditor_cancelButton_tooltip%',\n  '%commentEditor_assignTo_label%',\n  '%commentEditor_unassigned%',\n  '%commentEditor_team%',\n] as const);\n\n/** Localized strings needed for the comment editor component */\nexport type CommentEditorLocalizedStrings = {\n  [localizedKey in (typeof COMMENT_EDITOR_STRING_KEYS)[number]]?: string;\n};\n","import {\n  CommentStatus,\n  LanguageStrings,\n  LegacyComment,\n  LegacyCommentThread,\n  LocalizeKey,\n} from 'platform-bible-utils';\n\n/** Options for adding a comment to a thread */\nexport type AddCommentToThreadOptions = {\n  /** The ID of the thread to add the comment to */\n  threadId: string;\n  /** The content of the comment (optional - can be omitted when only changing status or assignment) */\n  contents?: string;\n  /** Status to set on the thread ('Resolved' or 'Todo') */\n  status?: CommentStatus;\n  /** User to assign to the thread. Use \"\" for unassigned, \"Team\" for team assignment. */\n  assignedUser?: string;\n};\n\n/**\n * Object containing all keys used for localization in the CommentList component. If you're using\n * this component in an extension, you can pass it into the useLocalizedStrings hook to easily\n * obtain the localized strings and pass them into the localizedStrings prop of this component\n */\nexport const COMMENT_LIST_STRING_KEYS: LocalizeKey[] = [\n  '%comment_assign_team%',\n  '%comment_assign_unassigned%',\n  '%comment_assigned_to%',\n  '%comment_assigning_to%',\n  '%comment_dateAtTime%',\n  '%comment_date_today%',\n  '%comment_date_yesterday%',\n  '%comment_deleteComment%',\n  '%comment_editComment%',\n  '%comment_replyOrAssign%',\n  '%comment_reopenResolved%',\n  '%comment_status_resolved%',\n  '%comment_status_todo%',\n  '%comment_thread_multiple_replies%',\n  '%comment_thread_single_reply%',\n  '%no_comments%',\n];\n\n/** Type definition for the localized strings used in the CommentList component */\nexport type CommentListLocalizedStrings = {\n  [localizedKey in (typeof COMMENT_LIST_STRING_KEYS)[number]]?: string;\n};\n\n/** Props for the CommentList component */\nexport interface CommentListProps {\n  /** Additional class name for the component */\n  className?: string;\n  /** Class name to apply to the display of the verse text for the first comment in the thread */\n  classNameForVerseText?: string;\n  /** Comment threads to render */\n  threads: LegacyCommentThread[];\n  /** Name of the current user, retrieved from the current user's Paratext Registry user information */\n  currentUser: string;\n  /** Localized strings for the component */\n  localizedStrings: LanguageStrings;\n  /**\n   * Externally controlled selected thread ID. When provided, this will be used as the selected\n   * thread instead of internal state. The parent component is responsible for updating this value\n   * when the selection changes.\n   */\n  selectedThreadId?: string;\n  /**\n   * Callback when the selected thread changes. Called when a thread is selected via click or\n   * keyboard navigation. Parent components can use this to sync their state with the internal\n   * selection.\n   */\n  onSelectedThreadChange?: (threadId: string | undefined) => void;\n  /**\n   * Handler for adding a comment to a thread. This unified handler supports:\n   *\n   * - Adding a comment (provide contents)\n   * - Resolving/unresolving a thread (provide status: 'Resolved' or 'Todo')\n   * - Assigning a user (provide assignedUser)\n   * - Any combination of the above\n   *\n   * If successful, returns the auto-generated comment ID (format: \"threadId/userName/date\").\n   * Otherwise, returns undefined.\n   */\n  handleAddCommentToThread: (options: AddCommentToThreadOptions) => Promise<string | undefined>;\n  /** Handler for updating a comment's content */\n  handleUpdateComment: (commentId: string, contents: string) => Promise<boolean>;\n  /** Handler for deleting a comment */\n  handleDeleteComment: (commentId: string) => Promise<boolean>;\n  /** Handler for updating a thread's read status */\n  handleReadStatusChange: (threadId: string, markRead: boolean) => Promise<boolean>;\n  /**\n   * Users that can be assigned to threads. Includes special values: \"Team\" for team assignment, \"\"\n   * (empty string) for unassigned.\n   */\n  assignableUsers?: string[];\n  /**\n   * Whether the current user can add comments to existing threads in this project. When false, UI\n   * elements for adding comments to threads should be hidden or disabled.\n   */\n  canUserAddCommentToThread?: boolean;\n  /**\n   * Callback to check if the current user can assign a specific thread. Returns a promise that\n   * resolves to true if the user can assign the thread, false otherwise.\n   */\n  canUserAssignThreadCallback?: (threadId: string) => Promise<boolean>;\n  /**\n   * Callback to check if the current user can resolve or re-open a specific thread. Returns a\n   * promise that resolves to true if the user can resolve the thread, false otherwise.\n   */\n  canUserResolveThreadCallback?: (threadId: string) => Promise<boolean>;\n  /**\n   * Callback to check if the current user can edit or delete a specific comment. Returns a promise\n   * that resolves to true if the user can edit or delete the comment, false otherwise.\n   */\n  canUserEditOrDeleteCommentCallback?: (commentId: string) => Promise<boolean>;\n}\n\n/** Props for the CommentThread component */\nexport interface CommentThreadProps {\n  /** Class name to apply to the display of the verse text for the first comment in the thread */\n  classNameForVerseText?: string;\n  /** Comments in the thread */\n  comments: LegacyComment[];\n  /** Localized strings for the component */\n  localizedStrings: LanguageStrings;\n  /** Whether the thread is selected */\n  isSelected?: boolean;\n  /** Verse reference for the thread */\n  verseRef?: string;\n  /** Name of the current user, retrieved from the current user's Paratext Registry user information */\n  currentUser: string;\n  /** User assigned to the thread */\n  assignedUser?: string;\n  /** Handler for selecting the thread */\n  handleSelectThread: (threadId: string) => void;\n  /** ID of the thread */\n  threadId: string;\n  /** Status of the thread */\n  threadStatus?: CommentStatus;\n  /**\n   * Handler for adding a comment to a thread. This unified handler supports:\n   *\n   * - Adding a comment (provide contents)\n   * - Resolving/unresolving a thread (provide status: 'Resolved' or 'Todo')\n   * - Assigning a user (provide assignedUser)\n   * - Any combination of the above\n   *\n   * If successful, returns the auto-generated comment ID (format: \"threadId/userName/date\").\n   * Otherwise, returns undefined.\n   */\n  handleAddCommentToThread: (options: AddCommentToThreadOptions) => Promise<string | undefined>;\n  /** Handler for updating a comment's content */\n  handleUpdateComment: (commentId: string, contents: string) => Promise<boolean>;\n  /** Handler for deleting a comment */\n  handleDeleteComment: (commentId: string) => Promise<boolean>;\n  /** Handler for updating read status */\n  handleReadStatusChange?: (threadId: string, markRead: boolean) => void;\n  /**\n   * Users that can be assigned to threads. Includes special values: \"Team\" for team assignment, \"\"\n   * (empty string) for unassigned.\n   */\n  assignableUsers?: string[];\n  /**\n   * Whether the current user can add comments to existing threads in this project. When false, UI\n   * elements for adding comments to threads should be hidden or disabled.\n   */\n  canUserAddCommentToThread?: boolean;\n  /**\n   * Callback to check if the current user can assign a specific thread. Returns a promise that\n   * resolves to true if the user can assign the thread, false otherwise.\n   */\n  canUserAssignThreadCallback?: (threadId: string) => Promise<boolean>;\n  /**\n   * Callback to check if the current user can resolve or re-open a specific thread. Returns a\n   * promise that resolves to true if the user can resolve the thread, false otherwise.\n   */\n  canUserResolveThreadCallback?: (threadId: string) => Promise<boolean>;\n  /**\n   * Callback to check if the current user can edit or delete a specific comment. Returns a promise\n   * that resolves to true if the user can edit or delete the comment, false otherwise.\n   */\n  canUserEditOrDeleteCommentCallback?: (commentId: string) => Promise<boolean>;\n  /** Whether the thread has been read (by the current user) */\n  isRead?: boolean;\n  /** Delay in seconds before auto-marking as read when selected, default 5s */\n  autoReadDelay?: number;\n}\n\n/** Props for the CommentItem component */\nexport interface CommentItemProps {\n  /** Comment to render */\n  comment: LegacyComment;\n  /** Whether the comment is a reply or a top-level comment */\n  isReply?: boolean;\n  /** Localized strings for the component */\n  localizedStrings: LanguageStrings;\n  /** Whether the thread is expanded */\n  isThreadExpanded?: boolean;\n  /** Current status of the thread */\n  threadStatus?: CommentStatus;\n  /**\n   * Handler for adding a comment to a thread (used for resolving). If successful, returns the\n   * auto-generated comment ID. Otherwise, returns undefined.\n   */\n  handleAddCommentToThread?: (options: AddCommentToThreadOptions) => Promise<string | undefined>;\n  /** Handler for updating a comment's content */\n  handleUpdateComment?: (commentId: string, contents: string) => Promise<boolean>;\n  /** Handler for deleting a comment */\n  handleDeleteComment?: (commentId: string) => Promise<boolean>;\n  /** Callback when editing state changes */\n  onEditingChange?: (isEditing: boolean) => void;\n  /** Whether the current user can edit or delete this comment */\n  canEditOrDelete?: boolean;\n  /** Whether the current user can resolve or re-open this thread. */\n  canUserResolveThread?: boolean;\n}\n","import React, { useCallback, useRef, useState } from 'react';\n\n/** Tags of interactive HTML elements to look for in the listbox */\nconst INTERACTIVE_ELEMENT_TAG_SELECTORS = ['input', 'select', 'textarea', 'button'];\n\n/** Roles of interactive HTML elements to look for in the listbox */\nconst INTERACTIVE_ELEMENT_ROLE_SELECTORS = ['button', 'textbox'];\n\n/** Properties of one option contained in a listbox */\nexport interface ListboxOption {\n  /** Unique identifier for the option */\n  id: string;\n}\n\n/** Props for the useListbox hook */\nexport interface UseListboxProps {\n  /** Array of options for the listbox */\n  options: ListboxOption[];\n  /** Callback when the focus changes to a different option */\n  onFocusChange?: (option: ListboxOption) => void;\n  /** Callback to toggle the selection of an option */\n  onOptionSelect?: (option: ListboxOption) => void;\n  /** Callback when a character key is pressed */\n  onCharacterPress?: (char: string) => void;\n}\n\n/**\n * Hook for handling keyboard navigation of a listbox.\n *\n * @param UseListboxProps - The properties for configuring the listbox behavior.\n * @returns An object containing:\n *\n *   - `listboxRef`: A ref to be attached to the listbox container element (e.g., `<ul>`), used for\n *       focus management.\n *   - `activeId`: The id of the currently focused (active) option, or `undefined` if none is focused.\n *   - `selectedId`: The id of the currently selected option, or `undefined` if none is selected.\n *   - `handleKeyDown`: A keyboard event handler to be attached to the listbox container for handling\n *       navigation and selection.\n *   - `focusOption`: A function to programmatically focus a specific option by id.\n */\nexport const useListbox = ({\n  options,\n  onFocusChange,\n  onOptionSelect,\n  onCharacterPress,\n}: UseListboxProps) => {\n  // ul/div ref property expects null and not undefined\n  // eslint-disable-next-line no-null/no-null\n  const listboxRef = useRef<HTMLElement>(null);\n  const [activeId, setActiveId] = useState<string | undefined>(undefined);\n  const [selectedId, setSelectedId] = useState<string | undefined>(undefined);\n\n  const focusOption = useCallback(\n    (id: string) => {\n      setActiveId(id);\n      const option = options.find((opt) => opt.id === id);\n      if (option) {\n        onFocusChange?.(option);\n      }\n\n      const element = document.getElementById(id);\n      if (element) {\n        element.scrollIntoView({ block: 'center' });\n        element.focus();\n      }\n\n      // Ensure aria-activedescendant is set on the listbox container for internal focus tracking\n      if (listboxRef.current) {\n        listboxRef.current.setAttribute('aria-activedescendant', id);\n      }\n    },\n    [onFocusChange, options],\n  );\n\n  const toggleSelectInternal = useCallback(\n    (id: string) => {\n      const option = options.find((opt) => opt.id === id);\n      if (!option) return;\n\n      setSelectedId((prev) => (prev === id ? undefined : id));\n      onOptionSelect?.(option);\n    },\n    [onOptionSelect, options],\n  );\n\n  // Detect if the key event originated from an interactive element inside the currently selected option\n  const isInteractiveElement = (element: HTMLElement | undefined) => {\n    if (!element) return false;\n    const tag = element.tagName.toLowerCase();\n    if (element.isContentEditable) return true;\n    if (INTERACTIVE_ELEMENT_TAG_SELECTORS.includes(tag)) return true;\n    const role = element.getAttribute('role');\n    if (role && INTERACTIVE_ELEMENT_ROLE_SELECTORS.includes(role)) return true;\n    const tabIndex = element.getAttribute('tabindex');\n    if (tabIndex !== undefined && tabIndex !== '-1') return true;\n    return false;\n  };\n\n  const handleKeyDown = useCallback(\n    (event: React.KeyboardEvent<HTMLElement>) => {\n      // Need to cast event.target to HTMLElement because the keyboard navigation can be used with multiple types of elements\n      // eslint-disable-next-line no-type-assertion/no-type-assertion\n      const targetElement = event.target as HTMLElement;\n      const getElementById = (id?: string) => (id ? document.getElementById(id) : undefined);\n      const selectedElement = getElementById(selectedId);\n      const activeElement = getElementById(activeId);\n\n      // Check if the event target is inside the selected option\n      const isInsideSelected = !!(\n        selectedElement &&\n        targetElement &&\n        selectedElement.contains(targetElement) &&\n        targetElement !== selectedElement\n      );\n      const isInteractiveInsideSelected = isInsideSelected && isInteractiveElement(targetElement);\n\n      // When focus is inside a selected option, don't hijack typical keys; allow an escape hatch back to the option\n      if (isInteractiveInsideSelected) {\n        if (\n          event.key === 'Escape' ||\n          (event.key === 'ArrowLeft' && !targetElement.isContentEditable)\n        ) {\n          if (selectedId) {\n            // Return focus to the selected option root\n            event.preventDefault();\n            event.stopPropagation();\n            const opt = options.find((o) => o.id === selectedId);\n            if (opt) {\n              focusOption(opt.id);\n            }\n          }\n          return;\n        }\n\n        // Handle ArrowUp/ArrowDown to navigate between interactive elements within the selected option\n        if (event.key === 'ArrowDown' || event.key === 'ArrowUp') {\n          if (!selectedElement) return;\n\n          // Get all focusable elements within the selected option\n          const focusableElements = Array.from(\n            selectedElement.querySelectorAll<HTMLElement>(\n              'button:not([disabled]), input:not([disabled]):not([type=\"hidden\"]), textarea:not([disabled]), select:not([disabled]), [href], [tabindex]:not([tabindex=\"-1\"])',\n            ),\n          );\n\n          if (focusableElements.length === 0) return;\n\n          const currentIndex = focusableElements.findIndex((el) => el === targetElement);\n          if (currentIndex === -1) return;\n\n          let nextIndex: number;\n          if (event.key === 'ArrowDown') {\n            nextIndex = Math.min(currentIndex + 1, focusableElements.length - 1);\n          } else {\n            nextIndex = Math.max(currentIndex - 1, 0);\n          }\n\n          if (nextIndex !== currentIndex) {\n            event.preventDefault();\n            event.stopPropagation();\n            focusableElements[nextIndex]?.focus();\n          }\n          return;\n        }\n\n        return; // Do not handle other keys while interacting within the selected option\n      }\n\n      const currentIndex = options.findIndex((opt) => opt.id === activeId);\n      let nextIndex = currentIndex;\n\n      switch (event.key) {\n        case 'ArrowDown':\n          nextIndex = Math.min(currentIndex + 1, options.length - 1);\n          event.preventDefault();\n          break;\n        case 'ArrowUp':\n          nextIndex = Math.max(currentIndex - 1, 0);\n          event.preventDefault();\n          break;\n        case 'Home':\n          nextIndex = 0;\n          event.preventDefault();\n          break;\n        case 'End':\n          nextIndex = options.length - 1;\n          event.preventDefault();\n          break;\n        case ' ':\n        case 'Enter':\n          if (activeId) {\n            toggleSelectInternal(activeId);\n          }\n          event.preventDefault();\n          event.stopPropagation();\n          return;\n        case 'ArrowRight': {\n          // If on an option, try to move focus into its first focusable control\n          const container = activeElement;\n          if (container) {\n            const preferred = container.querySelector<HTMLElement>(\n              'input:not([disabled]):not([type=\"hidden\"]), textarea:not([disabled]), select:not([disabled])',\n            );\n            const fallback = container.querySelector<HTMLElement>(\n              'button:not([disabled]), [href], [tabindex]:not([tabindex=\"-1\"]), [contenteditable=\"true\"]',\n            );\n            const toFocus = preferred ?? fallback;\n            if (toFocus) {\n              event.preventDefault();\n              toFocus.focus();\n              return;\n            }\n          }\n          break;\n        }\n        default:\n          // Only handle character keys when not inside an interactive element\n          if (event.key.length === 1 && !event.metaKey && !event.ctrlKey && !event.altKey) {\n            // Don't intercept typing in interactive elements\n            const isInInteractiveElement = isInteractiveElement(targetElement);\n            if (!isInInteractiveElement) {\n              onCharacterPress?.(event.key);\n              event.preventDefault();\n            }\n          }\n          return;\n      }\n\n      const nextOption = options[nextIndex];\n      if (nextOption) focusOption(nextOption.id);\n    },\n    [options, focusOption, activeId, selectedId, toggleSelectInternal, onCharacterPress],\n  );\n\n  return {\n    listboxRef,\n    activeId,\n    selectedId,\n    /** Keyboard event handler for listbox navigation and selection */\n    handleKeyDown,\n    /** Focus an option by its ID */\n    focusOption,\n  };\n};\n","import React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Style variants for the Badge component.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/badge}\n */\nconst badgeVariants = cva(\n  'pr-twp tw-inline-flex tw-items-center tw-rounded-full tw-px-2.5 tw-py-0.5 tw-text-xs tw-font-semibold tw-transition-colors focus:tw-outline-none focus:tw-ring-2 focus:tw-ring-ring focus:tw-ring-offset-2',\n  {\n    variants: {\n      variant: {\n        default:\n          'tw-border tw-border-transparent tw-bg-primary tw-text-primary-foreground hover:tw-bg-primary/80',\n        secondary:\n          'tw-border tw-border-transparent tw-bg-secondary tw-text-secondary-foreground hover:tw-bg-secondary/80',\n        muted:\n          'tw-border tw-border-transparent tw-bg-muted tw-text-muted-foreground hover:tw-bg-muted/80',\n        destructive:\n          'tw-border tw-border-transparent tw-bg-destructive tw-text-destructive-foreground hover:tw-bg-destructive/80',\n        outline: 'tw-border tw-text-foreground',\n        blueIndicator: 'tw-w-[5px] tw-h-[5px] tw-bg-blue-400 tw-px-0',\n        mutedIndicator: 'tw-w-[5px] tw-h-[5px] tw-bg-zinc-400 tw-px-0',\n        ghost: 'hover:tw-bg-accent hover:tw-text-accent-foreground tw-text-mu',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  },\n);\n\n/**\n * Props for the Badge component.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/badge}\n */\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\n/**\n * The Badge component displays a badge or a component that looks like a badge. The component is\n * built and styled by Shadcn UI.\n *\n * @param BadgeProps\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/badge}\n */\nconst Badge = React.forwardRef<HTMLDivElement, BadgeProps>(\n  ({ className, variant, ...props }, ref) => {\n    return (\n      <div ref={ref} className={cn('pr-twp', badgeVariants({ variant }), className)} {...props} />\n    );\n  },\n);\n\nBadge.displayName = 'Badge';\n\nexport { Badge, badgeVariants };\n","import React from 'react';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * The Card component displays a card with header, content, and footer. This component is built and\n * styled with Shadcn UI. See Shadcn UI Documentation: https://ui.shadcn.com/docs/components/card\n */\nconst Card = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n  ({ className, ...props }, ref) => (\n    <div\n      ref={ref}\n      className={cn(\n        'pr-twp tw-rounded-lg tw-border tw-bg-card tw-text-card-foreground tw-shadow-sm',\n        className,\n      )}\n      {...props}\n    />\n  ),\n);\nCard.displayName = 'Card';\n\n/** @inheritdoc Card */\nconst CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n  ({ className, ...props }, ref) => (\n    <div\n      ref={ref}\n      className={cn('pr-twp tw-flex tw-flex-col tw-space-y-1.5 tw-p-6', className)}\n      {...props}\n    />\n  ),\n);\nCardHeader.displayName = 'CardHeader';\n\n/** @inheritdoc Card */\nconst CardTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(\n  ({ className, ...props }, ref) => (\n    <h3\n      ref={ref}\n      className={cn(\n        'pr-twp tw-text-2xl tw-font-semibold tw-leading-none tw-tracking-tight',\n        className,\n      )}\n      {...props}\n    >\n      {/* added because of https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/main/docs/rules/heading-has-content.md  */}\n      {props.children}\n    </h3>\n  ),\n);\nCardTitle.displayName = 'CardTitle';\n\n/** @inheritdoc Card */\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p ref={ref} className={cn('pr-twp tw-text-sm tw-text-muted-foreground', className)} {...props} />\n));\nCardDescription.displayName = 'CardDescription';\n\n/** @inheritdoc Card */\nconst CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n  ({ className, ...props }, ref) => (\n    <div ref={ref} className={cn('pr-twp tw-p-6 tw-pt-0', className)} {...props} />\n  ),\n);\nCardContent.displayName = 'CardContent';\n\n/** @inheritdoc Card */\nconst CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n  ({ className, ...props }, ref) => (\n    <div\n      ref={ref}\n      className={cn('pr-twp tw-flex tw-items-center tw-p-6 tw-pt-0', className)}\n      {...props}\n    />\n  ),\n);\nCardFooter.displayName = 'CardFooter';\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };\n","import React from 'react';\nimport * as SeparatorPrimitive from '@radix-ui/react-separator';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * The Separator component visually or semantically separates content. This component is built on\n * Radix UI primitives and styled with Shadcn UI.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/separator}\n * @see Radix UI Documentation: {@link https://www.radix-ui.com/primitives/docs/components/separator}\n */\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(({ className, orientation = 'horizontal', decorative = true, ...props }, ref) => (\n  <SeparatorPrimitive.Root\n    ref={ref}\n    decorative={decorative}\n    orientation={orientation}\n    className={cn(\n      'pr-twp tw-shrink-0 tw-bg-border',\n      orientation === 'horizontal' ? 'tw-h-[1px] tw-w-full' : 'tw-h-full tw-w-[1px]',\n      className,\n    )}\n    {...props}\n  />\n));\nSeparator.displayName = SeparatorPrimitive.Root.displayName;\n\nexport { Separator };\n","import React from 'react';\nimport * as AvatarPrimitive from '@radix-ui/react-avatar';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * The Avatar component displays a user's profile picture or initials. The component is built and\n * styled by Shadcn UI. See Shadcn UI Documentation https://ui.shadcn.com/docs/components/avatar\n */\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      'pr-twp tw-relative tw-flex tw-h-10 tw-w-10 tw-shrink-0 tw-overflow-hidden tw-rounded-full',\n      className,\n    )}\n    {...props}\n  />\n));\nAvatar.displayName = AvatarPrimitive.Root.displayName;\n\n/** @inheritdoc Avatar */\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn('pr-twp tw-aspect-square tw-h-full tw-w-full', className)}\n    {...props}\n  />\n));\nAvatarImage.displayName = AvatarPrimitive.Image.displayName;\n\n/** @inheritdoc Avatar */\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      'pr-twp tw-flex tw-h-full tw-w-full tw-items-center tw-justify-center tw-rounded-full tw-bg-muted',\n      className,\n    )}\n    {...props}\n  />\n));\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName;\n\nexport { Avatar, AvatarImage, AvatarFallback };\n","import { cva } from 'class-variance-authority';\nimport { createContext, useContext } from 'react';\n\nexport type MenuContextProps = {\n  variant?: 'default' | 'muted';\n};\n\nexport const MenuContext = createContext<MenuContextProps | undefined>(undefined);\n\nexport function useMenuContext() {\n  const context = useContext(MenuContext);\n  if (!context) {\n    throw new Error('useMenuContext must be used within a MenuContext.Provider.');\n  }\n\n  return context;\n}\n\nexport const menuVariants = cva('', {\n  variants: {\n    variant: {\n      default: '',\n      muted:\n        'hover:tw-bg-muted hover:tw-text-foreground focus:tw-bg-muted focus:tw-text-foreground data-[state=open]:tw-bg-muted data-[state=open]:tw-text-foreground',\n    },\n  },\n  defaultVariants: {\n    variant: 'default',\n  },\n});\n","import {\n  MenuContext,\n  MenuContextProps,\n  menuVariants,\n  useMenuContext,\n} from '@/context/menu.context';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport * as DropdownMenuPrimitive from '@radix-ui/react-dropdown-menu';\nimport { Check, ChevronRight, Circle } from 'lucide-react';\nimport React from 'react';\n\n/**\n * Dropdown Menu components providing accessible dropdown menus and submenus. These components are\n * built on Radix UI primitives and styled with Shadcn UI. See Shadcn UI Documentation:\n * https://ui.shadcn.com/docs/components/dropdown-menu See Radix UI Documentation:\n * https://www.radix-ui.com/primitives/docs/components/dropdown-menu\n */\n/* #region CUSTOM Add variant prop to support different styles */\nexport type DropdownMenuProps = React.ComponentPropsWithoutRef<\n  typeof DropdownMenuPrimitive.Root\n> & {\n  variant?: MenuContextProps['variant'];\n};\n/* #endregion CUSTOM */\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuGroup = DropdownMenuPrimitive.Group;\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuPortal = DropdownMenuPrimitive.Portal;\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuSub = DropdownMenuPrimitive.Sub;\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;\n\n/** @inheritdoc DropdownMenuProps */\nexport type DropdownMenuSubTriggerProps = React.ComponentPropsWithoutRef<\n  typeof DropdownMenuPrimitive.SubTrigger\n> & {\n  className?: string;\n  inset?: boolean;\n};\n\n/** @inheritdoc DropdownMenuProps */\nexport type DropdownMenuSubContentProps = React.ComponentPropsWithoutRef<\n  typeof DropdownMenuPrimitive.SubContent\n> & {\n  className?: string;\n};\n\n/** @inheritdoc DropdownMenuProps */\nexport type DropdownMenuContentProps = React.ComponentPropsWithoutRef<\n  typeof DropdownMenuPrimitive.Content\n> & {\n  className?: string;\n  sideOffset?: number;\n};\n\n/** @inheritdoc DropdownMenuProps */\nexport type DropdownMenuItemProps = React.ComponentPropsWithoutRef<\n  typeof DropdownMenuPrimitive.Item\n> & {\n  className?: string;\n  inset?: boolean;\n};\n\n/** @inheritdoc DropdownMenuProps */\nexport type DropdownMenuCheckboxItemProps = React.ComponentPropsWithoutRef<\n  typeof DropdownMenuPrimitive.CheckboxItem\n> & {\n  className?: string;\n  checked?: boolean;\n};\n\n/** @inheritdoc DropdownMenuProps */\nexport type DropdownMenuRadioItemProps = React.ComponentPropsWithoutRef<\n  typeof DropdownMenuPrimitive.RadioItem\n> & {\n  className?: string;\n};\n\n/** @inheritdoc DropdownMenuProps */\nexport type DropdownMenuLabelProps = React.ComponentPropsWithoutRef<\n  typeof DropdownMenuPrimitive.Label\n> & {\n  className?: string;\n  inset?: boolean;\n};\n\n/** @inheritdoc DropdownMenuProps */\nexport type DropdownMenuSeparatorProps = React.ComponentPropsWithoutRef<\n  typeof DropdownMenuPrimitive.Separator\n> & {\n  className?: string;\n};\n\n/** @inheritdoc DropdownMenuProps */\nexport type DropdownMenuShortcutProps = React.HTMLAttributes<HTMLSpanElement> & {\n  className?: string;\n};\n\n/* #region CUSTOM Provide context to add variants */\n/** @inheritdoc DropdownMenuProps */\nexport function DropdownMenu({ variant = 'default', ...props }: DropdownMenuProps) {\n  const contextValue = React.useMemo<MenuContextProps>(\n    () => ({\n      variant,\n    }),\n    [variant],\n  );\n  return (\n    <MenuContext.Provider value={contextValue}>\n      <DropdownMenuPrimitive.Root {...props} />\n    </MenuContext.Provider>\n  );\n}\n/* #endregion CUSTOM */\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  DropdownMenuSubTriggerProps\n>(({ className, inset, children, ...props }, ref) => {\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <DropdownMenuPrimitive.SubTrigger\n      ref={ref}\n      className={cn(\n        'tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-px-2 tw-py-1.5 tw-text-sm tw-outline-none focus:tw-bg-accent data-[state=open]:tw-bg-accent',\n        inset && 'tw-pl-8',\n        className,\n        menuVariants({ variant: context.variant }), // CUSTOM use context to add variants\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronRight className=\"tw-ml-auto tw-h-4 tw-w-4\" />\n    </DropdownMenuPrimitive.SubTrigger>\n  );\n});\nDropdownMenuSubTrigger.displayName = DropdownMenuPrimitive.SubTrigger.displayName;\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  DropdownMenuSubContentProps\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      'pr-twp tw-z-50 tw-min-w-[8rem] tw-overflow-hidden tw-rounded-md tw-border tw-bg-popover tw-p-1 tw-text-popover-foreground tw-shadow-lg data-[state=open]:tw-animate-in data-[state=closed]:tw-animate-out data-[state=closed]:tw-fade-out-0 data-[state=open]:tw-fade-in-0 data-[state=closed]:tw-zoom-out-95 data-[state=open]:tw-zoom-in-95 data-[side=bottom]:tw-slide-in-from-top-2 data-[side=left]:tw-slide-in-from-right-2 data-[side=right]:tw-slide-in-from-left-2 data-[side=top]:tw-slide-in-from-bottom-2',\n      className,\n    )}\n    {...props}\n  />\n));\nDropdownMenuSubContent.displayName = DropdownMenuPrimitive.SubContent.displayName;\n\n/* TODO: bug in shadcn component: DropdownMenuContent does not support a dir prop.\nFor the content we can work around this by adding a div with dir, but that would not cause\nthe scrollbar to appear left in an rtl layout (e.g. see book-chapter-control.component) */\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  DropdownMenuContentProps\n>(({ className, sideOffset = 4, children, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <DropdownMenuPrimitive.Portal>\n      <DropdownMenuPrimitive.Content\n        ref={ref}\n        sideOffset={sideOffset}\n        className={cn(\n          /* adding pr-twp because the dropdown content is added to the dom as a sibling to the app root */\n          'pr-twp tw-z-50 tw-min-w-[8rem] tw-overflow-hidden tw-rounded-md tw-border tw-bg-popover tw-p-1 tw-text-popover-foreground tw-shadow-md data-[state=open]:tw-animate-in data-[state=closed]:tw-animate-out data-[state=closed]:tw-fade-out-0 data-[state=open]:tw-fade-in-0 data-[state=closed]:tw-zoom-out-95 data-[state=open]:tw-zoom-in-95 data-[side=bottom]:tw-slide-in-from-top-2 data-[side=left]:tw-slide-in-from-right-2 data-[side=right]:tw-slide-in-from-left-2 data-[side=top]:tw-slide-in-from-bottom-2',\n          className,\n        )}\n        {...props}\n      >\n        <div dir={dir}>{children}</div>\n      </DropdownMenuPrimitive.Content>\n    </DropdownMenuPrimitive.Portal>\n  );\n});\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  DropdownMenuItemProps\n>(({ className, inset, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <DropdownMenuPrimitive.Item\n      ref={ref}\n      className={cn(\n        // removed: tw-relative focus:tw-text-accent-foreground\n        'tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-px-2 tw-py-1.5 tw-text-sm tw-outline-none tw-transition-colors focus:tw-bg-accent data-[disabled]:tw-pointer-events-none data-[disabled]:tw-opacity-50',\n        inset && 'tw-pl-8',\n        className,\n        menuVariants({ variant: context.variant }), // CUSTOM use context to add variants\n      )}\n      {...props}\n      dir={dir}\n    />\n  );\n});\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  DropdownMenuCheckboxItemProps\n>(({ className, children, checked, ...props }, ref) => {\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <DropdownMenuPrimitive.CheckboxItem\n      ref={ref}\n      className={cn(\n        'tw-relative tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-py-1.5 tw-pe-2 tw-ps-8 tw-text-sm tw-outline-none tw-transition-colors focus:tw-bg-accent focus:tw-text-accent-foreground data-[disabled]:tw-pointer-events-none data-[disabled]:tw-opacity-50',\n        className,\n        menuVariants({ variant: context.variant }), // CUSTOM use context to add variants\n      )}\n      checked={checked}\n      {...props}\n    >\n      <span className=\"tw-absolute tw-flex tw-h-3.5 tw-w-3.5 tw-items-center tw-justify-center ltr:tw-left-2 rtl:tw-right-2\">\n        <DropdownMenuPrimitive.ItemIndicator>\n          <Check className=\"tw-h-4 tw-w-4\" />\n        </DropdownMenuPrimitive.ItemIndicator>\n      </span>\n      {children}\n    </DropdownMenuPrimitive.CheckboxItem>\n  );\n});\nDropdownMenuCheckboxItem.displayName = DropdownMenuPrimitive.CheckboxItem.displayName;\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  DropdownMenuRadioItemProps\n>(({ className, children, ...props }, ref) => {\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <DropdownMenuPrimitive.RadioItem\n      ref={ref}\n      className={cn(\n        'tw-relative tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-py-1.5 tw-pe-2 tw-ps-8 tw-text-sm tw-outline-none tw-transition-colors focus:tw-bg-accent focus:tw-text-accent-foreground data-[disabled]:tw-pointer-events-none data-[disabled]:tw-opacity-50',\n        className,\n        menuVariants({ variant: context.variant }), // CUSTOM use context to add variants\n      )}\n      {...props}\n    >\n      <span className=\"tw-absolute tw-flex tw-h-3.5 tw-w-3.5 tw-items-center tw-justify-center ltr:tw-left-2 rtl:tw-right-2\">\n        <DropdownMenuPrimitive.ItemIndicator>\n          <Circle className=\"tw-h-2 tw-w-2 tw-fill-current\" />\n        </DropdownMenuPrimitive.ItemIndicator>\n      </span>\n      {children}\n    </DropdownMenuPrimitive.RadioItem>\n  );\n});\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  DropdownMenuLabelProps\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn('tw-px-2 tw-py-1.5 tw-text-sm tw-font-semibold', inset && 'tw-pl-8', className)}\n    {...props}\n  />\n));\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;\n\n/** @inheritdoc DropdownMenuProps */\nexport const DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  DropdownMenuSeparatorProps\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn('tw--mx-1 tw-my-1 tw-h-px tw-bg-muted', className)}\n    {...props}\n  />\n));\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;\n\n/** @inheritdoc DropdownMenuProps */\nexport function DropdownMenuShortcut({ className, ...props }: DropdownMenuShortcutProps) {\n  return (\n    <span\n      className={cn('tw-ms-auto tw-text-xs tw-tracking-widest tw-opacity-60', className)}\n      // eslint-disable-next-line react/jsx-props-no-spreading\n      {...props}\n    />\n  );\n}\nDropdownMenuShortcut.displayName = 'DropdownMenuShortcut';\n","import { LanguageStrings } from 'platform-bible-utils';\n\n/**\n * Gets the display name for an assigned user, with localized names for special values.\n *\n * @param user - The user identifier (empty string for unassigned, 'Team' for team)\n * @param localizedStrings - The localized strings to use for display names\n * @returns The display name for the user\n */\nexport function getAssignedUserDisplayName(\n  user: string,\n  localizedStrings: LanguageStrings,\n): string {\n  if (user === '') {\n    return localizedStrings['%comment_assign_unassigned%'] ?? 'Unassigned';\n  }\n  if (user === 'Team') {\n    return localizedStrings['%comment_assign_team%'] ?? 'Team';\n  }\n  return user;\n}\n","import { Editor } from '@/components/advanced/editor/editor';\nimport {\n  editorStateToHtml,\n  focusContentEditable,\n  handleEditorKeyNavigation,\n  hasEditorContent,\n  htmlToEditorState,\n} from '@/components/advanced/editor/editor-utils';\nimport { Avatar, AvatarFallback } from '@/components/shadcn-ui/avatar';\nimport { Badge } from '@/components/shadcn-ui/badge';\nimport { Button } from '@/components/shadcn-ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/shadcn-ui/dropdown-menu';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { SerializedEditorState } from 'lexical';\nimport { ArrowUp, MoreHorizontal, Pencil, Trash2, X } from 'lucide-react';\nimport { formatRelativeDate, formatReplacementString, sanitizeHtml } from 'platform-bible-utils';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { CommentItemProps } from './comment-list.types';\nimport { getAssignedUserDisplayName } from './comment-list.utils';\n\n/**\n * A single comment item in the comment list.\n *\n * @param CommentItemProps The properties for the CommentItem component\n */\nexport function CommentItem({\n  comment,\n  isReply = false,\n  localizedStrings,\n  isThreadExpanded = false,\n  handleUpdateComment,\n  handleDeleteComment,\n  onEditingChange,\n  canEditOrDelete = false,\n}: CommentItemProps) {\n  const [isEditing, setIsEditing] = useState(false);\n  const [editorState, setEditorState] = useState<SerializedEditorState>();\n\n  // eslint-disable-next-line no-null/no-null\n  const editContainerRef = useRef<HTMLDivElement | null>(null);\n\n  // Focus the editor when entering edit mode, after dropdown menu has fully closed\n  useEffect(() => {\n    if (!isEditing) return undefined;\n\n    let isMounted = true;\n    const container = editContainerRef.current;\n    if (!container) return undefined;\n\n    /**\n     * The `Edit Comment` menu item is inside a dropdown that takes time to close. When the dropdown\n     * closes, it brings focus back to the dropdown trigger button, which steals focus from the\n     * editor. To work around this, we add a slight delay before focusing the editor. Unfortunately\n     * there is no reliable way to detect when the dropdown has fully closed, which leaves us with\n     * no other option than to use a timeout.\n     */\n    const timeoutId = setTimeout(() => {\n      if (!isMounted) return;\n      focusContentEditable(container);\n    }, 300);\n\n    return () => {\n      isMounted = false;\n      clearTimeout(timeoutId);\n    };\n  }, [isEditing]);\n\n  const handleCancelEdit = useCallback(() => {\n    setIsEditing(false);\n    setEditorState(undefined);\n    onEditingChange?.(false);\n  }, [onEditingChange]);\n\n  const handleSaveEdit = useCallback(async () => {\n    if (!editorState || !handleUpdateComment) return;\n    const isUpdateSuccessful = await handleUpdateComment(\n      comment.id,\n      editorStateToHtml(editorState),\n    );\n    if (isUpdateSuccessful) {\n      setIsEditing(false);\n      setEditorState(undefined);\n      onEditingChange?.(false);\n    }\n  }, [editorState, handleUpdateComment, comment.id, onEditingChange]);\n\n  const displayDate = useMemo(() => {\n    const date = new Date(comment.date);\n    const relativeDate = formatRelativeDate(\n      date,\n      localizedStrings['%comment_date_today%'],\n      localizedStrings['%comment_date_yesterday%'],\n    );\n    const time = date.toLocaleTimeString(undefined, {\n      hour: 'numeric',\n      minute: '2-digit',\n    });\n    return formatReplacementString(localizedStrings['%comment_dateAtTime%'], {\n      date: relativeDate,\n      time,\n    });\n  }, [comment.date, localizedStrings]);\n\n  const userLabel = useMemo(() => comment.user, [comment.user]);\n\n  // Generate initials for avatar\n  const initials = useMemo(\n    () =>\n      comment.user\n        .split(' ')\n        .map((name) => name[0])\n        .join('')\n        .toUpperCase()\n        .slice(0, 2),\n    [comment.user],\n  );\n\n  const sanitizedContent = useMemo(() => sanitizeHtml(comment.contents), [comment.contents]);\n\n  const dropdownContent = useMemo(() => {\n    if (!isThreadExpanded) return undefined;\n    if (!canEditOrDelete) return undefined;\n\n    return (\n      <>\n        <DropdownMenuItem\n          onClick={() => {\n            setIsEditing(true);\n            setEditorState(htmlToEditorState(comment.contents));\n            onEditingChange?.(true);\n          }}\n        >\n          <Pencil className=\"tw-me-2 tw-h-4 tw-w-4\" />\n          {localizedStrings['%comment_editComment%']}\n        </DropdownMenuItem>\n        <DropdownMenuItem\n          onClick={async () => {\n            if (handleDeleteComment) {\n              await handleDeleteComment(comment.id);\n            }\n          }}\n        >\n          <Trash2 className=\"tw-me-2 tw-h-4 tw-w-4\" />\n          {localizedStrings['%comment_deleteComment%']}\n        </DropdownMenuItem>\n      </>\n    );\n  }, [\n    canEditOrDelete,\n    isThreadExpanded,\n    localizedStrings,\n    comment.contents,\n    comment.id,\n    handleDeleteComment,\n    onEditingChange,\n  ]);\n\n  return (\n    <div\n      className={cn('tw-flex tw-w-full tw-flex-row tw-items-baseline tw-gap-3 tw-space-y-3', {\n        'tw-text-sm': isReply,\n      })}\n    >\n      <Avatar className=\"tw-h-8 tw-w-8\">\n        <AvatarFallback className=\"tw-text-xs tw-font-medium\">{initials}</AvatarFallback>\n      </Avatar>\n      <div className=\"tw-flex tw-flex-1 tw-flex-col tw-gap-2\">\n        <div className=\"tw-flex tw-w-full tw-flex-row tw-flex-wrap tw-items-baseline tw-gap-x-2\">\n          <p className=\"tw-text-sm tw-font-medium\">{userLabel}</p>\n          <p className=\"tw-text-xs tw-font-normal tw-text-muted-foreground\">{displayDate}</p>\n          <div className=\"tw-flex-1\" />\n          {isReply && comment.assignedUser !== undefined && (\n            <Badge variant=\"secondary\" className=\"tw-text-xs tw-font-normal\">\n              → {getAssignedUserDisplayName(comment.assignedUser, localizedStrings)}\n            </Badge>\n          )}\n        </div>\n        {isEditing && (\n          <div\n            role=\"textbox\"\n            tabIndex={-1}\n            className=\"tw-flex tw-flex-col tw-gap-2\"\n            ref={editContainerRef}\n            onKeyDownCapture={(e) => {\n              if (e.key === 'Escape') {\n                e.preventDefault();\n                e.stopPropagation();\n                handleCancelEdit();\n              } else if (e.key === 'Enter' && e.shiftKey) {\n                e.preventDefault();\n                e.stopPropagation();\n                if (hasEditorContent(editorState)) {\n                  handleSaveEdit();\n                }\n              }\n            }}\n            onKeyDown={(e) => {\n              handleEditorKeyNavigation(e);\n              if (e.key === 'Enter' || e.key === ' ') {\n                e.stopPropagation();\n              }\n            }}\n          >\n            <Editor\n              className={cn(\n                // Don't render blockquote on the first child. All comments are wrapped in blockquote\n                // that has text-align corresponding to LTR or RTL, so the blockquote is important.\n                // But we don't want it to look like there's a blockquote there. Target the\n                // lowest-level Lexical editor element by attribute so Tailwind can apply styles to\n                // the blockquote directly inside the editor.\n                '[&_[data-lexical-editor=\"true\"]>blockquote]:tw-mt-0 [&_[data-lexical-editor=\"true\"]>blockquote]:tw-border-s-0 [&_[data-lexical-editor=\"true\"]>blockquote]:tw-ps-0 [&_[data-lexical-editor=\"true\"]>blockquote]:tw-font-normal [&_[data-lexical-editor=\"true\"]>blockquote]:tw-not-italic [&_[data-lexical-editor=\"true\"]>blockquote]:tw-text-foreground',\n              )}\n              editorSerializedState={editorState}\n              onSerializedChange={(value) => setEditorState(value)}\n            />\n            <div className=\"tw-flex tw-flex-row tw-items-start tw-justify-end tw-gap-2\">\n              <Button\n                size=\"icon\"\n                onClick={handleCancelEdit}\n                variant=\"outline\"\n                className=\"tw-flex tw-items-center tw-justify-center tw-rounded-md\"\n              >\n                <X />\n              </Button>\n              <Button\n                size=\"icon\"\n                onClick={handleSaveEdit}\n                className=\"tw-flex tw-items-center tw-justify-center tw-rounded-md\"\n                disabled={!hasEditorContent(editorState)}\n              >\n                <ArrowUp />\n              </Button>\n            </div>\n          </div>\n        )}\n        {!isEditing && (\n          <>\n            {comment.status === 'Resolved' && (\n              <div className=\"tw-text-sm tw-italic\">\n                {localizedStrings['%comment_status_resolved%']}\n              </div>\n            )}\n            {comment.status === 'Todo' && isReply && (\n              <div className=\"tw-text-sm tw-italic\">\n                {localizedStrings['%comment_status_todo%']}\n              </div>\n            )}\n            <div\n              className={cn(\n                'tw-prose tw-items-start tw-gap-2 tw-break-words tw-text-sm tw-font-normal tw-text-foreground',\n                // tw-prose has a max width defined on it, that we choose to override\n                'tw-max-w-none',\n                // Don't render blockquote on the first child. All comments are wrapped in blockquote\n                // that has text-align corresponding to LTR or RTL, so the blockquote is important.\n                // But we don't want it to look like there's a blockquote there. Apply styles to the\n                // blockquote directly inside this div.\n                '[&>blockquote]:tw-border-s-0 [&>blockquote]:tw-p-0 [&>blockquote]:tw-ps-0 [&>blockquote]:tw-font-normal [&>blockquote]:tw-not-italic [&>blockquote]:tw-text-foreground',\n                // Don't render quotes on blockquotes\n                'tw-prose-quoteless',\n                {\n                  'tw-line-clamp-3': !isThreadExpanded,\n                },\n              )}\n              // The comment content is stored in HTML so it needs to be set directly. To make sure\n              // it is safe we have sanitized it first.\n              // eslint-disable-next-line react/no-danger\n              dangerouslySetInnerHTML={{ __html: sanitizedContent }}\n            />\n          </>\n        )}\n      </div>\n      {dropdownContent && (\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant=\"ghost\" size=\"icon\">\n              <MoreHorizontal />\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent align=\"end\">{dropdownContent}</DropdownMenuContent>\n        </DropdownMenu>\n      )}\n    </div>\n  );\n}\n","import { Editor } from '@/components/advanced/editor/editor';\nimport {\n  editorStateToHtml,\n  handleEditorKeyNavigation,\n  hasEditorContent,\n} from '@/components/advanced/editor/editor-utils';\nimport { Badge } from '@/components/shadcn-ui/badge';\nimport { Button } from '@/components/shadcn-ui/button';\nimport { Card, CardContent } from '@/components/shadcn-ui/card';\nimport { Separator } from '@/components/shadcn-ui/separator';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport {\n  SerializedEditorState,\n  SerializedElementNode,\n  SerializedParagraphNode,\n  SerializedTextNode,\n} from 'lexical';\nimport { ArrowUp, AtSign, Check, ChevronDown, ChevronUp, Mail, MailOpen } from 'lucide-react';\nimport { formatReplacementString } from 'platform-bible-utils';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/shadcn-ui/popover';\nimport { Command, CommandItem, CommandList } from '@/components/shadcn-ui/command';\nimport { CommentItem } from './comment-item.component';\nimport { AddCommentToThreadOptions, CommentThreadProps } from './comment-list.types';\nimport { getAssignedUserDisplayName } from './comment-list.utils';\n\nconst initialValue: SerializedEditorState<\n  SerializedParagraphNode & SerializedElementNode<SerializedTextNode>\n> = {\n  root: {\n    children: [\n      {\n        children: [\n          {\n            detail: 0,\n            format: 0,\n            mode: 'normal',\n            style: '',\n            text: '',\n            type: 'text',\n            version: 1,\n          },\n        ],\n        direction: 'ltr',\n        format: '',\n        indent: 0,\n        type: 'paragraph',\n        version: 1,\n        textFormat: 0,\n        textStyle: '',\n      },\n    ],\n    direction: 'ltr',\n    format: '',\n    indent: 0,\n    type: 'root',\n    version: 1,\n  },\n};\n\n/**\n * Represents a thread of comments\n *\n * @props CommentThreadProps\n */\nexport function CommentThread({\n  classNameForVerseText,\n  comments,\n  localizedStrings,\n  isSelected = false,\n  verseRef,\n  assignedUser,\n  currentUser,\n  handleSelectThread,\n  threadId,\n  threadStatus,\n  handleAddCommentToThread,\n  handleUpdateComment,\n  handleDeleteComment,\n  handleReadStatusChange,\n  assignableUsers,\n  canUserAddCommentToThread,\n  canUserAssignThreadCallback,\n  canUserResolveThreadCallback,\n  canUserEditOrDeleteCommentCallback,\n  isRead: isReadProp = false,\n  autoReadDelay = 5,\n}: CommentThreadProps) {\n  const [editorState, setEditorState] = useState<SerializedEditorState>(initialValue);\n  const isVerseExpanded = isSelected;\n  const [showAllReplies, setShowAllReplies] = useState<boolean>(false);\n  const [isAnyCommentEditing, setIsAnyCommentEditing] = useState<boolean>(false);\n  const [isAssignPopoverOpen, setIsAssignPopoverOpen] = useState<boolean>(false);\n  const [pendingAssignedUser, setPendingAssignedUser] = useState<string | undefined>(undefined);\n  const [canAssign, setCanAssign] = useState<boolean>(false);\n  const [canResolve, setCanResolve] = useState<boolean>(false);\n  const [isRead, setIsRead] = useState<boolean>(isReadProp);\n  const [manuallyUnread, setManuallyUnread] = useState<boolean>(false);\n  const autoReadTimerRef = useRef<ReturnType<typeof setTimeout> | undefined>(undefined);\n  const [commentEditDeletePermissions, setCommentEditDeletePermissions] = useState<\n    Map<string, boolean>\n  >(new Map());\n\n  // Check resolve permission on mount so the button can appear on hover\n  useEffect(() => {\n    let isPromiseCurrent = true;\n\n    const checkResolvePermission = async () => {\n      const resolveResult = canUserResolveThreadCallback\n        ? await canUserResolveThreadCallback(threadId)\n        : false;\n\n      if (!isPromiseCurrent) return;\n      setCanResolve(resolveResult);\n    };\n\n    checkResolvePermission();\n    return () => {\n      isPromiseCurrent = false;\n    };\n  }, [threadId, canUserResolveThreadCallback]);\n\n  // Check remaining async permissions when thread is selected\n  useEffect(() => {\n    let isPromiseCurrent = true;\n\n    if (!isSelected) {\n      setCanAssign(false);\n      setCommentEditDeletePermissions(new Map());\n      return undefined;\n    }\n\n    const checkPermissions = async () => {\n      const assignResult = canUserAssignThreadCallback\n        ? await canUserAssignThreadCallback(threadId)\n        : false;\n\n      if (!isPromiseCurrent) return;\n      setCanAssign(assignResult);\n    };\n\n    checkPermissions();\n    return () => {\n      isPromiseCurrent = false;\n    };\n  }, [isSelected, threadId, canUserAssignThreadCallback]);\n\n  const activeComments = useMemo(() => comments.filter((comment) => !comment.deleted), [comments]);\n\n  // Check edit/delete permissions for all comments when thread is selected or comments change\n  useEffect(() => {\n    let isPromiseCurrent = true;\n\n    if (!isSelected || !canUserEditOrDeleteCommentCallback) {\n      setCommentEditDeletePermissions(new Map());\n      return undefined;\n    }\n\n    const checkCommentPermissions = async () => {\n      const permissionsMap = new Map<string, boolean>();\n\n      await Promise.all(\n        activeComments.map(async (comment) => {\n          const canEdit = await canUserEditOrDeleteCommentCallback(comment.id);\n          if (isPromiseCurrent) {\n            permissionsMap.set(comment.id, canEdit);\n          }\n        }),\n      );\n\n      if (isPromiseCurrent) {\n        setCommentEditDeletePermissions(permissionsMap);\n      }\n    };\n\n    checkCommentPermissions();\n    return () => {\n      isPromiseCurrent = false;\n    };\n  }, [isSelected, activeComments, canUserEditOrDeleteCommentCallback]);\n\n  const firstComment = useMemo(() => activeComments[0], [activeComments]);\n\n  // </p> expects null and not undefined\n  // eslint-disable-next-line no-null/no-null\n  const verseTextRef = useRef<HTMLParagraphElement | null>(null);\n  const clearEditorRef = useRef<(() => void) | undefined>(undefined);\n\n  const clearEditor = useCallback(() => {\n    clearEditorRef.current?.();\n    setEditorState(initialValue);\n  }, []);\n\n  const toggleRead = useCallback(() => {\n    const newIsRead = !isRead;\n    setIsRead(newIsRead);\n    if (!newIsRead) {\n      setManuallyUnread(true);\n    } else {\n      setManuallyUnread(false);\n    }\n    handleReadStatusChange?.(threadId, newIsRead);\n  }, [isRead, handleReadStatusChange, threadId]);\n\n  useEffect(() => {\n    setShowAllReplies(false);\n  }, [isSelected]);\n\n  useEffect((): void | (() => void) => {\n    if (isSelected && !isRead && !manuallyUnread) {\n      const timer = setTimeout(() => {\n        setIsRead(true);\n        handleReadStatusChange?.(threadId, true);\n      }, autoReadDelay * 1000);\n      autoReadTimerRef.current = timer;\n      return () => clearTimeout(timer);\n    }\n    if (autoReadTimerRef.current) {\n      clearTimeout(autoReadTimerRef.current);\n      autoReadTimerRef.current = undefined;\n    }\n  }, [isSelected, isRead, manuallyUnread, autoReadDelay, threadId, handleReadStatusChange]);\n\n  const localizedReplies = useMemo(\n    () => ({\n      singleReply: localizedStrings['%comment_thread_single_reply%'],\n      multipleReplies: localizedStrings['%comment_thread_multiple_replies%'],\n    }),\n    [localizedStrings],\n  );\n\n  const localizedAssignedToText = useMemo(() => {\n    if (assignedUser === undefined) {\n      return undefined;\n    }\n    if (assignedUser === '') {\n      return localizedStrings['%comment_assign_unassigned%'] ?? 'Unassigned';\n    }\n    const displayName = getAssignedUserDisplayName(assignedUser, localizedStrings);\n    return formatReplacementString(localizedStrings['%comment_assigned_to%'], {\n      assignedUser: displayName,\n    });\n  }, [assignedUser, localizedStrings]);\n\n  const replies = useMemo(() => activeComments.slice(1), [activeComments]);\n  const replyCount = useMemo(() => replies.length ?? 0, [replies.length]);\n  const hasReplies = useMemo(() => replyCount > 0, [replyCount]);\n\n  // For expanded threads with more than 2 replies, show only the last 2 replies\n  const visibleReplies = useMemo(() => {\n    if (showAllReplies || replyCount <= 2) {\n      return replies;\n    }\n    // Show only the last 2 replies\n    return replies.slice(-2);\n  }, [replies, replyCount, showAllReplies]);\n\n  const hiddenReplyCount = useMemo(() => {\n    if (showAllReplies || replyCount <= 2) {\n      return 0;\n    }\n    return replyCount - 2;\n  }, [replyCount, showAllReplies]);\n\n  const replyText = useMemo(\n    () =>\n      replyCount === 1\n        ? localizedReplies.singleReply\n        : formatReplacementString(localizedReplies.multipleReplies, { count: replyCount }),\n    [replyCount, localizedReplies],\n  );\n\n  const hiddenReplyText = useMemo(\n    () =>\n      hiddenReplyCount === 1\n        ? localizedReplies.singleReply\n        : formatReplacementString(localizedReplies.multipleReplies, { count: hiddenReplyCount }),\n    [hiddenReplyCount, localizedReplies],\n  );\n\n  const handleSubmitComment = useCallback(async () => {\n    const contents = hasEditorContent(editorState) ? editorStateToHtml(editorState) : undefined;\n\n    // If there's a pending assignment, include it\n    if (pendingAssignedUser !== undefined) {\n      const success = await handleAddCommentToThread({\n        threadId,\n        contents,\n        assignedUser: pendingAssignedUser,\n      });\n      if (success) {\n        setPendingAssignedUser(undefined);\n        if (contents) {\n          clearEditor();\n        }\n      }\n      return;\n    }\n    // Otherwise, just add a comment if there's content\n    if (contents) {\n      const newCommentId = await handleAddCommentToThread({ threadId, contents });\n      if (newCommentId) {\n        clearEditor();\n      }\n    }\n  }, [clearEditor, editorState, handleAddCommentToThread, pendingAssignedUser, threadId]);\n\n  const handleAddCommentToThreadWithContents = useCallback(\n    async (options: AddCommentToThreadOptions) => {\n      const contents = hasEditorContent(editorState) ? editorStateToHtml(editorState) : undefined;\n      const success = await handleAddCommentToThread({\n        ...options,\n        contents,\n        assignedUser: pendingAssignedUser ?? options.assignedUser,\n      });\n      if (success && contents) {\n        clearEditor();\n      }\n      if (success && pendingAssignedUser !== undefined) {\n        setPendingAssignedUser(undefined);\n      }\n      return success;\n    },\n    [clearEditor, editorState, handleAddCommentToThread, pendingAssignedUser],\n  );\n\n  return (\n    <Card\n      role=\"option\"\n      aria-selected={isSelected}\n      id={threadId}\n      className={cn(\n        'tw-group tw-w-full tw-rounded-none tw-border-none tw-p-4 tw-outline-none tw-transition-all tw-duration-200 focus:tw-ring-2 focus:tw-ring-ring focus:tw-ring-offset-1 focus:tw-ring-offset-background',\n        { 'tw-cursor-pointer hover:tw-shadow-md': !isSelected },\n        {\n          'tw-bg-primary-foreground': !isSelected && threadStatus !== 'Resolved' && isRead,\n          'tw-bg-background': isSelected && threadStatus !== 'Resolved' && isRead,\n          'tw-bg-muted': threadStatus === 'Resolved',\n          'tw-bg-blue-50': !isRead && !isSelected && threadStatus !== 'Resolved',\n        },\n      )}\n      onClick={() => {\n        handleSelectThread(threadId);\n      }}\n      tabIndex={-1}\n    >\n      <CardContent className=\"tw-flex tw-flex-col tw-gap-2 tw-p-0\">\n        <div className=\"tw-flex tw-flex-col tw-content-center tw-items-start tw-gap-4\">\n          <div className=\"tw-flex tw-items-center tw-gap-2\">\n            {localizedAssignedToText && (\n              <Badge className=\"tw-rounded-sm tw-bg-input tw-text-sm tw-font-normal tw-text-primary hover:tw-bg-input\">\n                {localizedAssignedToText}\n              </Badge>\n            )}\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={(e) => {\n                e.stopPropagation();\n                toggleRead();\n              }}\n              className=\"tw-text-muted-foreground tw-transition hover:tw-text-foreground\"\n              aria-label={isRead ? 'Mark as unread' : 'Mark as read'}\n            >\n              {isRead ? <MailOpen /> : <Mail />}\n            </Button>\n            {canResolve && threadStatus !== 'Resolved' && (\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className={cn(\n                  'tw-ms-auto',\n                  'tw-text-primary tw-transition-opacity tw-duration-200 hover:tw-bg-primary/10',\n                  'tw-opacity-0 group-hover:tw-opacity-100',\n                )}\n                onClick={(e) => {\n                  e.stopPropagation();\n                  handleAddCommentToThreadWithContents({\n                    threadId,\n                    status: 'Resolved',\n                  });\n                }}\n                aria-label=\"Resolve thread\"\n              >\n                <Check className=\"tw-h-4 tw-w-4\" />\n              </Button>\n            )}\n          </div>\n          <div className=\"tw-flex tw-max-w-full tw-flex-wrap tw-items-baseline tw-gap-2\">\n            {/* Allow clicking to expand thread when collapsed, but allow text selection when expanded */}\n            {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events, jsx-a11y/no-noninteractive-element-interactions */}\n            <p\n              ref={verseTextRef}\n              className={cn(\n                'tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-text-sm tw-font-normal tw-text-muted-foreground',\n                {\n                  'tw-overflow-visible tw-text-clip tw-whitespace-normal tw-break-words':\n                    isVerseExpanded,\n                },\n                { 'tw-whitespace-nowrap': !isVerseExpanded },\n              )}\n            >\n              {verseRef}\n              <span className={classNameForVerseText}>\n                {firstComment.contextBefore}\n                <span className=\"tw-font-bold\">{firstComment.selectedText}</span>\n                {firstComment.contextAfter}\n              </span>\n            </p>\n          </div>\n          <CommentItem\n            comment={firstComment}\n            localizedStrings={localizedStrings}\n            isThreadExpanded={isSelected}\n            threadStatus={threadStatus}\n            handleAddCommentToThread={handleAddCommentToThreadWithContents}\n            handleUpdateComment={handleUpdateComment}\n            handleDeleteComment={handleDeleteComment}\n            onEditingChange={setIsAnyCommentEditing}\n            canEditOrDelete={commentEditDeletePermissions.get(firstComment.id) ?? false}\n            canUserResolveThread={canResolve}\n          />\n        </div>\n        <>\n          {hasReplies && !isSelected && (\n            <div className=\"tw-flex tw-items-center tw-gap-5\">\n              <div className=\"tw-w-8\">\n                <Separator />\n              </div>\n              <p className=\"tw-text-sm tw-text-muted-foreground\">{replyText}</p>\n            </div>\n          )}\n          {/* Show Editor on an unselected thread when it has drafted content */}\n          {!isSelected && hasEditorContent(editorState) && (\n            <Editor\n              editorSerializedState={editorState}\n              onSerializedChange={(value) => setEditorState(value)}\n              placeholder={localizedStrings['%comment_replyOrAssign%']}\n            />\n          )}\n          {isSelected && (\n            <>\n              {/* Show \"hidden replies\" separator before the visible replies if there are hidden replies */}\n              {hiddenReplyCount > 0 && (\n                <div\n                  className=\"tw-flex tw-cursor-pointer tw-items-center tw-gap-5 tw-py-2\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    setShowAllReplies(true);\n                  }}\n                  role=\"button\"\n                  tabIndex={0}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' || e.key === ' ') {\n                      e.preventDefault();\n                      e.stopPropagation();\n                      setShowAllReplies(true);\n                    }\n                  }}\n                >\n                  <div className=\"tw-w-8\">\n                    <Separator />\n                  </div>\n                  <div className=\"tw-flex tw-items-center tw-gap-2\">\n                    <p className=\"tw-text-sm tw-text-muted-foreground\">{hiddenReplyText}</p>\n                    {showAllReplies ? <ChevronUp /> : <ChevronDown />}\n                  </div>\n                </div>\n              )}\n              {visibleReplies.map((reply) => (\n                <div key={reply.id}>\n                  <CommentItem\n                    comment={reply}\n                    localizedStrings={localizedStrings}\n                    isReply\n                    isThreadExpanded={isSelected}\n                    handleUpdateComment={handleUpdateComment}\n                    handleDeleteComment={handleDeleteComment}\n                    onEditingChange={setIsAnyCommentEditing}\n                    canEditOrDelete={commentEditDeletePermissions.get(reply.id) ?? false}\n                  />\n                </div>\n              ))}\n\n              {/* Only show main Editor if user can add comments, no comment is being edited, or if it has draft content */}\n              {canUserAddCommentToThread !== false &&\n                (!isAnyCommentEditing || hasEditorContent(editorState)) && (\n                  <div\n                    role=\"textbox\"\n                    tabIndex={-1}\n                    className=\"tw-w-full tw-space-y-2\"\n                    onClick={(e) => e.stopPropagation()}\n                    onKeyDownCapture={(e) => {\n                      if (e.key === 'Enter' && e.shiftKey) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        if (hasEditorContent(editorState) || pendingAssignedUser !== undefined) {\n                          handleSubmitComment();\n                        }\n                      }\n                    }}\n                    onKeyDown={(e) => {\n                      handleEditorKeyNavigation(e);\n                      if (e.key === 'Enter' || e.key === ' ') {\n                        e.stopPropagation();\n                      }\n                    }}\n                  >\n                    <Editor\n                      editorSerializedState={editorState}\n                      onSerializedChange={(value) => setEditorState(value)}\n                      placeholder={\n                        threadStatus === 'Resolved'\n                          ? localizedStrings['%comment_reopenResolved%']\n                          : localizedStrings['%comment_replyOrAssign%']\n                      }\n                      autoFocus\n                      onClear={(clearFn) => {\n                        clearEditorRef.current = clearFn;\n                      }}\n                    />\n                    <div className=\"tw-flex tw-flex-row tw-items-center tw-justify-end tw-gap-2\">\n                      {pendingAssignedUser !== undefined && (\n                        <span className=\"tw-flex-1 tw-text-sm tw-text-muted-foreground\">\n                          {formatReplacementString(\n                            localizedStrings['%comment_assigning_to%'] ??\n                              'Assigning to: {assignedUser}',\n                            {\n                              assignedUser: getAssignedUserDisplayName(\n                                pendingAssignedUser,\n                                localizedStrings,\n                              ),\n                            },\n                          )}\n                        </span>\n                      )}\n                      <Popover open={isAssignPopoverOpen} onOpenChange={setIsAssignPopoverOpen}>\n                        <PopoverTrigger asChild>\n                          <Button\n                            size=\"icon\"\n                            variant=\"outline\"\n                            className=\"tw-flex tw-items-center tw-justify-center tw-rounded-md\"\n                            disabled={\n                              !canAssign ||\n                              !assignableUsers ||\n                              assignableUsers.length === 0 ||\n                              !assignableUsers.includes(currentUser)\n                            }\n                            aria-label=\"Assign user\"\n                          >\n                            <AtSign />\n                          </Button>\n                        </PopoverTrigger>\n                        <PopoverContent\n                          className=\"tw-w-auto tw-p-0\"\n                          align=\"end\"\n                          onKeyDown={(e) => {\n                            if (e.key === 'Escape') {\n                              e.stopPropagation();\n                              setIsAssignPopoverOpen(false);\n                            }\n                          }}\n                        >\n                          <Command>\n                            <CommandList>\n                              {assignableUsers?.map((user) => (\n                                <CommandItem\n                                  key={user || 'unassigned'}\n                                  onSelect={() => {\n                                    if (user !== assignedUser) {\n                                      setPendingAssignedUser(user);\n                                    } else {\n                                      setPendingAssignedUser(undefined);\n                                    }\n                                    setIsAssignPopoverOpen(false);\n                                  }}\n                                  className=\"tw-flex tw-items-center\"\n                                >\n                                  <span>{getAssignedUserDisplayName(user, localizedStrings)}</span>\n                                </CommandItem>\n                              ))}\n                            </CommandList>\n                          </Command>\n                        </PopoverContent>\n                      </Popover>\n                      <Button\n                        size=\"icon\"\n                        onClick={handleSubmitComment}\n                        className=\"tw-flex tw-items-center tw-justify-center tw-rounded-md\"\n                        disabled={\n                          !hasEditorContent(editorState) && pendingAssignedUser === undefined\n                        }\n                        aria-label=\"Submit comment\"\n                      >\n                        <ArrowUp />\n                      </Button>\n                    </div>\n                  </div>\n                )}\n            </>\n          )}\n        </>\n      </CardContent>\n    </Card>\n  );\n}\n","import { ListboxOption, useListbox } from '@/hooks/listbox-keyboard-navigation.hook';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport React, { RefObject, useCallback, useEffect, useState } from 'react';\nimport { CommentListProps } from './comment-list.types';\nimport { CommentThread } from './comment-thread.component';\n\n/**\n * Component for rendering a list of comment threads\n *\n * @param CommentListProps Props for the CommentList component\n */\nexport default function CommentList({\n  className = '',\n  classNameForVerseText,\n  threads,\n  currentUser,\n  localizedStrings,\n  handleAddCommentToThread,\n  handleUpdateComment,\n  handleDeleteComment,\n  handleReadStatusChange,\n  assignableUsers,\n  canUserAddCommentToThread,\n  canUserAssignThreadCallback,\n  canUserResolveThreadCallback,\n  canUserEditOrDeleteCommentCallback,\n  selectedThreadId: externalSelectedThreadId,\n  onSelectedThreadChange,\n}: CommentListProps) {\n  const [expandedThreadIds, setExpandedThreadIds] = useState<Set<string>>(new Set());\n  const [lastInteractedThreadId, setLastInteractedThreadId] = useState<string | undefined>();\n\n  // When external selection changes, add it to expanded set\n  useEffect(() => {\n    if (externalSelectedThreadId) {\n      setExpandedThreadIds((prev) => new Set(prev).add(externalSelectedThreadId));\n      setLastInteractedThreadId(externalSelectedThreadId);\n    }\n  }, [externalSelectedThreadId]);\n\n  const activeThreads = threads.filter((thread) =>\n    thread.comments.some((comment) => !comment.deleted),\n  );\n\n  const options: ListboxOption[] = activeThreads.map((thread) => ({\n    id: thread.id,\n  }));\n\n  const handleKeyboardSelectThread = useCallback(\n    (option: ListboxOption) => {\n      setExpandedThreadIds((prev) => new Set(prev).add(option.id));\n      setLastInteractedThreadId(option.id);\n      onSelectedThreadChange?.(option.id);\n    },\n    [onSelectedThreadChange],\n  );\n\n  const handleSelectThread = useCallback(\n    (threadId: string) => {\n      const isCollapsing = expandedThreadIds.has(threadId);\n      setExpandedThreadIds((prev) => {\n        const next = new Set(prev);\n        if (next.has(threadId)) {\n          next.delete(threadId);\n        } else {\n          next.add(threadId);\n        }\n        return next;\n      });\n      setLastInteractedThreadId(threadId);\n      onSelectedThreadChange?.(isCollapsing ? undefined : threadId);\n    },\n    [expandedThreadIds, onSelectedThreadChange],\n  );\n\n  const { listboxRef, activeId, handleKeyDown } = useListbox({\n    options,\n    onOptionSelect: handleKeyboardSelectThread,\n  });\n\n  // Collapse the last interacted thread when Escape is pressed\n  const handleKeyDownWithEscape = useCallback(\n    (event: React.KeyboardEvent<HTMLDivElement>) => {\n      if (event.key === 'Escape') {\n        if (lastInteractedThreadId && expandedThreadIds.has(lastInteractedThreadId)) {\n          setExpandedThreadIds((prev) => {\n            const next = new Set(prev);\n            next.delete(lastInteractedThreadId);\n            return next;\n          });\n          setLastInteractedThreadId(undefined);\n          onSelectedThreadChange?.(undefined);\n        }\n        event.preventDefault();\n        event.stopPropagation();\n      } else {\n        handleKeyDown(event);\n      }\n    },\n    [lastInteractedThreadId, expandedThreadIds, handleKeyDown, onSelectedThreadChange],\n  );\n\n  return (\n    <div\n      id=\"comment-list\"\n      role=\"listbox\"\n      tabIndex={0}\n      // The listboxRef is an HTMLElement so that the keyboard navigation can be used with multiple types of elements\n      // eslint-disable-next-line no-type-assertion/no-type-assertion\n      ref={listboxRef as RefObject<HTMLDivElement>}\n      aria-activedescendant={activeId ?? undefined}\n      aria-label=\"Comments\"\n      className={cn(\n        'tw-flex tw-w-full tw-flex-col tw-space-y-3 tw-outline-none focus:tw-ring-2 focus:tw-ring-ring focus:tw-ring-offset-1 focus:tw-ring-offset-background',\n\n        className,\n      )}\n      onKeyDown={handleKeyDownWithEscape}\n    >\n      {activeThreads.map((thread) => (\n        <div\n          key={thread.id}\n          id={thread.id}\n          className={cn({\n            'tw-opacity-60': thread.status === 'Resolved',\n          })}\n        >\n          <CommentThread\n            classNameForVerseText={classNameForVerseText}\n            comments={thread.comments}\n            localizedStrings={localizedStrings}\n            verseRef={thread.verseRef}\n            handleSelectThread={handleSelectThread}\n            threadId={thread.id}\n            isRead={thread.isRead}\n            isSelected={expandedThreadIds.has(thread.id)}\n            currentUser={currentUser}\n            assignedUser={thread.assignedUser}\n            threadStatus={thread.status}\n            handleAddCommentToThread={handleAddCommentToThread}\n            handleUpdateComment={handleUpdateComment}\n            handleDeleteComment={handleDeleteComment}\n            handleReadStatusChange={handleReadStatusChange}\n            assignableUsers={assignableUsers}\n            canUserAddCommentToThread={canUserAddCommentToThread}\n            canUserAssignThreadCallback={canUserAssignThreadCallback}\n            canUserResolveThreadCallback={canUserResolveThreadCallback}\n            canUserEditOrDeleteCommentCallback={canUserEditOrDeleteCommentCallback}\n          />\n        </div>\n      ))}\n    </div>\n  );\n}\n","import { DropdownMenuTrigger } from '@radix-ui/react-dropdown-menu';\nimport { FilterIcon } from 'lucide-react';\nimport { Table } from '@tanstack/react-table';\n\nimport { Button } from '@/components/shadcn-ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuCheckboxItem,\n  DropdownMenuContent,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n} from '@/components/shadcn-ui/dropdown-menu';\n\ninterface DataTableViewOptionsProps<TData> {\n  table: Table<TData>;\n}\n\nexport function DataTableViewOptions<TData>({ table }: DataTableViewOptionsProps<TData>) {\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"outline\" size=\"sm\" className=\"tw-ml-auto tw-hidden tw-h-8 lg:tw-flex\">\n          <FilterIcon className=\"tw-mr-2 tw-h-4 tw-w-4\" />\n          View\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"tw-w-[150px]\">\n        <DropdownMenuLabel>Toggle columns</DropdownMenuLabel>\n        <DropdownMenuSeparator />\n        {table\n          .getAllColumns()\n          .filter((column) => column.getCanHide())\n          .map((column) => {\n            return (\n              <DropdownMenuCheckboxItem\n                key={column.id}\n                className=\"tw-capitalize\"\n                checked={column.getIsVisible()}\n                onCheckedChange={(value) => column.toggleVisibility(!!value)}\n              >\n                {column.id}\n              </DropdownMenuCheckboxItem>\n            );\n          })}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n\nexport default DataTableViewOptions;\n","import React from 'react';\nimport * as SelectPrimitive from '@radix-ui/react-select';\nimport { Check, ChevronDown, ChevronUp } from 'lucide-react';\n\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\nimport { cva, VariantProps } from 'class-variance-authority';\n\n/**\n * Props for Select component\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/select}\n */\nexport interface SelectTriggerProps\n  extends React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>,\n    VariantProps<typeof selectTriggerVariants> {\n  asChild?: boolean;\n}\n\n/**\n * Select components display a list of options for the user to pick from—triggered by a button.\n * These components are built on Radix UI primitives and styled with Shadcn UI.\n *\n * See Shadcn UI Documentation: https://ui.shadcn.com/docs/components/select See Radix UI\n * Documentation: https://www.radix-ui.com/primitives/docs/components/select\n */\nconst Select = SelectPrimitive.Root;\n\n/** @inheritdoc Select */\nconst SelectGroup = SelectPrimitive.Group;\n\n/** @inheritdoc Select */\nconst SelectValue = SelectPrimitive.Value;\n\n/**\n * Style variants for the Select Trigger component.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/button}\n */\nexport const selectTriggerVariants = cva(\n  'tw-flex tw-h-10 tw-w-full tw-items-center tw-justify-between tw-rounded-md tw-border tw-border-input tw-bg-background tw-px-3 tw-py-2 tw-text-sm tw-ring-offset-background placeholder:tw-text-muted-foreground focus:tw-outline-none focus:tw-ring-2 focus:tw-ring-ring focus:tw-ring-offset-2 disabled:tw-cursor-not-allowed disabled:tw-opacity-50 [&>span]:tw-line-clamp-1',\n  {\n    variants: {\n      size: {\n        default: 'tw-h-10 tw-px-4 tw-py-2',\n        sm: 'tw-h-8 tw-rounded-md tw-px-3',\n        lg: 'tw-h-11 tw-rounded-md tw-px-8',\n        icon: 'tw-h-10 tw-w-10',\n      },\n    },\n    defaultVariants: {\n      size: 'default',\n    },\n  },\n);\n\n/** @inheritdoc Select */\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  SelectTriggerProps\n>(({ className, children, size, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <SelectPrimitive.Trigger\n      className={cn(selectTriggerVariants({ size, className }))}\n      ref={ref}\n      {...props}\n      dir={dir}\n    >\n      {children}\n      <SelectPrimitive.Icon asChild>\n        <ChevronDown className=\"tw-h-4 tw-w-4 tw-opacity-50\" />\n      </SelectPrimitive.Icon>\n    </SelectPrimitive.Trigger>\n  );\n});\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName;\n\n/** @inheritdoc Select */\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn('tw-flex tw-cursor-default tw-items-center tw-justify-center tw-py-1', className)}\n    {...props}\n  >\n    <ChevronUp className=\"tw-h-4 tw-w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n));\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;\n\n/** @inheritdoc Select */\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn('tw-flex tw-cursor-default tw-items-center tw-justify-center tw-py-1', className)}\n    {...props}\n  >\n    <ChevronDown className=\"tw-h-4 tw-w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n));\nSelectScrollDownButton.displayName = SelectPrimitive.ScrollDownButton.displayName;\n\n/** @inheritdoc Select */\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = 'popper', ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <SelectPrimitive.Portal>\n      <SelectPrimitive.Content\n        ref={ref}\n        className={cn(\n          'pr-twp tw-relative tw-z-50 tw-max-h-96 tw-min-w-[8rem] tw-overflow-hidden tw-rounded-md tw-border tw-bg-popover tw-text-popover-foreground tw-shadow-md data-[state=open]:tw-animate-in data-[state=closed]:tw-animate-out data-[state=closed]:tw-fade-out-0 data-[state=open]:tw-fade-in-0 data-[state=closed]:tw-zoom-out-95 data-[state=open]:tw-zoom-in-95 data-[side=bottom]:tw-slide-in-from-top-2 data-[side=left]:tw-slide-in-from-right-2 data-[side=right]:tw-slide-in-from-left-2 data-[side=top]:tw-slide-in-from-bottom-2',\n          position === 'popper' &&\n            'data-[side=bottom]:tw-translate-y-1 data-[side=left]:tw--translate-x-1 data-[side=right]:tw-translate-x-1 data-[side=top]:tw--translate-y-1',\n          className,\n        )}\n        position={position}\n        {...props}\n      >\n        <SelectScrollUpButton />\n        <SelectPrimitive.Viewport\n          className={cn(\n            'tw-p-1',\n            position === 'popper' &&\n              'tw-h-[var(--radix-select-trigger-height)] tw-w-full tw-min-w-[var(--radix-select-trigger-width)]',\n          )}\n        >\n          <div dir={dir}>{children}</div>\n        </SelectPrimitive.Viewport>\n        <SelectScrollDownButton />\n      </SelectPrimitive.Content>\n    </SelectPrimitive.Portal>\n  );\n});\nSelectContent.displayName = SelectPrimitive.Content.displayName;\n\n/** @inheritdoc Select */\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn('tw-py-1.5 tw-pl-8 tw-pr-2 tw-text-sm tw-font-semibold', className)}\n    {...props}\n  />\n));\nSelectLabel.displayName = SelectPrimitive.Label.displayName;\n\n/** @inheritdoc Select */\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      'tw-relative tw-flex tw-w-full tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-py-1.5 tw-pe-2 tw-ps-8 tw-text-sm tw-outline-none focus:tw-bg-accent focus:tw-text-accent-foreground data-[disabled]:tw-pointer-events-none data-[disabled]:tw-opacity-50',\n      className,\n    )}\n    {...props}\n  >\n    <span className=\"tw-absolute tw-start-2 tw-flex tw-h-3.5 tw-w-3.5 tw-items-center tw-justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"tw-h-4 tw-w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n));\nSelectItem.displayName = SelectPrimitive.Item.displayName;\n\n/** @inheritdoc Select */\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn('tw--mx-1 tw-my-1 tw-h-px tw-bg-muted', className)}\n    {...props}\n  />\n));\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName;\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n};\n","import { ChevronLeftIcon, ChevronRightIcon, ArrowLeftIcon, ArrowRightIcon } from 'lucide-react';\nimport { Table } from '@tanstack/react-table';\n\nimport { Button } from '@/components/shadcn-ui/button';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/shadcn-ui/select';\n\ninterface DataTablePaginationProps<TData> {\n  table: Table<TData>;\n}\n\nexport function DataTablePagination<TData>({ table }: DataTablePaginationProps<TData>) {\n  return (\n    <div className=\"tw-flex tw-items-center tw-justify-between tw-px-2 tw-pb-3 tw-pt-3\">\n      <div className=\"tw-flex tw-items-center tw-space-x-6 lg:tw-space-x-8\">\n        <div className=\"tw-flex-1 tw-text-sm tw-text-muted-foreground\">\n          {table.getFilteredSelectedRowModel().rows.length} of{' '}\n          {table.getFilteredRowModel().rows.length} row(s) selected\n        </div>\n        <div className=\"tw-flex tw-items-center tw-space-x-2\">\n          <p className=\"tw-text-nowrap tw-text-sm tw-font-medium\">Rows per page</p>\n          <Select\n            value={`${table.getState().pagination.pageSize}`}\n            onValueChange={(value) => {\n              table.setPageSize(Number(value));\n            }}\n          >\n            <SelectTrigger className=\"tw-h-8 tw-w-[70px]\">\n              <SelectValue placeholder={table.getState().pagination.pageSize} />\n            </SelectTrigger>\n            <SelectContent side=\"top\">\n              {[10, 20, 30, 40, 50].map((pageSize) => (\n                <SelectItem key={pageSize} value={`${pageSize}`}>\n                  {pageSize}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n        <div className=\"tw-flex tw-w-[100px] tw-items-center tw-justify-center tw-text-sm tw-font-medium\">\n          Page {table.getState().pagination.pageIndex + 1} of {table.getPageCount()}\n        </div>\n        <div className=\"tw-flex tw-items-center tw-space-x-2\">\n          <Button\n            variant=\"outline\"\n            size=\"icon\"\n            className=\"tw-hidden tw-h-8 tw-w-8 tw-p-0 lg:tw-flex\"\n            onClick={() => table.setPageIndex(0)}\n            disabled={!table.getCanPreviousPage()}\n          >\n            <span className=\"tw-sr-only\">Go to first page</span>\n            <ArrowLeftIcon className=\"tw-h-4 tw-w-4\" />\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"icon\"\n            className=\"tw-h-8 tw-w-8 tw-p-0\"\n            onClick={() => table.previousPage()}\n            disabled={!table.getCanPreviousPage()}\n          >\n            <span className=\"tw-sr-only\">Go to previous page</span>\n            <ChevronLeftIcon className=\"tw-h-4 tw-w-4\" />\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"icon\"\n            className=\"tw-h-8 tw-w-8 tw-p-0\"\n            onClick={() => table.nextPage()}\n            disabled={!table.getCanNextPage()}\n          >\n            <span className=\"tw-sr-only\">Go to next page</span>\n            <ChevronRightIcon className=\"tw-h-4 tw-w-4\" />\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"icon\"\n            className=\"tw-hidden tw-h-8 tw-w-8 tw-p-0 lg:tw-flex\"\n            onClick={() => table.setPageIndex(table.getPageCount() - 1)}\n            disabled={!table.getCanNextPage()}\n          >\n            <span className=\"tw-sr-only\">Go to last page</span>\n            <ArrowRightIcon className=\"tw-h-4 tw-w-4\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default DataTablePagination;\n","/** Defines HTML elements that can be focusable by keyboard as a CSS selector string */\nconst FOCUSABLE_SELECTOR = `\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [contenteditable],\n  tr:not([disabled])\n`;\n\n/** Returns true if the element is visible in the DOM */\nfunction isVisible(el: HTMLElement): boolean {\n  return !!(el.offsetWidth || el.offsetHeight || el.getClientRects().length);\n}\n\n/**\n * Finds all focusable elements in the given container. Focusable elements are all HTML elements\n * that can receive keyboard focus, and are not disabled or hidden from screen readers.\n *\n * @param container The container element to search for focusable elements.\n * @param uniqueQuerySelector An optional CSS selector to filter the focusable elements by.\n * @returns An array of focusable elements.\n */\nexport function getFocusableElements(\n  container: HTMLElement,\n  uniqueQuerySelector?: string,\n): HTMLElement[] {\n  const query = uniqueQuerySelector\n    ? `${FOCUSABLE_SELECTOR}, ${uniqueQuerySelector}`\n    : FOCUSABLE_SELECTOR;\n  return Array.from(container.querySelectorAll<HTMLElement>(query)).filter(\n    (el) => !el.hasAttribute('disabled') && !el.getAttribute('aria-hidden') && isVisible(el),\n  );\n}\n","import React from 'react';\nimport { getFocusableElements } from '@/utils/focus.util';\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Table components provide a responsive table. These components are built and styled with Shadcn\n * UI. See Shadcn UI Documentation: https://ui.shadcn.com/docs/components/table\n */\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement> & { stickyHeader?: boolean }\n>(({ className, stickyHeader, ...props }, ref) => {\n  // CUSTOM: Use internal ref to manage keyboard navigation and Enter key behavior\n  // This ref gets passed into the table row ref property which expects null and not undefined\n  // eslint-disable-next-line no-null/no-null\n  const tableRef = React.useRef<HTMLTableElement>(null);\n\n  // CUSTOM: Assign internal ref to external ref if provided\n  React.useEffect(() => {\n    if (typeof ref === 'function') {\n      ref(tableRef.current);\n    } else if (ref && 'current' in ref) {\n      ref.current = tableRef.current;\n    }\n  }, [ref]);\n\n  // CUSTOM: Force tabindex -1 on all focusable elements within the table to prevent tab navigation\n  React.useEffect(() => {\n    const currentTable = tableRef.current;\n    if (!currentTable) return;\n\n    const setTabIndexes = () => {\n      requestAnimationFrame(() => {\n        const focusables = getFocusableElements(currentTable, `[tabindex]:not([tabindex=\"-1\"])`);\n        focusables.forEach((el) => {\n          el.setAttribute('tabindex', '-1');\n        });\n      });\n    };\n\n    setTabIndexes();\n\n    const observer = new MutationObserver(() => {\n      setTabIndexes();\n    });\n\n    observer.observe(currentTable, {\n      childList: true, // Watch for added/removed elements\n      subtree: true, // Include descendants\n      attributes: true,\n      attributeFilter: ['tabindex'], // Watch for tabindex changes\n    });\n\n    return () => {\n      observer.disconnect();\n    };\n  }, []);\n\n  // CUSTOM: Handle keydown events for the table\n  const handleKeyDownInTable = (e: React.KeyboardEvent<HTMLDivElement>) => {\n    const { current: currentTable } = tableRef;\n    if (!currentTable) return;\n\n    if (e.key === 'ArrowDown') {\n      // Move focus to the first row in the table (header or body)\n      e.preventDefault();\n      const firstRow = getFocusableElements(currentTable)[0];\n      firstRow.focus();\n      return;\n    }\n    if (e.key === ' ' && document.activeElement === currentTable) {\n      e.preventDefault(); // Prevent scrolling\n    }\n  };\n\n  return (\n    <div className={cn('pr-twp tw-relative tw-w-full', { 'tw-p-1': stickyHeader })}>\n      {/* Table element is not interactive by default but we need to add a keydown handler */}\n      {/* eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions */}\n      <table\n        // Need to add a keydown handler to the table to prevent default behavior of space, enter, and arrow down keys\n        // eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex\n        tabIndex={0} // CUSTOM: Make table tabbable\n        onKeyDown={handleKeyDownInTable} // CUSTOM: Enable keyboard behavior\n        ref={tableRef} // CUSTOM: Use internal ref to manage keyboard navigation\n        className={cn(\n          'tw-w-full tw-caption-bottom tw-text-sm tw-outline-none', // CUSTOM: Add outline-none to remove duplicate outline\n          'focus:tw-relative focus:tw-z-10 focus:tw-ring-2 focus:tw-ring-ring focus:tw-ring-offset-1 focus:tw-ring-offset-background', // CUSTOM: Add focus styles\n          className,\n        )}\n        aria-label=\"Table\" // CUSTOM: Add aria-label for accessibility\n        aria-labelledby=\"table-label\" // CUSTOM: Add aria-labelledby for accessibility\n        {...props}\n      />\n    </div>\n  );\n});\nTable.displayName = 'Table';\n\n/** @inheritdoc Table */\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement> & { stickyHeader?: boolean }\n>(({ className, stickyHeader, ...props }, ref) => (\n  <thead\n    ref={ref}\n    className={cn(\n      {\n        'tw-sticky tw-top-[-1px] tw-z-20 tw-bg-background tw-drop-shadow-sm': stickyHeader,\n      },\n      '[&_tr]:tw-border-b',\n      className,\n    )}\n    {...props}\n  />\n));\nTableHeader.displayName = 'TableHeader';\n\n/** @inheritdoc Table */\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody ref={ref} className={cn('[&_tr:last-child]:tw-border-0', className)} {...props} />\n));\nTableBody.displayName = 'TableBody';\n\n/** @inheritdoc Table */\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn('tw-border-t tw-bg-muted/50 tw-font-medium [&>tr]:last:tw-border-b-0', className)}\n    {...props}\n  />\n));\nTableFooter.displayName = 'TableFooter';\n\n// CUSTOM: Manage keyboard navigation and Enter key behavior for focusable elements in a row\nfunction useFocusableInRowKeyboardNavigation(rowRef: React.RefObject<HTMLTableRowElement>) {\n  React.useEffect(() => {\n    const row = rowRef.current;\n    if (!row) return;\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (!row.contains(document.activeElement)) return;\n\n      if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {\n        e.preventDefault();\n        e.stopPropagation(); // Helps override internal widget handlers\n        const focusables = rowRef.current ? getFocusableElements(rowRef.current) : [];\n        // activeElement is generic Element, so we need to cast it to HTMLElement\n        // eslint-disable-next-line no-type-assertion/no-type-assertion\n        const index = focusables.indexOf(document.activeElement as HTMLElement);\n        const nextIndex = e.key === 'ArrowRight' ? index + 1 : index - 1;\n        if (nextIndex >= 0 && nextIndex < focusables.length) {\n          focusables[nextIndex].focus();\n        }\n      }\n\n      if (e.key === 'Escape') {\n        e.preventDefault();\n        row.focus();\n      }\n\n      if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {\n        e.preventDefault();\n      }\n    };\n\n    row.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      row.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [rowRef]);\n}\n\n// CUSTOM: Move focus left or right to adjacent focusable items in the same row\nfunction focusAdjacentFocusableElementInRow(\n  focusablesInRow: HTMLElement[],\n  currentIndexOfFocusables: number,\n  direction: 'ArrowLeft' | 'ArrowRight',\n) {\n  let nextFocusable: HTMLElement | undefined;\n  if (direction === 'ArrowLeft' && currentIndexOfFocusables > 0) {\n    nextFocusable = focusablesInRow[currentIndexOfFocusables - 1];\n  } else if (direction === 'ArrowRight' && currentIndexOfFocusables < focusablesInRow.length - 1) {\n    nextFocusable = focusablesInRow[currentIndexOfFocusables + 1];\n  }\n  if (nextFocusable) {\n    requestAnimationFrame(() => nextFocusable.focus());\n    return true;\n  }\n  return false;\n}\n\n// CUSTOM: Move focus up or down to adjacent rows in the same table\nfunction focusAdjacentRow(\n  rowsInTable: HTMLTableRowElement[],\n  currentRowIndex: number,\n  direction: 'ArrowDown' | 'ArrowUp',\n) {\n  let nextRow: HTMLTableRowElement | undefined;\n  if (direction === 'ArrowDown' && currentRowIndex < rowsInTable.length - 1) {\n    nextRow = rowsInTable[currentRowIndex + 1];\n  } else if (direction === 'ArrowUp' && currentRowIndex > 0) {\n    nextRow = rowsInTable[currentRowIndex - 1];\n  }\n  if (nextRow) {\n    requestAnimationFrame(() => nextRow.focus());\n    return true;\n  }\n  return false;\n}\n\n/** @inheritdoc Table */\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement> & { setFocusAlsoRunsSelect?: boolean }\n>(({ className, onKeyDown, onSelect, setFocusAlsoRunsSelect = false, ...props }, ref) => {\n  // CUSTOM: Use internal ref to manage keyboard navigation and Enter key behavior\n  // This ref gets passed into the table row ref property which expects null and not undefined\n  // eslint-disable-next-line no-null/no-null\n  const rowRef = React.useRef<HTMLTableRowElement>(null);\n\n  // CUSTOM: Assign internal ref to external ref if provided\n  React.useEffect(() => {\n    if (typeof ref === 'function') {\n      ref(rowRef.current);\n    } else if (ref && 'current' in ref) {\n      ref.current = rowRef.current;\n    }\n  }, [ref]);\n\n  // CUSTOM: Use internal ref to manage keyboard navigation and Enter key behavior\n  useFocusableInRowKeyboardNavigation(rowRef);\n\n  // CUSTOM: Get all focusable elements in the current row\n  const focusablesInRow = React.useMemo(\n    () => (rowRef.current ? getFocusableElements(rowRef.current) : []),\n    [rowRef],\n  );\n\n  // CUSTOM: Handle keydown events for keyboard navigation\n  const handleKeyDown = React.useCallback(\n    (e: React.KeyboardEvent<HTMLTableRowElement>) => {\n      const { current: currentRow } = rowRef;\n      if (!currentRow || !currentRow.parentElement) return;\n\n      const closestTable = currentRow.closest('table');\n      const rowsInTable = closestTable\n        ? // getFocusableElements returns an HTMLElement[] but we are filtering for HTMLTableRowElements\n          // eslint-disable-next-line no-type-assertion/no-type-assertion\n          (getFocusableElements(closestTable) as HTMLTableRowElement[]).filter(\n            (element) => element.tagName === 'TR',\n          )\n        : [];\n      const currentRowIndex = rowsInTable.indexOf(currentRow);\n      const currentIndexOfFocusables = focusablesInRow.indexOf(\n        // activeElement is generic Element, so we need to cast it to HTMLElement\n        // eslint-disable-next-line no-type-assertion/no-type-assertion\n        document.activeElement as HTMLElement,\n      );\n\n      if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {\n        e.preventDefault();\n        focusAdjacentRow(rowsInTable, currentRowIndex, e.key);\n      } else if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {\n        e.preventDefault();\n        focusAdjacentFocusableElementInRow(focusablesInRow, currentIndexOfFocusables, e.key);\n      } else if (e.key === 'Escape') {\n        e.preventDefault();\n        const table = currentRow.closest('table');\n        if (table) {\n          table.focus();\n        }\n      }\n\n      // Call user-defined onKeyDown handler if provided\n      onKeyDown?.(e);\n    },\n    [rowRef, focusablesInRow, onKeyDown],\n  );\n\n  const handleFocus = React.useCallback(\n    (e: React.FocusEvent<HTMLTableRowElement>) => {\n      if (setFocusAlsoRunsSelect) onSelect?.(e);\n    },\n    [setFocusAlsoRunsSelect, onSelect],\n  );\n\n  return (\n    <tr\n      ref={rowRef}\n      tabIndex={-1} // CUSTOM: Make row not tabbable\n      onKeyDown={handleKeyDown} // CUSTOM: Enable keyboard behavior\n      onFocus={handleFocus} // CUSTOM: Handle focus event\n      className={cn(\n        // CUSTOM: Add focus styles and add tw-outline-none so there isn't a duplicate outline\n        'tw-border-b tw-outline-none tw-transition-colors hover:tw-bg-muted/50',\n        'focus:tw-relative focus:tw-z-10 focus:tw-ring-2 focus:tw-ring-ring focus:tw-ring-offset-1 focus:tw-ring-offset-background',\n        'data-[state=selected]:tw-bg-muted',\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nTableRow.displayName = 'TableRow';\n\n/** @inheritdoc Table */\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      'tw-h-12 tw-px-4 tw-text-start tw-align-middle tw-font-medium tw-text-muted-foreground [&:has([role=checkbox])]:tw-pe-0',\n      className,\n    )}\n    {...props}\n  />\n));\nTableHead.displayName = 'TableHead';\n\n/** @inheritdoc Table */\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn('tw-p-4 tw-align-middle [&:has([role=checkbox])]:tw-pe-0', className)}\n    {...props}\n  />\n));\nTableCell.displayName = 'TableCell';\n\n/** @inheritdoc Table */\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn('tw-mt-4 tw-text-sm tw-text-muted-foreground', className)}\n    {...props}\n  />\n));\nTableCaption.displayName = 'TableCaption';\n\nexport { Table, TableHeader, TableBody, TableFooter, TableHead, TableRow, TableCell, TableCaption };\n","import React from 'react';\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Use to show a placeholder while content is loading. This component is from Shadcn UI. See Shadcn\n * UI documentation: https://ui.shadcn.com/docs/components/skeleton\n */\nfunction Skeleton({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn('pr-twp tw-animate-pulse tw-rounded-md tw-bg-muted', className)}\n      {...props}\n    />\n  );\n}\n\nexport { Skeleton };\n","import React, { useMemo, useState } from 'react';\n\nimport {\n  ColumnFiltersState,\n  flexRender,\n  getCoreRowModel,\n  getFilteredRowModel,\n  getPaginationRowModel,\n  getSortedRowModel,\n  SortingState,\n  ColumnDef as TSColumnDef,\n  Row as TSRow,\n  RowSelectionState as TSRowSelectionState,\n  SortDirection as TSSortDirection,\n  Table as TSTable,\n  useReactTable,\n  VisibilityState,\n} from '@tanstack/react-table';\n\nimport { DataTableViewOptions } from '@/components/advanced/data-table/data-table-column-toggle.component';\nimport { DataTablePagination } from '@/components/advanced/data-table/data-table-pagination.component';\nimport { Button } from '@/components/shadcn-ui/button';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/shadcn-ui/table';\nimport { Skeleton } from '@/components/shadcn-ui/skeleton';\n\nexport type ColumnDef<TData, TValue = unknown> = TSColumnDef<TData, TValue>;\nexport type RowContents<TData> = TSRow<TData>;\nexport type TableContents<TData> = TSTable<TData>;\nexport type SortDirection = TSSortDirection;\nexport type RowSelectionState = TSRowSelectionState;\n\ninterface DataTableProps<TData, TValue> {\n  columns: ColumnDef<TData, TValue>[];\n  data: TData[] | undefined;\n  enablePagination?: boolean;\n  showPaginationControls?: boolean;\n  showColumnVisibilityControls?: boolean;\n  stickyHeader?: boolean;\n  onRowClickHandler?: (row: RowContents<TData>, table: TableContents<TData>) => void;\n  id?: string;\n  isLoading?: boolean;\n  noResultsMessage: string;\n}\n\n/**\n * Feature-rich table component that infuses our basic shadcn-based Table component with features\n * from TanStack's React Table library\n */\nexport function DataTable<TData, TValue>({\n  columns,\n  data,\n  enablePagination = false,\n  showPaginationControls = false,\n  showColumnVisibilityControls = false,\n  stickyHeader = false,\n  onRowClickHandler = () => {},\n  id,\n  isLoading = false,\n  noResultsMessage,\n}: DataTableProps<TData, TValue>) {\n  const [sorting, setSorting] = useState<SortingState>([]);\n  const [columnFilters, setColumnFilters] = useState<ColumnFiltersState>([]);\n  const [columnVisibility, setColumnVisibility] = useState<VisibilityState>({});\n  const [rowSelection, setRowSelection] = useState({});\n\n  const normalizedData = useMemo(() => data ?? [], [data]);\n\n  const table = useReactTable({\n    data: normalizedData,\n    columns,\n    getCoreRowModel: getCoreRowModel(),\n    ...(enablePagination && { getPaginationRowModel: getPaginationRowModel() }),\n    onSortingChange: setSorting,\n    getSortedRowModel: getSortedRowModel(),\n    onColumnFiltersChange: setColumnFilters,\n    getFilteredRowModel: getFilteredRowModel(),\n    onColumnVisibilityChange: setColumnVisibility,\n    onRowSelectionChange: setRowSelection,\n    state: {\n      sorting,\n      columnFilters,\n      columnVisibility,\n      rowSelection,\n    },\n  });\n\n  const visibleColumns = table.getVisibleFlatColumns();\n  let bodyContent: React.ReactNode;\n\n  if (isLoading) {\n    const rowCount = 10;\n    const skeletonRowIds = Array.from({ length: rowCount }).map((_, idx) => `skeleton-row-${idx}`);\n    bodyContent = skeletonRowIds.map((rowId) => (\n      <TableRow key={rowId}>\n        <TableCell colSpan={visibleColumns.length ?? columns.length} className=\"tw-border-0 tw-p-0\">\n          <div className=\"tw-w-full tw-py-2\">\n            <Skeleton className=\"tw-h-14 tw-w-full tw-rounded-md\" />\n          </div>\n        </TableCell>\n      </TableRow>\n    ));\n  } else if (table.getRowModel().rows?.length > 0) {\n    bodyContent = table.getRowModel().rows.map((row) => (\n      <TableRow\n        onClick={() => onRowClickHandler(row, table)}\n        key={row.id}\n        data-state={row.getIsSelected() && 'selected'}\n      >\n        {row.getVisibleCells().map((cell) => (\n          <TableCell key={cell.id}>\n            {flexRender(cell.column.columnDef.cell, cell.getContext())}\n          </TableCell>\n        ))}\n      </TableRow>\n    ));\n  } else {\n    bodyContent = (\n      <TableRow>\n        <TableCell colSpan={columns.length} className=\"tw-h-24 tw-text-center\">\n          {noResultsMessage}\n        </TableCell>\n      </TableRow>\n    );\n  }\n\n  return (\n    <div className=\"pr-twp\" id={id}>\n      {showColumnVisibilityControls && <DataTableViewOptions table={table} />}\n      <Table stickyHeader={stickyHeader}>\n        <TableHeader stickyHeader={stickyHeader}>\n          {table.getHeaderGroups().map((headerGroup) => (\n            <TableRow key={headerGroup.id}>\n              {headerGroup.headers.map((header) => {\n                return (\n                  <TableHead key={header.id}>\n                    {header.isPlaceholder\n                      ? undefined\n                      : flexRender(header.column.columnDef.header, header.getContext())}\n                  </TableHead>\n                );\n              })}\n            </TableRow>\n          ))}\n        </TableHeader>\n        <TableBody>{bodyContent}</TableBody>\n      </Table>\n      {enablePagination && (\n        <div className=\"tw-flex tw-items-center tw-justify-end tw-space-x-2 tw-py-4\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => table.previousPage()}\n            disabled={!table.getCanPreviousPage()}\n          >\n            Previous\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => table.nextPage()}\n            disabled={!table.getCanNextPage()}\n          >\n            Next\n          </Button>\n        </div>\n      )}\n      {enablePagination && showPaginationControls && <DataTablePagination table={table} />}\n    </div>\n  );\n}\n\nexport default DataTable;\n","import { cn } from '@/utils/shadcn-ui.util';\nimport Markdown, { MarkdownToJSX } from 'markdown-to-jsx';\nimport { useMemo } from 'react';\n\ninterface MarkdownRendererProps {\n  /** Optional unique identifier */\n  id?: string;\n  /** The markdown string to render */\n  markdown: string;\n  className?: string;\n  /**\n   * The [`target` attribute for `a` html\n   * tags](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a#target). Defaults to not\n   * adding a `target` to `a` tags\n   */\n  anchorTarget?: string;\n  /** Optional flag to truncate the content to 3 lines */\n  truncate?: boolean;\n}\n\n/**\n * This component renders markdown content given a markdown string. It uses typography styles from\n * the platform.\n *\n * @param MarkdownRendererProps\n * @returns A div containing the rendered markdown content.\n */\nexport function MarkdownRenderer({\n  id,\n  markdown,\n  className,\n  anchorTarget,\n  truncate,\n}: MarkdownRendererProps) {\n  const options: MarkdownToJSX.Options = useMemo(\n    () => ({\n      overrides: {\n        a: {\n          props: {\n            target: anchorTarget,\n          },\n        },\n      },\n    }),\n    [anchorTarget],\n  );\n  return (\n    <div\n      id={id}\n      className={cn(\n        'pr-twp tw-prose',\n        {\n          'tw-line-clamp-3 tw-max-h-10 tw-overflow-hidden tw-text-ellipsis tw-break-words':\n            truncate,\n        },\n        className,\n      )}\n    >\n      <Markdown options={options}>{markdown}</Markdown>\n    </div>\n  );\n}\n\nexport default MarkdownRenderer;\n","import { Copy } from 'lucide-react';\nimport { Button } from '@/components/shadcn-ui/button';\nimport { LocalizedStringValue } from 'platform-bible-utils';\n\n/**\n * Object containing all keys used for localization in this component. If you're using this\n * component in an extension, you can pass it into the useLocalizedStrings hook to easily obtain the\n * localized strings and pass them into the localizedStrings prop of this component\n */\nexport const ERROR_DUMP_STRING_KEYS = Object.freeze([\n  '%webView_error_dump_header%',\n  '%webView_error_dump_info_message%',\n] as const);\n\nexport type ErrorDumpLocalizedStrings = {\n  [localizedInventoryKey in (typeof ERROR_DUMP_STRING_KEYS)[number]]?: LocalizedStringValue;\n};\n\n/**\n * Gets the localized value for the provided key\n *\n * @param strings Object containing localized string\n * @param key Key for a localized string\n * @returns The localized value for the provided key, if available. Returns the key if no localized\n *   value is available\n */\nconst localizeString = (\n  strings: ErrorDumpLocalizedStrings,\n  key: keyof ErrorDumpLocalizedStrings,\n) => {\n  return strings[key] ?? key;\n};\n\n/** Interface to store the parameters for the ErrorDump component */\nexport interface ErrorDumpProps {\n  /** String containing the error details to show */\n  errorDetails: string;\n  /** Handler function to notify the frontend when the error is copied */\n  handleCopyNotify?: () => void;\n  /**\n   * List of localized strings to localize the strings in this component. Relevant keys can be found\n   * in `ERROR_DUMP_STRING_KEYS`\n   */\n  localizedStrings: ErrorDumpLocalizedStrings;\n  /** Optional id for the root element */\n  id?: string;\n}\n\n/** Component to render an error dump */\nexport function ErrorDump({\n  errorDetails,\n  handleCopyNotify,\n  localizedStrings,\n  id,\n}: ErrorDumpProps) {\n  const headerText = localizeString(localizedStrings, '%webView_error_dump_header%');\n  const infoMessage = localizeString(localizedStrings, '%webView_error_dump_info_message%');\n\n  function handleCopy() {\n    navigator.clipboard.writeText(errorDetails);\n    if (handleCopyNotify) {\n      handleCopyNotify();\n    }\n  }\n\n  return (\n    <div\n      id={id}\n      className=\"tw-inline-flex tw-w-full tw-flex-col tw-items-start tw-justify-start tw-gap-4\"\n    >\n      <div className=\"tw-inline-flex tw-items-start tw-justify-start tw-gap-4 tw-self-stretch\">\n        <div className=\"tw-inline-flex tw-flex-1 tw-flex-col tw-items-start tw-justify-start\">\n          <div className=\"tw-text-color-text tw-justify-center tw-text-center tw-text-lg tw-font-semibold tw-leading-loose\">\n            {headerText}\n          </div>\n          <div className=\"tw-justify-center tw-self-stretch tw-text-sm tw-font-normal tw-leading-tight tw-text-muted-foreground\">\n            {infoMessage}\n          </div>\n        </div>\n        <Button variant=\"secondary\" size=\"icon\" className=\"size-8\" onClick={() => handleCopy()}>\n          <Copy />\n        </Button>\n      </div>\n      <div className=\"tw-prose tw-w-full\">\n        <pre className=\"tw-text-xs\">{errorDetails}</pre>\n      </div>\n    </div>\n  );\n}\n","import { PropsWithChildren, useState } from 'react';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { ErrorDump, ErrorDumpProps, ERROR_DUMP_STRING_KEYS } from '../basics/error-dump.component';\nimport { Popover, PopoverContent, PopoverTrigger } from '../shadcn-ui/popover';\nimport { Label } from '../shadcn-ui/label';\n\n/**\n * Object containing all keys used for localization in the ErrorPopover component. This extends\n * ERROR_DUMP_STRING_KEYS with additional keys specific to the ErrorPopover. If you're using this\n * component in an extension, you can pass it into the useLocalizedStrings hook to easily obtain the\n * localized strings and pass them into the localizedStrings prop of this component\n */\nexport const ERROR_POPOVER_STRING_KEYS = Object.freeze([\n  ...ERROR_DUMP_STRING_KEYS,\n  '%webView_error_dump_copied_message%',\n] as const);\n\nexport type ErrorPopoverLocalizedStrings = {\n  [localizedKey in (typeof ERROR_POPOVER_STRING_KEYS)[number]]?: string;\n};\n\n/** Interface to store the parameters for the ErrorPopover component */\nexport type ErrorPopoverProps = PropsWithChildren &\n  Omit<ErrorDumpProps, 'localizedStrings'> & {\n    /**\n     * List of localized strings to localize the strings in this component. Relevant keys can be\n     * found in `ERROR_POPOVER_STRING_KEYS`\n     */\n    localizedStrings: ErrorPopoverLocalizedStrings;\n    /** Optional CSS classes to insert into the `PopoverContent` */\n    className?: string;\n    /** Optional ID for the popover content for accessibility */\n    id?: string;\n  };\n\n/** A popover component that displays detailed error information using the ErrorDump component. */\nexport function ErrorPopover({\n  errorDetails,\n  handleCopyNotify,\n  localizedStrings,\n  children,\n  className,\n  id,\n}: ErrorPopoverProps) {\n  const [isCopySuccess, setIsCopySuccess] = useState<boolean>(false);\n\n  const handleCopyWithNotification = () => {\n    setIsCopySuccess(true);\n    if (handleCopyNotify) {\n      handleCopyNotify();\n    }\n  };\n\n  const handleOpenChange = (open: boolean) => {\n    if (!open) {\n      setIsCopySuccess(false);\n    }\n  };\n\n  return (\n    <Popover onOpenChange={handleOpenChange}>\n      <PopoverTrigger asChild>{children}</PopoverTrigger>\n      <PopoverContent id={id} className={cn('tw-min-w-80 tw-max-w-96', className)}>\n        {isCopySuccess && localizedStrings['%webView_error_dump_copied_message%'] && (\n          <Label>{localizedStrings['%webView_error_dump_copied_message%']}</Label>\n        )}\n        <ErrorDump\n          errorDetails={errorDetails}\n          handleCopyNotify={handleCopyWithNotification}\n          localizedStrings={localizedStrings}\n        />\n      </PopoverContent>\n    </Popover>\n  );\n}\n","import {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuLabel,\n  DropdownMenuGroup,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuSeparator,\n  DropdownMenuRadioGroup,\n} from '@/components/shadcn-ui/dropdown-menu';\nimport { Button } from '@/components/shadcn-ui/button';\nimport { ChevronDown, Filter } from 'lucide-react';\nimport { useState } from 'react';\n\n/** The DropdownMenuItemType enum is used to determine the type of the dropdown item */\nexport enum DropdownMenuItemType {\n  Check,\n  Radio,\n}\n\nexport type DropdownItem = {\n  /** Unique identifier for this dropdown */\n  id: string;\n  /** The label is the text that will be displayed on the dropdown item. */\n  label: string;\n  /** The onUpdate function is called when the state of a dropdown item is changed. */\n  onUpdate: (id: string, checked?: boolean) => void;\n};\n\nexport type DropdownGroup = {\n  /**\n   * The label is the text that will be displayed on the dropdown group. It is used to categorize\n   * the items in the group.\n   */\n  label: string;\n  /** The itemType determines the DropdownMenuItemType type as either Check or Radio. */\n  itemType: DropdownMenuItemType;\n  /** The items array contains the items that will be displayed in the dropdown group */\n  items: DropdownItem[];\n};\n\nexport type FilterDropdownProps = {\n  /** Object unique identifier */\n  id?: string;\n  /** Label for the trigger button */\n  label: string;\n  /** The groups array contains the groups that will be displayed in the dropdown */\n  groups: DropdownGroup[];\n}; // TODO: extend the props later\n\n/**\n * The FilterDropdown component is a dropdown designed for filtering content. It includes groups of\n * items that can be checkboxes or radio items.\n *\n * @param FilterDropdownProps\n * @returns A filter dropdown.\n */\nexport function FilterDropdown({ id, label, groups }: FilterDropdownProps) {\n  // Populates the boolean Arrays for the group indexes that are checkbox groups\n  const [checkedStates, setCheckedStates] = useState<Record<number, boolean[]>>(\n    Object.fromEntries(\n      groups\n        .map((group, index) =>\n          group.itemType === DropdownMenuItemType.Check ? [index, []] : undefined,\n        )\n        .filter((entry) => !!entry),\n    ),\n  );\n  const [radioStates, setRadioStates] = useState<Record<number, string>>({});\n\n  const handleCheckboxUpdate = (groupIndex: number, index: number) => {\n    const newCheckedState = !checkedStates[groupIndex][index];\n    // Update the checked state first\n    setCheckedStates((oldCheckedStates) => {\n      oldCheckedStates[groupIndex][index] = newCheckedState;\n      return { ...oldCheckedStates };\n    });\n\n    // Calls the `onUpdate()` handler function for the dropdown item\n    const item = groups[groupIndex].items[index];\n    item.onUpdate(item.id, newCheckedState);\n  };\n\n  const handleRadioUpdate = (groupIndex: number, value: string) => {\n    // Updates the radio state first\n    setRadioStates((oldRadioStates) => {\n      oldRadioStates[groupIndex] = value;\n      return { ...oldRadioStates };\n    });\n\n    // Calls the `onUpdate()` handler function for the dropdown item\n    const currentItem = groups[groupIndex].items.find((item) => item.id === value);\n    if (currentItem) {\n      currentItem.onUpdate(value);\n    } else {\n      console.error(`Could not find dropdown radio item with id '${value}'!`);\n    }\n  };\n\n  return (\n    <div id={id}>\n      {/* TODO: remove this once the DropDown Menu shadcn has an id prop */}\n      <DropdownMenu>\n        <DropdownMenuTrigger asChild>\n          <Button variant=\"default\">\n            <Filter size={16} className=\"tw-mr-2 tw-h-4 tw-w-4\" />\n            {label}\n            <ChevronDown size={16} className=\"tw-ml-2 tw-h-4 tw-w-4\" />\n          </Button>\n        </DropdownMenuTrigger>\n        <DropdownMenuContent>\n          {groups.map((group, groupIndex) => (\n            <div key={group.label}>\n              <DropdownMenuLabel>{group.label}</DropdownMenuLabel>\n              <DropdownMenuGroup>\n                {group.itemType === DropdownMenuItemType.Check ? (\n                  <>\n                    {group.items.map((item, index) => (\n                      <div key={item.id}>\n                        <DropdownMenuCheckboxItem\n                          checked={checkedStates[groupIndex][index]}\n                          onCheckedChange={() => handleCheckboxUpdate(groupIndex, index)}\n                        >\n                          {item.label}\n                        </DropdownMenuCheckboxItem>\n                      </div>\n                    ))}\n                  </>\n                ) : (\n                  <DropdownMenuRadioGroup\n                    value={radioStates[groupIndex]}\n                    onValueChange={(value) => handleRadioUpdate(groupIndex, value)}\n                  >\n                    {group.items.map((item) => (\n                      <div key={item.id}>\n                        <DropdownMenuRadioItem value={item.id}>{item.label}</DropdownMenuRadioItem>\n                      </div>\n                    ))}\n                  </DropdownMenuRadioGroup>\n                )}\n              </DropdownMenuGroup>\n              <DropdownMenuSeparator />\n            </div>\n          ))}\n        </DropdownMenuContent>\n      </DropdownMenu>\n    </div>\n  );\n}\n\nexport default FilterDropdown;\n","import { Button } from '@/components/shadcn-ui/button';\nimport { CircleHelp, Link as LucideLink, User } from 'lucide-react';\nimport { NumberFormat } from 'platform-bible-utils';\n\n/** Interface that stores the parameters passed to the More Info component */\ninterface MoreInfoProps {\n  /** Optional unique identifier */\n  id?: string;\n  /** The category of the extension */\n  category: string;\n  /** The number of downloads for the extension */\n  downloads: Record<string, number>;\n  /** The languages supported by the extension */\n  languages: string[];\n  /** The URL to the more info page of the extension */\n  moreInfoUrl: string;\n  /** Handler function triggered when the more info (Website) link is clicked */\n  handleMoreInfoLinkClick: () => void;\n  /** Optional URL to a website link to get support for the extension */\n  supportUrl: string;\n  /** Handler function triggered when the support link is clicked */\n  handleSupportLinkClick: () => void;\n}\n/**\n * This component displays the more info section of the extension which includes the category,\n * number of downloads, languages, and links to the website and support\n *\n * @param MoreInfoProps\n * @returns The more info component that displays the category, number of downloads, languages, and\n *   links to the website and support\n */\nexport function MoreInfo({\n  id,\n  category,\n  downloads,\n  languages,\n  moreInfoUrl,\n  handleMoreInfoLinkClick,\n  supportUrl,\n  handleSupportLinkClick,\n}: MoreInfoProps) {\n  /**\n   * This constant formats the number of downloads into a more readable format.\n   *\n   * @example 1000 -> 1K\n   *\n   * @example 1000000 -> 1M\n   *\n   * @returns The formatted number of downloads\n   */\n  const numberFormatted = new NumberFormat('en', {\n    notation: 'compact',\n    compactDisplay: 'short',\n  }).format(Object.values(downloads).reduce((a: number, b: number) => a + b, 0));\n\n  /** This function scrolls the window to the bottom of the page. */\n  const handleScrollToBottom = () => {\n    window.scrollTo(0, document.body.scrollHeight);\n  };\n\n  return (\n    <div\n      id={id}\n      className=\"pr-twp tw-flex tw-items-center tw-justify-center tw-gap-4 tw-divide-x tw-border-b tw-border-t tw-py-2 tw-text-center\"\n    >\n      {category && (\n        <div className=\"tw-flex tw-flex-col tw-items-center tw-gap-1\">\n          <div className=\"tw-flex\">\n            <span className=\"tw-text-xs tw-font-semibold tw-text-foreground\">{category}</span>\n          </div>\n          <span className=\"tw-text-xs tw-text-foreground\">CATEGORY</span>\n        </div>\n      )}\n      <div className=\"tw-flex tw-flex-col tw-items-center tw-gap-1 tw-ps-4\">\n        <div className=\"tw-flex tw-gap-1\">\n          <User className=\"tw-h-4 tw-w-4\" />\n          <span className=\"tw-text-xs tw-font-semibold tw-text-foreground\">{numberFormatted}</span>\n        </div>\n        <span className=\"tw-text-xs tw-text-foreground\">USERS</span>\n      </div>\n      <div className=\"tw-flex tw-flex-col tw-items-center tw-gap-1 tw-ps-4\">\n        <div className=\"tw-flex tw-gap-2\">\n          {languages.slice(0, 3).map((locale) => (\n            <span key={locale} className=\"tw-text-xs tw-font-semibold tw-text-foreground\">\n              {locale.toUpperCase()}\n            </span>\n          ))}\n        </div>\n        {languages.length > 3 && (\n          <button\n            type=\"button\"\n            onClick={() => handleScrollToBottom()}\n            className=\"tw-text-xs tw-text-foreground tw-underline\"\n          >\n            +{languages.length - 3} more languages\n          </button>\n        )}\n      </div>\n      {(moreInfoUrl || supportUrl) && (\n        <div className=\"tw-flex tw-flex-col tw-gap-1 tw-ps-4\">\n          {moreInfoUrl && (\n            <div className=\"tw-flex tw-gap-1\">\n              <Button\n                onClick={() => handleMoreInfoLinkClick()}\n                variant=\"link\"\n                className=\"tw-flex tw-h-auto tw-gap-1 tw-py-0 tw-text-xs tw-font-semibold tw-text-foreground\"\n              >\n                Website\n                <LucideLink className=\"tw-h-4 tw-w-4\" />\n              </Button>\n            </div>\n          )}\n          {supportUrl && (\n            <div className=\"tw-flex tw-gap-1\">\n              <Button\n                onClick={() => handleSupportLinkClick()}\n                variant=\"link\"\n                className=\"tw-flex tw-h-auto tw-gap-1 tw-py-0 tw-text-xs tw-font-semibold tw-text-foreground\"\n              >\n                Support\n                <CircleHelp className=\"tw-h-4 tw-w-4\" />\n              </Button>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useState } from 'react';\n\nexport type VersionInformation = {\n  /** Date the version was published */\n  date: string;\n  /** Description of the changes in the version */\n  description: string;\n};\n\n/** Type to store the version history information */\nexport type VersionHistoryType = Record<string, VersionInformation>;\n\n/** Interface that stores the parameters passed to the Version History component */\ninterface VersionHistoryProps {\n  /** Optional unique identifier */\n  id?: string;\n  /** Object containing the versions mapped with their information */\n  versionHistory: VersionHistoryType;\n}\n\n/**\n * Component to render the version history information shown in the footer component. Lists the 5\n * most recent versions, with the options to show all versions by pressing a button.\n *\n * @param VersionHistoryProps\n * @returns Rendered version history for the Footer component\n */\nexport function VersionHistory({ id, versionHistory }: VersionHistoryProps) {\n  const [showAllVersions, setShowAllVersions] = useState(false);\n  const currentDate = new Date();\n\n  /**\n   * Function to format the time string for the version history in the form of 'X year(s) ago'.\n   *\n   * @param dateString ISO Date string to determine the time string from\n   * @returns Formatted time string\n   */\n  function formatTimeString(dateString: string) {\n    const date = new Date(dateString);\n    const dateDiff = new Date(currentDate.getTime() - date.getTime());\n    const yearDiff = dateDiff.getUTCFullYear() - 1970;\n    const monthDiff = dateDiff.getUTCMonth();\n    const dayDiff = dateDiff.getUTCDate() - 1;\n\n    // Determines how long ago the version was published\n    let timeString = '';\n    if (yearDiff > 0) {\n      timeString = `${yearDiff.toString()} year${yearDiff === 1 ? '' : 's'} ago`;\n    } else if (monthDiff > 0) {\n      timeString = `${monthDiff.toString()} month${monthDiff === 1 ? '' : 's'} ago`;\n    } else if (dayDiff === 0) {\n      timeString = 'today';\n    } else {\n      timeString = `${dayDiff.toString()} day${dayDiff === 1 ? '' : 's'} ago`;\n    }\n\n    return timeString;\n  }\n\n  // Sorts the version history by version number\n  const sortedEntries = Object.entries(versionHistory).sort((a, b) => b[0].localeCompare(a[0]));\n\n  return (\n    <div className=\"pr-twp\" id={id}>\n      <h3 className=\"tw-text-md tw-font-semibold\">What`s New</h3>\n      <ul className=\"tw-list-disc tw-pl-5 tw-pr-4 tw-text-xs tw-text-foreground\">\n        {(showAllVersions ? sortedEntries : sortedEntries.slice(0, 5)).map((entry) => (\n          <div key={entry[0]} className=\"tw-mt-3 tw-flex tw-justify-between\">\n            <div className=\"tw-text-foreground\">\n              <li className=\"tw-prose tw-text-xs\">\n                <span>{entry[1].description}</span>\n              </li>\n            </div>\n            <div className=\"tw-justify-end tw-text-right\">\n              <div>Version {entry[0]}</div>\n              <div>{formatTimeString(entry[1].date)}</div>\n            </div>\n          </div>\n        ))}\n      </ul>\n      {sortedEntries.length > 5 && (\n        <button\n          type=\"button\"\n          onClick={() => setShowAllVersions(!showAllVersions)}\n          className=\"tw-text-xs tw-text-foreground tw-underline\"\n        >\n          {showAllVersions ? 'Show Less Version History' : 'Show All Version History'}\n        </button>\n      )}\n    </div>\n  );\n}\n\nexport default VersionHistory;\n","import { useMemo } from 'react';\nimport { formatBytes, getCurrentLocale } from 'platform-bible-utils';\nimport { VersionHistory, VersionHistoryType } from './version-history.component';\n\n/** Interface to store the parameters passed to the Footer component */\ninterface FooterProps {\n  /** Optional unique identifier */\n  id?: string;\n  /** Name of the publisher */\n  publisherDisplayName: string;\n  /** Size of the extension file in bytes */\n  fileSize: number;\n  /** List of language codes supported by the extension */\n  locales: string[];\n  /** Object containing the version history mapped with their information */\n  versionHistory: VersionHistoryType;\n  /** Current version of the extension */\n  currentVersion: string;\n}\n\n/**\n * Component to render the footer for the extension details which contains information on the\n * publisher, version history, languages, and file size.\n *\n * @param FooterProps\n * @returns The rendered Footer component\n */\nexport function Footer({\n  id,\n  publisherDisplayName,\n  fileSize,\n  locales,\n  versionHistory,\n  currentVersion,\n}: FooterProps) {\n  /** Formats the file size into a human-readable format */\n  const formattedFileSize = useMemo(() => formatBytes(fileSize), [fileSize]);\n\n  /**\n   * This function gets the display names of the languages based on the language codes.\n   *\n   * @param codes The list of language codes\n   * @returns The list of language names\n   */\n  const getLanguageNames = (codes: string[]) => {\n    const displayNames = new Intl.DisplayNames(getCurrentLocale(), { type: 'language' });\n    return codes.map((code) => displayNames.of(code));\n  };\n\n  const languageNames = getLanguageNames(locales);\n\n  return (\n    <div id={id} className=\"pr-twp tw-border-t tw-py-2\">\n      <div className=\"tw-flex tw-flex-col tw-gap-2 tw-divide-y\">\n        {Object.entries(versionHistory).length > 0 && (\n          <VersionHistory versionHistory={versionHistory} />\n        )}\n        <div className=\"tw-flex tw-flex-col tw-gap-2 tw-py-2\">\n          <h2 className=\"tw-text-md tw-font-semibold\">Information</h2>\n          <div className=\"tw-flex tw-items-start tw-justify-between tw-text-xs tw-text-foreground\">\n            <p className=\"tw-flex tw-flex-col tw-justify-start tw-gap-1\">\n              <span>Publisher</span>\n              <span className=\"tw-font-semibold\">{publisherDisplayName}</span>\n              <span>Size</span>\n              <span className=\"tw-font-semibold\">{formattedFileSize}</span>\n            </p>\n            <div className=\"tw-flex tw-w-3/4 tw-items-center tw-justify-between tw-text-xs tw-text-foreground\">\n              <p className=\"tw-flex tw-flex-col tw-justify-start tw-gap-1\">\n                <span>Version</span>\n                <span className=\"tw-font-semibold\">{currentVersion}</span>\n                <span>Languages</span>\n                <span className=\"tw-font-semibold\">{languageNames.join(', ')}</span>\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Footer;\n","import { Button, buttonVariants } from '@/components/shadcn-ui/button';\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from '@/components/shadcn-ui/command';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/shadcn-ui/popover';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Check, ChevronsUpDown, Star } from 'lucide-react';\nimport { ReactNode, useCallback, useMemo, useState } from 'react';\nimport { type VariantProps } from 'class-variance-authority';\n\nexport type MultiSelectComboBoxEntry = {\n  value: string;\n  label: string;\n  secondaryLabel?: string;\n  starred?: boolean;\n};\n\n/**\n * Props for MultiSelectComboBox component that provides a UI for selecting multiple items from a\n * list. It supports displaying a placeholder, custom selected text, and an optional icon. Users can\n * search through options and view starred items prominently.\n */\nexport interface MultiSelectComboBoxProps {\n  /** The list of entries to select from. */\n  entries: MultiSelectComboBoxEntry[];\n  /** The currently selected values. */\n  selected: string[];\n  /** Callback function to handle changes in selection. */\n  onChange: (values: string[]) => void;\n  /** Placeholder text when no items are selected. */\n  placeholder: string;\n  /** Whether to show select all/clear all buttons. */\n  hasToggleAllFeature?: boolean;\n  /** Text for the select all button. */\n  selectAllText?: string;\n  /** Text for the clear all button. */\n  clearAllText?: string;\n  /** Message displayed when no entries are found. */\n  commandEmptyMessage?: string;\n  /** Custom text to display when items are selected. */\n  customSelectedText?: string;\n  /** Whether the dropdown is open (for controlled usage). */\n  isOpen?: boolean;\n  /** Handler that is called when the dropdown's open state changes. */\n  onOpenChange?: (open: boolean) => void;\n  /** Flag to disable the component. */\n  isDisabled?: boolean;\n  /** Flag to sort selected items. */\n  sortSelected?: boolean;\n  /** Optional icon to display in the button. */\n  icon?: ReactNode;\n  /** Additional class names for styling. */\n  className?: string;\n  /** Button variant to use for the trigger button. */\n  variant?: VariantProps<typeof buttonVariants>['variant'];\n  /** Optional ID for the component. */\n  id?: string;\n}\n\n/** MultiSelectComboBox component for selecting multiple items from a list. */\nexport function MultiSelectComboBox({\n  entries,\n  selected,\n  onChange,\n  placeholder,\n  hasToggleAllFeature = false,\n  selectAllText = 'Select All',\n  clearAllText = 'Clear All',\n  commandEmptyMessage = 'No entries found',\n  customSelectedText,\n  isOpen = undefined,\n  onOpenChange = undefined,\n  isDisabled = false,\n  sortSelected = false,\n  icon = undefined,\n  className = undefined,\n  variant = 'ghost',\n  id,\n}: MultiSelectComboBoxProps) {\n  const [isOpenLocal, setIsOpenLocal] = useState(false);\n\n  const handleSelect = useCallback(\n    (label: string) => {\n      const value = entries.find((entry) => entry.label === label)?.value;\n      if (!value) return;\n      onChange(\n        selected.includes(value) ? selected.filter((item) => item !== value) : [...selected, value],\n      );\n    },\n    [entries, selected, onChange],\n  );\n\n  const getPlaceholderText = () => {\n    if (customSelectedText) return customSelectedText;\n    return placeholder;\n  };\n\n  const sortedOptions = useMemo(() => {\n    if (!sortSelected) return entries;\n\n    const starredItems = entries\n      .filter((opt) => opt.starred)\n      .sort((a, b) => a.label.localeCompare(b.label));\n    const nonStarredItems = entries\n      .filter((opt) => !opt.starred)\n      .sort((a, b) => {\n        const aSelected = selected.includes(a.value);\n        const bSelected = selected.includes(b.value);\n        if (aSelected && !bSelected) return -1;\n        if (!aSelected && bSelected) return 1;\n        return a.label.localeCompare(b.label);\n      });\n\n    return [...starredItems, ...nonStarredItems];\n  }, [entries, selected, sortSelected]);\n\n  const handleSelectAll = () => {\n    onChange(entries.map((entry) => entry.value));\n  };\n\n  const handleClearAll = () => {\n    onChange([]);\n  };\n\n  const actualIsOpen = isOpen ?? isOpenLocal;\n  const actualOnOpenChange = onOpenChange ?? setIsOpenLocal;\n\n  return (\n    <div id={id} className={className}>\n      <Popover open={actualIsOpen} onOpenChange={actualOnOpenChange}>\n        <PopoverTrigger asChild>\n          <Button\n            variant={variant}\n            role=\"combobox\"\n            aria-expanded={actualIsOpen}\n            className=\"tw-group tw-w-full tw-justify-between\"\n            disabled={isDisabled}\n          >\n            <div className=\"tw-flex tw-min-w-0 tw-flex-1 tw-items-center tw-gap-2\">\n              {icon && (\n                <div className=\"tw-ml-2 tw-h-4 tw-w-4 tw-shrink-0 tw-opacity-50\">\n                  <span className=\"tw-flex tw-h-full tw-w-full tw-items-center tw-justify-center\">\n                    {icon}\n                  </span>\n                </div>\n              )}\n              <span\n                className={cn(\n                  'tw-min-w-0 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-text-start tw-font-normal',\n                )}\n              >\n                {getPlaceholderText()}\n              </span>\n            </div>\n            <ChevronsUpDown className=\"tw-ml-2 tw-h-4 tw-w-4 tw-shrink-0 tw-opacity-50\" />\n          </Button>\n        </PopoverTrigger>\n        <PopoverContent align=\"start\" className=\"tw-w-full tw-p-0\">\n          <Command>\n            <CommandInput placeholder={`Search ${placeholder.toLowerCase()}...`} />\n            {hasToggleAllFeature && (\n              <div className=\"tw-flex tw-justify-between tw-border-b tw-p-2\">\n                <Button variant=\"ghost\" size=\"sm\" onClick={handleSelectAll}>\n                  {selectAllText}\n                </Button>\n                <Button variant=\"ghost\" size=\"sm\" onClick={handleClearAll}>\n                  {clearAllText}\n                </Button>\n              </div>\n            )}\n            <CommandList>\n              <CommandEmpty>{commandEmptyMessage}</CommandEmpty>\n              <CommandGroup>\n                {sortedOptions.map((option) => {\n                  return (\n                    <CommandItem\n                      key={option.label}\n                      value={option.label}\n                      onSelect={handleSelect}\n                      className=\"tw-flex tw-items-center tw-gap-2\"\n                    >\n                      <div className=\"w-4\">\n                        <Check\n                          className={cn(\n                            'tw-h-4 tw-w-4',\n                            selected.includes(option.value) ? 'tw-opacity-100' : 'tw-opacity-0',\n                          )}\n                        />\n                      </div>\n                      {option.starred && <Star className=\"tw-h-4 tw-w-4\" />}\n                      <div className=\"tw-flex-grow\">{option.label}</div>\n                      {option.secondaryLabel && (\n                        <div className=\"tw-text-end tw-text-muted-foreground\">\n                          {option.secondaryLabel}\n                        </div>\n                      )}\n                    </CommandItem>\n                  );\n                })}\n              </CommandGroup>\n            </CommandList>\n          </Command>\n        </PopoverContent>\n      </Popover>\n    </div>\n  );\n}\n\nexport default MultiSelectComboBox;\n","import { Badge } from '@/components/shadcn-ui/badge';\nimport { Button } from '@/components/shadcn-ui/button';\nimport { Label } from '@/components/shadcn-ui/label';\nimport { X } from 'lucide-react';\nimport { MultiSelectComboBox, MultiSelectComboBoxProps } from './multi-select-combo-box.component';\n\ninterface FilterProps extends MultiSelectComboBoxProps {\n  /**\n   * Placeholder text that will be displayed when no items are selected. It will appear at the\n   * location where the badges would be if any items were selected.\n   */\n  badgesPlaceholder: string;\n  /** Optional id for the component */\n  id?: string;\n}\n\n/**\n * This is a variant of the {@link MultiSelectComboBox}, that shows a {@link Badge} component for each\n * selected item in the combo box. Clicking the 'X' icon on the badge will clear the item from the\n * selected options. A placeholder text must be provided through 'badgesPlaceholder'. This will be\n * displayed if no items are selected,\n */\nexport function Filter({\n  entries,\n  selected,\n  onChange,\n  placeholder,\n  commandEmptyMessage,\n  customSelectedText,\n  isDisabled,\n  sortSelected,\n  icon,\n  className,\n  badgesPlaceholder,\n  id,\n}: FilterProps) {\n  return (\n    <div id={id} className=\"tw-flex tw-items-center tw-gap-2\">\n      <MultiSelectComboBox\n        entries={entries}\n        selected={selected}\n        onChange={onChange}\n        placeholder={placeholder}\n        commandEmptyMessage={commandEmptyMessage}\n        customSelectedText={customSelectedText}\n        isDisabled={isDisabled}\n        sortSelected={sortSelected}\n        icon={icon}\n        className={className}\n      />\n      {selected.length > 0 ? (\n        <div className=\"tw-flex tw-flex-wrap tw-items-center tw-gap-2\">\n          {selected.map((type) => (\n            <Badge key={type} variant=\"muted\" className=\"tw-flex tw-items-center tw-gap-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"tw-h-4 tw-w-4 tw-p-0 hover:tw-bg-transparent\"\n                onClick={() => onChange(selected.filter((selectedType) => selectedType !== type))}\n              >\n                <X className=\"tw-h-3 tw-w-3\" />\n              </Button>\n              {entries.find((entry) => entry.value === type)?.label}\n            </Badge>\n          ))}\n        </div>\n      ) : (\n        <Label>{badgesPlaceholder}</Label>\n      )}\n    </div>\n  );\n}\n\nexport default Filter;\n","import React from 'react';\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Props for Input component\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/input}\n */\nexport interface InputProps extends React.InputHTMLAttributes<HTMLInputElement> {}\n\n/**\n * Input component displays a form input field or a component that looks like an input field. This\n * components is built and styled with Shadcn UI.\n *\n * @param InputProps\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/input}\n */\nexport const Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          'pr-twp tw-flex tw-h-10 tw-rounded-md tw-border tw-border-input tw-bg-background tw-px-3 tw-py-2 tw-text-sm tw-ring-offset-background file:tw-border-0 file:tw-bg-transparent file:tw-text-sm file:tw-font-medium file:tw-text-foreground placeholder:tw-text-muted-foreground focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2 disabled:tw-cursor-not-allowed disabled:tw-opacity-50',\n          className,\n        )}\n        ref={ref}\n        // eslint-disable-next-line react/jsx-props-no-spreading\n        {...props}\n      />\n    );\n  },\n);\nInput.displayName = 'Input';\n","import {\n  DropdownMenu,\n  DropdownMenuCheckboxItem,\n  DropdownMenuContent,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/shadcn-ui/dropdown-menu';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/shadcn-ui/tooltip';\nimport { Button } from '@/components/shadcn-ui/button';\nimport { GENERATOR_NOTE_CALLER, HIDDEN_NOTE_CALLER } from '@eten-tech-foundation/platform-editor';\nimport { Input } from '@/components/shadcn-ui/input';\nimport { KeyboardEvent, useEffect, useRef, useState } from 'react';\nimport { FootnoteCallerType, FootnoteEditorLocalizedStrings } from './footnote-editor.types';\n\ninterface FootnoteCallerDropdownProps {\n  /** The caller type value to pass to the dropdown */\n  callerType: FootnoteCallerType;\n  /** Function to update the caller type */\n  updateCallerType: (newCallerType: FootnoteCallerType) => void;\n  /** The custom caller to pass to the custom caller input field */\n  customCaller: string;\n  /** FUnction to update the custom caller */\n  updateCustomCaller: (newCustomCaller: string) => void;\n  /** Localized strings from the parent component */\n  localizedStrings: FootnoteEditorLocalizedStrings;\n}\n\nconst renderCallerButtonContent = (\n  callerType: FootnoteCallerType,\n  localizedStrings: FootnoteEditorLocalizedStrings,\n  customCaller: string,\n) => {\n  if (callerType === 'generated') {\n    return (\n      <>\n        <p>+</p> {localizedStrings['%footnoteEditor_callerDropdown_item_generated%']}\n      </>\n    );\n  }\n\n  if (callerType === 'hidden') {\n    return (\n      <>\n        <p>-</p> {localizedStrings['%footnoteEditor_callerDropdown_item_hidden%']}\n      </>\n    );\n  }\n\n  return (\n    <>\n      <p>{customCaller}</p> {localizedStrings['%footnoteEditor_callerDropdown_item_custom%']}\n    </>\n  );\n};\n\nexport function FootnoteCallerDropdown({\n  callerType,\n  updateCallerType,\n  customCaller,\n  updateCustomCaller,\n  localizedStrings,\n}: FootnoteCallerDropdownProps) {\n  // The ref must start with being null to be passed as an element ref\n  // eslint-disable-next-line no-null/no-null\n  const customCallerInputRef = useRef<HTMLInputElement>(null);\n  // The ref must start with being null to be passed as an element ref\n  // eslint-disable-next-line no-null/no-null\n  const customCallerSelectRef = useRef<HTMLDivElement>(null);\n  // The ref must start with being null to be passed as an element ref\n  // eslint-disable-next-line no-null/no-null\n  const isCustomCallerInputFocused = useRef(false);\n  const [selectedCallerType, setSelectedCallerType] = useState<FootnoteCallerType>(callerType);\n  const [newCustomCaller, setNewCustomCaller] = useState<string>(customCaller);\n  const [isDropdownOpen, setIsDropdownOpen] = useState<boolean>(false);\n\n  // If the caller type changes, the selected caller type needs to change also\n  useEffect(() => {\n    setSelectedCallerType(callerType);\n  }, [callerType]);\n\n  // If the parent custom caller changes, then the new custom caller should reflect the changes\n  useEffect(() => {\n    if (newCustomCaller !== customCaller) {\n      setNewCustomCaller(customCaller);\n    }\n    // This can't be triggered when the new custom caller updates because otherwise this will\n    // completely prevent the input field from being edited\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [customCaller]);\n\n  const handleDropdownOpenChange = (open: boolean) => {\n    isCustomCallerInputFocused.current = false;\n    setIsDropdownOpen(open);\n    if (!open) {\n      // This makes it so that if the custom caller is invalid, then reverts back to the previous\n      // selected caller\n      if (selectedCallerType !== 'custom' || newCustomCaller) {\n        updateCallerType(selectedCallerType);\n        updateCustomCaller(newCustomCaller);\n      } else {\n        setSelectedCallerType(callerType);\n        setNewCustomCaller(customCaller);\n      }\n    }\n  };\n\n  const handleKeyDown = (event: KeyboardEvent<HTMLDivElement>) => {\n    event.stopPropagation();\n    // Allow to navigate to the input field\n    if (\n      (document.activeElement === customCallerSelectRef.current && event.key === 'ArrowDown') ||\n      event.key === 'ArrowRight'\n    ) {\n      customCallerInputRef.current?.focus();\n      isCustomCallerInputFocused.current = true;\n    } else if (document.activeElement === customCallerInputRef.current && event.key === 'ArrowUp') {\n      customCallerSelectRef.current?.focus();\n      isCustomCallerInputFocused.current = false;\n    } else if (\n      document.activeElement === customCallerInputRef.current &&\n      event.key === 'ArrowLeft' &&\n      customCallerInputRef.current?.selectionStart === 0\n    ) {\n      customCallerSelectRef.current?.focus();\n      isCustomCallerInputFocused.current = false;\n    }\n\n    // Allow the dropdown menu to be submitted if the custom caller is selected when you press enter\n    if (\n      selectedCallerType === 'custom' &&\n      event.key === 'Enter' &&\n      (document.activeElement === customCallerSelectRef.current ||\n        document.activeElement === customCallerInputRef.current)\n    ) {\n      handleDropdownOpenChange(false);\n    }\n  };\n\n  return (\n    <DropdownMenu open={isDropdownOpen} onOpenChange={handleDropdownOpenChange}>\n      <TooltipProvider>\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"outline\" className=\"tw-h-6\">\n                {renderCallerButtonContent(callerType, localizedStrings, customCaller)}\n              </Button>\n            </DropdownMenuTrigger>\n          </TooltipTrigger>\n          <TooltipContent>\n            {localizedStrings['%footnoteEditor_callerDropdown_tooltip%']}\n          </TooltipContent>\n        </Tooltip>\n      </TooltipProvider>\n      <DropdownMenuContent\n        className=\"tw-z-[300]\"\n        onClick={() => {\n          if (isCustomCallerInputFocused.current) isCustomCallerInputFocused.current = false;\n        }}\n        onKeyDown={handleKeyDown}\n        onMouseMove={() => {\n          if (isCustomCallerInputFocused.current) customCallerInputRef.current?.focus();\n        }}\n      >\n        <DropdownMenuLabel>\n          {localizedStrings['%footnoteEditor_callerDropdown_label%']}\n        </DropdownMenuLabel>\n        <DropdownMenuSeparator />\n        <DropdownMenuCheckboxItem\n          checked={selectedCallerType === 'generated'}\n          onCheckedChange={() => setSelectedCallerType('generated')}\n        >\n          <div className=\"tw-flex tw-w-full tw-justify-between\">\n            <span>{localizedStrings['%footnoteEditor_callerDropdown_item_generated%']}</span>\n            <span className=\"tw-w-10 tw-text-center\">{GENERATOR_NOTE_CALLER}</span>\n          </div>\n        </DropdownMenuCheckboxItem>\n        <DropdownMenuCheckboxItem\n          checked={selectedCallerType === 'hidden'}\n          onCheckedChange={() => setSelectedCallerType('hidden')}\n        >\n          <div className=\"tw-flex tw-w-full tw-justify-between\">\n            <span>{localizedStrings['%footnoteEditor_callerDropdown_item_hidden%']}</span>\n            <span className=\"tw-w-10 tw-text-center\">{HIDDEN_NOTE_CALLER}</span>\n          </div>\n        </DropdownMenuCheckboxItem>\n        <DropdownMenuCheckboxItem\n          ref={customCallerSelectRef}\n          checked={selectedCallerType === 'custom'}\n          onCheckedChange={() => setSelectedCallerType('custom')}\n          onClick={(event) => {\n            event.stopPropagation();\n            isCustomCallerInputFocused.current = true;\n            customCallerInputRef.current?.focus();\n          }}\n          onSelect={(event) => event.preventDefault()}\n        >\n          <div className=\"tw-flex tw-w-full tw-justify-between\">\n            <span>{localizedStrings['%footnoteEditor_callerDropdown_item_custom%']}</span>\n            <Input\n              tabIndex={0}\n              onMouseDown={(event) => {\n                event.stopPropagation();\n                setSelectedCallerType('custom');\n                isCustomCallerInputFocused.current = true;\n              }}\n              ref={customCallerInputRef}\n              className=\"tw-h-auto tw-w-10 tw-p-0 tw-text-center\"\n              value={newCustomCaller}\n              onKeyDown={(event) => {\n                if (\n                  !(\n                    event.key === 'Enter' ||\n                    event.key === 'ArrowUp' ||\n                    event.key === 'ArrowDown' ||\n                    event.key === 'ArrowLeft' ||\n                    event.key === 'ArrowRight'\n                  )\n                )\n                  event.stopPropagation();\n              }}\n              maxLength={1}\n              onChange={(event) => setNewCustomCaller(event.target.value)}\n            />\n          </div>\n        </DropdownMenuCheckboxItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","import { Button } from '@/components/shadcn-ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuCheckboxItem,\n  DropdownMenuContent,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/shadcn-ui/dropdown-menu';\nimport { Tooltip, TooltipContent, TooltipProvider } from '@/components/shadcn-ui/tooltip';\nimport { TooltipTrigger } from '@radix-ui/react-tooltip';\nimport { FunctionSquare, SquareSigma, SquareX } from 'lucide-react';\nimport { formatReplacementString } from 'platform-bible-utils';\nimport { FootnoteEditorLocalizedStrings } from './footnote-editor.types';\n\ninterface FootnoteTypeDropdownProps {\n  noteType: string;\n  handleNoteTypeChange: (newNoteType: string) => void;\n  localizedStrings: FootnoteEditorLocalizedStrings;\n  isTypeSwitchable: boolean;\n}\n\nconst renderNoteTypeButtonContent = (\n  noteType: string,\n  localizedStrings: FootnoteEditorLocalizedStrings,\n) => {\n  if (noteType === 'f') {\n    return (\n      <>\n        <FunctionSquare /> {localizedStrings['%footnoteEditor_noteType_footnote_label%']}\n      </>\n    );\n  }\n\n  if (noteType === 'fe') {\n    return (\n      <>\n        <SquareSigma /> {localizedStrings['%footnoteEditor_noteType_endNote_label%']}\n      </>\n    );\n  }\n\n  return (\n    <>\n      <SquareX /> {localizedStrings['%footnoteEditor_noteType_crossReference_label%']}\n    </>\n  );\n};\n\nconst formatNoteTypeTooltip = (\n  noteType: string,\n  localizedStrings: FootnoteEditorLocalizedStrings,\n) => {\n  if (noteType === 'x') {\n    return localizedStrings['%footnoteEditor_noteType_crossReference_label%'];\n  }\n\n  let noteTypeString = localizedStrings['%footnoteEditor_noteType_endNote_label%'];\n  if (noteType === 'f') {\n    noteTypeString = localizedStrings['%footnoteEditor_noteType_footnote_label%'];\n  }\n\n  return formatReplacementString(localizedStrings['%footnoteEditor_noteType_tooltip%'] ?? '', {\n    noteType: noteTypeString,\n  });\n};\n\nexport function FootnoteTypeDropdown({\n  noteType,\n  handleNoteTypeChange,\n  localizedStrings,\n  isTypeSwitchable,\n}: FootnoteTypeDropdownProps) {\n  return (\n    <DropdownMenu>\n      <TooltipProvider>\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"outline\" className=\"tw-h-6\">\n                {renderNoteTypeButtonContent(noteType, localizedStrings)}\n              </Button>\n            </DropdownMenuTrigger>\n          </TooltipTrigger>\n          <TooltipContent>\n            <p>{formatNoteTypeTooltip(noteType, localizedStrings)}</p>\n          </TooltipContent>\n        </Tooltip>\n      </TooltipProvider>\n      <DropdownMenuContent className=\"tw-z-[300]\">\n        <DropdownMenuLabel>\n          {localizedStrings['%footnoteEditor_noteTypeDropdown_label%']}\n        </DropdownMenuLabel>\n        <DropdownMenuSeparator />\n        <DropdownMenuCheckboxItem\n          disabled={noteType !== 'x' && !isTypeSwitchable}\n          checked={noteType === 'x'}\n          onCheckedChange={() => handleNoteTypeChange('x')}\n          className=\"tw-gap-2\"\n        >\n          <SquareX />\n          <span>{localizedStrings['%footnoteEditor_noteType_crossReference_label%']}</span>\n        </DropdownMenuCheckboxItem>\n        <DropdownMenuCheckboxItem\n          disabled={noteType === 'x' && !isTypeSwitchable}\n          checked={noteType === 'f'}\n          onCheckedChange={() => handleNoteTypeChange('f')}\n          className=\"tw-gap-2\"\n        >\n          <FunctionSquare />\n          <span>{localizedStrings['%footnoteEditor_noteType_footnote_label%']}</span>\n        </DropdownMenuCheckboxItem>\n        <DropdownMenuCheckboxItem\n          disabled={noteType === 'x' && !isTypeSwitchable}\n          checked={noteType === 'fe'}\n          onCheckedChange={() => handleNoteTypeChange('fe')}\n          className=\"tw-gap-2\"\n        >\n          <SquareSigma />\n          <span>{localizedStrings['%footnoteEditor_noteType_endNote_label%']}</span>\n        </DropdownMenuCheckboxItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","import { Button } from '@/components/shadcn-ui/button';\nimport {\n  DeltaOp,\n  DeltaOpInsertNoteEmbed,\n  Editorial,\n  EditorOptions,\n  EditorRef,\n  GENERATOR_NOTE_CALLER,\n  getDefaultViewOptions,\n  HIDDEN_NOTE_CALLER,\n  isInsertEmbedOpOfType,\n} from '@eten-tech-foundation/platform-editor';\nimport { Check, Copy, X } from 'lucide-react';\nimport { createRef, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport '@/components/advanced/footnote-editor/editor-overrides.css';\nimport { SerializedVerseRef } from '@sillsdev/scripture';\nimport {\n  Tooltip,\n  TooltipProvider,\n  TooltipTrigger,\n  TooltipContent,\n} from '@/components/shadcn-ui/tooltip';\nimport { Usj } from '@eten-tech-foundation/scripture-utilities';\nimport { FootnoteCallerDropdown } from './footnote-caller-dropdown.component';\nimport { FootnoteTypeDropdown } from './footnote-type-dropdown.component';\nimport { FootnoteCallerType, FootnoteEditorLocalizedStrings } from './footnote-editor.types';\n\n/** Interface containing the types of the properties that are passed to the `FootnoteEditor` */\nexport interface FootnoteEditorProps {\n  /** Class name for styling the embedded `Editor` component in this editor popover */\n  classNameForEditor?: string;\n  /** Delta ops for the current note being edited that are applied to the note editorial */\n  noteOps: DeltaOpInsertNoteEmbed[] | undefined;\n  /** External function to handle saving changes to the footnote */\n  onSave: (noteOps: DeltaOpInsertNoteEmbed[]) => void;\n  /**\n   * External function to handle closing the footnote editor. Gets called when the editor is closed\n   * without saving changes\n   */\n  onClose: () => void;\n  /** The scripture reference for the parent editor */\n  scrRef: SerializedVerseRef;\n  /** The unique note key to identify the note being edited used to apply changes to the note */\n  noteKey: string | undefined;\n  /** View options of the parent editor */\n  editorOptions: EditorOptions;\n  /** Localized strings to be passed to the footnote editor component */\n  localizedStrings: FootnoteEditorLocalizedStrings;\n}\n\n/**\n * Function to convert a footnote/endnote type node to a cross-reference type node\n *\n * @param op The node to be converted\n */\nfunction footnoteToCrossReferenceOp(op: DeltaOp) {\n  // The built-in type for the delta note ops does not contain the types for the attributes\n  // so have to cast it here\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const opCharAttribute = op.attributes?.char as Record<string, string>;\n  if (opCharAttribute.style) {\n    if (opCharAttribute.style === 'ft') {\n      opCharAttribute.style = 'xt';\n    }\n\n    if (opCharAttribute.style === 'fr') {\n      opCharAttribute.style = 'xo';\n    }\n\n    if (opCharAttribute.style === 'fq') {\n      opCharAttribute.style = 'xq';\n    }\n  }\n}\n\n/**\n * Function to convert a cross-reference type node to a footnote/endnote type node\n *\n * @param op THe node to be converted\n */\nfunction crossReferenceToFootnoteOp(op: DeltaOp) {\n  // The built-in type for the delta note ops does not contain the types for the attributes\n  // so have to cast it here\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const opCharAttribute = op.attributes?.char as Record<string, string>;\n  if (opCharAttribute.style) {\n    if (opCharAttribute.style === 'xt') {\n      opCharAttribute.style = 'ft';\n    }\n\n    if (opCharAttribute.style === 'xo') {\n      opCharAttribute.style = 'fr';\n    }\n\n    if (opCharAttribute.style === 'xq') {\n      opCharAttribute.style = 'fq';\n    }\n  }\n}\n\n// TODO: Remove this once the new marker menu is implemented with correct logic\n/**\n * This is for a temporary fix to get the markers menu to work by having the default usj include a\n * parent paragraph node\n */\nconst PARAGRAPH_USJ: Usj = {\n  type: 'USJ',\n  version: '3.1',\n  content: [\n    {\n      type: 'para',\n    },\n  ],\n};\n\n/**\n * Component to edit footnotes from within the editor component\n *\n * @param FootnoteEditorProps - The properties for the footnote editor component\n */\nexport default function FootnoteEditor({\n  classNameForEditor,\n  noteOps,\n  onSave,\n  onClose,\n  scrRef,\n  noteKey,\n  editorOptions,\n  localizedStrings,\n}: FootnoteEditorProps) {\n  // The editor ref component must be this\n  // eslint-disable-next-line no-null/no-null\n  const editorRef = useRef<EditorRef | null>(null);\n  const editorParentRef = createRef<HTMLDivElement>();\n\n  const [callerType, setCallerType] = useState<FootnoteCallerType>('generated');\n  const [customCaller, setCustomCaller] = useState<string>('*');\n\n  const [noteType, setNoteType] = useState<string>('f');\n\n  const [isTypeSwitchable, setIsTypeSwitchable] = useState<boolean>(false);\n\n  // Options for the editorial component\n  const options = useMemo<EditorOptions>(\n    () => ({\n      ...editorOptions,\n      markerMenuTrigger: editorOptions.markerMenuTrigger ?? '\\\\',\n      hasExternalUI: true,\n      view: { ...(editorOptions.view ?? getDefaultViewOptions()), noteMode: 'expanded' },\n    }),\n    [editorOptions],\n  );\n\n  // Makes it so that the footnote type change tooltip doesn't automatically focus when the\n  // component opens by focusing the editor\n  useEffect(() => {\n    editorRef.current?.focus();\n  });\n\n  // When the component loads, applies the note ops to the current editor, gets the note ref and caller\n  useEffect(() => {\n    let timeout: ReturnType<typeof setTimeout>;\n    const noteOp = noteOps?.at(0);\n    if (noteOp && isInsertEmbedOpOfType('note', noteOp)) {\n      const rawCaller = noteOp.insert.note?.caller;\n      // Parses the current caller\n      let parsedCallerType: FootnoteCallerType = 'custom';\n      if (rawCaller === GENERATOR_NOTE_CALLER) {\n        parsedCallerType = 'generated';\n      } else if (rawCaller === HIDDEN_NOTE_CALLER) {\n        parsedCallerType = 'hidden';\n      } else if (rawCaller) {\n        setCustomCaller(rawCaller);\n      }\n      setCallerType(parsedCallerType);\n      // Assigns note type\n      setNoteType(noteOp.insert.note?.style ?? 'f');\n      timeout = setTimeout(() => {\n        // Inserts the note node to be edited as an delta operation\n        editorRef.current?.applyUpdate([noteOp]);\n      }, 0);\n    }\n\n    return () => {\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n    };\n  }, [noteOps, noteKey]);\n\n  const handleSave = useCallback(() => {\n    const currentNoteOp = editorRef.current?.getNoteOps(0)?.at(0);\n    if (currentNoteOp && isInsertEmbedOpOfType('note', currentNoteOp)) {\n      if (currentNoteOp.insert.note) {\n        if (callerType === 'custom') {\n          currentNoteOp.insert.note.caller = customCaller;\n        } else {\n          currentNoteOp.insert.note.caller =\n            callerType === 'generated' ? GENERATOR_NOTE_CALLER : HIDDEN_NOTE_CALLER;\n        }\n      }\n      onSave([currentNoteOp]);\n    }\n  }, [callerType, customCaller, onSave]);\n\n  const handleCopy = () => {\n    const editorInput = editorParentRef.current?.getElementsByClassName('editor-input')[0];\n    if (editorInput?.textContent) {\n      navigator.clipboard.writeText(editorInput.textContent);\n    }\n  };\n\n  const handleNoteTypeChange = (value: string) => {\n    setNoteType(value);\n\n    // Changes the note type for the current note that is being edited\n    const currentNoteOp = editorRef.current?.getNoteOps(0)?.at(0);\n    if (currentNoteOp && isInsertEmbedOpOfType('note', currentNoteOp)) {\n      if (currentNoteOp.insert.note) currentNoteOp.insert.note.style = value;\n\n      // If switching between cross-reference and footnote/endnote, need to switch the nodes inside\n      const innerNoteOps = currentNoteOp.insert.note?.contents?.ops;\n      if (noteType !== 'x' && value === 'x') {\n        innerNoteOps?.forEach((op) => footnoteToCrossReferenceOp(op));\n      } else if (noteType === 'x' && value !== 'x') {\n        innerNoteOps?.forEach((op) => crossReferenceToFootnoteOp(op));\n      }\n\n      // Inserts the new footnote/cross-reference and deletes the old one\n      editorRef.current?.applyUpdate([currentNoteOp, { delete: 1 }]);\n    }\n  };\n\n  const handleUsjChange = (usj: Usj) => {\n    const noteOp = editorRef.current?.getNoteOps(0)?.at(0);\n    if (noteOp && isInsertEmbedOpOfType('note', noteOp)) {\n      // Prevents adding additional note nodes or other nodes after the main footnote node\n      if (usj.content.length > 1) {\n        setTimeout(() => {\n          // Retains the first two nodes which are the added paragraph node (for now) and the\n          // footnote/cross-reference and deletes the unwanted node that was just inserted\n          editorRef.current?.applyUpdate([{ retain: 2 }, { delete: 1 }]);\n        }, 0);\n      }\n      const currentNoteType = noteOp.insert.note?.style;\n      const innerNoteOps = noteOp.insert.note?.contents?.ops;\n      if (!currentNoteType) setIsTypeSwitchable(false);\n\n      if (currentNoteType === 'x') {\n        setIsTypeSwitchable(\n          !!innerNoteOps?.every((op) => {\n            if (!op.attributes?.char) return true;\n            // The built-in type for the delta note ops does not contain the types for the attributes\n            // so have to cast it here\n            // eslint-disable-next-line no-type-assertion/no-type-assertion\n            const nodeType = (op.attributes?.char as Record<string, string>).style;\n            return nodeType === 'xt' || nodeType === 'xo' || nodeType === 'xq';\n          }),\n        );\n      } else {\n        setIsTypeSwitchable(\n          !!innerNoteOps?.every((op) => {\n            if (!op.attributes?.char) return true;\n            // The built-in type for the delta note ops does not contain the types for the attributes\n            // so have to cast it here\n            // eslint-disable-next-line no-type-assertion/no-type-assertion\n            const nodeType = (op.attributes?.char as Record<string, string>).style;\n            return nodeType === 'ft' || nodeType === 'fr' || nodeType === 'fq';\n          }),\n        );\n      }\n    } else {\n      setIsTypeSwitchable(false);\n    }\n  };\n\n  return (\n    <div className=\"footnote-editor tw-grid tw-gap-[12px]\">\n      <div className=\"tw-flex\">\n        <div className=\"tw-flex tw-gap-4\">\n          <FootnoteTypeDropdown\n            isTypeSwitchable={isTypeSwitchable}\n            noteType={noteType}\n            handleNoteTypeChange={handleNoteTypeChange}\n            localizedStrings={localizedStrings}\n          />\n          <FootnoteCallerDropdown\n            callerType={callerType}\n            updateCallerType={setCallerType}\n            customCaller={customCaller}\n            updateCustomCaller={setCustomCaller}\n            localizedStrings={localizedStrings}\n          />\n        </div>\n        <div className=\"tw-flex tw-w-full tw-justify-end tw-gap-4\">\n          <TooltipProvider>\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button onClick={onClose} className=\"tw-h-6 tw-w-6\" size=\"icon\" variant=\"secondary\">\n                  <X />\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>\n                <p>{localizedStrings['%footnoteEditor_cancelButton_tooltip%']}</p>\n              </TooltipContent>\n            </Tooltip>\n          </TooltipProvider>\n          <TooltipProvider>\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button\n                  onClick={handleSave}\n                  className=\"tw-h-6 tw-w-6\"\n                  size=\"icon\"\n                  variant=\"default\"\n                >\n                  <Check />\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>\n                {localizedStrings['%footnoteEditor_saveButton_tooltip%']}\n              </TooltipContent>\n            </Tooltip>\n          </TooltipProvider>\n        </div>\n      </div>\n      <div\n        ref={editorParentRef}\n        className=\"tw-relative tw-rounded-[6px] tw-border-2 tw-border-ring\"\n      >\n        <div className={classNameForEditor}>\n          <Editorial\n            options={options}\n            onUsjChange={handleUsjChange}\n            defaultUsj={PARAGRAPH_USJ}\n            onScrRefChange={() => {}}\n            scrRef={scrRef}\n            ref={editorRef}\n          />\n        </div>\n        <div className=\"tw-absolute tw-bottom-0 tw-right-0\">\n          <TooltipProvider>\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button onClick={handleCopy} className=\"tw-h-6 tw-w-6\" variant=\"ghost\" size=\"icon\">\n                  <Copy />\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>\n                <p>{localizedStrings['%footnoteEditor_copyButton_tooltip%']}</p>\n              </TooltipContent>\n            </Tooltip>\n          </TooltipProvider>\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * Object containing all keys used for localization in the FootnoteEditor component. If you're using\n * this component in an extension, you can pass it into the useLocalizedStrings hook to easily\n * obtain the localized strings and pass them into the localizedStrings prop of this component\n */\nexport const FOOTNOTE_EDITOR_STRING_KEYS = Object.freeze([\n  '%footnoteEditor_callerDropdown_label%',\n  '%footnoteEditor_callerDropdown_item_generated%',\n  '%footnoteEditor_callerDropdown_item_hidden%',\n  '%footnoteEditor_callerDropdown_item_custom%',\n  '%footnoteEditor_callerDropdown_tooltip%',\n  '%footnoteEditor_cancelButton_tooltip%',\n  '%footnoteEditor_copyButton_tooltip%',\n  '%footnoteEditor_noteType_crossReference_label%',\n  '%footnoteEditor_noteType_endNote_label%',\n  '%footnoteEditor_noteType_footnote_label%',\n  '%footnoteEditor_noteType_tooltip%',\n  '%footnoteEditor_noteTypeDropdown_label%',\n  '%footnoteEditor_saveButton_tooltip%',\n] as const);\n\nexport type FootnoteEditorLocalizedStrings = {\n  [localizedKey in (typeof FOOTNOTE_EDITOR_STRING_KEYS)[number]]?: string;\n};\n\nexport type FootnoteCallerType = 'generated' | 'hidden' | 'custom';\n","import React from 'react';\nimport { MarkerContent, MarkerObject } from '@eten-tech-foundation/scripture-utilities';\nimport { AlertCircle } from 'lucide-react';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { FootnoteItemProps } from './footnotes.types';\n\nfunction makeKey(parentMarker: string | undefined, content?: MarkerContent[]): string {\n  if (!content || content.length === 0) return parentMarker ?? 'empty';\n\n  const firstString = content.find((part) => typeof part === 'string');\n  if (firstString) {\n    return `key-${parentMarker ?? 'unknown'}-${firstString.slice(0, 10)}`;\n  }\n\n  // Fallback: combine markers\n  const firstMarker =\n    typeof content[0] === 'string' ? 'impossible' : (content[0].marker ?? 'unknown');\n  return `key-${parentMarker ?? 'unknown'}-${firstMarker}`;\n}\n\nfunction renderParagraphs(\n  parentMarker: string | undefined,\n  content?: MarkerContent[],\n  showMarkers = true,\n  footnoteClosing: React.ReactNode | undefined = undefined,\n): React.ReactNode {\n  if (!content || content.length === 0) return undefined;\n\n  const markerHierarchy: string[] = [];\n\n  const paragraphs: MarkerContent[][] = [];\n  let current: MarkerContent[] = [];\n\n  content.forEach((part) => {\n    if (typeof part !== 'string' && part.marker === 'fp') {\n      // End current paragraph before starting new one\n      if (current.length > 0) paragraphs.push(current);\n\n      // Start new paragraph that *includes* the fp marker itself\n      current = [part];\n    } else {\n      current.push(part);\n    }\n  });\n\n  if (current.length > 0) paragraphs.push(current);\n\n  return paragraphs.map((para, i) => {\n    const isLast = i === paragraphs.length - 1;\n    return (\n      <p key={makeKey(parentMarker, para)}>\n        {renderContent(parentMarker, para, showMarkers, true, markerHierarchy)}\n        {isLast && footnoteClosing}\n      </p>\n    );\n  });\n}\n\nfunction renderContent(\n  parentMarker: string | undefined,\n  content?: MarkerContent[],\n  showMarkers = true,\n  allowUnmarkedText = true,\n  markerHierarchy: string[] = [],\n): React.ReactNode {\n  if (!content || content.length === 0) return undefined;\n\n  return content.map((footnotePart) => {\n    if (typeof footnotePart === 'string') {\n      // Build a key based on the hierarchy and text\n      const key = `${parentMarker}-text-${footnotePart.slice(0, 10)}`;\n      if (allowUnmarkedText) {\n        const classes = cn(`usfm_${parentMarker}`);\n        return (\n          <span key={key} className={classes}>\n            {footnotePart}\n          </span>\n        );\n      }\n      return (\n        <span\n          key={key}\n          className=\"tw-inline-flex tw-items-center tw-gap-1 tw-underline tw-decoration-destructive\"\n        >\n          <AlertCircle className=\"tw-h-4 tw-w-4 tw-fill-destructive\" />\n          <span>{footnotePart}</span>\n          <AlertCircle className=\"tw-h-4 tw-w-4 tw-fill-destructive\" />\n        </span>\n      );\n    }\n\n    return renderMarkerObject(\n      footnotePart,\n      makeKey(`${parentMarker}\\\\${footnotePart.marker}`, [footnotePart]),\n      showMarkers,\n      [...markerHierarchy, parentMarker ?? 'unknown'],\n    );\n  });\n}\n\nfunction renderMarkerObject(\n  markerObj: MarkerObject,\n  key: React.Key,\n  showMarkers: boolean,\n  markerHierarchy: string[] = [],\n): React.ReactNode {\n  const { marker } = markerObj;\n\n  return (\n    <span key={key}>\n      {marker ? (\n        showMarkers && <span className=\"marker\">{`\\\\${marker} `}</span>\n      ) : (\n        <AlertCircle\n          className=\"tw-text-error tw-mr-1 tw-inline-block tw-h-4 tw-w-4\"\n          aria-label=\"Missing marker\"\n        />\n      )}\n      {renderContent(marker, markerObj.content, showMarkers, true, [\n        ...markerHierarchy,\n        marker ?? 'unknown',\n      ])}\n    </span>\n  );\n}\n\n/** `FootnoteItem` is a component that provides a read-only display of a single USFM/JSX footnote. */\nexport function FootnoteItem({\n  footnote,\n  layout = 'horizontal',\n  formatCaller,\n  showMarkers = true,\n}: FootnoteItemProps) {\n  const caller = formatCaller ? formatCaller(footnote.caller) : footnote.caller;\n  const isCallerFormatted = caller !== footnote.caller;\n\n  // Split out target reference (first top-level fr/xo, if any)\n  let targetRef: MarkerContent | undefined;\n  let remainingContent = footnote.content;\n\n  if (\n    Array.isArray(footnote.content) &&\n    footnote.content.length > 0 &&\n    typeof footnote.content[0] !== 'string' &&\n    (footnote.content[0].marker === 'fr' || footnote.content[0].marker === 'xo')\n  ) {\n    [targetRef, ...remainingContent] = footnote.content;\n  }\n\n  const footnoteOpening = showMarkers ? (\n    <span className=\"marker\">{`\\\\${footnote.marker} `}</span>\n  ) : undefined;\n\n  const footnoteClosing = showMarkers ? (\n    <span className=\"marker\">{` \\\\${footnote.marker}*`}</span>\n  ) : undefined;\n\n  const footnoteCaller = caller && (\n    // USFM does not specify a marker for caller, so instead of a usfm_* class, we use a\n    // specific class name in case styling is needed.\n    <span className={cn('note-caller tw-inline-block', { formatted: isCallerFormatted })}>\n      {caller}{' '}\n    </span>\n  );\n  const footnoteTargetRef = targetRef && (\n    <>{renderContent(footnote.marker, [targetRef], showMarkers, false)} </>\n  );\n\n  const layoutClass = layout === 'horizontal' ? 'horizontal' : 'vertical';\n  const markerClass = showMarkers ? 'marker-visible' : '';\n  const footnoteBodyClass =\n    layout === 'horizontal' ? 'tw-col-span-1' : 'tw-col-span-2 tw-col-start-1 tw-row-start-2';\n  const baseClasses = cn(layoutClass, markerClass);\n\n  return (\n    <>\n      <div className={cn('textual-note-header tw-col-span-1 tw-w-fit tw-text-nowrap', baseClasses)}>\n        {footnoteOpening}\n        {footnoteCaller}\n      </div>\n      <div className={cn('textual-note-header tw-col-span-1 tw-w-fit tw-text-nowrap', baseClasses)}>\n        {footnoteTargetRef}\n      </div>\n      <div\n        className={cn(\n          'textual-note-body tw-flex tw-flex-col tw-gap-1',\n          footnoteBodyClass,\n          baseClasses,\n        )}\n      >\n        {remainingContent && remainingContent.length > 0 && (\n          <>{renderParagraphs(footnote.marker, remainingContent, showMarkers, footnoteClosing)}</>\n        )}\n      </div>\n    </>\n  );\n}\n\nexport default FootnoteItem;\n","import { MarkerObject } from '@eten-tech-foundation/scripture-utilities';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Separator } from '@/components/shadcn-ui/separator';\nimport { getFormatCallerFunction } from 'platform-bible-utils';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { FootnoteItem } from './footnote-item.component';\nimport { FootnoteListProps } from './footnotes.types';\n\n/** `FootnoteList` is a component that provides a read-only display of a list of USFM/JSX footnote. */\nexport function FootnoteList({\n  className,\n  classNameForItems,\n  footnotes,\n  layout = 'horizontal',\n  listId,\n  selectedFootnote,\n  showMarkers = true,\n  suppressFormatting = false,\n  formatCaller,\n  onFootnoteSelected,\n}: FootnoteListProps) {\n  const handleFormatCaller = formatCaller ?? getFormatCallerFunction(footnotes, undefined);\n  const handleFootnoteClick = (footnote: MarkerObject, index: number) => {\n    onFootnoteSelected?.(footnote, index, listId);\n  };\n\n  const initialFocusedIndex = selectedFootnote\n    ? footnotes.findIndex((f) => f === selectedFootnote)\n    : -1;\n\n  const [focusedIndex, setFocusedIndex] = useState<number>(initialFocusedIndex);\n\n  const handleFootnoteKeyDown = (\n    e: React.KeyboardEvent<HTMLLIElement>,\n    footnote: MarkerObject,\n    index: number,\n  ) => {\n    if (!footnotes.length) return;\n\n    switch (e.key) {\n      case 'Enter':\n      case ' ':\n        e.preventDefault();\n        onFootnoteSelected?.(footnote, index, listId);\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  const handleListKeyDown = (e: React.KeyboardEvent<HTMLDivElement>) => {\n    if (!footnotes.length) return;\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        setFocusedIndex((prev) => Math.min(prev + 1, footnotes.length - 1));\n        break;\n\n      case 'ArrowUp':\n        e.preventDefault();\n        setFocusedIndex((prev) => Math.max(prev - 1, 0));\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  const rowRefs = useRef<(HTMLLIElement | null)[]>([]);\n\n  useEffect(() => {\n    if (focusedIndex >= 0 && focusedIndex < rowRefs.current.length) {\n      rowRefs.current[focusedIndex]?.focus();\n    }\n  }, [focusedIndex]);\n\n  /*\n   * TODO(PT-3743): After upgrading to Tailwind v4, move to using @container and @sm/@lg css\n   * styling to replace the use of the `layout` variable to distinguish between\n   * wide/skinny layouts.\n   */\n  return (\n    <div\n      role=\"listbox\"\n      aria-label=\"Footnotes\"\n      tabIndex={focusedIndex < 0 ? 0 : -1}\n      className={cn('tw-h-full tw-overflow-y-auto', className)}\n      onKeyDown={handleListKeyDown}\n    >\n      <ul\n        className={cn(\n          'tw-p-0.5 tw-pt-1' /* Added top padding to prevent focus ring clipping in P.B app */,\n          'tw-grid',\n          layout === 'horizontal'\n            ? 'tw-grid-cols-[min-content_min-content_1fr]'\n            : 'tw-grid-cols-[min-content_1fr]',\n          !suppressFormatting && 'formatted-font',\n        )}\n      >\n        {footnotes.map((footnote, idx) => {\n          const isSelected = footnote === selectedFootnote;\n          const key = `${listId}-${idx}`;\n          return (\n            <>\n              <li\n                ref={(el) => {\n                  rowRefs.current[idx] = el;\n                }}\n                role=\"option\"\n                aria-selected={isSelected}\n                key={key}\n                data-marker={footnote.marker}\n                data-state={isSelected ? 'selected' : undefined}\n                tabIndex={idx === focusedIndex ? 0 : -1}\n                className={cn(\n                  'tw-gap-x-3 tw-gap-y-1 tw-p-2 data-[state=selected]:tw-bg-muted',\n                  onFootnoteSelected && 'hover:tw-bg-muted/50',\n                  'tw-w-full tw-rounded-sm tw-border-0 tw-bg-transparent tw-shadow-none',\n                  'focus:tw-outline-none focus-visible:tw-outline-none',\n                  /* ENHANCE: After considerable fiddling, this set of styles makes a focus ring\n                     that looks great in Storybook. However, the left edge of the ring is clipped in\n                     P.B app. These are similar, but not identical to, the customizations made in\n                     our shadcn table component.\n                  */\n                  'focus-visible:tw-ring-offset-0.5 focus-visible:tw-relative focus-visible:tw-z-10 focus-visible:tw-ring-2 focus-visible:tw-ring-ring',\n                  'tw-grid tw-grid-flow-col tw-grid-cols-subgrid',\n                  layout === 'horizontal' ? 'tw-col-span-3' : 'tw-col-span-2 tw-row-span-2',\n                  classNameForItems,\n                )}\n                onClick={() => handleFootnoteClick(footnote, idx)}\n                onKeyDown={(e) => handleFootnoteKeyDown(e, footnote, idx)}\n              >\n                <FootnoteItem\n                  footnote={footnote}\n                  layout={layout}\n                  formatCaller={() => handleFormatCaller(footnote.caller, idx)}\n                  showMarkers={showMarkers}\n                />\n              </li>\n              {/* Only render separator if not the last item */}\n              {idx < footnotes.length - 1 && layout === 'vertical' && (\n                <Separator tabIndex={-1} className=\"tw-col-span-2\" />\n              )}\n            </>\n          );\n        })}\n      </ul>\n    </div>\n  );\n}\n\nexport default FootnoteList;\n","import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/shadcn-ui/table';\nimport { SerializedVerseRef } from '@sillsdev/scripture';\nimport { formatScrRef, LanguageStrings } from 'platform-bible-utils';\nimport { ReactNode, useMemo } from 'react';\nimport { InventoryItemOccurrence } from './inventory-utils';\n\n/**\n * Convert text with `\\\\word\\\\` markers to React elements with bold formatting.\n *\n * @param text Text containing `\\\\word\\\\` markers for bolding\n * @returns Array of React nodes with text and bold elements\n */\nfunction formatTextWithBold(text: string): ReactNode[] {\n  const parts: ReactNode[] = [];\n  let lastIndex = 0;\n  // Look for text wrapped in double backslashes (e.g., \\\\bolded text\\\\)\n  const regex = /\\\\\\\\(.+?)\\\\\\\\/g;\n  let match;\n\n  // regex.exec() returns null when no match is found\n  // eslint-disable-next-line no-null/no-null, no-cond-assign\n  while ((match = regex.exec(text)) !== null) {\n    // Add text before the match\n    if (match.index > lastIndex) {\n      parts.push(text.substring(lastIndex, match.index));\n    }\n    // Add the bold text\n    parts.push(<strong key={match.index}>{match[1]}</strong>);\n    lastIndex = regex.lastIndex;\n  }\n\n  // Add any remaining text after the last match\n  if (lastIndex < text.length) {\n    parts.push(text.substring(lastIndex));\n  }\n\n  return parts.length > 0 ? parts : [text];\n}\n\n/** Props for the OccurrencesTable component */\ntype OccurrencesTableProps = {\n  /** Data that contains scriptures references and snippets of scripture */\n  occurrenceData: InventoryItemOccurrence[];\n  /** Callback function that is executed when the scripture reference is changed */\n  setScriptureReference: (scriptureReference: SerializedVerseRef) => void;\n  /**\n   * Object with all localized strings that the OccurrencesTable needs to work well across multiple\n   * languages\n   */\n  localizedStrings: LanguageStrings;\n  /** Class name to apply to the occurrence text */\n  classNameForText?: string;\n};\n\n/**\n * Table that shows occurrences of specified inventory item(s). The first column shows the related\n * scripture reference. The second column shows the snippet of scripture that contains the specified\n * inventory item\n */\nexport function OccurrencesTable({\n  occurrenceData,\n  setScriptureReference,\n  localizedStrings,\n  classNameForText,\n}: OccurrencesTableProps) {\n  const referenceHeaderText =\n    localizedStrings['%webView_inventory_occurrences_table_header_reference%'];\n  const occurrenceHeaderText =\n    localizedStrings['%webView_inventory_occurrences_table_header_occurrence%'];\n\n  const occurrences: InventoryItemOccurrence[] = useMemo(() => {\n    const uniqueOccurrences: InventoryItemOccurrence[] = [];\n    const seen = new Set<string>();\n\n    occurrenceData.forEach((occurrence) => {\n      const key = `${occurrence.reference.book}:${occurrence.reference.chapterNum}:${occurrence.reference.verseNum}:${occurrence.text}`;\n\n      if (!seen.has(key)) {\n        seen.add(key);\n        uniqueOccurrences.push(occurrence);\n      }\n    });\n\n    return uniqueOccurrences;\n  }, [occurrenceData]);\n\n  return (\n    <Table stickyHeader>\n      <TableHeader stickyHeader>\n        <TableRow>\n          <TableHead>{referenceHeaderText}</TableHead>\n          <TableHead>{occurrenceHeaderText}</TableHead>\n        </TableRow>\n      </TableHeader>\n      <TableBody>\n        {occurrences.length > 0 &&\n          occurrences.map((occurrence) => (\n            <TableRow\n              key={`${occurrence.reference.book} ${occurrence.reference.chapterNum}:${\n                occurrence.reference.verseNum\n              }-${occurrence.text}`}\n              onClick={() => {\n                setScriptureReference(occurrence.reference);\n              }}\n            >\n              <TableCell>{formatScrRef(occurrence.reference, 'English')}</TableCell>\n              <TableCell className={classNameForText}>\n                {formatTextWithBold(occurrence.text)}\n              </TableCell>\n            </TableRow>\n          ))}\n      </TableBody>\n    </Table>\n  );\n}\n\nexport default OccurrencesTable;\n","import React from 'react';\nimport * as CheckboxPrimitive from '@radix-ui/react-checkbox';\nimport { Check } from 'lucide-react';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Checkbox component provides a control that allows the user to toggle between checked and not\n * checked. This components is built on Radix UI primitives and styled with Shadcn UI.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/checkbox}\n * @see Radix UI Documentation: {@link https://www.radix-ui.com/primitives/docs/components/checkbox}\n */\nexport const Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      'tw-peer pr-twp tw-h-4 tw-w-4 tw-shrink-0 tw-rounded-sm tw-border tw-border-primary tw-ring-offset-background focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2 disabled:tw-cursor-not-allowed disabled:tw-opacity-50 data-[state=checked]:tw-bg-primary data-[state=checked]:tw-text-primary-foreground',\n      className,\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn('tw-flex tw-items-center tw-justify-center tw-text-current')}\n    >\n      <Check className=\"tw-h-4 tw-w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n));\nCheckbox.displayName = CheckboxPrimitive.Root.displayName;\n\nexport default Checkbox;\n","import { ColumnDef, SortDirection } from '@/components/advanced/data-table/data-table.component';\nimport { Button } from '@/components/shadcn-ui/button';\nimport { ToggleGroup, ToggleGroupItem } from '@/components/shadcn-ui/toggle-group';\nimport {\n  ArrowDownIcon,\n  ArrowUpDownIcon,\n  ArrowUpIcon,\n  CircleCheckIcon,\n  CircleHelpIcon,\n  CircleXIcon,\n} from 'lucide-react';\nimport { ReactNode } from 'react';\nimport { InventoryTableData, Status } from './inventory-utils';\n\n/**\n * Gets an icon that indicates the current sorting direction based on the provided input\n *\n * @param sortDirection Sorting direction. Can be ascending ('asc'), descending ('desc') or false (\n *   i.e. not sorted)\n * @returns The appropriate sorting icon for the provided sorting direction\n */\nconst getSortingIcon = (sortDirection: false | SortDirection): ReactNode => {\n  if (sortDirection === 'asc') {\n    return <ArrowUpIcon className=\"tw-ms-2 tw-h-4 tw-w-4\" />;\n  }\n  if (sortDirection === 'desc') {\n    return <ArrowDownIcon className=\"tw-ms-2 tw-h-4 tw-w-4\" />;\n  }\n  return <ArrowUpDownIcon className=\"tw-ms-2 tw-h-4 tw-w-4\" />;\n};\n\n/**\n * Function that creates the item column for inventories\n *\n * @param itemLabel Localized label for the item column (e.g. 'Character', 'Repeated Word', etc.)\n * @returns Column that shows the inventory items. Should be used with the DataTable component\n */\nexport const inventoryItemColumn = (itemLabel: string): ColumnDef<InventoryTableData> => {\n  return {\n    accessorKey: 'item',\n    accessorFn: (row: InventoryTableData) => row.items[0],\n    header: ({ column }) => (\n      <Button variant=\"ghost\" onClick={() => column.toggleSorting(undefined)}>\n        {itemLabel}\n        {getSortingIcon(column.getIsSorted())}\n      </Button>\n    ),\n  };\n};\n\n/**\n * Function that creates the additional item columns for inventories\n *\n * @param additionalItemLabel Localized label for the additional item column (e.g. 'Preceding\n *   Marker')\n * @param additionalItemIndex Index that locates the desired item in the items array of the\n *   inventory\n * @returns Column that shows additional inventory items. Should be used with the DataTable\n *   component\n */\nexport const inventoryAdditionalItemColumn = (\n  additionalItemLabel: string,\n  additionalItemIndex: number,\n): ColumnDef<InventoryTableData> => {\n  return {\n    accessorKey: `item${additionalItemIndex}`,\n    accessorFn: (row: InventoryTableData) => row.items[additionalItemIndex],\n    header: ({ column }) => (\n      <Button variant=\"ghost\" onClick={() => column.toggleSorting(undefined)}>\n        {additionalItemLabel}\n        {getSortingIcon(column.getIsSorted())}\n      </Button>\n    ),\n  };\n};\n\n/**\n * Function that creates the count column for inventories. Should be used with the DataTable\n * component.\n *\n * @param countLabel Localized label for the count column\n * @returns Column that shows the number of occurrences of the related inventory items\n */\nexport const inventoryCountColumn = (countLabel: string): ColumnDef<InventoryTableData> => {\n  return {\n    accessorKey: 'count',\n    header: ({ column }) => (\n      <div className=\"tw-flex tw-justify-end tw-tabular-nums\">\n        <Button variant=\"ghost\" onClick={() => column.toggleSorting(undefined)}>\n          {countLabel}\n          {getSortingIcon(column.getIsSorted())}\n        </Button>\n      </div>\n    ),\n    cell: ({ row }) => <div className=\"tw-flex tw-justify-end\">{row.getValue('count')}</div>,\n  };\n};\n\n/**\n * Function that updates project settings when status for item(s) changes\n *\n * @param changedItems Array of items for which the status is being updated\n * @param newStatus The status that the items are being given\n * @param approvedItems Array of currently approved items\n * @param onApprovedItemsChange Callback function that stores the updated list of approved items\n * @param unapprovedItems Array of currently unapproved items\n * @param onUnapprovedItemsChange Callback function that stores the updated list of unapproved items\n */\nconst statusChangeHandler = (\n  changedItems: string[],\n  newStatus: Status,\n  approvedItems: string[],\n  onApprovedItemsChange: (items: string[]) => void,\n  unapprovedItems: string[],\n  onUnapprovedItemsChange: (items: string[]) => void,\n) => {\n  let newApprovedItems: string[] = [...approvedItems];\n  changedItems.forEach((item) => {\n    if (newStatus === 'approved') {\n      if (!newApprovedItems.includes(item)) {\n        newApprovedItems.push(item);\n      }\n    } else {\n      newApprovedItems = newApprovedItems.filter((validItem) => validItem !== item);\n    }\n  });\n  onApprovedItemsChange(newApprovedItems);\n\n  let newUnapprovedItems: string[] = [...unapprovedItems];\n  changedItems.forEach((item) => {\n    if (newStatus === 'unapproved') {\n      if (!newUnapprovedItems.includes(item)) {\n        newUnapprovedItems.push(item);\n      }\n    } else {\n      newUnapprovedItems = newUnapprovedItems.filter((unapprovedItem) => unapprovedItem !== item);\n    }\n  });\n  onUnapprovedItemsChange(newUnapprovedItems);\n};\n\n/**\n * Function that creates the status column for inventories. Should be used with the DataTable\n * component.\n *\n * @param statusLabel Localized label for the status column\n * @param approvedItems Array of approved items, typically as defined in `Settings.xml`\n * @param onApprovedItemsChange Callback function that stores the updated list of approved items\n * @param unapprovedItems Array of unapproved items, typically as defined in `Settings.xml`\n * @param onUnapprovedItemsChange Callback function that stores the updated list of unapproved items\n * @returns Column that shows the status buttons for the related inventory item. The button for the\n *   current status of the item is selected\n */\nexport const inventoryStatusColumn = (\n  statusLabel: string,\n  approvedItems: string[],\n  onApprovedItemsChange: (items: string[]) => void,\n  unapprovedItems: string[],\n  onUnapprovedItemsChange: (items: string[]) => void,\n): ColumnDef<InventoryTableData> => {\n  return {\n    accessorKey: 'status',\n    header: ({ column }) => {\n      return (\n        <div className=\"tw-flex tw-justify-center\">\n          <Button variant=\"ghost\" onClick={() => column.toggleSorting(undefined)}>\n            {statusLabel}\n            {getSortingIcon(column.getIsSorted())}\n          </Button>\n        </div>\n      );\n    },\n    cell: ({ row }) => {\n      const status: Status = row.getValue('status');\n      const item: string = row.getValue('item');\n      return (\n        <ToggleGroup value={status} variant=\"outline\" type=\"single\">\n          <ToggleGroupItem\n            onClick={(event) => {\n              event.stopPropagation();\n              statusChangeHandler(\n                [item],\n                'approved',\n                approvedItems,\n                onApprovedItemsChange,\n                unapprovedItems,\n                onUnapprovedItemsChange,\n              );\n            }}\n            value=\"approved\"\n          >\n            <CircleCheckIcon />\n          </ToggleGroupItem>\n          <ToggleGroupItem\n            onClick={(event) => {\n              event.stopPropagation();\n              statusChangeHandler(\n                [item],\n                'unapproved',\n                approvedItems,\n                onApprovedItemsChange,\n                unapprovedItems,\n                onUnapprovedItemsChange,\n              );\n            }}\n            value=\"unapproved\"\n          >\n            <CircleXIcon />\n          </ToggleGroupItem>\n          <ToggleGroupItem\n            onClick={(event) => {\n              event.stopPropagation();\n              statusChangeHandler(\n                [item],\n                'unknown',\n                approvedItems,\n                onApprovedItemsChange,\n                unapprovedItems,\n                onUnapprovedItemsChange,\n              );\n            }}\n            value=\"unknown\"\n          >\n            <CircleHelpIcon />\n          </ToggleGroupItem>\n        </ToggleGroup>\n      );\n    },\n  };\n};\n","import { SerializedVerseRef } from '@sillsdev/scripture';\n\n/* #region Types */\n\n/**\n * Status of items that appear in inventories. 'approved' and 'unapproved' items are defined in the\n * project's `Settings.xml`. All other items are defined as 'unknown'\n */\nexport type Status = 'approved' | 'unapproved' | 'unknown';\n\n/** Occurrence of item in inventory. Primarily used by table that shows occurrences */\nexport type InventoryItemOccurrence = {\n  /** Reference to scripture where the item appears */\n  reference: SerializedVerseRef;\n  /** Snippet of scripture that contains the occurrence */\n  text: string;\n};\n\n/** Data structure that contains all information on an item that is shown in an inventory */\nexport type InventoryTableData = {\n  /**\n   * The item (e.g. a character in the characters inventory, a marker in the marker inventory) In\n   * most cases the array will only have one element. In case of additional items (e.g. the\n   * preceding marker in the markers check), the primary item should be stored in the first index.\n   * To show additional items in the inventory, make sure to configure the `additionalItemsLabels`\n   * prop for the Inventory component\n   */\n  items: string[];\n  /** The number of times this item occurs in the selected scope */\n  count: number;\n  /** The status of this item (see documentation for `Status` type for more information) */\n  status: Status;\n  /** Occurrences of this item in the scripture text for the selected scope */\n  occurrences: InventoryItemOccurrence[];\n};\n\n/* #endregion */\n\n/* #region Functions */\n\n/**\n * Splits USFM string into shorter line-like segments\n *\n * @param text A single (likely very large) USFM string\n * @returns An array containing the input text, split into shorter segments\n */\nexport const getLinesFromUSFM = (text: string) => {\n  // Splits on (CR)LF, CR, \\v, \\c and \\id\n  return text.split(/(?:\\r?\\n|\\r)|(?=(?:\\\\(?:v|c|id)))/g);\n};\n\n/**\n * Extracts chapter or verse number from USFM strings that start with a \\c or \\v marker\n *\n * @param text USFM string that is expected to start with \\c or \\v marker\n * @returns Chapter or verse number if one is found. Else returns 0.\n */\nexport const getNumberFromUSFM = (text: string): number | undefined => {\n  // Captures all digits that follow \\v or \\c markers followed by whitespace located at the start of a string\n  const regex = /^\\\\[vc]\\s+(\\d+)/;\n  const match = text.match(regex);\n\n  if (match) {\n    return +match[1];\n  }\n  return undefined;\n};\n\n/**\n * Gets book ID from USFM string that starts with the \\id marker, and returns book number for it\n *\n * @param text USFM string that is expected to start with \\id marker\n * @returns Book number corresponding to the \\id marker in the input text. Returns 0 if no marker is\n *   found or the marker is not valid\n */\nexport const getBookIdFromUSFM = (text: string): string => {\n  // Captures all digits that follow an \\id marker followed by whitespace located at the start of a string\n  const match = text.match(/^\\\\id\\s+([A-Za-z]+)/);\n  if (match) {\n    return match[1];\n  }\n  return '';\n};\n\n/**\n * Gets the status for an item, typically used in the Inventory component\n *\n * @param item The item for which the status is being requested\n * @param approvedItems Array of approved items, typically as defined in `Settings.xml`\n * @param unapprovedItems Array of unapproved items, typically as defined in `Settings.xml`\n * @returns The status for the specified item\n */\nexport const getStatusForItem = (\n  item: string,\n  approvedItems: string[],\n  unapprovedItems: string[],\n): Status => {\n  if (unapprovedItems.includes(item)) return 'unapproved';\n  if (approvedItems.includes(item)) return 'approved';\n  return 'unknown';\n};\n\n/* #endregion */\n","import {\n  ColumnDef,\n  DataTable,\n  RowContents,\n  RowSelectionState,\n  TableContents,\n} from '@/components/advanced/data-table/data-table.component';\nimport { OccurrencesTable } from '@/components/advanced/inventory/occurrences-table.component';\nimport { Checkbox } from '@/components/shadcn-ui/checkbox';\nimport { Input } from '@/components/shadcn-ui/input';\nimport { Label } from '@/components/shadcn-ui/label';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/shadcn-ui/select';\nimport { Scope } from '@/components/utils/scripture.util';\nimport { SerializedVerseRef } from '@sillsdev/scripture';\nimport { deepEqual, isString, LocalizedStringValue } from 'platform-bible-utils';\nimport { useEffect, useMemo, useState } from 'react';\nimport { inventoryAdditionalItemColumn } from './inventory-columns';\nimport {\n  getStatusForItem,\n  InventoryItemOccurrence,\n  InventoryTableData,\n  Status,\n} from './inventory-utils';\n\n/**\n * Represents an item in the inventory with associated text and verse reference.\n *\n * @deprecated 12 January 2026. Use InventorySummaryItem instead for better performance and\n *   functionality.\n */\nexport type InventoryItem = {\n  /**\n   * The label by which the item is shown in the inventory (e.g. the word that is repeated in case\n   * of the Repeated Words check). It serves as a unique identifier for the item. It usually is a\n   * string, but can be a string[] when there are multiple defining attributes (e.g. when 'show\n   * preceding marker' is enabled for the Markers Inventory, the preceding marker will be stored as\n   * the second item in the array)\n   */\n  inventoryText: string | string[];\n  /** The snippet of scripture where this occurrence of the `inventoryItem` is found */\n  verse: string;\n  /** The reference to the location where the `verse` can be found in scripture */\n  verseRef: SerializedVerseRef;\n  /**\n   * Offset used to locate the `inventoryText` (or inventoryText[0] in case of an array) in the\n   * `verse` string\n   */\n  offset: number;\n};\n\n/**\n * Represents a summary item in the inventory with aggregated count and optional detailed\n * occurrences. This type is used for displaying inventory data in a summarized format, where each\n * item shows the total count and can optionally include detailed occurrence information that gets\n * loaded dynamically when the user selects the item.\n */\nexport type InventorySummaryItem = {\n  /** The item key (e.g., character, word, etc.) */\n  key: string | string[];\n  /** Total count of occurrences */\n  count: number;\n  /** Status of the item */\n  status?: Status;\n  /** Detailed occurrences - optional, loaded on demand */\n  occurrences?: InventoryItemOccurrence[];\n};\n\n/**\n * Object containing all keys used for localization in this component. If you're using this\n * component in an extension, you can pass it into the useLocalizedStrings hook to easily obtain the\n * localized strings and pass them into the localizedStrings prop of this component\n */\nexport const INVENTORY_STRING_KEYS = Object.freeze([\n  '%webView_inventory_all%',\n  '%webView_inventory_approved%',\n  '%webView_inventory_unapproved%',\n  '%webView_inventory_unknown%',\n  '%webView_inventory_scope_currentBook%',\n  '%webView_inventory_scope_chapter%',\n  '%webView_inventory_scope_verse%',\n  '%webView_inventory_filter_text%',\n  '%webView_inventory_show_additional_items%',\n  '%webView_inventory_occurrences_table_header_reference%',\n  '%webView_inventory_occurrences_table_header_occurrence%',\n  '%webView_inventory_no_results%',\n] as const);\n\nexport type InventoryLocalizedStrings = {\n  [localizedInventoryKey in (typeof INVENTORY_STRING_KEYS)[number]]?: LocalizedStringValue;\n};\n\n/** Status values that the status filter can select from */\ntype StatusFilter = Status | 'all';\n\n/** Text labels for the inventory columns and the control components of additional inventory items */\ntype AdditionalItemsLabels = {\n  checkboxText?: string;\n  tableHeaders?: string[];\n};\n\n/**\n * Filters data that is shown in the DataTable section of the Inventory\n *\n * @param itemData All inventory items and their related information\n * @param statusFilter Allows filtering by status (i.e. show all items, or only items that are\n *   'approved', 'unapproved' or 'unknown')\n * @param textFilter Allows filtering by text. All items that include the filter text will be\n *   selected.\n * @returns Array of items and their related information that are matched by the specified filters\n */\nconst filterItemData = (\n  itemData: InventoryTableData[],\n  statusFilter: StatusFilter,\n  textFilter: string,\n): InventoryTableData[] => {\n  let filteredItemData: InventoryTableData[] = itemData;\n\n  if (statusFilter !== 'all') {\n    filteredItemData = filteredItemData.filter(\n      (item) =>\n        (statusFilter === 'approved' && item.status === 'approved') ||\n        (statusFilter === 'unapproved' && item.status === 'unapproved') ||\n        (statusFilter === 'unknown' && item.status === 'unknown'),\n    );\n  }\n\n  if (textFilter !== '')\n    filteredItemData = filteredItemData.filter((item) => item.items[0].includes(textFilter));\n\n  return filteredItemData;\n};\n\n/**\n * Processes InventorySummaryItem array into InventoryTableData for display\n *\n * @param inventoryItems Summary items with counts and optional occurrences\n * @param approvedItems Array of approved items\n * @param unapprovedItems Array of unapproved items\n * @returns Array of table data for display\n */\nconst processSummaryItems = (\n  inventoryItems: InventorySummaryItem[],\n  approvedItems: string[],\n  unapprovedItems: string[],\n): InventoryTableData[] => {\n  return inventoryItems.map((item) => {\n    const itemKey = isString(item.key) ? item.key : item.key[0];\n    const items = isString(item.key) ? [item.key] : item.key;\n\n    return {\n      items,\n      count: item.count,\n      status: item.status || getStatusForItem(itemKey, approvedItems, unapprovedItems),\n      occurrences: item.occurrences || [],\n    };\n  });\n};\n\n/**\n * Gets the localized value for the provided key\n *\n * @param strings Object containing localized string\n * @param key Key for a localized string\n * @returns The localized value for the provided key, if available. Returns the key if no localized\n *   value is available\n */\nconst localizeString = (\n  strings: InventoryLocalizedStrings,\n  key: keyof InventoryLocalizedStrings,\n) => {\n  return strings[key] ?? key;\n};\n\n/** Props for the Inventory component */\ntype InventoryProps = {\n  /** The inventory items that the inventory should be populated with */\n  inventoryItems: InventorySummaryItem[] | undefined;\n  /** Callback function that is executed when the scripture reference is changed */\n  setVerseRef: (scriptureReference: SerializedVerseRef) => void;\n  /**\n   * Object with all localized strings that the Inventory needs to work well across multiple\n   * languages. When using this component with Platform.Bible, you can import\n   * `INVENTORY_STRING_KEYS` from this library, pass it in to the Platform's localization hook, and\n   * pass the localized keys that are returned by the hook into this prop.\n   */\n  localizedStrings: InventoryLocalizedStrings;\n  /**\n   * Text labels for control elements and additional column headers in case your Inventory has more\n   * than one item to show (e.g. The 'Preceding Marker' in the Markers Inventory)\n   */\n  additionalItemsLabels?: AdditionalItemsLabels;\n  /** Array of approved items, typically as defined in `Settings.xml` */\n  approvedItems: string[];\n  /** Array of unapproved items, typically as defined in `Settings.xml` */\n  unapprovedItems: string[];\n  /** Scope of scripture that the inventory will operate on */\n  scope: Scope;\n  /** Callback function that is executed when the scope is changed from the Inventory */\n  onScopeChange: (scope: Scope) => void;\n  /**\n   * Column definitions for the Inventory data table. The most commonly used column definitions are\n   * pre-configured for your convenience and can be imported (e.g. inventoryItemColumn,\n   * inventoryAdditionalItemColumn inventoryCountColumn, and inventoryStatusColumn). If you need any\n   * other columns you can add these yourself\n   */\n  columns: ColumnDef<InventoryTableData>[];\n  /** Unique identifier for the Inventory component */\n  id?: string;\n  /** Whether the inventory items are still loading */\n  areInventoryItemsLoading?: boolean;\n  /** Class name to apply to the provided occurrence verse text in the `OccurrencesTable` component */\n  classNameForVerseText?: string;\n  /** Optional callback that is called when an item is selected. Receives the selected item key. */\n  onItemSelected?: (itemKey: string) => void;\n};\n\n/** Inventory component that is used to view and control the status of provided project settings */\nexport function Inventory({\n  inventoryItems,\n  setVerseRef,\n  localizedStrings,\n  additionalItemsLabels,\n  approvedItems,\n  unapprovedItems,\n  scope,\n  onScopeChange,\n  columns,\n  id,\n  areInventoryItemsLoading = false,\n  classNameForVerseText,\n  onItemSelected,\n}: InventoryProps) {\n  const allItemsText = localizeString(localizedStrings, '%webView_inventory_all%');\n  const approvedItemsText = localizeString(localizedStrings, '%webView_inventory_approved%');\n  const unapprovedItemsText = localizeString(localizedStrings, '%webView_inventory_unapproved%');\n  const unknownItemsText = localizeString(localizedStrings, '%webView_inventory_unknown%');\n  const scopeBookText = localizeString(localizedStrings, '%webView_inventory_scope_currentBook%');\n  const scopeChapterText = localizeString(localizedStrings, '%webView_inventory_scope_chapter%');\n  const scopeVerseText = localizeString(localizedStrings, '%webView_inventory_scope_verse%');\n  const filterText = localizeString(localizedStrings, '%webView_inventory_filter_text%');\n  const showAdditionalItemsText = localizeString(\n    localizedStrings,\n    '%webView_inventory_show_additional_items%',\n  );\n  const noResultsText = localizeString(localizedStrings, '%webView_inventory_no_results%');\n\n  const [showAdditionalItems, setShowAdditionalItems] = useState<boolean>(false);\n  const [statusFilter, setStatusFilter] = useState<StatusFilter>('all');\n  const [textFilter, setTextFilter] = useState<string>('');\n  const [selectedItem, setSelectedItem] = useState<string[]>([]);\n\n  const tableData: InventoryTableData[] = useMemo(() => {\n    const safeInventoryItems = inventoryItems ?? [];\n    if (safeInventoryItems.length === 0) return [];\n    return processSummaryItems(safeInventoryItems, approvedItems, unapprovedItems);\n  }, [inventoryItems, approvedItems, unapprovedItems]);\n\n  const reducedTableData: InventoryTableData[] = useMemo(() => {\n    if (showAdditionalItems) return tableData;\n\n    const newTableData: InventoryTableData[] = [];\n\n    tableData.forEach((tableEntry) => {\n      const firstItem = tableEntry.items[0];\n\n      const existingEntry = newTableData.find(\n        (newTableEntry) => newTableEntry.items[0] === firstItem,\n      );\n\n      if (existingEntry) {\n        existingEntry.count += tableEntry.count;\n        existingEntry.occurrences = existingEntry.occurrences.concat(tableEntry.occurrences);\n      } else {\n        newTableData.push({\n          items: [firstItem],\n          count: tableEntry.count,\n          occurrences: tableEntry.occurrences,\n          status: tableEntry.status,\n        });\n      }\n    });\n\n    return newTableData;\n  }, [showAdditionalItems, tableData]);\n\n  const filteredTableData: InventoryTableData[] = useMemo(() => {\n    if (reducedTableData.length === 0) return [];\n    return filterItemData(reducedTableData, statusFilter, textFilter);\n  }, [reducedTableData, statusFilter, textFilter]);\n\n  const allColumns: ColumnDef<InventoryTableData>[] = useMemo(() => {\n    if (!showAdditionalItems) return columns;\n\n    const numberOfAdditionalItems = additionalItemsLabels?.tableHeaders?.length;\n    if (!numberOfAdditionalItems) return columns;\n\n    const additionalColumns: ColumnDef<InventoryTableData>[] = [];\n\n    for (let index = 0; index < numberOfAdditionalItems; index++) {\n      additionalColumns.push(\n        inventoryAdditionalItemColumn(\n          additionalItemsLabels?.tableHeaders?.[index] || 'Additional Item',\n          index + 1,\n        ),\n      );\n    }\n\n    return [...additionalColumns, ...columns];\n  }, [additionalItemsLabels?.tableHeaders, columns, showAdditionalItems]);\n\n  useEffect(() => {\n    if (filteredTableData.length === 0) {\n      setSelectedItem([]);\n    } else if (filteredTableData.length === 1) {\n      setSelectedItem(filteredTableData[0].items);\n    }\n  }, [filteredTableData]);\n\n  const rowClickHandler = (\n    row: RowContents<InventoryTableData>,\n    table: TableContents<InventoryTableData>,\n  ) => {\n    table.setRowSelection(() => {\n      const newSelection: RowSelectionState = {};\n      newSelection[row.index] = true;\n      return newSelection;\n    });\n\n    const selectedItems = row.original.items;\n    setSelectedItem(selectedItems);\n\n    // Call the callback if provided, passing the first item as the key\n    if (onItemSelected && selectedItems.length > 0) {\n      onItemSelected(selectedItems[0]);\n    }\n  };\n\n  const handleScopeChange = (value: string) => {\n    if (value === 'book' || value === 'chapter' || value === 'verse') {\n      onScopeChange(value);\n    } else {\n      throw new Error(`Invalid scope value: ${value}`);\n    }\n  };\n\n  const handleStatusFilterChange = (value: string) => {\n    if (value === 'all' || value === 'approved' || value === 'unapproved' || value === 'unknown') {\n      setStatusFilter(value);\n    } else {\n      throw new Error(`Invalid status filter value: ${value}`);\n    }\n  };\n\n  const occurrenceData: InventoryItemOccurrence[] = useMemo(() => {\n    if (reducedTableData.length === 0 || selectedItem.length === 0) return [];\n    const occurrence = reducedTableData.filter((tableEntry: InventoryTableData) => {\n      return deepEqual(\n        showAdditionalItems ? tableEntry.items : [tableEntry.items[0]],\n        selectedItem,\n      );\n    });\n    if (occurrence.length > 1) throw new Error('Selected item is not unique');\n    if (occurrence.length === 0) return [];\n    return occurrence[0].occurrences;\n  }, [selectedItem, showAdditionalItems, reducedTableData]);\n\n  return (\n    <div id={id} className=\"pr-twp tw-flex tw-h-full tw-flex-col\">\n      <div className=\"tw-flex tw-items-stretch\">\n        <Select\n          onValueChange={(value) => handleStatusFilterChange(value)}\n          defaultValue={statusFilter}\n        >\n          <SelectTrigger className=\"tw-m-1\">\n            <SelectValue placeholder=\"Select filter\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">{allItemsText}</SelectItem>\n            <SelectItem value=\"approved\">{approvedItemsText}</SelectItem>\n            <SelectItem value=\"unapproved\">{unapprovedItemsText}</SelectItem>\n            <SelectItem value=\"unknown\">{unknownItemsText}</SelectItem>\n          </SelectContent>\n        </Select>\n        <Select onValueChange={(value) => handleScopeChange(value)} defaultValue={scope}>\n          <SelectTrigger className=\"tw-m-1\">\n            <SelectValue placeholder=\"Select scope\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"book\">{scopeBookText}</SelectItem>\n            <SelectItem value=\"chapter\">{scopeChapterText}</SelectItem>\n            <SelectItem value=\"verse\">{scopeVerseText}</SelectItem>\n          </SelectContent>\n        </Select>\n        <Input\n          className=\"tw-m-1 tw-rounded-md tw-border\"\n          placeholder={filterText}\n          value={textFilter}\n          onChange={(event) => {\n            setTextFilter(event.target.value);\n          }}\n        />\n        {additionalItemsLabels && (\n          <div className=\"tw-m-1 tw-flex tw-items-center tw-rounded-md tw-border\">\n            <Checkbox\n              className=\"tw-m-1\"\n              checked={showAdditionalItems}\n              onCheckedChange={(checked: boolean) => {\n                setShowAdditionalItems(checked);\n              }}\n            />\n            <Label className=\"tw-m-1 tw-flex-shrink-0 tw-whitespace-nowrap\">\n              {additionalItemsLabels?.checkboxText ?? showAdditionalItemsText}\n            </Label>\n          </div>\n        )}\n      </div>\n      <div className=\"tw-m-1 tw-flex-1 tw-overflow-auto tw-rounded-md tw-border\">\n        <DataTable\n          columns={allColumns}\n          data={filteredTableData}\n          onRowClickHandler={rowClickHandler}\n          stickyHeader\n          isLoading={areInventoryItemsLoading}\n          noResultsMessage={noResultsText}\n        />\n      </div>\n      {occurrenceData.length > 0 && (\n        <div className=\"tw-m-1 tw-flex-1 tw-overflow-auto tw-rounded-md tw-border\">\n          <OccurrencesTable\n            classNameForText={classNameForVerseText}\n            occurrenceData={occurrenceData}\n            setScriptureReference={setVerseRef}\n            localizedStrings={localizedStrings}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Inventory;\n","import { useMemo, useState } from 'react';\nimport { Ban, LucideIcon } from 'lucide-react';\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n  CommandShortcut,\n} from '../shadcn-ui/command';\n\n/**\n * Object containing all keys used for localization in the FootnoteEditor component. If you're using\n * this component in an extension, you can pass it into the useLocalizedStrings hook to easily\n * obtain the localized strings and pass them into the localizedStrings prop of this component\n */\nexport const MARKER_MENU_STRING_KEYS = Object.freeze([\n  '%markerMenu_deprecated_label%',\n  '%markerMenu_disallowed_label%',\n  '%markerMenu_noResults%',\n  '%markerMenu_searchPlaceholder%',\n] as const);\n\nexport type MarkerMenuLocalizedStrings = {\n  [localizedKey in (typeof MARKER_MENU_STRING_KEYS)[number]]?: string;\n};\n\n/** Type for the markers that contain all necessary information to be displayed in the list */\nexport interface MarkerMenuItem {\n  /** If the item is a marker, then this is the marker code */\n  marker?: string;\n  /** The main title for the marker or command */\n  title: string;\n  /** An optional subtitle for the marker */\n  subtitle?: string;\n  /** Optional name of icon to use instead of the marker */\n  icon?: LucideIcon;\n  /** Whether the command/marker is deprecated */\n  isDeprecated?: boolean;\n  /** Whether the command/marker is disallowed for this project */\n  isDisallowed?: boolean;\n  /** Function to be triggered when the marker or command is selected */\n  action: () => void;\n}\n\n/** Props for the marker menu component */\nexport interface MarkerMenuProps {\n  /** Localized strings to pass through for the marker menu */\n  localizedStrings: MarkerMenuLocalizedStrings;\n  /**\n   * A list of the marker menu items which can either be a marker to insert or some basic command\n   * actions\n   */\n  markerMenuItems: MarkerMenuItem[];\n}\n\n/** Function to format the marker menu icon and size it accordingly */\nfunction MenuMarkerIcon({ icon, className }: { icon?: LucideIcon; className?: string }) {\n  const IconComponent = icon ?? Ban;\n  return <IconComponent className={className} size={16} />;\n}\n\n/** Marker menu component to render the list of markers and a few commands in the scripture editor */\nexport function MarkerMenu({ localizedStrings, markerMenuItems }: MarkerMenuProps) {\n  const [commandSearch, setCommandSearch] = useState<string>('');\n\n  const filteredMarkerItems = useMemo(() => {\n    const query = commandSearch.trim().toLowerCase();\n    if (!query) {\n      return markerMenuItems;\n    }\n\n    return markerMenuItems.filter(\n      (markerItem) =>\n        markerItem.marker?.toLowerCase().includes(query) ||\n        markerItem.title.toLowerCase().includes(query),\n    );\n  }, [commandSearch, markerMenuItems]);\n\n  return (\n    <Command className=\"tw-p-1\" shouldFilter={false} loop>\n      <CommandInput\n        value={commandSearch}\n        onValueChange={(value) => setCommandSearch(value)}\n        placeholder={localizedStrings['%markerMenu_searchPlaceholder%']}\n      />\n      <CommandList>\n        <CommandEmpty>{localizedStrings['%markerMenu_noResults%']}</CommandEmpty>\n        <CommandGroup>\n          {filteredMarkerItems.map((item) => (\n            <CommandItem\n              className=\"tw-flex tw-gap-2 hover:tw-bg-accent\"\n              disabled={item.isDisallowed || item.isDeprecated}\n              onSelect={item.action}\n              key={`item-${item.marker ?? item.icon?.name}-${item.title.replaceAll(' ', '')}`}\n            >\n              <div className=\"tw-w-6\">\n                {item.marker ? (\n                  <span className=\"tw-text-xs\">{item.marker}</span>\n                ) : (\n                  <div>\n                    <MenuMarkerIcon icon={item.icon} />\n                  </div>\n                )}\n              </div>\n              <div>\n                <p className=\"tw-text-sm\">{item.title}</p>\n                {item.subtitle && (\n                  <p className=\"tw-text-xs tw-text-muted-foreground\">{item.subtitle}</p>\n                )}\n              </div>\n              {(item.isDisallowed || item.isDeprecated) && (\n                <CommandShortcut className=\"tw-font-sans\">\n                  {item.isDisallowed\n                    ? localizedStrings['%markerMenu_disallowed_label%']\n                    : localizedStrings['%markerMenu_deprecated_label%']}\n                </CommandShortcut>\n              )}\n            </CommandItem>\n          ))}\n        </CommandGroup>\n      </CommandList>\n    </Command>\n  );\n}\n","import React from 'react';\nimport { Slot } from '@radix-ui/react-slot';\nimport { VariantProps, cva } from 'class-variance-authority';\nimport { PanelLeft, PanelRight } from 'lucide-react';\n\nimport { Button } from '@/components/shadcn-ui/button';\nimport { Input } from '@/components/shadcn-ui/input';\nimport { Separator } from '@/components/shadcn-ui/separator';\nimport { Skeleton } from '@/components/shadcn-ui/skeleton';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/shadcn-ui/tooltip';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\n\n/**\n * CUSTOM: Changes from the original code from Shadcn- Removed uses of useIsMobile, Sheet, and\n * SheetContent. Also removed the parts setting COOKIES.\n */\n\nconst SIDEBAR_WIDTH = '16rem';\nconst SIDEBAR_WIDTH_ICON = '3rem';\n// CUSTOM: Commented this out pending a discussion with UX about keyboard shortcuts\n// const SIDEBAR_KEYBOARD_SHORTCUT = 'b';\n\ntype Side = 'primary' | 'secondary';\n\ntype SidebarContextProps = {\n  state: 'expanded' | 'collapsed';\n  open: boolean;\n  setOpen: (open: boolean) => void;\n  toggleSidebar: () => void;\n  // CUSTOM: this was moved from Sidebar to SidebarProvider to also be able to flip the icon based on the side\n  side: Side;\n};\n\nconst SidebarContext = React.createContext<SidebarContextProps | undefined>(undefined);\n\n/** @inheritdoc SidebarProvider */\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext);\n  if (!context) {\n    throw new Error('useSidebar must be used within a SidebarProvider.');\n  }\n\n  return context;\n}\n\n/**\n * Sidebar components providing an accessible sidebar along with all the sub components that can be\n * used to populate and style it. These components are adapted from Shadcn UI. See Shadcn UI\n * Documentation: https://ui.shadcn.com/docs/components/sidebar\n */\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<'div'> & {\n    /** Whether the sidebar is initially open. */\n    defaultOpen?: boolean;\n    /** Whether the sidebar is open. */\n    open?: boolean;\n    /** Callback fired when the open state changes. */\n    onOpenChange?: (open: boolean) => void;\n    /** The side of the sidebar. */\n    side?: Side;\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      side = 'primary',\n      ...props\n    },\n    ref,\n  ) => {\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    const [_open, _setOpen] = React.useState(defaultOpen);\n    const isOpen = openProp ?? _open;\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === 'function' ? value(isOpen) : value;\n        if (setOpenProp) {\n          setOpenProp(openState);\n        } else {\n          _setOpen(openState);\n        }\n      },\n      [setOpenProp, isOpen],\n    );\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return setOpen((open) => !open);\n    }, [setOpen]);\n\n    // CUSTOM: Commented this out pending a discussion with UX about keyboard shortcuts\n    // Adds a keyboard shortcut to toggle the sidebar.\n    // React.useEffect(() => {\n    //   const handleKeyDown = (event: KeyboardEvent) => {\n    //     if (event.key === SIDEBAR_KEYBOARD_SHORTCUT && (event.metaKey || event.ctrlKey)) {\n    //       event.preventDefault();\n    //       toggleSidebar();\n    //     }\n    //   };\n\n    //   window.addEventListener('keydown', handleKeyDown);\n    //   return () => window.removeEventListener('keydown', handleKeyDown);\n    // }, [toggleSidebar]);\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = isOpen ? 'expanded' : 'collapsed';\n\n    const dir: Direction = readDirection();\n    const oppositeSide: Side = side === 'primary' ? 'secondary' : 'primary';\n    const directionAwareSide = dir === 'ltr' ? side : oppositeSide;\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open: isOpen,\n        setOpen,\n        toggleSidebar,\n        side: directionAwareSide,\n      }),\n      [state, isOpen, setOpen, toggleSidebar, directionAwareSide],\n    );\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              // eslint-disable-next-line no-type-assertion/no-type-assertion\n              {\n                '--sidebar-width': SIDEBAR_WIDTH,\n                '--sidebar-width-icon': SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              // Removed tw-min-h-svh\n              'tw-group/sidebar-wrapper pr-twp tw-flex tw-w-full has-[[data-variant=inset]]:tw-bg-sidebar',\n              className,\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    );\n  },\n);\nSidebarProvider.displayName = 'SidebarProvider';\n\n/** @inheritdoc SidebarProvider */\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<'div'> & {\n    variant?: 'sidebar' | 'floating' | 'inset';\n    collapsible?: 'offcanvas' | 'icon' | 'none';\n  }\n>(({ variant = 'sidebar', collapsible = 'offcanvas', className, children, ...props }, ref) => {\n  const context = useSidebar();\n\n  if (collapsible === 'none') {\n    return (\n      <div\n        className={cn(\n          'tw-flex tw-h-full tw-w-[--sidebar-width] tw-flex-col tw-bg-sidebar tw-text-sidebar-foreground',\n          className,\n        )}\n        ref={ref}\n        {...props}\n      >\n        {children}\n      </div>\n    );\n  }\n\n  return (\n    <div\n      ref={ref}\n      className=\"tw-group tw-peer tw-hidden tw-text-sidebar-foreground md:tw-block\"\n      data-state={context.state}\n      data-collapsible={context.state === 'collapsed' ? collapsible : ''}\n      data-variant={variant}\n      data-side={context.side}\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        className={cn(\n          'tw-relative tw-h-svh tw-w-[--sidebar-width] tw-bg-transparent tw-transition-[width] tw-duration-200 tw-ease-linear',\n          'group-data-[collapsible=offcanvas]:tw-w-0',\n          'group-data-[side=secondary]:tw-rotate-180',\n          variant === 'floating' || variant === 'inset'\n            ? 'group-data-[collapsible=icon]:tw-w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]'\n            : 'group-data-[collapsible=icon]:tw-w-[--sidebar-width-icon]',\n        )}\n      />\n      <div\n        className={cn(\n          // CUSTOM: Switched tw-fixed to tw-absolute here to scope the sidebar inside of it's container\n          'tw-absolute tw-inset-y-0 tw-z-10 tw-hidden tw-h-svh tw-w-[--sidebar-width] tw-transition-[left,right,width] tw-duration-200 tw-ease-linear md:tw-flex',\n          context.side === 'primary'\n            ? 'tw-left-0 group-data-[collapsible=offcanvas]:tw-left-[calc(var(--sidebar-width)*-1)]'\n            : 'tw-right-0 group-data-[collapsible=offcanvas]:tw-right-[calc(var(--sidebar-width)*-1)]',\n          // Adjust the padding for floating and inset variants.\n          variant === 'floating' || variant === 'inset'\n            ? 'tw-p-2 group-data-[collapsible=icon]:tw-w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]'\n            : 'group-data-[collapsible=icon]:tw-w-[--sidebar-width-icon] group-data-[side=primary]:tw-border-r group-data-[side=secondary]:tw-border-l',\n          className,\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          className=\"tw-flex tw-h-full tw-w-full tw-flex-col tw-bg-sidebar group-data-[variant=floating]:tw-rounded-lg group-data-[variant=floating]:tw-border group-data-[variant=floating]:tw-border-sidebar-border group-data-[variant=floating]:tw-shadow\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  );\n});\nSidebar.displayName = 'Sidebar';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const context = useSidebar();\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn('tw-h-7 tw-w-7', className)}\n      onClick={(event) => {\n        onClick?.(event);\n        context.toggleSidebar();\n      }}\n      {...props}\n    >\n      {context.side === 'primary' ? <PanelLeft /> : <PanelRight />}\n      <span className=\"tw-sr-only\">Toggle Sidebar</span>\n    </Button>\n  );\n});\nSidebarTrigger.displayName = 'SidebarTrigger';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarRail = React.forwardRef<HTMLButtonElement, React.ComponentProps<'button'>>(\n  ({ className, ...props }, ref) => {\n    const { toggleSidebar } = useSidebar();\n\n    return (\n      <button\n        type=\"button\"\n        ref={ref}\n        data-sidebar=\"rail\"\n        aria-label=\"Toggle Sidebar\"\n        tabIndex={-1}\n        onClick={toggleSidebar}\n        title=\"Toggle Sidebar\"\n        className={cn(\n          'tw-absolute tw-inset-y-0 tw-z-20 tw-hidden tw-w-4 tw--translate-x-1/2 tw-transition-all tw-ease-linear after:tw-absolute after:tw-inset-y-0 after:tw-left-1/2 after:tw-w-[2px] hover:after:tw-bg-sidebar-border group-data-[side=primary]:tw--right-4 group-data-[side=secondary]:tw-left-0 sm:tw-flex',\n          '[[data-side=secondary]_&]:tw-cursor-e-resize [[data-side=secondary]_&]:tw-cursor-w-resize',\n          '[[data-side=primary][data-state=collapsed]_&]:tw-cursor-e-resize [[data-side=secondary][data-state=collapsed]_&]:tw-cursor-w-resize',\n          'group-data-[collapsible=offcanvas]:tw-translate-x-0 group-data-[collapsible=offcanvas]:after:tw-left-full group-data-[collapsible=offcanvas]:hover:tw-bg-sidebar',\n          '[[data-side=primary][data-collapsible=offcanvas]_&]:tw--right-2',\n          '[[data-side=secondary][data-collapsible=offcanvas]_&]:tw--left-2',\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarRail.displayName = 'SidebarRail';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarInset = React.forwardRef<HTMLDivElement, React.ComponentProps<'main'>>(\n  ({ className, ...props }, ref) => {\n    return (\n      <main\n        ref={ref}\n        className={cn(\n          // CUSTOM: Removed tw-min-h-svh\n          'tw-relative tw-flex tw-flex-1 tw-flex-col tw-bg-background',\n          'peer-data-[variant=inset]:tw-min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:tw-m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:tw-ml-2 md:peer-data-[variant=inset]:tw-ml-0 md:peer-data-[variant=inset]:tw-rounded-xl md:peer-data-[variant=inset]:tw-shadow',\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarInset.displayName = 'SidebarInset';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        'tw-h-8 tw-w-full tw-bg-background tw-shadow-none focus-visible:tw-ring-2 focus-visible:tw-ring-sidebar-ring',\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarInput.displayName = 'SidebarInput';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarHeader = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(\n  ({ className, ...props }, ref) => {\n    return (\n      <div\n        ref={ref}\n        data-sidebar=\"header\"\n        className={cn('tw-flex tw-flex-col tw-gap-2 tw-p-2', className)}\n        {...props}\n      />\n    );\n  },\n);\nSidebarHeader.displayName = 'SidebarHeader';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarFooter = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(\n  ({ className, ...props }, ref) => {\n    return (\n      <div\n        ref={ref}\n        data-sidebar=\"footer\"\n        className={cn('tw-flex tw-flex-col tw-gap-2 tw-p-2', className)}\n        {...props}\n      />\n    );\n  },\n);\nSidebarFooter.displayName = 'SidebarFooter';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn('tw-mx-2 tw-w-auto tw-bg-sidebar-border', className)}\n      {...props}\n    />\n  );\n});\nSidebarSeparator.displayName = 'SidebarSeparator';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarContent = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(\n  ({ className, ...props }, ref) => {\n    return (\n      <div\n        ref={ref}\n        data-sidebar=\"content\"\n        className={cn(\n          'tw-flex tw-min-h-0 tw-flex-1 tw-flex-col tw-gap-2 tw-overflow-auto group-data-[collapsible=icon]:tw-overflow-hidden',\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarContent.displayName = 'SidebarContent';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarGroup = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(\n  ({ className, ...props }, ref) => {\n    return (\n      <div\n        ref={ref}\n        data-sidebar=\"group\"\n        className={cn('tw-relative tw-flex tw-w-full tw-min-w-0 tw-flex-col tw-p-2', className)}\n        {...props}\n      />\n    );\n  },\n);\nSidebarGroup.displayName = 'SidebarGroup';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<'div'> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : 'div';\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        'tw-flex tw-h-8 tw-shrink-0 tw-items-center tw-rounded-md tw-px-2 tw-text-xs tw-font-medium tw-text-sidebar-foreground/70 tw-outline-none tw-ring-sidebar-ring tw-transition-[margin,opa] tw-duration-200 tw-ease-linear focus-visible:tw-ring-2 [&>svg]:tw-size-4 [&>svg]:tw-shrink-0',\n        'group-data-[collapsible=icon]:tw--mt-8 group-data-[collapsible=icon]:tw-opacity-0',\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarGroupLabel.displayName = 'SidebarGroupLabel';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<'button'> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : 'button';\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        'tw-absolute tw-right-3 tw-top-3.5 tw-flex tw-aspect-square tw-w-5 tw-items-center tw-justify-center tw-rounded-md tw-p-0 tw-text-sidebar-foreground tw-outline-none tw-ring-sidebar-ring tw-transition-transform hover:tw-bg-sidebar-accent hover:tw-text-sidebar-accent-foreground focus-visible:tw-ring-2 [&>svg]:tw-size-4 [&>svg]:tw-shrink-0',\n        // Increases the hit area of the button on mobile.\n        'after:tw-absolute after:tw--inset-2 after:md:tw-hidden',\n        'group-data-[collapsible=icon]:tw-hidden',\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarGroupAction.displayName = 'SidebarGroupAction';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarGroupContent = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(\n  ({ className, ...props }, ref) => (\n    <div\n      ref={ref}\n      data-sidebar=\"group-content\"\n      className={cn('tw-w-full tw-text-sm', className)}\n      {...props}\n    />\n  ),\n);\nSidebarGroupContent.displayName = 'SidebarGroupContent';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarMenu = React.forwardRef<HTMLUListElement, React.ComponentProps<'ul'>>(\n  ({ className, ...props }, ref) => (\n    <ul\n      ref={ref}\n      data-sidebar=\"menu\"\n      className={cn('tw-flex tw-w-full tw-min-w-0 tw-flex-col tw-gap-1', className)}\n      {...props}\n    />\n  ),\n);\nSidebarMenu.displayName = 'SidebarMenu';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarMenuItem = React.forwardRef<HTMLLIElement, React.ComponentProps<'li'>>(\n  ({ className, ...props }, ref) => (\n    <li\n      ref={ref}\n      data-sidebar=\"menu-item\"\n      className={cn('tw-group/menu-item tw-relative', className)}\n      {...props}\n    />\n  ),\n);\nSidebarMenuItem.displayName = 'SidebarMenuItem';\n\nconst sidebarMenuButtonVariants = cva(\n  'tw-peer/menu-button tw-flex tw-w-full tw-items-center tw-gap-2 tw-overflow-hidden tw-rounded-md tw-p-2 tw-text-left tw-text-sm tw-outline-none tw-ring-sidebar-ring tw-transition-[width,height,padding] hover:tw-bg-sidebar-accent hover:tw-text-sidebar-accent-foreground focus-visible:tw-ring-2 active:tw-bg-sidebar-accent active:tw-text-sidebar-accent-foreground disabled:tw-pointer-events-none disabled:tw-opacity-50 tw-group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:tw-pointer-events-none aria-disabled:tw-opacity-50 data-[active=true]:tw-font-medium data-[active=true]:tw-text-sidebar-accent-foreground data-[active=true]:tw-bg-sidebar-accent data-[state=open]:hover:tw-bg-sidebar-accent data-[state=open]:hover:tw-text-sidebar-accent-foreground group-data-[collapsible=icon]:tw-!size-8 group-data-[collapsible=icon]:tw-!p-2 [&>span:last-child]:tw-truncate [&>svg]:tw-size-4 [&>svg]:tw-shrink-0',\n  {\n    variants: {\n      variant: {\n        default: 'hover:tw-bg-sidebar-accent hover:tw-text-sidebar-accent-foreground',\n        outline:\n          'tw-bg-background tw-shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:tw-bg-sidebar-accent hover:tw-text-sidebar-accent-foreground hover:tw-shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]',\n      },\n      size: {\n        default: 'tw-h-8 tw-text-sm',\n        sm: 'tw-h-7 tw-text-xs',\n        lg: 'tw-h-12 tw-text-sm group-data-[collapsible=icon]:tw-!p-0',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n);\n\n/** @inheritdoc SidebarProvider */\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<'button'> & {\n    asChild?: boolean;\n    isActive?: boolean;\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>;\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = 'default',\n      size = 'default',\n      tooltip,\n      className,\n      ...props\n    },\n    ref,\n  ) => {\n    const Comp = asChild ? Slot : 'button';\n    const { state } = useSidebar();\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    );\n\n    if (!tooltip) {\n      return button;\n    }\n\n    if (typeof tooltip === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      tooltip = {\n        children: tooltip,\n      };\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent side=\"right\" align=\"center\" hidden={state !== 'collapsed'} {...tooltip} />\n      </Tooltip>\n    );\n  },\n);\nSidebarMenuButton.displayName = 'SidebarMenuButton';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<'button'> & {\n    asChild?: boolean;\n    showOnHover?: boolean;\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : 'button';\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        'tw-peer-hover/menu-button:text-sidebar-accent-foreground tw-absolute tw-right-1 tw-top-1.5 tw-flex tw-aspect-square tw-w-5 tw-items-center tw-justify-center tw-rounded-md tw-p-0 tw-text-sidebar-foreground tw-outline-none tw-ring-sidebar-ring tw-transition-transform hover:tw-bg-sidebar-accent hover:tw-text-sidebar-accent-foreground focus-visible:tw-ring-2 [&>svg]:tw-size-4 [&>svg]:tw-shrink-0',\n        // Increases the hit area of the button on mobile.\n        'after:tw-absolute after:tw--inset-2 after:md:tw-hidden',\n        'tw-peer-data-[size=sm]/menu-button:top-1',\n        'tw-peer-data-[size=default]/menu-button:top-1.5',\n        'tw-peer-data-[size=lg]/menu-button:top-2.5',\n        'group-data-[collapsible=icon]:tw-hidden',\n        showOnHover &&\n          'tw-group-focus-within/menu-item:opacity-100 tw-group-hover/menu-item:opacity-100 tw-peer-data-[active=true]/menu-button:text-sidebar-accent-foreground data-[state=open]:tw-opacity-100 md:tw-opacity-0',\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarMenuAction.displayName = 'SidebarMenuAction';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarMenuBadge = React.forwardRef<HTMLDivElement, React.ComponentProps<'div'>>(\n  ({ className, ...props }, ref) => (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        'tw-pointer-events-none tw-absolute tw-right-1 tw-flex tw-h-5 tw-min-w-5 tw-select-none tw-items-center tw-justify-center tw-rounded-md tw-px-1 tw-text-xs tw-font-medium tw-tabular-nums tw-text-sidebar-foreground',\n        'tw-peer-hover/menu-button:text-sidebar-accent-foreground tw-peer-data-[active=true]/menu-button:text-sidebar-accent-foreground',\n        'tw-peer-data-[size=sm]/menu-button:top-1',\n        'tw-peer-data-[size=default]/menu-button:top-1.5',\n        'tw-peer-data-[size=lg]/menu-button:top-2.5',\n        'group-data-[collapsible=icon]:tw-hidden',\n        className,\n      )}\n      {...props}\n    />\n  ),\n);\nSidebarMenuBadge.displayName = 'SidebarMenuBadge';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<'div'> & {\n    showIcon?: boolean;\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`;\n  }, []);\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn('tw-flex tw-h-8 tw-items-center tw-gap-2 tw-rounded-md tw-px-2', className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton className=\"tw-size-4 tw-rounded-md\" data-sidebar=\"menu-skeleton-icon\" />\n      )}\n      <Skeleton\n        className=\"tw-h-4 tw-max-w-[--skeleton-width] tw-flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          // eslint-disable-next-line no-type-assertion/no-type-assertion\n          {\n            '--skeleton-width': width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  );\n});\nSidebarMenuSkeleton.displayName = 'SidebarMenuSkeleton';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarMenuSub = React.forwardRef<HTMLUListElement, React.ComponentProps<'ul'>>(\n  ({ className, ...props }, ref) => (\n    <ul\n      ref={ref}\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        'tw-mx-3.5 tw-flex tw-min-w-0 tw-translate-x-px tw-flex-col tw-gap-1 tw-border-l tw-border-sidebar-border tw-px-2.5 tw-py-0.5',\n        'group-data-[collapsible=icon]:tw-hidden',\n        className,\n      )}\n      {...props}\n    />\n  ),\n);\nSidebarMenuSub.displayName = 'SidebarMenuSub';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarMenuSubItem = React.forwardRef<HTMLLIElement, React.ComponentProps<'li'>>(\n  ({ ...props }, ref) => <li ref={ref} {...props} />,\n);\nSidebarMenuSubItem.displayName = 'SidebarMenuSubItem';\n\n/** @inheritdoc SidebarProvider */\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<'a'> & {\n    asChild?: boolean;\n    size?: 'sm' | 'md';\n    isActive?: boolean;\n  }\n>(({ asChild = false, size = 'md', isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : 'a';\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        'tw-flex tw-h-7 tw-min-w-0 tw--translate-x-px tw-items-center tw-gap-2 tw-overflow-hidden tw-rounded-md tw-px-2 tw-text-sidebar-foreground tw-outline-none tw-ring-sidebar-ring hover:tw-bg-sidebar-accent hover:tw-text-sidebar-accent-foreground focus-visible:tw-ring-2 active:tw-bg-sidebar-accent active:tw-text-sidebar-accent-foreground disabled:tw-pointer-events-none disabled:tw-opacity-50 aria-disabled:tw-pointer-events-none aria-disabled:tw-opacity-50 [&>span:last-child]:tw-truncate [&>svg]:tw-size-4 [&>svg]:tw-shrink-0 [&>svg]:tw-text-sidebar-accent-foreground',\n        'data-[active=true]:tw-bg-sidebar-accent data-[active=true]:tw-text-sidebar-accent-foreground',\n        size === 'sm' && 'tw-text-xs',\n        size === 'md' && 'tw-text-sm',\n        'group-data-[collapsible=icon]:tw-hidden',\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarMenuSubButton.displayName = 'SidebarMenuSubButton';\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n};\n","import { ComboBox } from '@/components/basics/combo-box.component';\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupLabel,\n  SidebarGroupContent,\n  SidebarMenu,\n  SidebarMenuItem,\n  SidebarMenuButton,\n} from '@/components/shadcn-ui/sidebar';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { ScrollText } from 'lucide-react';\nimport { useCallback } from 'react';\n\nexport type SelectedSettingsSidebarItem = {\n  label: string;\n  projectId?: string;\n};\n\nexport type ProjectInfo = { projectId: string; projectName: string };\n\nexport type SettingsSidebarProps = {\n  /** Optional id for testing */\n  id?: string;\n\n  /** Extension labels from contribution */\n  extensionLabels: Record<string, string>;\n\n  /** Project names and ids */\n  projectInfo: ProjectInfo[];\n\n  /** Handler for selecting a sidebar item */\n  handleSelectSidebarItem: (key: string, projectId?: string) => void;\n\n  /** The current selected value in the sidebar */\n  selectedSidebarItem: SelectedSettingsSidebarItem;\n\n  /** Label for the group of extensions setting groups */\n  extensionsSidebarGroupLabel: string;\n\n  /** Label for the group of projects settings */\n  projectsSidebarGroupLabel: string;\n\n  /** Placeholder text for the button */\n  buttonPlaceholderText: string;\n\n  /** Additional css classes to help with unique styling of the sidebar */\n  className?: string;\n};\n\n/**\n * The SettingsSidebar component is a sidebar that displays a list of extension settings and project\n * settings. It can be used to navigate to different settings pages. Must be wrapped in a\n * SidebarProvider component otherwise produces errors.\n *\n * @param props - {@link SettingsSidebarProps} The props for the component.\n */\nexport function SettingsSidebar({\n  id,\n  extensionLabels,\n  projectInfo,\n  handleSelectSidebarItem,\n  selectedSidebarItem,\n  extensionsSidebarGroupLabel,\n  projectsSidebarGroupLabel,\n  buttonPlaceholderText,\n  className,\n}: SettingsSidebarProps) {\n  const handleSelectItem = useCallback(\n    (item: string, projectId?: string) => {\n      handleSelectSidebarItem(item, projectId);\n    },\n    [handleSelectSidebarItem],\n  );\n\n  const getProjectNameFromProjectId = useCallback(\n    (projectId: string) => {\n      const project = projectInfo.find((info) => info.projectId === projectId);\n      return project ? project.projectName : projectId;\n    },\n    [projectInfo],\n  );\n\n  const getIsActive: (label: string) => boolean = useCallback(\n    (label: string) => !selectedSidebarItem.projectId && label === selectedSidebarItem.label,\n    [selectedSidebarItem],\n  );\n\n  return (\n    <Sidebar\n      id={id}\n      collapsible=\"none\"\n      variant=\"inset\"\n      className={cn('tw-w-96 tw-gap-2 tw-overflow-y-auto', className)}\n    >\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"tw-text-sm\">\n            {extensionsSidebarGroupLabel}\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {Object.entries(extensionLabels).map(([key, label]) => (\n                <SidebarMenuItem key={key}>\n                  <SidebarMenuButton\n                    onClick={() => handleSelectItem(key)}\n                    isActive={getIsActive(key)}\n                  >\n                    <span className=\"tw-pl-3\">{label}</span>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"tw-text-sm\">{projectsSidebarGroupLabel}</SidebarGroupLabel>\n          <SidebarGroupContent className=\"tw-pl-3\">\n            <ComboBox\n              buttonVariant=\"ghost\"\n              buttonClassName={cn('tw-w-full', {\n                'tw-bg-sidebar-accent tw-text-sidebar-accent-foreground':\n                  selectedSidebarItem?.projectId,\n              })}\n              popoverContentClassName=\"tw-z-[1000]\"\n              options={projectInfo.flatMap((info) => info.projectId)}\n              getOptionLabel={getProjectNameFromProjectId}\n              buttonPlaceholder={buttonPlaceholderText}\n              onChange={(projectId: string) => {\n                const selectedProjectName = getProjectNameFromProjectId(projectId);\n                handleSelectItem(selectedProjectName, projectId);\n              }}\n              value={selectedSidebarItem?.projectId ?? undefined}\n              icon={<ScrollText />}\n            />\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n    </Sidebar>\n  );\n}\n\nexport default SettingsSidebar;\n","import { Button } from '@/components/shadcn-ui/button';\nimport { Input } from '@/components/shadcn-ui/input';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Search, X } from 'lucide-react';\nimport { forwardRef } from 'react';\n\n/** Props for the SearchBar component. */\nexport type SearchBarProps = {\n  /** Search query for the search bar */\n  value: string;\n  /**\n   * Callback fired to handle the search query is updated\n   *\n   * @param searchQuery\n   */\n  onSearch: (searchQuery: string) => void;\n\n  /** Optional string that appears in the search bar without a search string */\n  placeholder?: string;\n\n  /** Optional boolean to set the input base to full width */\n  isFullWidth?: boolean;\n\n  /** Additional css classes to help with unique styling of the search bar */\n  className?: string;\n\n  /** Optional boolean to disable the search bar */\n  isDisabled?: boolean;\n\n  /** Optional id for the root element */\n  id?: string;\n};\n\n/**\n * A search bar component with a search icon and a clear button when the search query is not empty.\n *\n * @param {SearchBarProps} props - The props for the component.\n * @param {string} props.value - The search query for the search bar\n * @param {(searchQuery: string) => void} props.onSearch - Callback fired to handle the search query\n *   is updated\n * @param {string} [props.placeholder] - Optional string that appears in the search bar without a\n *   search string\n * @param {boolean} [props.isFullWidth] - Optional boolean to set the input base to full width\n * @param {string} [props.className] - Additional css classes to help with unique styling of the\n *   search bar\n * @param {boolean} [props.isDisabled] - Optional boolean to disable the search bar\n * @param {string} [props.id] - Optional id for the root element\n */\nexport const SearchBar = forwardRef<HTMLInputElement, SearchBarProps>(\n  ({ value, onSearch, placeholder, isFullWidth, className, isDisabled = false, id }, inputRef) => {\n    const dir: Direction = readDirection();\n\n    return (\n      <div id={id} className={cn('tw-relative', { 'tw-w-full': isFullWidth }, className)}>\n        <Search\n          className={cn(\n            'tw-absolute tw-top-1/2 tw-h-4 tw-w-4 tw--translate-y-1/2 tw-transform tw-opacity-50',\n            { 'tw-right-3': dir === 'rtl' },\n            { 'tw-left-3': dir === 'ltr' },\n          )}\n        />\n        <Input\n          ref={inputRef}\n          className=\"tw-w-full tw-text-ellipsis tw-pe-9 tw-ps-9\"\n          placeholder={placeholder}\n          value={value}\n          onChange={(e) => onSearch(e.target.value)}\n          disabled={isDisabled}\n        />\n        {value && (\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className={cn(\n              'tw-absolute tw-top-1/2 tw-h-7 tw--translate-y-1/2 tw-transform hover:tw-bg-transparent',\n              { 'tw-left-0': dir === 'rtl' },\n              { 'tw-right-0': dir === 'ltr' },\n            )}\n            onClick={() => {\n              onSearch('');\n            }}\n          >\n            <X className=\"tw-h-4 tw-w-4\" />\n            <span className=\"tw-sr-only\">Clear</span>\n          </Button>\n        )}\n      </div>\n    );\n  },\n);\n\nSearchBar.displayName = 'SearchBar';\n\nexport default SearchBar;\n","import { SidebarInset, SidebarProvider } from '@/components/shadcn-ui/sidebar';\nimport { PropsWithChildren } from 'react';\nimport { SearchBar } from '@/components/basics/search-bar.component';\nimport { SettingsSidebar, SettingsSidebarProps } from './settings-sidebar.component';\n\nexport type SettingsSidebarContentSearchProps = SettingsSidebarProps &\n  PropsWithChildren & {\n    /** The search query in the search bar */\n    searchValue: string;\n\n    /** Handler to run when the value of the search bar changes */\n    onSearch: (searchQuery: string) => void;\n  };\n\n/**\n * A component that wraps a search bar and a settings sidebar, providing a way to search and\n * navigate to different settings pages.\n *\n * @param {SettingsSidebarContentSearchProps} props - The props for the component.\n * @param {string} props.id - The id of the sidebar.\n */\nexport function SettingsSidebarContentSearch({\n  id,\n  extensionLabels,\n  projectInfo,\n  children,\n  handleSelectSidebarItem,\n  selectedSidebarItem,\n  searchValue,\n  onSearch,\n  extensionsSidebarGroupLabel,\n  projectsSidebarGroupLabel,\n  buttonPlaceholderText,\n}: SettingsSidebarContentSearchProps) {\n  return (\n    <div className=\"tw-box-border tw-flex tw-h-full tw-flex-col\">\n      <div className=\"tw-box-border tw-flex tw-items-center tw-justify-center tw-py-4\">\n        <SearchBar\n          className=\"tw-w-9/12\"\n          value={searchValue}\n          onSearch={onSearch}\n          placeholder=\"Search app settings, extension settings, and project settings\"\n        />\n      </div>\n      <SidebarProvider\n        id={id}\n        className=\"tw-h-full tw-flex-1 tw-gap-4 tw-overflow-auto tw-border-t\"\n      >\n        <SettingsSidebar\n          className=\"tw-w-1/2 tw-min-w-[140px] tw-max-w-[220px] tw-border-e\"\n          extensionLabels={extensionLabels}\n          projectInfo={projectInfo}\n          handleSelectSidebarItem={handleSelectSidebarItem}\n          selectedSidebarItem={selectedSidebarItem}\n          extensionsSidebarGroupLabel={extensionsSidebarGroupLabel}\n          projectsSidebarGroupLabel={projectsSidebarGroupLabel}\n          buttonPlaceholderText={buttonPlaceholderText}\n        />\n        <SidebarInset className=\"tw-min-w-[215px]\">{children}</SidebarInset>\n      </SidebarProvider>\n    </div>\n  );\n}\n\nexport default SettingsSidebarContentSearch;\n","import { Button } from '@/components/shadcn-ui/button';\nimport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/shadcn-ui/select';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/shadcn-ui/table';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Canon } from '@sillsdev/scripture';\nimport {\n  Cell,\n  ColumnDef,\n  flexRender,\n  getCoreRowModel,\n  getExpandedRowModel,\n  getGroupedRowModel,\n  getSortedRowModel,\n  GroupingState,\n  Row,\n  RowSelectionState,\n  SortingState,\n  useReactTable,\n} from '@tanstack/react-table';\nimport '@/components/advanced/scripture-results-viewer/scripture-results-viewer.component.css';\nimport {\n  compareScrRefs,\n  formatScrRef,\n  ScriptureSelection,\n  scrRefToBBBCCCVVV,\n} from 'platform-bible-utils';\nimport { MouseEvent, useEffect, useMemo, useState } from 'react';\nimport { ChevronDown, ChevronLeft, ChevronRight } from 'lucide-react';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\n\n/**\n * Information (e.g., a checking error or some other type of \"transient\" annotation) about something\n * noteworthy at a specific place in an instance of the Scriptures.\n */\nexport type ScriptureItemDetail = ScriptureSelection & {\n  /**\n   * Text of the error, note, etc. In the future, we might want to support something more than just\n   * text so that a JSX element could be provided with a link or some other controls related to the\n   * issue being reported.\n   */\n  detail: string;\n};\n\n/**\n * A uniquely identifiable source of results that can be displayed in the ScriptureResultsViewer.\n * Generally, the source will be a particular Scripture check, but there may be other types of\n * sources.\n */\nexport type ResultsSource = {\n  /**\n   * Uniquely identifies the source.\n   *\n   * @type {string}\n   */\n  id: string;\n\n  /**\n   * Name (potentially localized) of the source, suitable for display in the UI.\n   *\n   * @type {string}\n   */\n  displayName: string;\n};\n\nexport type ScriptureSrcItemDetail = ScriptureItemDetail & {\n  /** Source/type of detail. Can be used for grouping. */\n  source: ResultsSource;\n};\n\n/**\n * Represents a set of results keyed by Scripture reference. Generally, the source will be a\n * particular Scripture check, but this type also allows for other types of uniquely identifiable\n * sources.\n */\nexport type ResultsSet = {\n  /**\n   * The backing source associated with this set of results.\n   *\n   * @type {ResultsSource}\n   */\n  source: ResultsSource;\n\n  /**\n   * Array of Scripture item details (messages keyed by Scripture reference).\n   *\n   * @type {ScriptureItemDetail[]}\n   */\n  data: ScriptureItemDetail[];\n};\n\nconst scrBookColId = 'scrBook';\nconst scrRefColId = 'scrRef';\nconst typeColId = 'source';\nconst detailsColId = 'details';\n\nconst defaultScrRefColumnName = 'Scripture Reference';\nconst defaultScrBookGroupName = 'Scripture Book';\nconst defaultTypeColumnName = 'Type';\nconst defaultDetailsColumnName = 'Details';\n\nexport type ScriptureResultsViewerColumnInfo = {\n  /** Optional header to display for the Reference column. Default value: 'Scripture Reference'. */\n  scriptureReferenceColumnName?: string;\n\n  /** Optional text to display to refer to the Scripture book group. Default value: 'Scripture Book'. */\n  scriptureBookGroupName?: string;\n\n  /** Optional header to display for the Type column. Default value: 'Type'. */\n  typeColumnName?: string;\n\n  /** Optional header to display for the Details column. Default value: 'Details' */\n  detailsColumnName?: string;\n};\n\nexport type ScriptureResultsViewerProps = ScriptureResultsViewerColumnInfo & {\n  /** Groups of ScriptureItemDetail objects from particular sources (e.g., Scripture checks) */\n  sources: ResultsSet[];\n\n  /** Flag indicating whether to display column headers. Default is false. */\n  showColumnHeaders?: boolean;\n\n  /** Flag indicating whether to display source column. Default is false. */\n  showSourceColumn?: boolean;\n\n  /** Callback function to notify when a row is selected */\n  onRowSelected?: (selectedRow: ScriptureSrcItemDetail | undefined) => void;\n\n  /** Optional id attribute for the outermost element */\n  id?: string;\n};\n\nfunction getColumns(\n  colInfo?: ScriptureResultsViewerColumnInfo,\n  showSourceColumn?: boolean,\n): ColumnDef<ScriptureSrcItemDetail>[] {\n  const showSrcCol = showSourceColumn ?? false;\n  return [\n    {\n      accessorFn: (row) => `${row.start.book} ${row.start.chapterNum}:${row.start.verseNum}`,\n      id: scrBookColId,\n      header: colInfo?.scriptureReferenceColumnName ?? defaultScrRefColumnName,\n      cell: (info) => {\n        const row = info.row.original;\n        if (info.row.getIsGrouped()) {\n          return Canon.bookIdToEnglishName(row.start.book);\n        }\n        return info.row.groupingColumnId === scrBookColId ? formatScrRef(row.start) : undefined;\n      },\n      getGroupingValue: (row) => Canon.bookIdToNumber(row.start.book),\n      sortingFn: (a, b) => {\n        return compareScrRefs(a.original.start, b.original.start);\n      },\n      enableGrouping: true,\n    },\n    {\n      accessorFn: (row) => formatScrRef(row.start),\n      id: scrRefColId,\n      header: undefined,\n      cell: (info) => {\n        const row = info.row.original;\n        return info.row.getIsGrouped() ? undefined : formatScrRef(row.start);\n      },\n      sortingFn: (a, b) => {\n        return compareScrRefs(a.original.start, b.original.start);\n      },\n      enableGrouping: false,\n    },\n    {\n      accessorFn: (row) => row.source.displayName,\n      id: typeColId,\n      header: showSrcCol ? (colInfo?.typeColumnName ?? defaultTypeColumnName) : undefined,\n      cell: (info) => (showSrcCol || info.row.getIsGrouped() ? info.getValue() : undefined),\n      getGroupingValue: (row) => row.source.id,\n      sortingFn: (a, b) =>\n        a.original.source.displayName.localeCompare(b.original.source.displayName),\n      enableGrouping: true,\n    },\n    {\n      accessorFn: (row) => row.detail,\n      id: detailsColId,\n      header: colInfo?.detailsColumnName ?? defaultDetailsColumnName,\n      cell: (info) => info.getValue(),\n      enableGrouping: false,\n    },\n  ];\n}\n\nconst toRefOrRange = (scriptureSelection: ScriptureSelection) => {\n  if (!('offset' in scriptureSelection.start))\n    throw new Error('No offset available in range start');\n  if (scriptureSelection.end && !('offset' in scriptureSelection.end))\n    throw new Error('No offset available in range end');\n  const { offset: offsetStart } = scriptureSelection.start;\n  let offsetEnd: number = 0;\n  if (scriptureSelection.end) ({ offset: offsetEnd } = scriptureSelection.end);\n  if (\n    !scriptureSelection.end ||\n    compareScrRefs(scriptureSelection.start, scriptureSelection.end) === 0\n  )\n    return `${scrRefToBBBCCCVVV(scriptureSelection.start)}+${offsetStart}`;\n  return `${scrRefToBBBCCCVVV(scriptureSelection.start)}+${offsetStart}-${scrRefToBBBCCCVVV(scriptureSelection.end)}+${offsetEnd}`;\n};\n\nconst getRowKey = (row: ScriptureSrcItemDetail) =>\n  `${toRefOrRange({ start: row.start, end: row.end })} ${row.source.displayName} ${row.detail}`;\n\n/**\n * Component to display a combined list of detailed items from one or more sources, where the items\n * are keyed primarily by Scripture reference. This is particularly useful for displaying a list of\n * results from Scripture checks, but more generally could be used to display any \"results\" from any\n * source(s). The component allows for grouping by Scripture book, source, or both. By default, it\n * displays somewhat \"tree-like\" which allows it to be more horizontally compact and intuitive. But\n * it also has the option of displaying as a traditional table with column headings (with or without\n * the source column showing).\n */\nexport function ScriptureResultsViewer({\n  sources,\n  showColumnHeaders = false,\n  showSourceColumn = false,\n  scriptureReferenceColumnName,\n  scriptureBookGroupName,\n  typeColumnName,\n  detailsColumnName,\n  onRowSelected,\n  id,\n}: ScriptureResultsViewerProps) {\n  const [grouping, setGrouping] = useState<GroupingState>([]);\n  const [sorting, setSorting] = useState<SortingState>([{ id: scrBookColId, desc: false }]);\n  const [rowSelection, setRowSelection] = useState<RowSelectionState>({});\n\n  const scriptureResults = useMemo(\n    () =>\n      sources.flatMap((source) => {\n        return source.data.map((item) => ({\n          ...item,\n          source: source.source,\n        }));\n      }),\n    [sources],\n  );\n\n  const columns = useMemo(\n    () =>\n      getColumns(\n        {\n          scriptureReferenceColumnName,\n          typeColumnName,\n          detailsColumnName,\n        },\n        showSourceColumn,\n      ),\n    [scriptureReferenceColumnName, typeColumnName, detailsColumnName, showSourceColumn],\n  );\n\n  useEffect(() => {\n    // Ensure sorting is applied correctly when grouped by type\n    if (grouping.includes(typeColId)) {\n      setSorting([\n        { id: typeColId, desc: false },\n        { id: scrBookColId, desc: false },\n      ]);\n    } else {\n      setSorting([{ id: scrBookColId, desc: false }]);\n    }\n  }, [grouping]);\n\n  const table = useReactTable({\n    data: scriptureResults,\n    columns,\n    state: {\n      grouping,\n      sorting,\n      rowSelection,\n    },\n    onGroupingChange: setGrouping,\n    onSortingChange: setSorting,\n    onRowSelectionChange: setRowSelection,\n    getExpandedRowModel: getExpandedRowModel(),\n    getGroupedRowModel: getGroupedRowModel(),\n    getCoreRowModel: getCoreRowModel(),\n    getSortedRowModel: getSortedRowModel(),\n    getRowId: getRowKey,\n    autoResetExpanded: false,\n    enableMultiRowSelection: false,\n    enableSubRowSelection: false,\n  });\n\n  useEffect(() => {\n    if (onRowSelected) {\n      const selectedRows = table.getSelectedRowModel().rowsById;\n      const keys = Object.keys(selectedRows);\n      if (keys.length === 1) {\n        const selectedRow = scriptureResults.find((row) => getRowKey(row) === keys[0]) || undefined;\n        if (selectedRow) onRowSelected(selectedRow);\n      }\n    }\n  }, [rowSelection, scriptureResults, onRowSelected, table]);\n\n  // Define possible grouping options\n  const scrBookGroupName = scriptureBookGroupName ?? defaultScrBookGroupName;\n  const typeGroupName = typeColumnName ?? defaultTypeColumnName;\n\n  const groupingOptions = [\n    { label: 'No Grouping', value: [] },\n    { label: `Group by ${scrBookGroupName}`, value: [scrBookColId] },\n    { label: `Group by ${typeGroupName}`, value: [typeColId] },\n    {\n      label: `Group by ${scrBookGroupName} and ${typeGroupName}`,\n      value: [scrBookColId, typeColId],\n    },\n    {\n      label: `Group by ${typeGroupName} and ${scrBookGroupName}`,\n      value: [typeColId, scrBookColId],\n    },\n  ];\n\n  const handleSelectChange = (selectedGrouping: string) => {\n    setGrouping(JSON.parse(selectedGrouping));\n  };\n\n  const handleRowClick = (row: Row<ScriptureSrcItemDetail>, event: MouseEvent) => {\n    if (!row.getIsGrouped() && !row.getIsSelected()) {\n      row.getToggleSelectedHandler()(event);\n    }\n  };\n\n  const getEvenOrOddBandingStyle = (row: Row<ScriptureSrcItemDetail>, index: number) => {\n    if (row.getIsGrouped()) return '';\n    // UX has now said they don't think they want banding. I'm leaving in the code to\n    // set even and odd styles, but there's nothing in the CSS to style them differently.\n    // The \"even\" style used to also have  tw-bg-neutral-300 (along with even) to create\n    // a visual banding effect. That could be added back in if UX changes the decision.\n    return cn('banded-row', index % 2 === 0 ? 'even' : 'odd');\n  };\n\n  const getIndent = (\n    groupingState: GroupingState,\n    row: Row<ScriptureSrcItemDetail>,\n    cell: Cell<ScriptureSrcItemDetail, unknown>,\n  ) => {\n    if (groupingState?.length === 0 || row.depth < cell.column.getGroupedIndex()) return undefined;\n    if (row.getIsGrouped()) {\n      switch (row.depth) {\n        case 1:\n          return 'tw-ps-4';\n        default:\n          return undefined;\n      }\n    }\n    switch (row.depth) {\n      case 1:\n        return 'tw-ps-8';\n      case 2:\n        return 'tw-ps-12';\n      default:\n        return undefined;\n    }\n  };\n\n  return (\n    <div id={id} className=\"pr-twp tw-flex tw-h-full tw-w-full tw-flex-col\">\n      {!showColumnHeaders && (\n        <Select\n          value={JSON.stringify(grouping)}\n          onValueChange={(value) => {\n            handleSelectChange(value);\n          }}\n        >\n          <SelectTrigger className=\"tw-mb-1 tw-mt-2\">\n            <SelectValue />\n          </SelectTrigger>\n          <SelectContent position=\"item-aligned\">\n            <SelectGroup>\n              {groupingOptions.map((option) => (\n                <SelectItem key={option.label} value={JSON.stringify(option.value)}>\n                  {option.label}\n                </SelectItem>\n              ))}\n            </SelectGroup>\n          </SelectContent>\n        </Select>\n      )}\n      <Table className=\"tw-relative tw-flex tw-flex-col tw-overflow-y-auto tw-p-0\">\n        {showColumnHeaders && (\n          <TableHeader>\n            {table.getHeaderGroups().map((headerGroup) => (\n              <TableRow key={headerGroup.id}>\n                {headerGroup.headers\n                  .filter((h) => h.column.columnDef.header)\n                  .map((header) => (\n                    /* For sticky column headers to work, we probably need to change the default definition of the shadcn Table component. See https://github.com/shadcn-ui/ui/issues/1151 */\n                    <TableHead key={header.id} colSpan={header.colSpan} className=\"top-0 tw-sticky\">\n                      {header.isPlaceholder ? undefined : (\n                        <div>\n                          {header.column.getCanGroup() ? (\n                            <Button\n                              variant=\"ghost\"\n                              title={`Toggle grouping by ${header.column.columnDef.header}`}\n                              onClick={header.column.getToggleGroupingHandler()}\n                              type=\"button\"\n                            >\n                              {header.column.getIsGrouped() ? `🛑` : `👊 `}\n                            </Button>\n                          ) : undefined}{' '}\n                          {flexRender(header.column.columnDef.header, header.getContext())}\n                        </div>\n                      )}\n                    </TableHead>\n                  ))}\n              </TableRow>\n            ))}\n          </TableHeader>\n        )}\n        <TableBody>\n          {table.getRowModel().rows.map((row, rowIndex) => {\n            const dir: Direction = readDirection();\n            return (\n              <TableRow\n                data-state={row.getIsSelected() ? 'selected' : ''}\n                key={row.id}\n                className={cn(getEvenOrOddBandingStyle(row, rowIndex))}\n                onClick={(event) => handleRowClick(row, event)}\n              >\n                {row.getVisibleCells().map((cell) => {\n                  if (\n                    cell.getIsPlaceholder() ||\n                    (cell.column.columnDef.enableGrouping &&\n                      !cell.getIsGrouped() &&\n                      (cell.column.columnDef.id !== typeColId || !showSourceColumn))\n                  )\n                    return undefined;\n                  return (\n                    <TableCell\n                      key={cell.id}\n                      // It seems like a hack to use tw-p-[1px] to override the \"built in\" tw-p-4\n                      // that comes in with the shadcn TableCell class. I could just remove it from\n                      // that class, but it's not clear that that is desirable. I'm not even 100%\n                      // sure I know what padding value to use here, but the problem with 4 (the\n                      // default) is that is prevents the nested indentation when grouping.\n                      className={cn(\n                        cell.column.columnDef.id,\n                        'tw-p-[1px]',\n                        getIndent(grouping, row, cell),\n                      )}\n                    >\n                      {(() => {\n                        if (cell.getIsGrouped()) {\n                          return (\n                            <Button\n                              variant=\"link\"\n                              onClick={row.getToggleExpandedHandler()}\n                              type=\"button\"\n                            >\n                              {row.getIsExpanded() && <ChevronDown />}\n                              {!row.getIsExpanded() &&\n                                (dir === 'ltr' ? <ChevronRight /> : <ChevronLeft />)}{' '}\n                              {flexRender(cell.column.columnDef.cell, cell.getContext())} (\n                              {row.subRows.length})\n                            </Button>\n                          );\n                        }\n\n                        // if (cell.getIsAggregated()) {\n                        //   flexRender(\n                        //     cell.column.columnDef.aggregatedCell ?? cell.column.columnDef.cell,\n                        //     cell.getContext(),\n                        //   );\n                        // }\n\n                        return flexRender(cell.column.columnDef.cell, cell.getContext());\n                      })()}\n                    </TableCell>\n                  );\n                })}\n              </TableRow>\n            );\n          })}\n        </TableBody>\n      </Table>\n    </div>\n  );\n}\n\nexport default ScriptureResultsViewer;\n","import { getSectionForBook, Section } from 'platform-bible-utils';\n\n/**\n * Filters an array of book IDs to only include books from a specific section\n *\n * @param bookIds Array of book IDs to filter\n * @param section The section to filter by\n * @returns Array of book IDs that belong to the specified section\n */\nexport const getBooksForSection = (bookIds: string[], section: Section) => {\n  return bookIds.filter((bookId) => {\n    try {\n      return getSectionForBook(bookId) === section;\n    } catch {\n      return false;\n    }\n  });\n};\n\n/**\n * Checks if all books in a given section are included in the selectedBookIds array\n *\n * @param bookIds Array of all available book IDs\n * @param section The section to check\n * @param selectedBookIds Array of currently selected book IDs\n * @returns True if all books from the specified section are selected, false otherwise\n */\nexport const isSectionFullySelected = (\n  bookIds: string[],\n  section: Section,\n  selectedBookIds: string[],\n) => getBooksForSection(bookIds, section).every((bookId) => selectedBookIds.includes(bookId));\n","import { Button } from '@/components/shadcn-ui/button';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { LanguageStrings, Section } from 'platform-bible-utils';\nimport { getSectionShortName } from '@/components/shared/book.utils';\nimport { getBooksForSection, isSectionFullySelected } from './scope-selector.utils';\n\n/**\n * A button component that represents a scripture section (testament) in the book selector. The\n * button shows a different state when all books in its section are selected and becomes disabled\n * when no books are available in its section.\n */\nfunction SectionButton({\n  section,\n  availableBookIds,\n  selectedBookIds,\n  onToggle,\n  localizedStrings,\n}: {\n  section: Section;\n  availableBookIds: string[];\n  selectedBookIds: string[];\n  onToggle: (section: Section) => void;\n  localizedStrings: LanguageStrings;\n}) {\n  const isDisabled = getBooksForSection(availableBookIds, section).length === 0;\n\n  const sectionOtShortText = localizedStrings['%scripture_section_ot_short%'];\n  const sectionNtShortText = localizedStrings['%scripture_section_nt_short%'];\n  const sectionDcShortText = localizedStrings['%scripture_section_dc_short%'];\n  const sectionExtraShortText = localizedStrings['%scripture_section_extra_short%'];\n\n  return (\n    <Button\n      variant=\"outline\"\n      size=\"sm\"\n      onClick={() => onToggle(section)}\n      className={cn(\n        isSectionFullySelected(availableBookIds, section, selectedBookIds) &&\n          !isDisabled &&\n          'tw-bg-primary tw-text-primary-foreground hover:tw-bg-primary/70 hover:tw-text-primary-foreground',\n      )}\n      disabled={isDisabled}\n    >\n      {getSectionShortName(\n        section,\n        sectionOtShortText,\n        sectionNtShortText,\n        sectionDcShortText,\n        sectionExtraShortText,\n      )}\n    </Button>\n  );\n}\n\nexport default SectionButton;\n","import { BookItem } from '@/components/shared/book-item.component';\nimport { Badge } from '@/components/shadcn-ui/badge';\nimport { Button } from '@/components/shadcn-ui/button';\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandList,\n  CommandSeparator,\n} from '@/components/shadcn-ui/command';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/shadcn-ui/popover';\nimport { Canon } from '@sillsdev/scripture';\nimport { ChevronsUpDown } from 'lucide-react';\nimport { getSectionForBook, LanguageStrings, Section } from 'platform-bible-utils';\nimport {\n  getSectionLongName,\n  getLocalizedBookName,\n  doesBookMatchQuery,\n} from '@/components/shared/book.utils';\nimport { Fragment, MouseEvent, useCallback, useMemo, useRef, useState } from 'react';\nimport { generateCommandValue } from '@/components/shared/book-item.utils';\nimport { getBooksForSection, isSectionFullySelected } from './scope-selector.utils';\nimport SectionButton from './section-button.component';\n\n/** Maximum number of badges to show before collapsing into a \"+X more\" badge */\nconst VISIBLE_BADGES_COUNT = 5;\n/** Maximum number of badges that can be shown without triggering the collapse */\nconst MAX_VISIBLE_BADGES = 6;\n\ntype BookSelectorProps = {\n  /**\n   * Information about available books, formatted as a 123 character long string as defined in a\n   * projects BooksPresent setting\n   */\n  availableBookInfo: string;\n  /** Array of currently selected book IDs */\n  selectedBookIds: string[];\n  /** Callback function that is executed when the book selection changes */\n  onChangeSelectedBookIds: (books: string[]) => void;\n  /** Object containing the localized strings for the component */\n  localizedStrings: LanguageStrings;\n  /**\n   * Optional map of localized book IDs/short names and full names. Key is the (English) book ID,\n   * value contains localized versions of the ID and full book name\n   */\n  localizedBookNames?: Map<string, { localizedId: string; localizedName: string }>;\n};\n\n/**\n * A component for selecting multiple books from the Bible canon. It provides:\n *\n * - Quick selection buttons for major sections (OT, NT, DC, Extra)\n * - A searchable dropdown with all available books\n * - Support for shift-click range selection\n * - Visual feedback with badges showing selected books\n */\nexport function BookSelector({\n  availableBookInfo,\n  selectedBookIds,\n  onChangeSelectedBookIds,\n  localizedStrings,\n  localizedBookNames,\n}: BookSelectorProps) {\n  const booksSelectedText = localizedStrings['%webView_book_selector_books_selected%'];\n  const selectBooksText = localizedStrings['%webView_book_selector_select_books%'];\n  const searchBooksText = localizedStrings['%webView_book_selector_search_books%'];\n  const selectAllText = localizedStrings['%webView_book_selector_select_all%'];\n  const clearAllText = localizedStrings['%webView_book_selector_clear_all%'];\n  const noBookFoundText = localizedStrings['%webView_book_selector_no_book_found%'];\n  const moreText = localizedStrings['%webView_book_selector_more%'];\n\n  const { otLong, ntLong, dcLong, extraLong } = {\n    otLong: localizedStrings?.['%scripture_section_ot_long%'],\n    ntLong: localizedStrings?.['%scripture_section_nt_long%'],\n    dcLong: localizedStrings?.['%scripture_section_dc_long%'],\n    extraLong: localizedStrings?.['%scripture_section_extra_long%'],\n  };\n\n  const [isBooksSelectorOpen, setIsBooksSelectorOpen] = useState(false);\n  const [inputValue, setInputValue] = useState('');\n  const lastSelectedBookRef = useRef<string | undefined>(undefined);\n  const lastKeyEventShiftKey = useRef(false);\n\n  if (availableBookInfo.length !== Canon.allBookIds.length) {\n    throw new Error('availableBookInfo length must match Canon.allBookIds length');\n  }\n\n  const availableBooksIds = useMemo(() => {\n    return Canon.allBookIds.filter(\n      (bookId, index) =>\n        availableBookInfo[index] === '1' && !Canon.isObsolete(Canon.bookIdToNumber(bookId)),\n    );\n  }, [availableBookInfo]);\n\n  const filteredBooksBySection = useMemo(() => {\n    if (!inputValue.trim()) {\n      const allBooks: Record<Section, string[]> = {\n        [Section.OT]: [],\n        [Section.NT]: [],\n        [Section.DC]: [],\n        [Section.Extra]: [],\n      };\n\n      availableBooksIds.forEach((bookId) => {\n        const section = getSectionForBook(bookId);\n        allBooks[section].push(bookId);\n      });\n\n      return allBooks;\n    }\n\n    const filteredBooks = availableBooksIds.filter((bookId) =>\n      doesBookMatchQuery(bookId, inputValue, localizedBookNames),\n    );\n\n    const matchingBooks: Record<Section, string[]> = {\n      [Section.OT]: [],\n      [Section.NT]: [],\n      [Section.DC]: [],\n      [Section.Extra]: [],\n    };\n\n    filteredBooks.forEach((bookId) => {\n      const section = getSectionForBook(bookId);\n      matchingBooks[section].push(bookId);\n    });\n\n    return matchingBooks;\n  }, [availableBooksIds, inputValue, localizedBookNames]);\n\n  const toggleBook = useCallback(\n    (bookId: string, shiftKey = false) => {\n      if (!shiftKey || !lastSelectedBookRef.current) {\n        onChangeSelectedBookIds(\n          selectedBookIds.includes(bookId)\n            ? selectedBookIds.filter((id) => id !== bookId)\n            : [...selectedBookIds, bookId],\n        );\n        lastSelectedBookRef.current = bookId;\n        return;\n      }\n\n      const lastIndex = availableBooksIds.findIndex((id) => id === lastSelectedBookRef.current);\n      const currentIndex = availableBooksIds.findIndex((id) => id === bookId);\n\n      if (lastIndex === -1 || currentIndex === -1) return;\n\n      const [startIndex, endIndex] = [\n        Math.min(lastIndex, currentIndex),\n        Math.max(lastIndex, currentIndex),\n      ];\n      const booksInRange = availableBooksIds.slice(startIndex, endIndex + 1).map((id) => id);\n\n      onChangeSelectedBookIds(\n        selectedBookIds.includes(bookId)\n          ? selectedBookIds.filter((shortname) => !booksInRange.includes(shortname))\n          : [...new Set([...selectedBookIds, ...booksInRange])],\n      );\n    },\n    [selectedBookIds, onChangeSelectedBookIds, availableBooksIds],\n  );\n\n  const handleKeyboardSelect = (bookId: string) => {\n    toggleBook(bookId, lastKeyEventShiftKey.current);\n    lastKeyEventShiftKey.current = false;\n  };\n\n  const handleMouseDown = (event: MouseEvent, bookId: string) => {\n    event.preventDefault();\n    toggleBook(bookId, event.shiftKey);\n  };\n\n  const toggleSection = useCallback(\n    (section: Section) => {\n      const sectionBooks = getBooksForSection(availableBooksIds, section).map((bookId) => bookId);\n      onChangeSelectedBookIds(\n        isSectionFullySelected(availableBooksIds, section, selectedBookIds)\n          ? selectedBookIds.filter((shortname) => !sectionBooks.includes(shortname))\n          : [...new Set([...selectedBookIds, ...sectionBooks])],\n      );\n    },\n    [selectedBookIds, onChangeSelectedBookIds, availableBooksIds],\n  );\n\n  const handleSelectAll = () => {\n    onChangeSelectedBookIds(availableBooksIds.map((bookId) => bookId));\n  };\n\n  const handleClearAll = () => {\n    onChangeSelectedBookIds([]);\n  };\n\n  return (\n    <div className=\"tw-space-y-2\">\n      <div className=\"tw-flex tw-flex-wrap tw-gap-2\">\n        {Object.values(Section).map((section) => {\n          return (\n            <SectionButton\n              key={section}\n              section={section}\n              availableBookIds={availableBooksIds}\n              selectedBookIds={selectedBookIds}\n              onToggle={toggleSection}\n              localizedStrings={localizedStrings}\n            />\n          );\n        })}\n      </div>\n\n      <Popover\n        open={isBooksSelectorOpen}\n        onOpenChange={(open) => {\n          setIsBooksSelectorOpen(open);\n          if (!open) {\n            setInputValue(''); // Reset search when closing\n          }\n        }}\n      >\n        <PopoverTrigger asChild>\n          <Button\n            variant=\"outline\"\n            role=\"combobox\"\n            aria-expanded={isBooksSelectorOpen}\n            className=\"tw-max-w-64 tw-justify-between\"\n          >\n            {selectedBookIds.length > 0\n              ? `${booksSelectedText}: ${selectedBookIds.length}`\n              : selectBooksText}\n            <ChevronsUpDown className=\"tw-ml-2 tw-h-4 tw-w-4 tw-shrink-0 tw-opacity-50\" />\n          </Button>\n        </PopoverTrigger>\n        <PopoverContent className=\"tw-w-full tw-p-0\" align=\"start\">\n          <Command\n            shouldFilter={false}\n            onKeyDown={(e) => {\n              if (e.key === 'Enter') {\n                // Store shift state in a ref that will be used by onSelect\n                lastKeyEventShiftKey.current = e.shiftKey;\n              }\n            }}\n          >\n            <CommandInput\n              placeholder={searchBooksText}\n              value={inputValue}\n              onValueChange={setInputValue}\n            />\n            <div className=\"tw-flex tw-justify-between tw-border-b tw-p-2\">\n              <Button variant=\"ghost\" size=\"sm\" onClick={handleSelectAll}>\n                {selectAllText}\n              </Button>\n              <Button variant=\"ghost\" size=\"sm\" onClick={handleClearAll}>\n                {clearAllText}\n              </Button>\n            </div>\n            <CommandList>\n              <CommandEmpty>{noBookFoundText}</CommandEmpty>\n              {Object.values(Section).map((section, index) => {\n                const sectionBooks = filteredBooksBySection[section];\n\n                if (sectionBooks.length === 0) return undefined;\n\n                return (\n                  <Fragment key={section}>\n                    <CommandGroup\n                      heading={getSectionLongName(section, otLong, ntLong, dcLong, extraLong)}\n                    >\n                      {sectionBooks.map((bookId) => (\n                        <BookItem\n                          key={bookId}\n                          bookId={bookId}\n                          isSelected={selectedBookIds.includes(bookId)}\n                          onSelect={() => handleKeyboardSelect(bookId)}\n                          onMouseDown={(event) => handleMouseDown(event, bookId)}\n                          section={getSectionForBook(bookId)}\n                          showCheck\n                          localizedBookNames={localizedBookNames}\n                          commandValue={generateCommandValue(bookId, localizedBookNames)}\n                          className=\"tw-flex tw-items-center\"\n                        />\n                      ))}\n                    </CommandGroup>\n                    {index < Object.values(Section).length - 1 && <CommandSeparator />}\n                  </Fragment>\n                );\n              })}\n            </CommandList>\n          </Command>\n        </PopoverContent>\n      </Popover>\n\n      {selectedBookIds.length > 0 && (\n        <div className=\"tw-mt-2 tw-flex tw-flex-wrap tw-gap-1\">\n          {selectedBookIds\n            .slice(\n              0,\n              selectedBookIds.length === MAX_VISIBLE_BADGES\n                ? MAX_VISIBLE_BADGES\n                : VISIBLE_BADGES_COUNT,\n            )\n            .map((bookId) => (\n              <Badge className=\"hover:tw-bg-secondary\" key={bookId} variant=\"secondary\">\n                {getLocalizedBookName(bookId, localizedBookNames)}\n              </Badge>\n            ))}\n          {selectedBookIds.length > MAX_VISIBLE_BADGES && (\n            <Badge\n              className=\"hover:tw-bg-secondary\"\n              variant=\"secondary\"\n            >{`+${selectedBookIds.length - VISIBLE_BADGES_COUNT} ${moreText}`}</Badge>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","import { BookSelector } from '@/components/advanced/scope-selector/book-selector.component';\nimport { Label } from '@/components/shadcn-ui/label';\nimport { RadioGroup, RadioGroupItem } from '@/components/shadcn-ui/radio-group';\nimport { Scope } from '@/components/utils/scripture.util';\nimport { LocalizedStringValue } from 'platform-bible-utils';\n\n/**\n * Object containing all keys used for localization in this component. If you're using this\n * component in an extension, you can pass it into the useLocalizedStrings hook to easily obtain the\n * localized strings and pass them into the localizedStrings prop of this component\n */\nexport const SCOPE_SELECTOR_STRING_KEYS = Object.freeze([\n  '%webView_scope_selector_selected_text%',\n  '%webView_scope_selector_current_verse%',\n  '%webView_scope_selector_current_chapter%',\n  '%webView_scope_selector_current_book%',\n  '%webView_scope_selector_choose_books%',\n  '%webView_scope_selector_scope%',\n  '%webView_scope_selector_select_books%',\n  '%webView_book_selector_books_selected%',\n  '%webView_book_selector_select_books%',\n  '%webView_book_selector_search_books%',\n  '%webView_book_selector_select_all%',\n  '%webView_book_selector_clear_all%',\n  '%webView_book_selector_no_book_found%',\n  '%webView_book_selector_more%',\n  '%scripture_section_ot_long%',\n  '%scripture_section_ot_short%',\n  '%scripture_section_nt_long%',\n  '%scripture_section_nt_short%',\n  '%scripture_section_dc_long%',\n  '%scripture_section_dc_short%',\n  '%scripture_section_extra_long%',\n  '%scripture_section_extra_short%',\n] as const);\n\n/** Type definition for the localized strings used in this component */\nexport type ScopeSelectorLocalizedStrings = {\n  [localizedInventoryKey in (typeof SCOPE_SELECTOR_STRING_KEYS)[number]]?: LocalizedStringValue;\n};\n\n/**\n * Gets the localized value for the provided key\n *\n * @param strings Object containing localized string\n * @param key Key for a localized string\n * @returns The localized value for the provided key, if available. Returns the key if no localized\n *   value is available\n */\nconst localizeString = (\n  strings: ScopeSelectorLocalizedStrings,\n  key: keyof ScopeSelectorLocalizedStrings,\n) => {\n  return strings[key] ?? key;\n};\n\n/** Props for configuring the ScopeSelector component */\ninterface ScopeSelectorProps {\n  /** The current scope selection */\n  scope: Scope;\n\n  /**\n   * Optional array of scopes that should be available in the selector. If not provided, all scopes\n   * will be shown as defined in the Scope type\n   */\n  availableScopes?: Scope[];\n\n  /** Callback function that is executed when the user changes the scope selection */\n  onScopeChange: (scope: Scope) => void;\n\n  /**\n   * Information about available books, formatted as a 123 character long string as defined in a\n   * projects BooksPresent setting\n   */\n  availableBookInfo: string;\n\n  /** Array of currently selected book IDs */\n  selectedBookIds: string[];\n\n  /** Callback function that is executed when the user changes the book selection */\n  onSelectedBookIdsChange: (books: string[]) => void;\n\n  /**\n   * Object with all localized strings that the component needs to work well across multiple\n   * languages. When using this component with Platform.Bible, you can import\n   * `SCOPE_SELECTOR_STRING_KEYS` from this library, pass it in to the Platform's localization hook,\n   * and pass the localized keys that are returned by the hook into this prop.\n   */\n  localizedStrings: ScopeSelectorLocalizedStrings;\n  /**\n   * Optional map of localized book IDs/short names and full names. Key is the (English) book ID,\n   * value contains localized versions of the ID and full book name\n   */\n  localizedBookNames?: Map<string, { localizedId: string; localizedName: string }>;\n  /** Optional ID that is applied to the root element of this component */\n  id?: string;\n}\n\n/**\n * A component that allows users to select the scope of their search or operation. Available scopes\n * are defined in the Scope type. When 'selectedBooks' is chosen as the scope, a BookSelector\n * component is displayed to allow users to choose specific books.\n */\nexport function ScopeSelector({\n  scope,\n  availableScopes,\n  onScopeChange,\n  availableBookInfo,\n  selectedBookIds,\n  onSelectedBookIdsChange,\n  localizedStrings,\n  localizedBookNames,\n  id,\n}: ScopeSelectorProps) {\n  const selectedTextText = localizeString(\n    localizedStrings,\n    '%webView_scope_selector_selected_text%',\n  );\n  const currentVerseText = localizeString(\n    localizedStrings,\n    '%webView_scope_selector_current_verse%',\n  );\n  const currentChapterText = localizeString(\n    localizedStrings,\n    '%webView_scope_selector_current_chapter%',\n  );\n  const currentBookText = localizeString(localizedStrings, '%webView_scope_selector_current_book%');\n  const chooseBooksText = localizeString(localizedStrings, '%webView_scope_selector_choose_books%');\n  const scopeText = localizeString(localizedStrings, '%webView_scope_selector_scope%');\n  const selectBooksText = localizeString(localizedStrings, '%webView_scope_selector_select_books%');\n\n  const SCOPE_OPTIONS: Array<{ value: Scope; label: string; id: string }> = [\n    { value: 'selectedText', label: selectedTextText, id: 'scope-selected-text' },\n    { value: 'verse', label: currentVerseText, id: 'scope-verse' },\n    { value: 'chapter', label: currentChapterText, id: 'scope-chapter' },\n    { value: 'book', label: currentBookText, id: 'scope-book' },\n    { value: 'selectedBooks', label: chooseBooksText, id: 'scope-selected' },\n  ];\n\n  const displayedScopes = availableScopes\n    ? SCOPE_OPTIONS.filter((option) => availableScopes.includes(option.value))\n    : SCOPE_OPTIONS;\n\n  return (\n    <div id={id} className=\"tw-grid tw-gap-4\">\n      <div className=\"tw-grid tw-gap-2\">\n        <Label>{scopeText}</Label>\n        <RadioGroup\n          value={scope}\n          onValueChange={onScopeChange}\n          className=\"tw-flex tw-flex-col tw-space-y-1\"\n        >\n          {displayedScopes.map(({ value, label, id: scopeId }) => (\n            <div key={scopeId} className=\"tw-flex tw-items-center\">\n              <RadioGroupItem className=\"tw-me-2\" value={value} id={scopeId} />\n              <Label htmlFor={scopeId}>{label}</Label>\n            </div>\n          ))}\n        </RadioGroup>\n      </div>\n\n      {scope === 'selectedBooks' && (\n        <div className=\"tw-grid tw-gap-2\">\n          <Label>{selectBooksText}</Label>\n          <BookSelector\n            availableBookInfo={availableBookInfo}\n            selectedBookIds={selectedBookIds}\n            onChangeSelectedBookIds={onSelectedBookIdsChange}\n            localizedStrings={localizedStrings}\n            localizedBookNames={localizedBookNames}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default ScopeSelector;\n","import {\n  getLocalizeKeyForScrollGroupId,\n  LanguageStrings,\n  ScrollGroupId,\n} from 'platform-bible-utils';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/shadcn-ui/select';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\nimport { cn } from '@/utils/shadcn-ui.util';\n\nconst DEFAULT_SCROLL_GROUP_LOCALIZED_STRINGS = {\n  [getLocalizeKeyForScrollGroupId('undefined')]: 'Ø',\n  [getLocalizeKeyForScrollGroupId(0)]: 'A',\n  [getLocalizeKeyForScrollGroupId(1)]: 'B',\n  [getLocalizeKeyForScrollGroupId(2)]: 'C',\n  [getLocalizeKeyForScrollGroupId(3)]: 'D',\n  [getLocalizeKeyForScrollGroupId(4)]: 'E',\n  [getLocalizeKeyForScrollGroupId(5)]: 'F',\n  [getLocalizeKeyForScrollGroupId(6)]: 'G',\n  [getLocalizeKeyForScrollGroupId(7)]: 'H',\n  [getLocalizeKeyForScrollGroupId(8)]: 'I',\n  [getLocalizeKeyForScrollGroupId(9)]: 'J',\n  [getLocalizeKeyForScrollGroupId(10)]: 'K',\n  [getLocalizeKeyForScrollGroupId(11)]: 'L',\n  [getLocalizeKeyForScrollGroupId(12)]: 'M',\n  [getLocalizeKeyForScrollGroupId(13)]: 'N',\n  [getLocalizeKeyForScrollGroupId(14)]: 'O',\n  [getLocalizeKeyForScrollGroupId(15)]: 'P',\n  [getLocalizeKeyForScrollGroupId(16)]: 'Q',\n  [getLocalizeKeyForScrollGroupId(17)]: 'R',\n  [getLocalizeKeyForScrollGroupId(18)]: 'S',\n  [getLocalizeKeyForScrollGroupId(19)]: 'T',\n  [getLocalizeKeyForScrollGroupId(20)]: 'U',\n  [getLocalizeKeyForScrollGroupId(21)]: 'V',\n  [getLocalizeKeyForScrollGroupId(22)]: 'W',\n  [getLocalizeKeyForScrollGroupId(23)]: 'X',\n  [getLocalizeKeyForScrollGroupId(24)]: 'Y',\n  [getLocalizeKeyForScrollGroupId(25)]: 'Z',\n};\n\nexport type ScrollGroupSelectorProps = {\n  /**\n   * List of scroll group ids to show to the user. Either a `ScrollGroupId` or `undefined` for no\n   * scroll group\n   */\n  availableScrollGroupIds: (ScrollGroupId | undefined)[];\n  /** Currently selected scroll group id. `undefined` for no scroll group */\n  scrollGroupId: ScrollGroupId | undefined;\n  /** Callback function run when the user tries to change the scroll group id */\n  onChangeScrollGroupId: (newScrollGroupId: ScrollGroupId | undefined) => void;\n  /**\n   * Localized strings to use for displaying scroll group ids. Must be an object whose keys are\n   * `getLocalizeKeyForScrollGroupId(scrollGroupId)` for all scroll group ids (and `undefined` if\n   * included) in {@link ScrollGroupSelectorProps.availableScrollGroupIds} and whose values are the\n   * localized strings to use for those scroll group ids.\n   *\n   * Defaults to English localizations of English alphabet for scroll groups 0-25 (e.g. 0 is A) and\n   * Ø for `undefined`. Will fill in any that are not provided with these English localizations.\n   * Also, if any values match the keys, the English localization will be used. This is useful in\n   * case you want to pass in a temporary version of the localized strings while your localized\n   * strings load.\n   *\n   * @example\n   *\n   * ```typescript\n   * const myScrollGroupIdLocalizedStrings = {\n   *   [getLocalizeKeyForScrollGroupId('undefined')]: 'Ø',\n   *   [getLocalizeKeyForScrollGroupId(0)]: 'A',\n   *   [getLocalizeKeyForScrollGroupId(1)]: 'B',\n   *   [getLocalizeKeyForScrollGroupId(2)]: 'C',\n   *   [getLocalizeKeyForScrollGroupId(3)]: 'D',\n   *   [getLocalizeKeyForScrollGroupId(4)]: 'E',\n   * };\n   * ```\n   *\n   * @example\n   *\n   * ```tsx\n   * const availableScrollGroupIds = [undefined, 0, 1, 2, 3, 4];\n   *\n   * const localizeKeys = getLocalizeKeysForScrollGroupIds();\n   *\n   * const [localizedStrings] = useLocalizedStrings(localizeKeys);\n   *\n   * ...\n   *\n   * <ScrollGroupSelector localizedStrings={localizedStrings} />\n   * ```\n   */\n  localizedStrings?: LanguageStrings;\n\n  /** Size of the scroll group dropdown button. Defaults to 'sm' */\n  size?: 'default' | 'sm' | 'lg' | 'icon';\n\n  /** Additional css classes to help with unique styling */\n  className?: string;\n\n  /** Optional id for the select element */\n  id?: string;\n};\n\n/** Selector component for choosing a scroll group */\nexport function ScrollGroupSelector({\n  availableScrollGroupIds,\n  scrollGroupId,\n  onChangeScrollGroupId,\n  localizedStrings = {},\n  size = 'sm',\n  className,\n  id,\n}: ScrollGroupSelectorProps) {\n  const localizedStringsDefaulted = {\n    ...DEFAULT_SCROLL_GROUP_LOCALIZED_STRINGS,\n    ...Object.fromEntries(\n      Object.entries(localizedStrings).map(\n        ([localizedStringKey, localizedStringValue]: [string, string]) => [\n          localizedStringKey,\n          localizedStringKey === localizedStringValue &&\n          localizedStringKey in DEFAULT_SCROLL_GROUP_LOCALIZED_STRINGS\n            ? DEFAULT_SCROLL_GROUP_LOCALIZED_STRINGS[localizedStringKey]\n            : localizedStringValue,\n        ],\n      ),\n    ),\n  };\n\n  const dir: Direction = readDirection();\n\n  return (\n    <Select\n      value={`${scrollGroupId}`}\n      onValueChange={(newScrollGroupString) =>\n        onChangeScrollGroupId(\n          newScrollGroupString === 'undefined' ? undefined : parseInt(newScrollGroupString, 10),\n        )\n      }\n    >\n      <SelectTrigger size={size} className={cn('pr-twp tw-w-auto', className)}>\n        <SelectValue\n          placeholder={\n            localizedStringsDefaulted[getLocalizeKeyForScrollGroupId(scrollGroupId)] ??\n            scrollGroupId\n          }\n        />\n      </SelectTrigger>\n      <SelectContent\n        id={id}\n        align={dir === 'rtl' ? 'end' : 'start'}\n        // Need to get over the floating web view z-index 200\n        style={{ zIndex: 250 }}\n      >\n        {availableScrollGroupIds.map((scrollGroupOptionId) => (\n          <SelectItem key={`${scrollGroupOptionId}`} value={`${scrollGroupOptionId}`}>\n            {localizedStringsDefaulted[getLocalizeKeyForScrollGroupId(scrollGroupOptionId)]}\n          </SelectItem>\n        ))}\n      </SelectContent>\n    </Select>\n  );\n}\n\nexport default ScrollGroupSelector;\n","import { PropsWithChildren } from 'react';\nimport { Separator } from '@/components/shadcn-ui/separator';\n\n/** Props for the SettingsList component, currently just children */\ntype SettingsListProps = PropsWithChildren;\n\n/**\n * SettingsList component is a wrapper for list items. Rendered with a formatted div\n *\n * @deprecated Jul 18 2025. This component is no longer supported or tested. Use of this component\n *   is discouraged and it may be removed in the future.\n * @param children To populate the list with\n * @returns Formatted div encompassing the children\n */\nexport function SettingsList({ children }: SettingsListProps) {\n  return <div className=\"pr-twp tw-grid\">{children}</div>;\n}\n\n/** Props for SettingsListItem component */\ntype SettingsListItemProps = PropsWithChildren & {\n  /** Primary text of the list item */\n  primary: string;\n\n  /** Optional text of the list item */\n  secondary?: string | undefined;\n\n  /** Optional boolean to display a message if the children aren't loaded yet. Defaults to false */\n  isLoading?: boolean;\n\n  /** Optional message to display if isLoading */\n  loadingMessage?: string;\n};\n\n/**\n * SettingsListItem component is a common list item. Rendered with a formatted div\n *\n * @deprecated Jul 18 2025. This component is no longer supported or tested. Use of this component\n *   is discouraged and it may be removed in the future.\n * @param SettingsListItemProps\n * @returns Formatted div encompassing the list item content\n */\nexport function SettingsListItem({\n  primary,\n  secondary,\n  children,\n  isLoading = false,\n  loadingMessage,\n}: SettingsListItemProps) {\n  return (\n    <div className=\"tw-flex tw-items-center tw-justify-between tw-space-x-4 tw-py-2\">\n      <div>\n        <p className=\"tw-text-sm tw-font-medium tw-leading-none\">{primary}</p>\n        <p className=\"tw-whitespace-normal tw-break-words tw-text-sm tw-text-muted-foreground\">\n          {secondary}\n        </p>\n      </div>\n\n      {isLoading ? (\n        <p className=\"tw-text-sm tw-text-muted-foreground\">{loadingMessage}</p>\n      ) : (\n        <div>{children}</div>\n      )}\n    </div>\n  );\n}\n\n/** Props for SettingsListHeader component */\ntype SettingsListHeaderProps = {\n  /** The primary text of the list header */\n  primary: string;\n\n  /** Optional secondary text of the list header */\n  secondary?: string | undefined;\n\n  /** Optional boolean to include a separator underneath the secondary text. Defaults to false */\n  includeSeparator?: boolean;\n};\n\n/**\n * SettingsListHeader component displays text above the list\n *\n * @deprecated Jul 18 2025. This component is no longer supported or tested. Use of this component\n *   is discouraged and it may be removed in the future.\n * @param SettingsListHeaderProps\n * @returns Formatted div with list header content\n */\nexport function SettingsListHeader({\n  primary,\n  secondary,\n  includeSeparator = false,\n}: SettingsListHeaderProps) {\n  return (\n    <div className=\"tw-space-y-4 tw-py-2\">\n      <div>\n        <h3 className=\"tw-text-lg tw-font-medium\">{primary}</h3>\n        <p className=\"tw-text-sm tw-text-muted-foreground\">{secondary}</p>\n      </div>\n      {includeSeparator ? <Separator /> : ''}\n    </div>\n  );\n}\n","import { GroupsInMultiColumnMenu, Localized } from 'platform-bible-utils';\n\n/**\n * Function that looks up the key of a sub-menu group using the value of it's `menuItem` property.\n *\n * @example\n *\n * ```ts\n * const groups = {\n *   'platform.subMenu': { menuItem: 'platform.subMenuId', order: 1 },\n *   'platform.subSubMenu': { menuItem: 'platform.subSubMenuId', order: 2 },\n * };\n * const id = 'platform.subMenuId';\n * const groupKey = getSubMenuGroupKeyForMenuItemId(groups, id);\n * console.log(groupKey); // Output: 'platform.subMenu'\n * ```\n *\n * @param groups The JSON Object containing the group definitions\n * @param id The value of the `menuItem` property of the group to look up\n * @returns The key of the group that has the `menuItem` property with the value of `id` or\n *   `undefined` if no such group exists.\n */\nexport function getSubMenuGroupKeyForMenuItemId(\n  groups: Localized<GroupsInMultiColumnMenu>,\n  id: string,\n): string | undefined {\n  return Object.entries(groups).find(\n    ([, value]) => 'menuItem' in value && value.menuItem === id,\n  )?.[0];\n}\n","import { cn } from '@/utils/shadcn-ui.util';\n\ntype MenuItemIconProps = {\n  /** The icon to display */\n  icon: string;\n  /** The label of the menu item */\n  menuLabel: string;\n  /** Whether the icon is leading or trailing */\n  leading?: boolean;\n};\n\nfunction MenuItemIcon({ icon, menuLabel, leading }: MenuItemIconProps) {\n  return icon ? (\n    <img\n      className={cn('tw-max-h-5 tw-max-w-5', leading ? 'tw-me-2' : 'tw-ms-2')}\n      src={icon}\n      alt={`${leading ? 'Leading' : 'Trailing'} icon for ${menuLabel}`}\n    />\n  ) : undefined;\n}\n\nexport default MenuItemIcon;\n","import {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuGroup,\n  DropdownMenuItem,\n  DropdownMenuPortal,\n  DropdownMenuSeparator,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuTrigger,\n} from '@/components/shadcn-ui/dropdown-menu';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/shadcn-ui/tooltip';\nimport { MenuIcon } from 'lucide-react';\nimport {\n  GroupsInMultiColumnMenu,\n  Localized,\n  MenuItemContainingCommand,\n  MenuItemContainingSubmenu,\n  MultiColumnMenu,\n} from 'platform-bible-utils';\nimport { Fragment, ReactNode } from 'react';\nimport { Button } from '@/components/shadcn-ui/button';\nimport { getSubMenuGroupKeyForMenuItemId } from './menu.util';\nimport { SelectMenuItemHandler } from './platform-menubar.component';\nimport MenuItemIcon from './menu-icon.component';\n\nconst getGroupContent = (\n  groups: Localized<GroupsInMultiColumnMenu>,\n  items: Localized<(MenuItemContainingCommand | MenuItemContainingSubmenu)[]>,\n  columnOrSubMenuKey: string | undefined,\n  onSelectMenuItem: SelectMenuItemHandler,\n) => {\n  if (!columnOrSubMenuKey) return undefined;\n\n  const sortedGroupsForColumn = Object.entries(groups)\n    .filter(\n      ([key, group]) =>\n        ('column' in group && group.column === columnOrSubMenuKey) || key === columnOrSubMenuKey,\n    )\n    .sort(([, a], [, b]) => a.order - b.order);\n\n  return sortedGroupsForColumn.flatMap(([groupKey]) => {\n    const groupItems = items\n      .filter((item) => item.group === groupKey)\n      .sort((a, b) => a.order - b.order)\n      .map((item: Localized<MenuItemContainingCommand | MenuItemContainingSubmenu>) => {\n        return (\n          <Tooltip key={`tooltip-${item.label}-${'command' in item ? item.command : item.id}`}>\n            <TooltipTrigger asChild>\n              {'command' in item ? (\n                <DropdownMenuItem\n                  key={`dropdown-menu-item-${item.label}-${item.command}`}\n                  onClick={() => {\n                    // Since the item has a command, we know it is a MenuItemContainingCommand.\n                    // eslint-disable-next-line no-type-assertion/no-type-assertion\n                    onSelectMenuItem(item as MenuItemContainingCommand);\n                  }}\n                >\n                  {item.iconPathBefore && (\n                    <MenuItemIcon icon={item.iconPathBefore} menuLabel={item.label} leading />\n                  )}\n                  {item.label}\n                  {item.iconPathAfter && (\n                    <MenuItemIcon icon={item.iconPathAfter} menuLabel={item.label} />\n                  )}\n                </DropdownMenuItem>\n              ) : (\n                <DropdownMenuSub key={`dropdown-menu-sub-${item.label}-${item.id}`}>\n                  <DropdownMenuSubTrigger>{item.label}</DropdownMenuSubTrigger>\n\n                  <DropdownMenuPortal>\n                    <DropdownMenuSubContent>\n                      {getGroupContent(\n                        groups,\n                        items,\n                        getSubMenuGroupKeyForMenuItemId(groups, item.id),\n                        onSelectMenuItem,\n                      )}\n                    </DropdownMenuSubContent>\n                  </DropdownMenuPortal>\n                </DropdownMenuSub>\n              )}\n            </TooltipTrigger>\n            {item.tooltip && <TooltipContent>{item.tooltip}</TooltipContent>}\n          </Tooltip>\n        );\n      });\n\n    return groupItems;\n  });\n};\n\nexport type TabDropdownMenuProps = {\n  /** The handler to use for menu commands */\n  onSelectMenuItem: SelectMenuItemHandler;\n\n  /** The menu data to show on the dropdown menu */\n  menuData: Localized<MultiColumnMenu>;\n\n  /** Defines a string value that labels the current element */\n  tabLabel: string;\n\n  /** Optional icon for the dropdown menu trigger. Defaults to hamburger icon. */\n  icon?: ReactNode;\n\n  /** Additional css class(es) to help with unique styling of the tab dropdown menu */\n  className?: string;\n\n  /** Style variant for the app menubar component. */\n  variant?: 'default' | 'muted';\n\n  buttonVariant?: 'default' | 'ghost' | 'outline' | 'secondary';\n\n  /** Optional unique identifier */\n  id?: string;\n};\n\n/**\n * Dropdown menu designed to be used with Platform.Bible menu data. Column headers are ignored.\n * Column data is separated by a horizontal divider, so groups are not distinguishable. Tooltips are\n * displayed on hovering over menu items, if a tooltip is defined for them.\n *\n * A child component can be passed in to show as an icon on the menu trigger button.\n */\nexport default function TabDropdownMenu({\n  onSelectMenuItem,\n  menuData,\n  tabLabel,\n  icon,\n  className,\n  variant,\n  buttonVariant = 'ghost',\n  id,\n}: TabDropdownMenuProps) {\n  return (\n    <DropdownMenu variant={variant}>\n      <DropdownMenuTrigger aria-label={tabLabel} className={className} asChild id={id}>\n        <Button variant={buttonVariant} size=\"icon\">\n          {icon ?? <MenuIcon />}\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"start\" className=\"tw-z-[250]\">\n        {Object.entries(menuData.columns)\n          .filter(([, column]) => typeof column === 'object')\n          .sort(([, a], [, b]) => {\n            if (typeof a === 'boolean' || typeof b === 'boolean') return 0;\n            return a.order - b.order;\n          })\n          .map(([columnKey], index, array) => (\n            <Fragment key={columnKey}>\n              <DropdownMenuGroup>\n                <TooltipProvider>\n                  {getGroupContent(menuData.groups, menuData.items, columnKey, onSelectMenuItem)}\n                </TooltipProvider>\n              </DropdownMenuGroup>\n\n              {index < array.length - 1 && <DropdownMenuSeparator />}\n            </Fragment>\n          ))}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","import { Localized, MultiColumnMenu } from 'platform-bible-utils';\nimport React, { PropsWithChildren, ReactNode } from 'react';\nimport { SelectMenuItemHandler } from '../menus/platform-menubar.component';\n\nexport type TabToolbarCommonProps = {\n  /**\n   * The handler to use for toolbar item commands related to the project menu. Here is a basic\n   * example of how to create this:\n   *\n   * @example\n   *\n   * ```tsx\n   * const projectMenuCommandHandler: SelectMenuItemHandler = async (selectedMenuItem) => {\n   *   const commandName = selectedMenuItem.command;\n   *   try {\n   *     // Assert the more specific type. Assert the more specific type. The menu data should\n   *     // specify a valid command name here. If not, the error will be caught.\n   *     // eslint-disable-next-line no-type-assertion/no-type-assertion\n   *     await papi.commands.sendCommand(commandName as CommandNames);\n   *   } catch (e) {\n   *     throw new Error(\n   *       `handleMenuCommand error: command: ${commandName}. ${JSON.stringify(e)}`,\n   *     );\n   *   }\n   * };\n   * ```\n   */\n  onSelectProjectMenuItem: SelectMenuItemHandler;\n\n  /**\n   * Menu data that is used to populate the Menubar component for the project menu. In an extension,\n   * the menu data comes from menus.json in the contributions folder. To access that info, use\n   * useMemo to get the WebViewMenu.\n   */\n  projectMenuData?: Localized<MultiColumnMenu>;\n\n  /** Optional unique identifier */\n  id?: string;\n\n  /** Additional css classes to help with unique styling of the extensible toolbar */\n  className?: string;\n\n  /** Icon that will be displayed on the Menu Button. Defaults to the hamburger menu icon. */\n  menuButtonIcon?: ReactNode;\n};\n\nexport type TabToolbarContainerProps = PropsWithChildren<{\n  /** Optional unique identifier */\n  id?: string;\n  /** Additional css classes to help with unique styling of the extensible toolbar */\n  className?: string;\n}>;\n\n/** Wrapper that allows consistent styling for both TabToolbar and TabFloatingMenu. */\nexport const TabToolbarContainer = React.forwardRef<HTMLDivElement, TabToolbarContainerProps>(\n  ({ id, className, children }, ref) => (\n    <div\n      ref={ref}\n      className={`tw-sticky tw-top-0 tw-box-border tw-flex tw-h-14 tw-flex-row tw-items-center tw-justify-between tw-gap-2 tw-overflow-clip tw-px-4 tw-py-2 tw-text-foreground tw-@container/toolbar ${className}`}\n      id={id}\n    >\n      {children}\n    </div>\n  ),\n);\n\nexport default TabToolbarContainer;\n","import { ReactNode } from 'react';\nimport { Localized, MultiColumnMenu } from 'platform-bible-utils';\nimport { Menu, EllipsisVertical } from 'lucide-react';\nimport TabDropdownMenu from '../menus/tab-dropdown-menu.component';\nimport { SelectMenuItemHandler } from '../menus/platform-menubar.component';\nimport { TabToolbarCommonProps, TabToolbarContainer } from './tab-toolbar-container.component';\n\nexport type TabToolbarProps = TabToolbarCommonProps & {\n  /**\n   * The handler to use for toolbar item commands related to the tab view menu. Here is a basic\n   * example of how to create this from the hello-rock3 extension:\n   *\n   * @example\n   *\n   * ```tsx\n   * const projectMenuCommandHandler: SelectMenuItemHandler = async (selectedMenuItem) => {\n   *   const commandName = selectedMenuItem.command;\n   *   try {\n   *     // Assert the more specific type. Assert the more specific type. The menu data should\n   *     // specify a valid command name here. If not, the error will be caught.\n   *     // eslint-disable-next-line no-type-assertion/no-type-assertion\n   *     await papi.commands.sendCommand(commandName as CommandNames);\n   *   } catch (e) {\n   *     throw new Error(\n   *       `handleMenuCommand error: command: ${commandName}. ${JSON.stringify(e)}`,\n   *     );\n   *   }\n   * };\n   * ```\n   */\n  onSelectViewInfoMenuItem: SelectMenuItemHandler;\n\n  /** Menu data that is used to populate the Menubar component for the view info menu */\n  tabViewMenuData?: Localized<MultiColumnMenu>;\n\n  /**\n   * Toolbar children to be put at the start of the the toolbar after the project menu icon (left\n   * side in ltr, right side in rtl). Recommended for inner navigation.\n   */\n  startAreaChildren?: ReactNode;\n\n  /** Toolbar children to be put in the center area of the the toolbar. Recommended for tools. */\n  centerAreaChildren?: ReactNode;\n\n  /**\n   * Toolbar children to be put at the end of the the toolbar before the tab view menu icon (right\n   * side in ltr, left side in rtl). Recommended for secondary tools and view options.\n   */\n  endAreaChildren?: ReactNode;\n};\n\n/**\n * Toolbar that holds the project menu icon on one side followed by three different areas/categories\n * for toolbar icons followed by an optional view info menu icon. See the Tab Floating Menu Button\n * component for a menu component that takes up less screen real estate yet is always visible.\n */\nexport function TabToolbar({\n  onSelectProjectMenuItem,\n  onSelectViewInfoMenuItem,\n  projectMenuData,\n  tabViewMenuData,\n  id,\n  className,\n  startAreaChildren,\n  centerAreaChildren,\n  endAreaChildren,\n  menuButtonIcon,\n}: TabToolbarProps) {\n  return (\n    <TabToolbarContainer className={`tw-w-full tw-border ${className}`} id={id}>\n      {projectMenuData && (\n        <TabDropdownMenu\n          onSelectMenuItem={onSelectProjectMenuItem}\n          menuData={projectMenuData}\n          tabLabel=\"Project\"\n          icon={menuButtonIcon ?? <Menu />}\n          buttonVariant=\"ghost\"\n        />\n      )}\n      {startAreaChildren && (\n        <div className=\"tw-flex tw-h-full tw-shrink tw-grow-[2] tw-flex-row tw-flex-wrap tw-items-start tw-gap-2 tw-overflow-clip tw-@container/tab-toolbar-start\">\n          {startAreaChildren}\n        </div>\n      )}\n      {centerAreaChildren && (\n        <div className=\"tw-flex tw-h-full tw-shrink tw-basis-0 tw-flex-row tw-flex-wrap tw-items-start tw-justify-center tw-gap-2 tw-overflow-clip tw-@container/tab-toolbar-center @sm:tw-grow @sm:tw-basis-auto\">\n          {centerAreaChildren}\n        </div>\n      )}\n      <div className=\"tw-flex tw-h-full tw-shrink tw-grow-[2] tw-flex-row-reverse tw-flex-wrap tw-items-start tw-gap-2 tw-overflow-clip tw-@container/tab-toolbar-end\">\n        {tabViewMenuData && (\n          <TabDropdownMenu\n            onSelectMenuItem={onSelectViewInfoMenuItem}\n            menuData={tabViewMenuData}\n            tabLabel=\"View Info\"\n            icon={<EllipsisVertical />}\n            className=\"tw-h-full\"\n          />\n        )}\n        {endAreaChildren}\n      </div>\n    </TabToolbarContainer>\n  );\n}\n\nexport default TabToolbar;\n","import TabDropdownMenu from '../menus/tab-dropdown-menu.component';\nimport { TabToolbarCommonProps, TabToolbarContainer } from './tab-toolbar-container.component';\n\n/**\n * Renders a TabDropdownMenu with a trigger button that looks like the menuButtonIcon or like the\n * default of three stacked horizontal lines (aka the hamburger). The menu \"floats\" over the content\n * so it is always visible. When clicked, it displays a dropdown menu with the projectMenuData.\n */\nexport function TabFloatingMenu({\n  onSelectProjectMenuItem,\n  projectMenuData,\n  id,\n  className,\n  menuButtonIcon,\n}: TabToolbarCommonProps) {\n  return (\n    <TabToolbarContainer className=\"tw-pointer-events-none\" id={id}>\n      {projectMenuData && (\n        <TabDropdownMenu\n          onSelectMenuItem={onSelectProjectMenuItem}\n          menuData={projectMenuData}\n          tabLabel=\"Project\"\n          icon={menuButtonIcon}\n          className={`tw-pointer-events-auto tw-shadow-lg ${className}`}\n          buttonVariant=\"outline\"\n        />\n      )}\n    </TabToolbarContainer>\n  );\n}\n\nexport default TabFloatingMenu;\n","// adapted from: https://github.com/shadcn-ui/ui/discussions/752\n\n'use client';\n\nimport { TabsContentProps, TabsListProps, TabsTriggerProps } from '@/components/shadcn-ui/tabs';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport * as TabsPrimitive from '@radix-ui/react-tabs';\nimport React from 'react';\n\nexport type VerticalTabsProps = React.ComponentPropsWithoutRef<typeof TabsPrimitive.Root> & {\n  className?: string;\n};\n\nexport type LeftTabsTriggerProps = TabsTriggerProps & {\n  value: string;\n  ref?: React.Ref<HTMLButtonElement>;\n};\n\n/**\n * Tabs components provide a set of layered sections of content—known as tab panels–that are\n * displayed one at a time. These components are built on Radix UI primitives and styled with Shadcn\n * UI. See Shadcn UI Documentation: https://ui.shadcn.com/docs/components/tabs See Radix UI\n * Documentation: https://www.radix-ui.com/primitives/docs/components/tabs\n */\nexport const VerticalTabs = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Root>,\n  VerticalTabsProps\n>(({ className, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <TabsPrimitive.Root\n      orientation=\"vertical\"\n      ref={ref}\n      className={cn('tw-flex tw-gap-1 tw-rounded-md tw-text-muted-foreground', className)}\n      {...props}\n      dir={dir}\n    />\n  );\n});\n\nVerticalTabs.displayName = TabsPrimitive.List.displayName;\n\n/** @inheritdoc VerticalTabs */\nexport const VerticalTabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  TabsListProps\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      'tw-flex-fit tw-mlk-items-center tw-w-[124px] tw-justify-center tw-rounded-md tw-bg-muted tw-p-1 tw-text-muted-foreground',\n      className,\n    )}\n    {...props}\n  />\n));\nVerticalTabsList.displayName = TabsPrimitive.List.displayName;\n\n/** @inheritdoc VerticalTabs */\nexport const VerticalTabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  LeftTabsTriggerProps\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    {...props}\n    className={cn(\n      'overflow-clip tw-inline-flex tw-w-[116px] tw-cursor-pointer tw-items-center tw-justify-center tw-break-words tw-rounded-sm tw-border-0 tw-bg-muted tw-px-3 tw-py-1.5 tw-text-sm tw-font-medium tw-text-inherit tw-ring-offset-background tw-transition-all hover:tw-text-foreground focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2 disabled:tw-pointer-events-none disabled:tw-opacity-50 data-[state=active]:tw-bg-background data-[state=active]:tw-text-foreground data-[state=active]:tw-shadow-sm',\n      className,\n    )}\n  />\n));\n\n/** @inheritdoc VerticalTabs */\nexport const VerticalTabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  TabsContentProps\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      // Removed tw-mt-2 because Sebastian said so\n      'tw-ms-5 tw-flex-grow tw-text-foreground tw-ring-offset-background focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2',\n      className,\n    )}\n    {...props}\n  />\n));\nVerticalTabsContent.displayName = TabsPrimitive.Content.displayName;\n","import { SearchBar } from '@/components/basics/search-bar.component';\nimport {\n  VerticalTabs,\n  VerticalTabsContent,\n  VerticalTabsList,\n  VerticalTabsTrigger,\n} from '@/components/basics/tabs-vertical';\nimport { ReactNode } from 'react';\n\nexport type TabKeyValueContent = {\n  key: string;\n  value: string;\n  content: ReactNode;\n};\n\nexport type TabNavigationContentSearchProps = {\n  /** List of values and keys for each tab this component should provide */\n  tabList: TabKeyValueContent[];\n\n  /** The search query in the search bar */\n  searchValue: string;\n\n  /** Handler to run when the value of the search bar changes */\n  onSearch: (searchQuery: string) => void;\n\n  /** Optional placeholder for the search bar */\n  searchPlaceholder?: string;\n\n  /** Optional title to include in the header */\n  headerTitle?: string;\n\n  /** Optional className to modify the search input */\n  searchClassName?: string;\n\n  /** Optional id for the root element */\n  id?: string;\n};\n\n/**\n * TabNavigationContentSearch component provides a vertical tab navigation interface with a search\n * bar at the top. This component allows users to filter content within tabs based on a search\n * query.\n *\n * @param {TabNavigationContentSearchProps} props\n * @param {TabKeyValueContent[]} props.tabList - List of objects containing keys, values, and\n *   content for each tab to be displayed.\n * @param {string} props.searchValue - The current value of the search input.\n * @param {function} props.onSearch - Callback function called when the search input changes;\n *   receives the new search query as an argument.\n * @param {string} [props.searchPlaceholder] - Optional placeholder text for the search input.\n * @param {string} [props.headerTitle] - Optional title to display above the search input.\n * @param {string} [props.searchClassName] - Optional CSS class name to apply custom styles to the\n *   search input.\n * @param {string} [props.id] - Optional id for the root element.\n */\nexport function TabNavigationContentSearch({\n  tabList,\n  searchValue,\n  onSearch,\n  searchPlaceholder,\n  headerTitle,\n  searchClassName,\n  id,\n}: TabNavigationContentSearchProps) {\n  return (\n    <div id={id} className=\"pr-twp\">\n      <div className=\"tw-sticky tw-top-0 tw-space-y-2 tw-pb-2\">\n        {headerTitle ? <h1>{headerTitle}</h1> : ''}\n        <SearchBar\n          className={searchClassName}\n          value={searchValue}\n          onSearch={onSearch}\n          placeholder={searchPlaceholder}\n        />\n      </div>\n      <VerticalTabs>\n        <VerticalTabsList>\n          {tabList.map((tab) => (\n            <VerticalTabsTrigger key={tab.key} value={tab.value}>\n              {tab.value}\n            </VerticalTabsTrigger>\n          ))}\n        </VerticalTabsList>\n        {tabList.map((tab) => (\n          <VerticalTabsContent key={tab.key} value={tab.value}>\n            {tab.content}\n          </VerticalTabsContent>\n        ))}\n      </VerticalTabs>\n    </div>\n  );\n}\n\nexport default TabNavigationContentSearch;\n","import {\n  MenuContext,\n  MenuContextProps,\n  menuVariants,\n  useMenuContext,\n} from '@/context/menu.context';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport * as MenubarPrimitive from '@radix-ui/react-menubar';\nimport { Check, ChevronRight, Circle } from 'lucide-react';\nimport React from 'react';\n\nfunction MenubarMenu({ ...props }: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />;\n}\n\nfunction MenubarGroup({ ...props }: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />;\n}\n\nfunction MenubarPortal({ ...props }: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />;\n}\n\nfunction MenubarRadioGroup({ ...props }: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />;\n}\n\nfunction MenubarSub({ ...props }: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />;\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root> & {\n    variant?: MenuContextProps['variant'];\n  }\n>(({ className, variant = 'default', ...props }, ref) => {\n  /* #region CUSTOM provide context to add variants */\n  const contextValue = React.useMemo<MenuContextProps>(\n    () => ({\n      variant,\n    }),\n    [variant],\n  );\n  return (\n    <MenuContext.Provider value={contextValue}>\n      {/* #endregion CUSTOM */}\n      <MenubarPrimitive.Root\n        ref={ref}\n        className={cn(\n          'tw-flex tw-h-10 tw-items-center tw-space-x-1 tw-rounded-md tw-border tw-bg-background tw-p-1',\n          className,\n        )}\n        {...props}\n      />\n    </MenuContext.Provider>\n  );\n});\nMenubar.displayName = MenubarPrimitive.Root.displayName;\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => {\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <MenubarPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        'tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-px-3 tw-py-1.5 tw-text-sm tw-font-medium tw-outline-none focus:tw-bg-accent focus:tw-text-accent-foreground data-[state=open]:tw-bg-accent data-[state=open]:tw-text-accent-foreground',\n        // CUSTOM\n        'pr-twp',\n        menuVariants({ variant: context.variant, className }), // CUSTOM use context to add variants\n      )}\n      {...props}\n    />\n  );\n});\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName;\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean;\n  }\n>(({ className, inset, children, ...props }, ref) => {\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <MenubarPrimitive.SubTrigger\n      ref={ref}\n      className={cn(\n        'tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-px-2 tw-py-1.5 tw-text-sm tw-outline-none focus:tw-bg-accent focus:tw-text-accent-foreground data-[state=open]:tw-bg-accent data-[state=open]:tw-text-accent-foreground',\n        inset && 'tw-pl-8',\n        menuVariants({ variant: context.variant, className }), // CUSTOM use context to add variants\n        className,\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronRight className=\"tw-ml-auto tw-h-4 tw-w-4\" />\n    </MenubarPrimitive.SubTrigger>\n  );\n});\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName;\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => {\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <MenubarPrimitive.SubContent\n      ref={ref}\n      className={cn(\n        'tw-z-50 tw-min-w-[8rem] tw-overflow-hidden tw-rounded-md tw-border tw-bg-popover tw-p-1 tw-text-popover-foreground data-[state=open]:tw-animate-in data-[state=closed]:tw-animate-out data-[state=closed]:tw-fade-out-0 data-[state=open]:tw-fade-in-0 data-[state=closed]:tw-zoom-out-95 data-[state=open]:tw-zoom-in-95 data-[side=bottom]:tw-slide-in-from-top-2 data-[side=left]:tw-slide-in-from-right-2 data-[side=right]:tw-slide-in-from-left-2 data-[side=top]:tw-slide-in-from-bottom-2',\n        // CUSTOM use context to add variants\n        {\n          'tw-bg-popover': context.variant === 'muted',\n        },\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName;\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(({ className, align = 'start', alignOffset = -4, sideOffset = 8, ...props }, ref) => {\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          'tw-z-50 tw-min-w-[12rem] tw-overflow-hidden tw-rounded-md tw-border tw-bg-popover tw-p-1 tw-text-popover-foreground tw-shadow-md data-[state=open]:tw-animate-in data-[state=closed]:tw-fade-out-0 data-[state=open]:tw-fade-in-0 data-[state=closed]:tw-zoom-out-95 data-[state=open]:tw-zoom-in-95 data-[side=bottom]:tw-slide-in-from-top-2 data-[side=left]:tw-slide-in-from-right-2 data-[side=right]:tw-slide-in-from-left-2 data-[side=top]:tw-slide-in-from-bottom-2',\n          // CUSTOM reset styles so that only shadcn styles are applied\n          'pr-twp',\n          // CUSTOM use context to add variants\n          {\n            'tw-bg-popover': context.variant === 'muted',\n          },\n          className,\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  );\n});\nMenubarContent.displayName = MenubarPrimitive.Content.displayName;\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => {\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <MenubarPrimitive.Item\n      ref={ref}\n      className={cn(\n        'tw-relative tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-px-2 tw-py-1.5 tw-text-sm tw-outline-none focus:tw-bg-accent focus:tw-text-accent-foreground data-[disabled]:tw-pointer-events-none data-[disabled]:tw-opacity-50',\n        inset && 'tw-pl-8',\n        menuVariants({ variant: context.variant, className }), // CUSTOM use context to add variants\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nMenubarItem.displayName = MenubarPrimitive.Item.displayName;\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => {\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <MenubarPrimitive.CheckboxItem\n      ref={ref}\n      className={cn(\n        'tw-relative tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-py-1.5 tw-pl-8 tw-pr-2 tw-text-sm tw-outline-none focus:tw-bg-accent focus:tw-text-accent-foreground data-[disabled]:tw-pointer-events-none data-[disabled]:tw-opacity-50',\n        menuVariants({ variant: context.variant, className }), // CUSTOM use context to add variants\n        className,\n      )}\n      checked={checked}\n      {...props}\n    >\n      <span className=\"tw-absolute tw-left-2 tw-flex tw-h-3.5 tw-w-3.5 tw-items-center tw-justify-center\">\n        <MenubarPrimitive.ItemIndicator>\n          <Check className=\"tw-h-4 tw-w-4\" />\n        </MenubarPrimitive.ItemIndicator>\n      </span>\n      {children}\n    </MenubarPrimitive.CheckboxItem>\n  );\n});\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName;\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => {\n  const context = useMenuContext(); // CUSTOM use context to add variants\n  return (\n    <MenubarPrimitive.RadioItem\n      ref={ref}\n      className={cn(\n        'tw-relative tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-py-1.5 tw-pl-8 tw-pr-2 tw-text-sm tw-outline-none focus:tw-bg-accent focus:tw-text-accent-foreground data-[disabled]:tw-pointer-events-none data-[disabled]:tw-opacity-50',\n        menuVariants({ variant: context.variant, className }), // CUSTOM use context to add variants\n        className,\n      )}\n      {...props}\n    >\n      <span className=\"tw-absolute tw-left-2 tw-flex tw-h-3.5 tw-w-3.5 tw-items-center tw-justify-center\">\n        <MenubarPrimitive.ItemIndicator>\n          <Circle className=\"tw-h-2 tw-w-2 tw-fill-current\" />\n        </MenubarPrimitive.ItemIndicator>\n      </span>\n      {children}\n    </MenubarPrimitive.RadioItem>\n  );\n});\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName;\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn('tw-px-2 tw-py-1.5 tw-text-sm tw-font-semibold', inset && 'tw-pl-8', className)}\n    {...props}\n  />\n));\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName;\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn('tw--mx-1 tw-my-1 tw-h-px tw-bg-muted', className)}\n    {...props}\n  />\n));\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName;\n\nfunction MenubarShortcut({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) {\n  return (\n    <span\n      className={cn('tw-ml-auto tw-text-xs tw-tracking-widest tw-text-muted-foreground', className)}\n      {...props}\n    />\n  );\n}\nMenubarShortcut.displayname = 'MenubarShortcut';\n\nexport {\n  Menubar,\n  MenubarCheckboxItem,\n  MenubarContent,\n  MenubarGroup,\n  MenubarItem,\n  MenubarLabel,\n  MenubarMenu,\n  MenubarPortal,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarSeparator,\n  MenubarShortcut,\n  MenubarSub,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarTrigger,\n};\n","import {\n  Menubar,\n  MenubarContent,\n  MenubarItem,\n  MenubarMenu,\n  MenubarSeparator,\n  MenubarSub,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarTrigger,\n} from '@/components/shadcn-ui/menubar';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/shadcn-ui/tooltip';\nimport {\n  GroupsInMultiColumnMenu,\n  Localized,\n  MenuItemContainingCommand,\n  MenuItemContainingSubmenu,\n  MultiColumnMenu,\n} from 'platform-bible-utils';\nimport { RefObject, useEffect, useRef } from 'react';\nimport { useHotkeys } from 'react-hotkeys-hook';\nimport { getSubMenuGroupKeyForMenuItemId } from './menu.util';\nimport MenuItemIcon from './menu-icon.component';\n\n/**\n * Callback function that is invoked when a user selects a menu item. Receives the full\n * `MenuItemContainingCommand` object as an argument.\n */\nexport interface SelectMenuItemHandler {\n  (selectedMenuItem: MenuItemContainingCommand): void;\n}\n\nconst simulateKeyPress = (ref: RefObject<HTMLButtonElement>, keys: KeyboardEventInit[]) => {\n  setTimeout(() => {\n    keys.forEach((key) => {\n      ref.current?.dispatchEvent(new KeyboardEvent('keydown', key));\n    });\n  }, 0);\n};\n\nconst getMenubarContent = (\n  groups: Localized<GroupsInMultiColumnMenu>,\n  items: Localized<(MenuItemContainingCommand | MenuItemContainingSubmenu)[]>,\n  columnOrSubMenuKey: string | undefined,\n  onSelectMenuItem: SelectMenuItemHandler,\n) => {\n  if (!columnOrSubMenuKey) return undefined;\n\n  const sortedGroupsForColumn = Object.entries(groups)\n    .filter(\n      ([key, group]) =>\n        ('column' in group && group.column === columnOrSubMenuKey) || key === columnOrSubMenuKey,\n    )\n    .sort(([, a], [, b]) => a.order - b.order);\n\n  return sortedGroupsForColumn.flatMap(([groupKey], index) => {\n    const groupItems = items\n      .filter((item) => item.group === groupKey)\n      .sort((a, b) => a.order - b.order)\n      .map((item: Localized<MenuItemContainingCommand | MenuItemContainingSubmenu>) => {\n        return (\n          <Tooltip key={`tooltip-${item.label}-${'command' in item ? item.command : item.id}`}>\n            <TooltipTrigger asChild>\n              {'command' in item ? (\n                <MenubarItem\n                  key={`menubar-item-${item.label}-${item.command}`}\n                  onClick={() => {\n                    // Since the item has a command, we know it is a MenuItemContainingCommand.\n                    // eslint-disable-next-line no-type-assertion/no-type-assertion\n                    onSelectMenuItem(item as MenuItemContainingCommand);\n                  }}\n                >\n                  {item.iconPathBefore && (\n                    <MenuItemIcon icon={item.iconPathBefore} menuLabel={item.label} leading />\n                  )}\n                  {item.label}\n                  {item.iconPathAfter && (\n                    <MenuItemIcon icon={item.iconPathAfter} menuLabel={item.label} />\n                  )}\n                </MenubarItem>\n              ) : (\n                <MenubarSub key={`menubar-sub-${item.label}-${item.id}`}>\n                  <MenubarSubTrigger>{item.label}</MenubarSubTrigger>\n                  <MenubarSubContent>\n                    {getMenubarContent(\n                      groups,\n                      items,\n                      getSubMenuGroupKeyForMenuItemId(groups, item.id),\n                      onSelectMenuItem,\n                    )}\n                  </MenubarSubContent>\n                </MenubarSub>\n              )}\n            </TooltipTrigger>\n            {item.tooltip && <TooltipContent>{item.tooltip}</TooltipContent>}\n          </Tooltip>\n        );\n      });\n\n    const itemsWithSeparator = [...groupItems];\n    if (groupItems.length > 0 && index < sortedGroupsForColumn.length - 1) {\n      itemsWithSeparator.push(<MenubarSeparator key={`separator-${groupKey}`} />);\n    }\n\n    return itemsWithSeparator;\n  });\n};\n\ntype PlatformMenubarProps = {\n  /** Menu data that is used to populate the Menubar component. */\n  menuData: Localized<MultiColumnMenu>;\n\n  /** The handler to use for menu commands. */\n  onSelectMenuItem: SelectMenuItemHandler;\n\n  /**\n   * Optional callback function that is executed whenever a menu on the Menubar is opened or closed.\n   * Helpful for handling updates to the menu, as changing menu data when the menu is opened is not\n   * desirable.\n   */\n  onOpenChange?: (isOpen: boolean) => void;\n\n  /** Style variant for the app menubar component. */\n  variant?: 'default' | 'muted';\n};\n\n/** Menubar component tailored to work with Platform.Bible menu data */\nexport function PlatformMenubar({\n  menuData,\n  onSelectMenuItem,\n  onOpenChange,\n  variant,\n}: PlatformMenubarProps) {\n  // These refs will always be defined\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const menubarRef = useRef<HTMLDivElement>(undefined!);\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const projectMenuRef = useRef<HTMLButtonElement>(undefined!);\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const windowMenuRef = useRef<HTMLButtonElement>(undefined!);\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const layoutMenuRef = useRef<HTMLButtonElement>(undefined!);\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const helpMenuRef = useRef<HTMLButtonElement>(undefined!);\n\n  const getRefForColumn = (columnKey: string) => {\n    switch (columnKey) {\n      case 'platform.app':\n        return projectMenuRef;\n      case 'platform.window':\n        return windowMenuRef;\n      case 'platform.layout':\n        return layoutMenuRef;\n      case 'platform.help':\n        return helpMenuRef;\n      default:\n        return undefined;\n    }\n  };\n\n  // This is a quick and dirty way to implement some shortcuts by simulating key presses\n  useHotkeys(['alt', 'alt+p', 'alt+l', 'alt+n', 'alt+h'], (event, handler) => {\n    event.preventDefault();\n\n    const escKey: KeyboardEventInit = { key: 'Escape', code: 'Escape', keyCode: 27, bubbles: true };\n    const spaceKey: KeyboardEventInit = { key: ' ', code: 'Space', keyCode: 32, bubbles: true };\n\n    switch (handler.hotkey) {\n      case 'alt':\n        simulateKeyPress(projectMenuRef, [escKey]);\n        break;\n      case 'alt+p':\n        projectMenuRef.current?.focus();\n        simulateKeyPress(projectMenuRef, [escKey, spaceKey]);\n        break;\n      case 'alt+l':\n        windowMenuRef.current?.focus();\n        simulateKeyPress(windowMenuRef, [escKey, spaceKey]);\n        break;\n      case 'alt+n':\n        layoutMenuRef.current?.focus();\n        simulateKeyPress(layoutMenuRef, [escKey, spaceKey]);\n        break;\n      case 'alt+h':\n        helpMenuRef.current?.focus();\n        simulateKeyPress(helpMenuRef, [escKey, spaceKey]);\n        break;\n      default:\n        break;\n    }\n  });\n\n  useEffect(() => {\n    if (!onOpenChange || !menubarRef.current) return;\n\n    const observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        if (mutation.attributeName === 'data-state' && mutation.target instanceof HTMLElement) {\n          const state = mutation.target.getAttribute('data-state');\n\n          if (state === 'open') {\n            onOpenChange(true);\n          } else {\n            onOpenChange(false);\n          }\n        }\n      });\n    });\n\n    const menubarElement = menubarRef.current;\n    const dataStateAttributes = menubarElement.querySelectorAll('[data-state]');\n\n    dataStateAttributes.forEach((element) => {\n      observer.observe(element, { attributes: true });\n    });\n\n    return () => observer.disconnect();\n  }, [onOpenChange]);\n\n  if (!menuData) return undefined;\n\n  return (\n    <Menubar ref={menubarRef} className=\"pr-twp tw-border-0 tw-bg-transparent\" variant={variant}>\n      {Object.entries(menuData.columns)\n        .filter(([, column]) => typeof column === 'object')\n        .sort(([, a], [, b]) => {\n          if (typeof a === 'boolean' || typeof b === 'boolean') return 0;\n          return a.order - b.order;\n        })\n        .map(([columnKey, column]) => (\n          <MenubarMenu key={columnKey}>\n            <MenubarTrigger ref={getRefForColumn(columnKey)}>\n              {typeof column === 'object' && 'label' in column && column.label}\n            </MenubarTrigger>\n            <MenubarContent\n              className=\"tw-z-[250]\" // Need to get over the floating web view z-index 200\n            >\n              <TooltipProvider>\n                {getMenubarContent(menuData.groups, menuData.items, columnKey, onSelectMenuItem)}\n              </TooltipProvider>\n            </MenubarContent>\n          </MenubarMenu>\n        ))}\n    </Menubar>\n  );\n}\n\nexport default PlatformMenubar;\n","import {\n  SelectMenuItemHandler,\n  PlatformMenubar,\n} from '@/components/advanced/menus/platform-menubar.component';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Localized, MultiColumnMenu } from 'platform-bible-utils';\nimport { PropsWithChildren, ReactNode, useRef } from 'react';\n\nexport type ToolbarProps = PropsWithChildren<{\n  /** The handler to use for menu commands (and eventually toolbar commands). */\n  onSelectMenuItem: SelectMenuItemHandler;\n\n  /**\n   * Menu data that is used to populate the Menubar component. If empty object, no menus will be\n   * shown on the App Menubar\n   */\n  menuData?: Localized<MultiColumnMenu>;\n\n  /**\n   * Optional callback function that is executed whenever a menu on the App Menubar is opened or\n   * closed. Helpful for handling updates to the menu, as changing menu data when the menu is opened\n   * is not desirable.\n   */\n  onOpenChange?: (isOpen: boolean) => void;\n\n  /** Optional unique identifier */\n  id?: string;\n\n  /** Additional css classes to help with unique styling of the toolbar */\n  className?: string;\n\n  /**\n   * Whether the toolbar should be used as a draggable area for moving the application. This will\n   * add an electron specific style `WebkitAppRegion: 'drag'` to the toolbar in order to make it\n   * draggable. See:\n   * https://www.electronjs.org/docs/latest/tutorial/custom-title-bar#create-a-custom-title-bar\n   */\n  shouldUseAsAppDragArea?: boolean;\n\n  /** Toolbar children to be put at the start of the toolbar (left side in ltr, right side in rtl) */\n  appMenuAreaChildren?: ReactNode;\n\n  /** Toolbar children to be put at the end of the toolbar (right side in ltr, left side in rtl) */\n  configAreaChildren?: ReactNode;\n\n  /** Variant of the menubar */\n  menubarVariant?: 'default' | 'muted';\n}>;\n\n/**\n * Get tailwind class for reserved space for the window controls / macos \"traffic lights\". Passing\n * 'darwin' will reserve the necessary space for macos traffic lights at the start, otherwise a\n * different amount of space at the end for the window controls.\n *\n * Apply to the toolbar like: `<Toolbar className={cn('tw-h-8 tw-bg-background',\n * getToolbarOSReservedSpaceClassName('darwin'))}>` or `<Toolbar\n * className={getToolbarOSReservedSpaceClassName('linux')}>`\n *\n * @param operatingSystem The os platform: 'darwin' (macos) | anything else\n * @returns The class name to apply to the toolbar if os specific space should be reserved\n */\nexport function getToolbarOSReservedSpaceClassName(\n  operatingSystem: string | undefined,\n): string | undefined {\n  switch (operatingSystem) {\n    case undefined:\n      return undefined;\n    case 'darwin':\n      return 'tw-ps-[85px]';\n    default:\n      return 'tw-pe-[calc(138px+1rem)]';\n  }\n}\n\n/**\n * A customizable toolbar component with a menubar, content area, and configure area.\n *\n * This component is designed to be used in the window title bar of an electron application.\n *\n * @param {ToolbarProps} props - The props for the component.\n */\nexport function Toolbar({\n  menuData,\n  onOpenChange,\n  onSelectMenuItem,\n  className,\n  id,\n  children,\n  appMenuAreaChildren,\n  configAreaChildren,\n  shouldUseAsAppDragArea,\n  menubarVariant = 'default',\n}: ToolbarProps) {\n  // This ref will always be defined\n  // eslint-disable-next-line no-type-assertion/no-type-assertion\n  const containerRef = useRef<HTMLDivElement>(undefined!);\n\n  return (\n    <div\n      className={cn('tw-border tw-px-4 tw-text-foreground', className)}\n      ref={containerRef}\n      style={{ position: 'relative' }}\n      id={id}\n    >\n      <div\n        className=\"tw-flex tw-h-full tw-w-full tw-justify-between tw-overflow-hidden\"\n        /* @ts-ignore Electron-only property */\n        style={shouldUseAsAppDragArea ? { WebkitAppRegion: 'drag' } : undefined}\n      >\n        {/* App Menu area */}\n        <div className=\"tw-flex tw-grow tw-basis-0\">\n          <div\n            className=\"tw-flex tw-items-center tw-gap-2\"\n            /* @ts-ignore Electron-only property */\n            style={shouldUseAsAppDragArea ? { WebkitAppRegion: 'no-drag' } : undefined}\n          >\n            {appMenuAreaChildren}\n\n            {menuData && (\n              <PlatformMenubar\n                menuData={menuData}\n                onOpenChange={onOpenChange}\n                onSelectMenuItem={onSelectMenuItem}\n                variant={menubarVariant}\n              />\n            )}\n          </div>\n        </div>\n\n        {/* Content area */}\n        <div\n          className=\"tw-flex tw-items-center tw-gap-2 tw-px-2\"\n          /* @ts-ignore Electron-only property */\n          style={shouldUseAsAppDragArea ? { WebkitAppRegion: 'no-drag' } : undefined}\n        >\n          {children}\n        </div>\n\n        {/* Configure area */}\n        <div className=\"tw-flex tw-min-w-0 tw-grow tw-basis-0 tw-justify-end\">\n          <div\n            className=\"tw-flex tw-min-w-0 tw-items-center tw-gap-2 tw-pe-1\"\n            /* @ts-ignore Electron-only property */\n            style={shouldUseAsAppDragArea ? { WebkitAppRegion: 'no-drag' } : undefined}\n          >\n            {configAreaChildren}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Toolbar;\n","import { useState } from 'react';\nimport { LocalizedStringValue, formatReplacementString } from 'platform-bible-utils';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '../shadcn-ui/select';\nimport { Label } from '../shadcn-ui/label';\n\n/**\n * Immutable array containing all keys used for localization in this component. If you're using this\n * component in an extension, you can pass it into the useLocalizedStrings hook to easily obtain the\n * localized strings and pass them into the localizedStrings prop of this component\n */\nexport const UI_LANGUAGE_SELECTOR_STRING_KEYS = Object.freeze([\n  '%settings_uiLanguageSelector_fallbackLanguages%',\n] as const);\n\nexport type UiLanguageSelectorLocalizedStrings = {\n  [localizedUiLanguageSelectorKey in (typeof UI_LANGUAGE_SELECTOR_STRING_KEYS)[number]]?: LocalizedStringValue;\n};\n\n/**\n * Gets the localized value for the provided key\n *\n * @param strings Object containing localized string\n * @param key Key for a localized string\n * @returns The localized value for the provided key, if available. Returns the key if no localized\n *   value is available\n */\nconst localizeString = (\n  strings: UiLanguageSelectorLocalizedStrings,\n  key: keyof UiLanguageSelectorLocalizedStrings,\n) => {\n  return strings[key] ?? key;\n};\n\nexport type LanguageInfo = {\n  /** The name of the language to be displayed (in its native script) */\n  autonym: string;\n  /**\n   * The name of the language in other languages, so that the language can also be displayed in the\n   * current UI language, if known.\n   */\n  uiNames?: Record<string, string>;\n  /**\n   * Other known names of the language (for searching). This can include pejorative names and should\n   * never be displayed unless typed by the user.\n   */\n  otherNames?: string[];\n};\n\nexport type UiLanguageSelectorProps = {\n  /** Full set of known languages to display. The keys are valid BCP-47 tags. */\n  knownUiLanguages: Record<string, LanguageInfo>;\n  /** IETF BCP-47 language tag of the current primary UI language. `undefined` => 'en' */\n  primaryLanguage: string;\n  /**\n   * Ordered list of fallback language tags to use if the localization key can't be found in the\n   * current primary UI language. This list never contains English ('en') because it is the ultimate\n   * fallback.\n   */\n  fallbackLanguages: string[] | undefined;\n  /**\n   * Handler for when either the primary or the fallback languages change (or both). For this\n   * handler, the primary UI language is the first one in the array, followed by the fallback\n   * languages in order of decreasing preference.\n   */\n  onLanguagesChange?: (newUiLanguages: string[]) => void;\n  /** Handler for the primary language changes. */\n  onPrimaryLanguageChange?: (newPrimaryUiLanguage: string) => void;\n  /**\n   * Handler for when the fallback languages change. The array contains the fallback languages in\n   * order of decreasing preference.\n   */\n  onFallbackLanguagesChange?: (newFallbackLanguages: string[]) => void;\n  /**\n   * Map whose keys are localized string keys as contained in UI_LANGUAGE_SELECTOR_STRING_KEYS and\n   * whose values are the localized strings (in the current UI language).\n   */\n  localizedStrings: UiLanguageSelectorLocalizedStrings;\n  /** Additional css classes to help with unique styling of the control */\n  className?: string;\n  /** Optional id for the root element */\n  id?: string;\n};\n\n/**\n * A component for selecting the user interface language and managing fallback languages. Allows\n * users to choose a primary UI language and optionally select fallback languages.\n *\n * @param {UiLanguageSelectorProps} props - The props for the component.\n */\nexport function UiLanguageSelector({\n  knownUiLanguages,\n  primaryLanguage = 'en',\n  fallbackLanguages = [],\n  onLanguagesChange,\n  onPrimaryLanguageChange,\n  onFallbackLanguagesChange,\n  localizedStrings,\n  className,\n  id,\n}: UiLanguageSelectorProps) {\n  const fallbackLanguagesText = localizeString(\n    localizedStrings,\n    '%settings_uiLanguageSelector_fallbackLanguages%',\n  );\n  const [isOpen, setIsOpen] = useState(false);\n\n  const handleLanguageChange = (code: string) => {\n    if (onPrimaryLanguageChange) onPrimaryLanguageChange(code);\n    // REVIEW: Should fallback languages be preserved when primary language changes?\n    if (onLanguagesChange)\n      onLanguagesChange([code, ...fallbackLanguages.filter((lang) => lang !== code)]);\n    if (onFallbackLanguagesChange && fallbackLanguages.find((l) => l === code))\n      onFallbackLanguagesChange([...fallbackLanguages.filter((lang) => lang !== code)]);\n    setIsOpen(false); // Close the dropdown when a selection is made\n  };\n\n  /**\n   * Gets the display name for the given language. This will typically include the autonym (in the\n   * native script), along with the name of the language in the current UI locale if known, with a\n   * fallback to the English name (if known).\n   *\n   * @param {string} lang - The BCP-47 code of the language whose display name is being requested.\n   * @param {string} uiLang - The BCP-47 code of the current user-interface language used used to\n   *   try to look up the name of the language in a form that is likely to be helpful to the user if\n   *   they do not recognize the autonym.\n   * @returns {string} The display name of the language.\n   */\n  const getLanguageDisplayName = (lang: string, uiLang: string) => {\n    const altName =\n      uiLang !== lang\n        ? (knownUiLanguages[lang]?.uiNames?.[uiLang] ?? knownUiLanguages[lang]?.uiNames?.en)\n        : undefined;\n\n    return altName\n      ? `${knownUiLanguages[lang]?.autonym} (${altName})`\n      : knownUiLanguages[lang]?.autonym;\n  };\n\n  return (\n    <div id={id} className={cn('pr-twp tw-max-w-sm', className)}>\n      {/* Language Selector */}\n      <Select\n        name=\"uiLanguage\"\n        value={primaryLanguage}\n        onValueChange={handleLanguageChange}\n        open={isOpen}\n        onOpenChange={(open) => setIsOpen(open)}\n      >\n        <SelectTrigger>\n          <SelectValue />\n        </SelectTrigger>\n        <SelectContent\n          className=\"tw-z-[250]\" // Need to get over the floating web view z-index 200\n        >\n          {Object.keys(knownUiLanguages).map((key) => {\n            return (\n              <SelectItem key={key} value={key}>\n                {getLanguageDisplayName(key, primaryLanguage)}\n              </SelectItem>\n            );\n          })}\n        </SelectContent>\n      </Select>\n\n      {/* Fallback Language Button */}\n      {primaryLanguage !== 'en' && (\n        <div className=\"tw-pt-3\">\n          <Label className=\"tw-font-normal tw-text-muted-foreground\">\n            {formatReplacementString(fallbackLanguagesText, {\n              fallbackLanguages:\n                fallbackLanguages?.length > 0\n                  ? fallbackLanguages\n                      .map((f) => getLanguageDisplayName(f, primaryLanguage))\n                      .join(', ')\n                  : knownUiLanguages.en.autonym,\n            })}\n          </Label>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default UiLanguageSelector;\n","import { Label } from '@/components/shadcn-ui/label';\nimport { ReactNode } from 'react';\n\ntype SmartLabelProps = {\n  item: string;\n  createLabel?: (item: string) => string;\n  createComplexLabel?: (item: string) => ReactNode;\n};\n\n/** Create labels with text, react elements (e.g. links), or text + react elements */\nfunction SmartLabel({ item, createLabel, createComplexLabel }: SmartLabelProps): ReactNode {\n  if (createLabel) {\n    return <Label>{createLabel(item)}</Label>;\n  }\n  if (createComplexLabel) {\n    return <Label>{createComplexLabel(item)}</Label>;\n  }\n  return <Label>{item}</Label>;\n}\n\nexport default SmartLabel;\n","import { Checkbox } from '@/components/shadcn-ui/checkbox';\nimport { ReactNode } from 'react';\nimport SmartLabel from './smart-label.component';\n\nexport type ChecklistProps = {\n  /** Optional string representing the id attribute of the Checklist */\n  id?: string;\n  /** Optional string representing CSS class name(s) for styling */\n  className?: string;\n  /** Array of strings representing the checkable items */\n  listItems: string[];\n  /** Array of strings representing the checked items */\n  selectedListItems: string[];\n  /**\n   * Function that is called when a checkbox item is selected or deselected\n   *\n   * @param item The string description for this item\n   * @param selected True if selected, false if not selected\n   */\n  handleSelectListItem: (item: string, selected: boolean) => void;\n\n  /**\n   * Optional function creates a label for a provided checkable item\n   *\n   * @param item The item for which a label is to be created\n   * @returns A string representing the label text for the checkbox associated with that item\n   */\n  createLabel?: (item: string) => string;\n\n  /**\n   * Optional function creates a label for a provided checkable item\n   *\n   * @param item The item for which a label is to be created, including text and any additional\n   *   elements (e.g. links)\n   * @returns A react node representing the label text and any additional elements (e.g. links) for\n   *   the checkbox associated with that item\n   */\n  createComplexLabel?: (item: string) => ReactNode;\n};\n\n/** Renders a list of checkboxes. Each checkbox corresponds to an item from the `listItems` array. */\nexport function Checklist({\n  id,\n  className,\n  listItems,\n  selectedListItems,\n  handleSelectListItem,\n  createLabel,\n  createComplexLabel,\n}: ChecklistProps) {\n  return (\n    <div id={id} className={className}>\n      {listItems.map((item) => (\n        <div key={item} className=\"tw-m-2 tw-flex tw-items-center\">\n          <Checkbox\n            className=\"tw-me-2 tw-align-middle\"\n            checked={selectedListItems.includes(item)}\n            onCheckedChange={(value: boolean) => handleSelectListItem(item, value)}\n          />\n          <SmartLabel\n            item={item}\n            createLabel={createLabel}\n            createComplexLabel={createComplexLabel}\n          />\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default Checklist;\n","import { cn } from '@/utils/shadcn-ui.util';\nimport { MoreHorizontal } from 'lucide-react';\nimport React, { ReactNode } from 'react';\nimport { Button } from '../shadcn-ui/button';\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuTrigger } from '../shadcn-ui/dropdown-menu';\n\n/** Props interface for the ResultsCard base component */\nexport interface ResultsCardProps {\n  /** Unique key for the card */\n  cardKey: string;\n  /** Whether this card is currently selected/focused */\n  isSelected: boolean;\n  /** Callback function called when the card is clicked */\n  onSelect: () => void;\n  /** Whether the content of this card are in a denied state */\n  isDenied?: boolean;\n  /** Whether the card should be hidden */\n  isHidden?: boolean;\n  /** Additional CSS classes to apply to the card */\n  className?: string;\n  /** Main content to display on the card */\n  children: ReactNode;\n  /** Content to show in the dropdown menu when selected */\n  dropdownContent?: ReactNode;\n  /** Additional content to show below the main content when selected */\n  additionalSelectedContent?: ReactNode;\n  /** Color to use for the card's accent border */\n  accentColor?: string;\n}\n\n/**\n * ResultsCard is a base component for displaying scripture-related results in a card format, even\n * though it is not based on the Card component. It provides common functionality like selection\n * state, dropdown menus, and expandable content.\n */\nexport function ResultsCard({\n  cardKey,\n  isSelected,\n  onSelect,\n  isDenied,\n  isHidden = false,\n  className,\n  children,\n  dropdownContent,\n  additionalSelectedContent,\n  accentColor,\n}: ResultsCardProps) {\n  const handleKeyDown = (event: React.KeyboardEvent) => {\n    if (event.key === 'Enter' || event.key === ' ') {\n      event.preventDefault();\n      onSelect();\n    }\n  };\n\n  return (\n    <div\n      hidden={isHidden}\n      key={cardKey}\n      onClick={onSelect}\n      onKeyDown={handleKeyDown}\n      role=\"button\"\n      tabIndex={0}\n      aria-pressed={isSelected}\n      className={cn(\n        'tw-relative tw-min-w-36 tw-rounded-xl tw-border tw-shadow-none hover:tw-bg-muted/50',\n        { 'tw-opacity-50 hover:tw-opacity-100': isDenied && !isSelected },\n        { 'tw-bg-accent': isSelected },\n        { 'tw-bg-transparent': !isSelected },\n        className,\n      )}\n    >\n      <div className=\"tw-flex tw-flex-col tw-gap-2 tw-p-4\">\n        <div className=\"tw-flex tw-justify-between tw-overflow-hidden\">\n          <div className=\"tw-min-w-0 tw-flex-1\">{children}</div>\n          {isSelected && dropdownContent && (\n            <DropdownMenu>\n              <DropdownMenuTrigger className={cn(accentColor && 'tw-me-1')} asChild>\n                <Button className=\"tw-m-1 tw-h-6 tw-w-6\" variant=\"ghost\" size=\"icon\">\n                  <MoreHorizontal />\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\">{dropdownContent}</DropdownMenuContent>\n            </DropdownMenu>\n          )}\n        </div>\n        {isSelected && additionalSelectedContent && (\n          <div className=\"tw-w-fit tw-min-w-0 tw-max-w-full tw-overflow-hidden\">\n            {additionalSelectedContent}\n          </div>\n        )}\n      </div>\n      {accentColor && (\n        <div\n          className={`tw-absolute tw-right-0 tw-top-0 tw-h-full tw-w-2 tw-rounded-r-xl ${accentColor}`}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default ResultsCard;\n","import { cn } from '@/utils/shadcn-ui.util';\nimport { LoaderCircle, LucideProps } from 'lucide-react';\nimport { forwardRef } from 'react';\n\nexport type SpinnerProps = LucideProps;\n\n/**\n * A spinner component that uses the LoaderCircle icon from lucide-react to indicate loading states.\n * The spinner rotates to indicate that a process is ongoing.\n */\nexport const Spinner = forwardRef<SVGSVGElement, SpinnerProps>(({ className, ...props }, ref) => {\n  return (\n    <LoaderCircle size={35} className={cn('tw-animate-spin', className)} {...props} ref={ref} />\n  );\n});\n\nSpinner.displayName = 'Spinner';\n\nexport default Spinner;\n","import { Input as ShadInput } from '@/components/shadcn-ui/input';\nimport { Label as ShadLabel } from '@/components/shadcn-ui/label';\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { ChangeEventHandler, FocusEventHandler } from 'react';\n\nexport type TextFieldProps = {\n  /** Optional unique identifier */\n  id?: string;\n  /**\n   * If `true`, the component is disabled.\n   *\n   * @default false\n   */\n  isDisabled?: boolean;\n  /**\n   * If `true`, the label is displayed in an error state.\n   *\n   * @default false\n   */\n  hasError?: boolean;\n  /**\n   * If `true`, the input will take up the full width of its container.\n   *\n   * @default false\n   */\n  isFullWidth?: boolean;\n  /** Text that gives the user instructions on what contents the TextField expects */\n  helperText?: string;\n  /** The title of the TextField */\n  label?: string;\n  /** The short hint displayed in the `input` before the user enters a value. */\n  placeholder?: string;\n  /**\n   * If `true`, the label is displayed as required and the `input` element is required.\n   *\n   * @default false\n   */\n  isRequired?: boolean;\n  /** Additional css classes to help with unique styling of the text field */\n  className?: string;\n  /** Starting value for the text field if it is not controlled */\n  defaultValue?: string | number;\n  /** Value of the text field if controlled */\n  value?: string | number;\n  /** Triggers when content of textfield is changed */\n  onChange?: ChangeEventHandler<HTMLInputElement>;\n  /** Triggers when textfield gets focus */\n  onFocus?: FocusEventHandler<HTMLInputElement>;\n  /** Triggers when textfield loses focus */\n  onBlur?: FocusEventHandler<HTMLInputElement>;\n};\n\n/**\n * Text input field\n *\n * Thanks to Shadcn for heavy inspiration and documentation\n * https://ui.shadcn.com/docs/components/input#with-label\n */\nexport function TextField({\n  id,\n  isDisabled = false,\n  hasError = false,\n  isFullWidth = false,\n  helperText,\n  label,\n  placeholder,\n  isRequired = false,\n  className,\n  defaultValue,\n  value,\n  onChange,\n  onFocus,\n  onBlur,\n}: TextFieldProps) {\n  return (\n    <div className={cn('tw-inline-grid tw-items-center tw-gap-1.5', { 'tw-w-full': isFullWidth })}>\n      <ShadLabel\n        htmlFor={id}\n        className={cn({\n          'tw-text-red-600': hasError,\n          'tw-hidden': !label,\n        })}\n      >{`${label}${isRequired ? '*' : ''}`}</ShadLabel>\n      <ShadInput\n        id={id}\n        disabled={isDisabled}\n        placeholder={placeholder}\n        required={isRequired}\n        className={cn(className, { 'tw-border-red-600': hasError })}\n        defaultValue={defaultValue}\n        value={value}\n        onChange={onChange}\n        onFocus={onFocus}\n        onBlur={onBlur}\n      />\n      <p className={cn({ 'tw-hidden': !helperText })}>{helperText}</p>\n    </div>\n  );\n}\n\nexport default TextField;\n","import React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\nconst alertVariants = cva(\n  // CUSTOM: Copied all `svg` arbitrary selector variant classes as `img` variants so we can use\n  // images (or svgs from file) as icons\n  // Implemented by TJ Couch\n  // Approved by Alex Mercado\n  // 20 February 2025\n  'tw-relative tw-w-full tw-rounded-lg tw-border tw-p-4 [&>svg~*]:tw-pl-7 [&>svg+div]:tw-translate-y-[-3px] [&>svg]:tw-absolute [&>svg]:tw-left-4 [&>svg]:tw-top-4 [&>svg]:tw-text-foreground [&>img~*]:tw-pl-7 [&>img+div]:tw-translate-y-[-3px] [&>img]:tw-absolute [&>img]:tw-left-4 [&>img]:tw-top-4 [&>img]:tw-text-foreground',\n  {\n    variants: {\n      variant: {\n        default: 'tw-bg-background tw-text-foreground',\n        destructive:\n          // CUSTOM: Copied all `svg` arbitrary selector variant classes as `img` variants so we can\n          // use images (or svgs from file) as icons\n          // Implemented by TJ Couch\n          // Approved by Alex Mercado\n          // 20 February 2025\n          'tw-border-destructive/50 tw-text-destructive dark:tw-border-destructive [&>svg]:tw-text-destructive [&>img]:tw-text-destructive',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  },\n);\n\n/**\n * The Alert displays a callout for user attention. The component is built and styled by Shadcn UI.\n * See Shadcn UI Documentation https://ui.shadcn.com/docs/components/alert\n */\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(\n      // CUSTOM\n      'pr-twp',\n      alertVariants({ variant }),\n      className,\n    )}\n    {...props}\n  />\n));\nAlert.displayName = 'Alert';\n\n/** @inheritdoc Alert */\nconst AlertTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(\n  ({ className, ...props }, ref) => (\n    <h5\n      ref={ref}\n      className={cn('tw-mb-1 tw-font-medium tw-leading-none tw-tracking-tight', className)}\n      {...props}\n    >\n      {/* added because of https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/main/docs/rules/heading-has-content.md  */}\n      {props.children}{' '}\n    </h5>\n  ),\n);\nAlertTitle.displayName = 'AlertTitle';\n\n/** @inheritdoc Alert */\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn('tw-text-sm [&_p]:tw-leading-relaxed', className)} {...props} />\n));\nAlertDescription.displayName = 'AlertDescription';\n\nexport { Alert, AlertTitle, AlertDescription };\n","import React from 'react';\nimport * as ContextMenuPrimitive from '@radix-ui/react-context-menu';\nimport { Check, ChevronRight, Circle } from 'lucide-react';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Context Menu component displays a menu to the user — such as a set of actions or functions,\n * triggered by a button.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/context-menu}\n * @see Radix UI Documentation: {@link https://www.radix-ui.com/primitives/docs/components/context-menu}\n */\nconst ContextMenu = ContextMenuPrimitive.Root;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuGroup = ContextMenuPrimitive.Group;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuPortal = ContextMenuPrimitive.Portal;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuSub = ContextMenuPrimitive.Sub;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean;\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      'pr-twp tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-px-2 tw-py-1.5 tw-text-sm tw-outline-none focus:tw-bg-accent focus:tw-text-accent-foreground data-[state=open]:tw-bg-accent data-[state=open]:tw-text-accent-foreground',\n      inset && 'tw-pl-8',\n      className,\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"tw-ml-auto tw-h-4 tw-w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n));\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      'pr-twp tw-z-50 tw-min-w-[8rem] tw-origin-[--radix-context-menu-content-transform-origin] tw-overflow-hidden tw-rounded-md tw-border tw-bg-popover tw-p-1 tw-text-popover-foreground tw-shadow-md data-[state=open]:tw-animate-in data-[state=closed]:tw-animate-out data-[state=closed]:tw-fade-out-0 data-[state=open]:tw-fade-in-0 data-[state=closed]:tw-zoom-out-95 data-[state=open]:tw-zoom-in-95 data-[side=bottom]:tw-slide-in-from-top-2 data-[side=left]:tw-slide-in-from-right-2 data-[side=right]:tw-slide-in-from-left-2 data-[side=top]:tw-slide-in-from-bottom-2',\n      className,\n    )}\n    {...props}\n  />\n));\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        'pr-twp tw-z-50 tw-max-h-[--radix-context-menu-content-available-height] tw-min-w-[8rem] tw-origin-[--radix-context-menu-content-transform-origin] tw-overflow-y-auto tw-overflow-x-hidden tw-rounded-md tw-border tw-bg-popover tw-p-1 tw-text-popover-foreground tw-shadow-md tw-animate-in tw-fade-in-80 data-[state=open]:tw-animate-in data-[state=closed]:tw-animate-out data-[state=closed]:tw-fade-out-0 data-[state=open]:tw-fade-in-0 data-[state=closed]:tw-zoom-out-95 data-[state=open]:tw-zoom-in-95 data-[side=bottom]:tw-slide-in-from-top-2 data-[side=left]:tw-slide-in-from-right-2 data-[side=right]:tw-slide-in-from-left-2 data-[side=top]:tw-slide-in-from-bottom-2',\n        className,\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n));\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      'pr-twp tw-relative tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-px-2 tw-py-1.5 tw-text-sm tw-outline-none focus:tw-bg-accent focus:tw-text-accent-foreground data-[disabled]:tw-pointer-events-none data-[disabled]:tw-opacity-50',\n      inset && 'tw-pl-8',\n      className,\n    )}\n    {...props}\n  />\n));\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      'tw-relative tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-py-1.5 tw-pl-8 tw-pr-2 tw-text-sm tw-outline-none focus:tw-bg-accent focus:tw-text-accent-foreground data-[disabled]:tw-pointer-events-none data-[disabled]:tw-opacity-50',\n      className,\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"tw-absolute tw-left-2 tw-flex tw-h-3.5 tw-w-3.5 tw-items-center tw-justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"tw-h-4 tw-w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n));\nContextMenuCheckboxItem.displayName = ContextMenuPrimitive.CheckboxItem.displayName;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      'tw-relative tw-flex tw-cursor-default tw-select-none tw-items-center tw-rounded-sm tw-py-1.5 tw-pl-8 tw-pr-2 tw-text-sm tw-outline-none focus:tw-bg-accent focus:tw-text-accent-foreground data-[disabled]:tw-pointer-events-none data-[disabled]:tw-opacity-50',\n      className,\n    )}\n    {...props}\n  >\n    <span className=\"tw-absolute tw-left-2 tw-flex tw-h-3.5 tw-w-3.5 tw-items-center tw-justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"tw-h-2 tw-w-2 tw-fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n));\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      'tw-px-2 tw-py-1.5 tw-text-sm tw-font-semibold tw-text-foreground',\n      inset && 'tw-pl-8',\n      className,\n    )}\n    {...props}\n  />\n));\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName;\n\n/** @inheritdoc ContextMenu */\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn('tw--mx-1 tw-my-1 tw-h-px tw-bg-border', className)}\n    {...props}\n  />\n));\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName;\n\n/** @inheritdoc ContextMenu */\nfunction ContextMenuShortcut({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) {\n  return (\n    <span\n      className={cn('tw-ml-auto tw-text-xs tw-tracking-widest tw-text-muted-foreground', className)}\n      {...props}\n    />\n  );\n}\nContextMenuShortcut.displayName = 'ContextMenuShortcut';\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n};\n","import React from 'react';\nimport { Drawer as DrawerPrimitive } from 'vaul';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n// CUSTOM: Added context to manage drawer direction\nconst DrawerContext = React.createContext<{\n  direction?: 'top' | 'bottom' | 'left' | 'right';\n}>({\n  direction: 'bottom',\n});\n\n/**\n * A drawer component for React. These components are built on Vaul and styled with Shadcn UI. See\n * Shadcn UI Documentation: https://ui.shadcn.com/docs/components/drawer See Vaul Documentation:\n * https://vaul.emilkowal.ski/getting-started\n */\nfunction Drawer({\n  shouldScaleBackground = true,\n  direction = 'bottom',\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) {\n  // CUSTOM: Use context to provide direction to child components\n  const contextValue = React.useMemo(() => ({ direction }), [direction]);\n  return (\n    <DrawerContext.Provider value={contextValue}>\n      <DrawerPrimitive.Root\n        shouldScaleBackground={shouldScaleBackground}\n        direction={direction}\n        {...props}\n      />\n    </DrawerContext.Provider>\n  );\n}\nDrawer.displayName = 'Drawer';\n\n/** @inheritdoc Drawer */\nconst DrawerTrigger = DrawerPrimitive.Trigger;\n\n/** @inheritdoc Drawer */\nconst DrawerPortal = DrawerPrimitive.Portal;\n\n/** @inheritdoc Drawer */\nconst DrawerClose = DrawerPrimitive.Close;\n\n/** @inheritdoc Drawer */\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn('tw-fixed tw-inset-0 tw-z-50 tw-bg-black/80', className)}\n    {...props}\n  />\n));\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName;\n\n/* CUSTOM: Extend DrawerPrimitive.Content with additional props */\ninterface DrawerContentProps\n  extends React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content> {\n  /** Optionally hide the drawer handle */\n  hideDrawerHandle?: boolean;\n}\n\n/** @inheritdoc Drawer */\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  DrawerContentProps\n>(({ className, children, hideDrawerHandle = false, ...props }, ref) => {\n  // CUSTOM: Use context to provide direction to child components\n  const { direction = 'bottom' } = React.useContext(DrawerContext);\n\n  // CUSTOM: Define positioning and styling based on direction\n  const directionStyles = {\n    bottom: 'tw-inset-x-0 tw-bottom-0 tw-mt-24 tw-rounded-t-[10px]',\n    top: 'tw-inset-x-0 tw-top-0 tw-mb-24 tw-rounded-b-[10px]',\n    left: 'tw-inset-y-0 tw-left-0 tw-mr-24 tw-rounded-r-[10px] tw-w-auto tw-max-w-sm',\n    right: 'tw-inset-y-0 tw-right-0 tw-ml-24 tw-rounded-l-[10px] tw-w-auto tw-max-w-sm',\n  };\n\n  // CUSTOM: Define handle styles for each direction\n  const handleStyles = {\n    bottom: 'tw-mx-auto tw-mt-4 tw-h-2 tw-w-[100px] tw-rounded-full tw-bg-muted',\n    top: 'tw-mx-auto tw-mb-4 tw-h-2 tw-w-[100px] tw-rounded-full tw-bg-muted',\n    left: 'tw-my-auto tw-mr-4 tw-w-2 tw-h-[100px] tw-rounded-full tw-bg-muted',\n    right: 'tw-my-auto tw-ml-4 tw-w-2 tw-h-[100px] tw-rounded-full tw-bg-muted',\n  };\n\n  return (\n    <DrawerPortal>\n      <DrawerOverlay />\n      <DrawerPrimitive.Content\n        ref={ref}\n        className={cn(\n          // CUSTOM: Change Tailwind CSS classes for styling\n          // Removed tw-inset-x-0 tw-bottom-0 tw-mt-24 tw-rounded-t-[10px] tw-flex-col\n          'pr-twp tw-fixed tw-z-50 tw-flex tw-h-auto tw-border tw-bg-background',\n          direction === 'bottom' || direction === 'top' ? 'tw-flex-col' : 'tw-flex-row',\n          directionStyles[direction],\n          className,\n        )}\n        {...props}\n      >\n        {/* CUSTOM: Render handles and children based on direction and if the drawer handle is hidden */}\n        {!hideDrawerHandle && (direction === 'bottom' || direction === 'right') && (\n          <div className={handleStyles[direction]} />\n        )}\n        <div className=\"tw-flex tw-flex-col\">{children}</div>\n        {!hideDrawerHandle && (direction === 'top' || direction === 'left') && (\n          <div className={handleStyles[direction]} />\n        )}\n      </DrawerPrimitive.Content>\n    </DrawerPortal>\n  );\n});\nDrawerContent.displayName = 'DrawerContent';\n\n/** @inheritdoc Drawer */\nfunction DrawerHeader({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn('tw-grid tw-gap-1.5 tw-p-4 tw-text-center sm:tw-text-left', className)}\n      {...props}\n    />\n  );\n}\nDrawerHeader.displayName = 'DrawerHeader';\n\n/** @inheritdoc Drawer */\nfunction DrawerFooter({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div className={cn('tw-mt-auto tw-flex tw-flex-col tw-gap-2 tw-p-4', className)} {...props} />\n  );\n}\nDrawerFooter.displayName = 'DrawerFooter';\n\n/** @inheritdoc Drawer */\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn('tw-text-lg tw-font-semibold tw-leading-none tw-tracking-tight', className)}\n    {...props}\n  />\n));\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName;\n\n/** @inheritdoc Drawer */\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn('tw-text-sm tw-text-muted-foreground', className)}\n    {...props}\n  />\n));\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName;\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n};\n","import React from 'react';\nimport * as ProgressPrimitive from '@radix-ui/react-progress';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Displays an indicator showing the completion progress of a task, typically displayed as a\n * progress bar. This component is built on Radix UI primitives and styled with Shadcn UI. See\n * Shadcn UI documentation: https://ui.shadcn.com/docs/components/progress See Radix UI\n * documentation: https://www.radix-ui.com/primitives/docs/components/progress#api-reference\n */\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      'pr-twp tw-relative tw-h-4 tw-w-full tw-overflow-hidden tw-rounded-full tw-bg-secondary',\n      className,\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"tw-h-full tw-w-full tw-flex-1 tw-bg-primary tw-transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n));\nProgress.displayName = ProgressPrimitive.Root.displayName;\n\nexport { Progress };\n","import React from 'react';\nimport { GripVertical } from 'lucide-react';\nimport * as ResizablePrimitive from 'react-resizable-panels';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Accessible resizable panel groups and layouts with keyboard support. This component is built on\n * react-resizable-panels and styled with Shadcn UI. See Shadcn UI documentation:\n * https://ui.shadcn.com/docs/components/resizable See react-resizable-panels documentation:\n * https://github.com/bvaughn/react-resizable-panels/tree/main/packages/react-resizable-panels\n */\nfunction ResizablePanelGroup({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) {\n  return (\n    <ResizablePrimitive.PanelGroup\n      className={cn(\n        'tw-flex tw-h-full tw-w-full data-[panel-group-direction=vertical]:tw-flex-col',\n        className,\n      )}\n      {...props}\n    />\n  );\n}\n\n/** @inheritdoc ResizablePanelGroup */\nconst ResizablePanel = ResizablePrimitive.Panel;\n\n/** @inheritdoc ResizablePanelGroup */\nfunction ResizableHandle({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean;\n}) {\n  return (\n    <ResizablePrimitive.PanelResizeHandle\n      className={cn(\n        'tw-relative tw-flex tw-w-px tw-items-center tw-justify-center tw-bg-border after:tw-absolute after:tw-inset-y-0 after:tw-left-1/2 after:tw-w-1 after:tw--translate-x-1/2 focus-visible:tw-outline-none focus-visible:tw-ring-1 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-1 data-[panel-group-direction=vertical]:tw-h-px data-[panel-group-direction=vertical]:tw-w-full data-[panel-group-direction=vertical]:after:tw-left-0 data-[panel-group-direction=vertical]:after:tw-h-1 data-[panel-group-direction=vertical]:after:tw-w-full data-[panel-group-direction=vertical]:after:tw--translate-y-1/2 data-[panel-group-direction=vertical]:after:tw-translate-x-0 [&[data-panel-group-direction=vertical]>div]:tw-rotate-90',\n        className,\n      )}\n      {...props}\n    >\n      {withHandle && (\n        <div className=\"tw-z-10 tw-flex tw-h-4 tw-w-3 tw-items-center tw-justify-center tw-rounded-sm tw-border tw-bg-border\">\n          <GripVertical className=\"tw-h-2.5 tw-w-2.5\" />\n        </div>\n      )}\n    </ResizablePrimitive.PanelResizeHandle>\n  );\n}\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle };\n","import { ComponentProps } from 'react';\nimport { toast as sonner, Toaster } from 'sonner';\n\n/**\n * Props for Sonner component.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/sonner}\n * @see Sonner Documentation: {@link https://sonner.emilkowal.ski}\n */\ntype SonnerProps = ComponentProps<typeof Toaster>;\n\n/**\n * The Sonner component is an opinionated toast component for React. It is built on Sonner and\n * styled with Shadcn UI.\n *\n * @param SonnerProps\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/sonner}\n * @see Sonner Documentation: {@link https://sonner.emilkowal.ski}\n */\nfunction Sonner({ ...props }: SonnerProps) {\n  return (\n    <Toaster\n      className=\"tw-toaster tw-group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            'group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg',\n          description: 'group-[.toast]:text-muted-foreground',\n          actionButton: 'group-[.toast]:bg-primary group-[.toast]:text-primary-foreground',\n          cancelButton: 'group-[.toast]:bg-muted group-[.toast]:text-muted-foreground',\n        },\n      }}\n      {...props}\n    />\n  );\n}\n\n// The re-export of the sonner function was added manually\nexport { Sonner, sonner };\n","import React from 'react';\nimport * as SliderPrimitive from '@radix-ui/react-slider';\n\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\n\n/**\n * The Slider component is an input where the user selects a value from within a given range. This\n * component is built on Radix UI primitives and styled with Shadcn UI.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/slider}\n * @see Radix UI Documentation: {@link https://www.radix-ui.com/primitives/docs/components/slider}\n */\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <SliderPrimitive.Root\n      ref={ref}\n      className={cn(\n        'pr-twp tw-relative tw-flex tw-w-full tw-touch-none tw-select-none tw-items-center',\n        className,\n      )}\n      {...props}\n      dir={dir}\n    >\n      <SliderPrimitive.Track className=\"tw-relative tw-h-2 tw-w-full tw-grow tw-overflow-hidden tw-rounded-full tw-bg-secondary\">\n        <SliderPrimitive.Range className=\"tw-absolute tw-h-full tw-bg-primary\" />\n      </SliderPrimitive.Track>\n      <SliderPrimitive.Thumb className=\"tw-block tw-h-5 tw-w-5 tw-rounded-full tw-border-2 tw-border-primary tw-bg-background tw-ring-offset-background tw-transition-colors focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2 disabled:tw-pointer-events-none disabled:tw-opacity-50\" />\n    </SliderPrimitive.Root>\n  );\n});\nSlider.displayName = SliderPrimitive.Root.displayName;\n\nexport { Slider };\n","import * as SwitchPrimitives from '@radix-ui/react-switch';\nimport React from 'react';\n\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\n\n/**\n * The Switch component is a control that allows the user to toggle between checked and not checked.\n * This component is built on Radix UI primitives and styled with Shadcn UI.\n *\n * @see Shadcn UI Documentation: {@link https://ui.shadcn.com/docs/components/switch}\n * @see Radix UI Documentation: {@link https://www.radix-ui.com/primitives/docs/components/switch}\n */\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <SwitchPrimitives.Root\n      className={cn(\n        'tw-peer pr-twp tw-inline-flex tw-h-6 tw-w-11 tw-shrink-0 tw-cursor-pointer tw-items-center tw-rounded-full tw-border-2 tw-border-transparent tw-transition-colors focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2 focus-visible:tw-ring-offset-background disabled:tw-cursor-not-allowed disabled:tw-opacity-50 data-[state=checked]:tw-bg-primary data-[state=unchecked]:tw-bg-input',\n        className,\n      )}\n      {...props}\n      ref={ref}\n    >\n      <SwitchPrimitives.Thumb\n        className={cn(\n          'pr-twp tw-pointer-events-none tw-block tw-h-5 tw-w-5 tw-rounded-full tw-bg-background tw-shadow-lg tw-ring-0 tw-transition-transform',\n          {\n            'data-[state=checked]:tw-translate-x-5 data-[state=unchecked]:tw-translate-x-0':\n              dir === 'ltr',\n          },\n          {\n            'data-[state=checked]:tw-translate-x-[-20px] data-[state=unchecked]:tw-translate-x-0':\n              dir === 'rtl',\n          },\n        )}\n      />\n    </SwitchPrimitives.Root>\n  );\n});\nSwitch.displayName = SwitchPrimitives.Root.displayName;\n\nexport { Switch };\n","import React from 'react';\nimport * as TabsPrimitive from '@radix-ui/react-tabs';\n\nimport { cn } from '@/utils/shadcn-ui.util';\nimport { Direction, readDirection } from '@/utils/dir-helper.util';\n\n/**\n * Tabs components provide a set of layered sections of content—known as tab panels–that are\n * displayed one at a time. These components are built on Radix UI primitives and styled with Shadcn\n * UI. See Shadcn UI Documentation: https://ui.shadcn.com/docs/components/tabs See Radix UI\n * Documentation: https://www.radix-ui.com/primitives/docs/components/tabs\n */\nexport const Tabs = TabsPrimitive.Root;\n\n/** @inheritdoc Tabs */\nexport type TabsListProps = React.ComponentPropsWithoutRef<typeof TabsPrimitive.List> & {\n  className?: string;\n};\n\n/** @inheritdoc Tabs */\nexport type TabsTriggerProps = React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger> & {\n  className?: string;\n};\n\n/** @inheritdoc Tabs */\nexport type TabsContentProps = React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content> & {\n  className?: string;\n};\n\n/** @inheritdoc Tabs */\nexport const TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  TabsListProps\n>(({ className, ...props }, ref) => {\n  const dir: Direction = readDirection();\n  return (\n    <TabsPrimitive.List\n      ref={ref}\n      className={cn(\n        'pr-twp tw-inline-flex tw-h-10 tw-items-center tw-justify-center tw-rounded-md tw-bg-muted tw-p-1 tw-text-muted-foreground',\n        className,\n      )}\n      {...props}\n      dir={dir}\n    />\n  );\n});\nTabsList.displayName = TabsPrimitive.List.displayName;\n\n/** @inheritdoc Tabs */\nexport const TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  TabsTriggerProps\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      'pr-twp tw-inline-flex tw-items-center tw-justify-center tw-whitespace-nowrap tw-rounded-sm tw-px-3 tw-py-1.5 tw-text-sm tw-font-medium tw-ring-offset-background tw-transition-all hover:tw-text-foreground focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2 disabled:tw-pointer-events-none disabled:tw-opacity-50 data-[state=active]:tw-bg-background data-[state=active]:tw-text-foreground data-[state=active]:tw-shadow-sm',\n      className,\n    )}\n    {...props}\n  />\n));\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName;\n\n/** @inheritdoc Tabs */\nexport const TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  TabsContentProps\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      'pr-twp tw-mt-2 tw-ring-offset-background focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2',\n      className,\n    )}\n    {...props}\n  />\n));\nTabsContent.displayName = TabsPrimitive.Content.displayName;\n","import React from 'react';\n\nimport { cn } from '@/utils/shadcn-ui.util';\n\n/**\n * Displays a form textarea or a component that looks like a textarea. This component is from Shadcn\n * UI. See Shadcn UI documentation: https://ui.shadcn.com/docs/components/textarea\n */\nconst Textarea = React.forwardRef<HTMLTextAreaElement, React.ComponentProps<'textarea'>>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          'pr-twp tw-flex tw-min-h-[80px] tw-w-full tw-rounded-md tw-border tw-border-input tw-bg-background tw-px-3 tw-py-2 tw-text-base tw-ring-offset-background placeholder:tw-text-muted-foreground focus-visible:tw-outline-none focus-visible:tw-ring-2 focus-visible:tw-ring-ring focus-visible:tw-ring-offset-2 disabled:tw-cursor-not-allowed disabled:tw-opacity-50 md:tw-text-sm',\n          className,\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  },\n);\nTextarea.displayName = 'Textarea';\n\nexport { Textarea };\n","import { PlatformEvent, PlatformEventHandler } from 'platform-bible-utils';\nimport { useEffect } from 'react';\n\n/**\n * Adds an event handler to an event so the event handler runs when the event is emitted. Use\n * `papi.network.getNetworkEvent` to use a networked event with this hook.\n *\n * @param event The event to subscribe to.\n *\n *   - If event is a `PlatformEvent`, that event will be used\n *   - If event is undefined, the callback will not be subscribed. Useful if the event is not yet\n *       available for example\n *\n * @param eventHandler The callback to run when the event is emitted\n *\n *   WARNING: MUST BE STABLE - const or wrapped in useCallback. The reference must not be updated\n *   every render\n */\nexport const useEvent = <T>(\n  event: PlatformEvent<T> | undefined,\n  eventHandler: PlatformEventHandler<T>,\n) => {\n  useEffect(() => {\n    // Do nothing if the event is not provided (in case the event is not yet available, for example)\n    if (!event) return () => {};\n\n    const unsubscriber = event(eventHandler);\n    return () => {\n      unsubscriber();\n    };\n  }, [event, eventHandler]);\n};\nexport default useEvent;\n","import { useEffect, useRef, useState } from 'react';\n\nexport type UsePromiseOptions = {\n  /**\n   * Whether to leave the value as the most recent resolved promise value or set it back to\n   * defaultValue while running the promise again. Defaults to true\n   */\n  preserveValue?: boolean;\n};\n\n/** Set up defaults for options for usePromise hook */\nfunction getUsePromiseOptionsDefaults(options: UsePromiseOptions): UsePromiseOptions {\n  return {\n    preserveValue: true,\n    ...options,\n  };\n}\n\n/**\n * Awaits a promise and returns a loading value while the promise is unresolved\n *\n * @param promiseFactoryCallback A function that returns the promise to await. If this callback is\n *   undefined, the current value will be returned (defaultValue unless it was previously changed\n *   and `options.preserveValue` is true), and there will be no loading.\n *\n *   WARNING: MUST BE STABLE - const or wrapped in useCallback. The reference must not be updated\n *   every render\n * @param defaultValue The initial value to return while first awaiting the promise. If\n *   `options.preserveValue` is false, this value is also shown while awaiting the promise on\n *   subsequent calls.\n *\n *   Note: this parameter is internally assigned to a `ref`, so changing it will not cause any hooks\n *   to re-run with its new value. This means that, if the `promiseFactoryCallback` changes and\n *   `options.preserveValue` is `false`, the returned value will be set to the current\n *   `defaultValue`. However, the returned value will not be updated if`defaultValue` changes.\n * @param options Various options for adjusting how this hook runs the `promiseFactoryCallback`\n *\n *   Note: this parameter is internally assigned to a `ref`, so changing it will not cause any hooks\n *   to re-run with its new value. However, the latest `options.preserveValue` will always be used\n *   appropriately to determine whether to preserve the returned value when changing the\n *   `promiseFactoryCallback`\n * @returns `[value, isLoading]`\n *\n *   - `value`: the current value for the promise, either the defaultValue or the resolved promise value\n *   - `isLoading`: whether the promise is waiting to be resolved\n */\nexport const usePromise = <T>(\n  promiseFactoryCallback: (() => Promise<T>) | undefined,\n  defaultValue: T,\n  options: UsePromiseOptions = {},\n): [value: T, isLoading: boolean] => {\n  // Use defaultValue as a ref so it doesn't update dependency arrays\n  const defaultValueRef = useRef(defaultValue);\n  defaultValueRef.current = defaultValue;\n  // Use options as a ref so it doesn't update dependency arrays\n  const optionsDefaultedRef = useRef(options);\n  optionsDefaultedRef.current = getUsePromiseOptionsDefaults(optionsDefaultedRef.current);\n\n  const [value, setValue] = useState<T>(() => defaultValueRef.current);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  useEffect(() => {\n    let promiseIsCurrent = true;\n    // If a promiseFactoryCallback was provided, we are loading. Otherwise, there is no loading to do\n    setIsLoading(!!promiseFactoryCallback);\n    (async () => {\n      // If there is a callback to run, run it\n      if (promiseFactoryCallback) {\n        const result = await promiseFactoryCallback();\n        // If the promise was not already replaced, update the value\n        if (promiseIsCurrent) {\n          setValue(() => result);\n          setIsLoading(false);\n        }\n      }\n    })();\n\n    return () => {\n      // Mark this promise as old and not to be used\n      promiseIsCurrent = false;\n      if (!optionsDefaultedRef.current.preserveValue) setValue(() => defaultValueRef.current);\n    };\n  }, [promiseFactoryCallback]);\n\n  return [value, isLoading];\n};\nexport default usePromise;\n","import { useCallback, useEffect } from 'react';\nimport { PlatformEvent, PlatformEventAsync, PlatformEventHandler } from 'platform-bible-utils';\nimport { usePromise } from './use-promise.hook';\n\nconst noopUnsubscriber = () => false;\n\n/**\n * Adds an event handler to an asynchronously subscribing/unsubscribing event so the event handler\n * runs when the event is emitted. Use `papi.network.getNetworkEvent` to use a networked event with\n * this hook.\n *\n * @param event The asynchronously (un)subscribing event to subscribe to.\n *\n *   - If event is a `PlatformEvent` or `PlatformEventAsync`, that event will be used\n *   - If event is undefined, the callback will not be subscribed. Useful if the event is not yet\n *       available for example\n *\n * @param eventHandler The callback to run when the event is emitted\n *\n *   WARNING: MUST BE STABLE - const or wrapped in useCallback. The reference must not be updated\n *   every render\n */\nexport const useEventAsync = <T>(\n  event: PlatformEvent<T> | PlatformEventAsync<T> | undefined,\n  eventHandler: PlatformEventHandler<T>,\n) => {\n  // Subscribe to the event asynchronously\n  const [unsubscribe] = usePromise(\n    useCallback(async () => {\n      // Do nothing if the event is not provided (in case the event is not yet available, for example)\n      if (!event) return noopUnsubscriber;\n\n      // Wrap subscribe and unsubscribe in promises to allow normal events to be used as well\n      const unsub = await Promise.resolve(event(eventHandler));\n      return async () => unsub();\n    }, [eventHandler, event]),\n    noopUnsubscriber,\n    // We want the unsubscriber to return to default value immediately upon changing subscription\n    // So the useEffect below will unsubscribe asap\n    { preserveValue: false },\n  );\n\n  // Unsubscribe from the event asynchronously (but we aren't awaiting the unsub)\n  useEffect(() => {\n    return () => {\n      if (unsubscribe !== noopUnsubscriber) {\n        unsubscribe();\n      }\n    };\n  }, [unsubscribe]);\n};\n\nexport default useEventAsync;\n","import { useEffect } from 'react';\n\n/**\n * Adds a CSS stylesheet to the current document in a\n * [`style`](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/style) element\n *\n * @param stylesheet The CSS stylesheet to apply to the current document. If `undefined`, this hook\n *   does nothing.\n */\nexport function useStylesheet(stylesheet: string | undefined) {\n  useEffect(() => {\n    let styleElement: HTMLStyleElement;\n\n    if (stylesheet) {\n      // Add styles to document\n      styleElement = document.createElement('style');\n      styleElement.appendChild(document.createTextNode(stylesheet));\n      document.head.appendChild(styleElement);\n    }\n\n    return () => {\n      if (styleElement) {\n        // Remove styles\n        document.head.removeChild(styleElement);\n      }\n    };\n  }, [stylesheet]);\n}\n"],"names":["twMergeCustom","extendTailwindMerge","cn","inputs","clsx","STORAGE_KEY","readDirection","retrieved","Dialog","DialogPrimitive","DialogPortal","DialogOverlay","React","className","props","ref","jsx","DialogContent","children","dir","jsxs","X","DialogHeader","DialogTitle","DialogDescription","Command","CommandPrimitive","CommandInput","Search","CommandList","CommandEmpty","CommandGroup","CommandSeparator","CommandItem","CommandShortcut","getSectionLongName","section","otLongName","ntLongName","dcLongName","extraLongName","Section","getSectionShortName","otShortName","ntShortName","dcShortName","extraShortName","getLocalizedBookName","bookId","localizedBookNames","_a","Canon","getLocalizedBookId","ALL_BOOK_IDS","ALL_ENGLISH_BOOK_NAMES","doesBookMatchQuery","query","normalizedQuery","englishName","localizedBook","includes","BookItem","forwardRef","isSelected","onSelect","onMouseDown","showCheck","commandValue","isMouseClick","useRef","handleSelect","handleMouseDown","e","bookDisplayName","useMemo","bookDisplayId","Check","buttonVariants","cva","Button","variant","size","asChild","Slot","Popover","PopoverPrimitive","PopoverTrigger","PopoverAnchor","PopoverContent","align","sideOffset","generateCommandValue","chapter","RecentSearches","recentSearches","onSearchItemSelect","renderItem","item","getItemKey","ariaLabel","groupHeading","id","classNameForItems","isOpen","setIsOpen","useState","handleSearchItemSelect","Clock","useRecentSearches","setRecentSearches","areItemsEqual","b","maxItems","recentSearchesWithoutCurrent","existingItem","updatedRecentSearches","SCRIPTURE_REGEX_PATTERNS","SEARCH_QUERY_FORMATS","getKeyCharacterType","key","isLetter","isDigit","fetchEndChapter","getChaptersForBook","calculateTopMatch","availableBooks","topMatch","result","format","matches","book","verse","validBookId","allPotentialMatches","bookIdUpperCase","matchingLocalizedBookId","matchingBookIdForFullName","bookName","matchingLocalizedBookName","chapterNum","verseNum","useQuickNavButtons","scrRef","direction","handleSubmit","handlePreviousChapter","useCallback","currentBookIndex","previousBook","lastChapter","handleNextChapter","maxChapter","nextBook","handlePreviousVerse","handleNextVerse","ChevronsLeft","ChevronsRight","ChevronLeft","ChevronRight","ChapterGrid","onChapterSelect","setChapterRef","isChapterDimmed","_","i","BookChapterControl","getActiveBookIds","localizedStrings","onAddRecentSearch","isCommandOpen","setIsCommandOpen","setCommandValue","inputValue","setInputValue","viewMode","setViewMode","selectedBookForChaptersView","setSelectedBookForChaptersView","isCommandListHidden","setIsCommandListHidden","commandRef","commandInputRef","commandListRef","selectedBookItemRef","chapterRefs","handleSubmitAndAddToRecent","newScrRef","activeBookIds","availableBooksByType","filteredBooksByType","filteredBooks","type","handleTopMatchSelect","handleBookSelect","handleChapterSelect","chapterNumber","handleRecentItemSelect","quickNavButtons","handleBackToBooks","handleOpenChange","shouldCommandBeOpen","otLong","ntLong","dcLong","extraLong","getSectionLabel","doesChapterMatch","currentDisplayValue","formatScrRef","element","handleInputKeyDown","event","handleCommandKeyDown","currentBookName","currentBookId","currentChapter","match","targetChapter","GRID_COLS","targetElement","handleQuickNavButtonKeyDown","prevValue","useLayoutEffect","scrollTimeout","listElement","itemElement","itemOffsetTop","listHeight","itemHeight","scrollPosition","isCurrentlySelectedBook","verseRef","onClick","disabled","title","Icon","ArrowLeft","ArrowRight","Fragment","books","selectedBookId","getSectionForBook","BOOK_CHAPTER_CONTROL_STRING_KEYS","labelVariants","Label","LabelPrimitive","RadioGroup","RadioGroupPrimitive","RadioGroupItem","Circle","getOptionLabelDefault","option","ComboBox","options","buttonClassName","popoverContentClassName","value","onChange","getOptionLabel","getButtonLabel","icon","buttonPlaceholder","textPlaceholder","commandEmptyMessage","buttonVariant","alignDropDown","isDisabled","open","setOpen","buttonLabel","isGroupedOptions","groupOptions","renderCommandItem","optionLabel","secondaryLabel","ChevronDown","group","ChapterRangeSelector","startChapter","endChapter","handleSelectStartChapter","handleSelectEndChapter","chapterCount","chapterOptions","index","BookSelectionMode","BOOK_SELECTOR_STRING_KEYS","localizeString","strings","BookSelector","handleBookSelectionModeChange","onSelectBooks","selectedBookIds","currentBookText","chooseText","chooseBooksText","bookSelectionMode","setBookSelectionMode","onSelectionModeChange","newMode","r","n","t","o","m","u","c","l","p","a","f","d","s","E","editorTheme","TooltipProvider","TooltipPrimitive","Tooltip","TooltipTrigger","TooltipContent","nodes","HeadingNode","ParagraphNode","TextNode","QuoteNode","ErrorBoundaryContext","createContext","initialState","ErrorBoundary","Component","error","_this$props$onReset","_this$props","_len","args","_key","info","_this$props$onError","_this$props2","prevProps","prevState","didCatch","resetKeys","hasArrayChanged","_this$props$onReset2","_this$props3","fallbackRender","FallbackComponent","fallback","childToRender","createElement","M","g","h","T","B","yt","L","W","G","Z","F","V","J","H","q","Q","Y","tt","et","nt","it","ot","st","rt","ct","dt","ft","ut","gt","pt","mt","vt","xt","St","Et","bt","wt","Nt","Ot","Rt","Mt","Ct","Dt","_t","It","__publicField","jt","At","Pt","Kt","$t","zt","Ut","Lt","Tt","v","Vt","Wt","x","y","Jt","O","qt","Ht","R","S","Qt","w","C","D","N","Yt","I","k","U","$","z","j","A","P","K","ContentEditable","placeholder","placeholderClassName","LexicalContentEditable","Context","ToolbarContext","activeEditor","$updateToolbar","blockType","setBlockType","showModal","contextValue","useToolbarContext","context","useContext","useEditorModal","modalContent","setModalContent","onClose","modal","content","getContent","closeOnClickOutside","ToolbarPlugin","editor","useLexicalComposerContext","setActiveEditor","useEffect","SELECTION_CHANGE_COMMAND","_payload","newEditor","COMMAND_PRIORITY_CRITICAL","useUpdateToolbarHandler","callback","selection","$getSelection","toggleVariants","Toggle","TogglePrimitive","ToggleGroupContext","ToggleGroup","ToggleGroupPrimitive","ToggleGroupItem","FORMATS","BoldIcon","ItalicIcon","UnderlineIcon","StrikethroughIcon","FontFormatToolbarPlugin","activeFormats","setActiveFormats","$isRangeSelection","$isTableSelection","formats","prev","label","FORMAT_TEXT_COMMAND","ClearEditorBridge","onClear","CLEAR_EDITOR_COMMAND","Plugins","autoFocus","setFloatingAnchorElem","RichTextPlugin","_floatingAnchorElem","LexicalErrorBoundary","AutoFocusPlugin","ClearEditorPlugin","editorConfig","Editor","editorState","editorSerializedState","onSerializedChange","LexicalComposer","OnChangePlugin","latestEditorState","focusContentEditable","container","contentEditableField","range","doChildrenHaveEditorContent","child","hasEditorContent","htmlToEditorState","html","createHeadlessEditor","serializedState","dom","generatedNodes","$generateNodesFromDOM","$getRoot","$insertNodes","editorStateToHtml","parsedEditorState","$generateHtmlFromNodes","handleEditorKeyNavigation","initialValue","getAssignedUserDisplayName","user","CommentEditor","assignableUsers","onSave","setEditorState","selectedUser","setSelectedUser","isAssignPopoverOpen","setIsAssignPopoverOpen","clearEditorRef","editorContainerRef","isMounted","timeoutId","handleSave","contents","saveTooltip","cancelTooltip","assignToLabel","AtSign","clearFn","COMMENT_EDITOR_STRING_KEYS","COMMENT_LIST_STRING_KEYS","INTERACTIVE_ELEMENT_TAG_SELECTORS","INTERACTIVE_ELEMENT_ROLE_SELECTORS","useListbox","onFocusChange","onOptionSelect","onCharacterPress","listboxRef","activeId","setActiveId","selectedId","setSelectedId","focusOption","opt","toggleSelectInternal","isInteractiveElement","tag","role","tabIndex","handleKeyDown","getElementById","selectedElement","activeElement","focusableElements","currentIndex","el","nextIndex","preferred","toFocus","nextOption","badgeVariants","Badge","Card","CardHeader","CardTitle","CardDescription","CardContent","CardFooter","Separator","orientation","decorative","SeparatorPrimitive","Avatar","AvatarPrimitive","AvatarImage","AvatarFallback","MenuContext","useMenuContext","menuVariants","DropdownMenuTrigger","DropdownMenuPrimitive","DropdownMenuGroup","DropdownMenuPortal","DropdownMenuSub","DropdownMenuRadioGroup","DropdownMenu","DropdownMenuSubTrigger","inset","DropdownMenuSubContent","DropdownMenuContent","DropdownMenuItem","DropdownMenuCheckboxItem","checked","DropdownMenuRadioItem","DropdownMenuLabel","DropdownMenuSeparator","DropdownMenuShortcut","CommentItem","comment","isReply","isThreadExpanded","handleUpdateComment","handleDeleteComment","onEditingChange","canEditOrDelete","isEditing","setIsEditing","editContainerRef","handleCancelEdit","handleSaveEdit","displayDate","date","relativeDate","formatRelativeDate","time","formatReplacementString","userLabel","initials","name","sanitizedContent","sanitizeHtml","dropdownContent","Pencil","Trash2","ArrowUp","MoreHorizontal","CommentThread","classNameForVerseText","comments","assignedUser","currentUser","handleSelectThread","threadId","threadStatus","handleAddCommentToThread","handleReadStatusChange","canUserAddCommentToThread","canUserAssignThreadCallback","canUserResolveThreadCallback","canUserEditOrDeleteCommentCallback","isReadProp","autoReadDelay","isVerseExpanded","showAllReplies","setShowAllReplies","isAnyCommentEditing","setIsAnyCommentEditing","pendingAssignedUser","setPendingAssignedUser","canAssign","setCanAssign","canResolve","setCanResolve","isRead","setIsRead","manuallyUnread","setManuallyUnread","autoReadTimerRef","commentEditDeletePermissions","setCommentEditDeletePermissions","isPromiseCurrent","resolveResult","assignResult","activeComments","permissionsMap","canEdit","firstComment","verseTextRef","clearEditor","toggleRead","newIsRead","timer","localizedReplies","localizedAssignedToText","displayName","replies","replyCount","hasReplies","visibleReplies","hiddenReplyCount","replyText","hiddenReplyText","handleSubmitComment","handleAddCommentToThreadWithContents","success","MailOpen","Mail","ChevronUp","reply","CommentList","threads","externalSelectedThreadId","onSelectedThreadChange","expandedThreadIds","setExpandedThreadIds","lastInteractedThreadId","setLastInteractedThreadId","activeThreads","thread","handleKeyboardSelectThread","isCollapsing","next","handleKeyDownWithEscape","DataTableViewOptions","table","FilterIcon","column","Select","SelectPrimitive","SelectGroup","SelectValue","selectTriggerVariants","SelectTrigger","SelectScrollUpButton","SelectScrollDownButton","SelectContent","position","SelectLabel","SelectItem","SelectSeparator","DataTablePagination","pageSize","ArrowLeftIcon","ChevronLeftIcon","ChevronRightIcon","ArrowRightIcon","FOCUSABLE_SELECTOR","isVisible","getFocusableElements","uniqueQuerySelector","Table","stickyHeader","tableRef","currentTable","setTabIndexes","observer","handleKeyDownInTable","TableHeader","TableBody","TableFooter","useFocusableInRowKeyboardNavigation","rowRef","row","focusables","focusAdjacentFocusableElementInRow","focusablesInRow","currentIndexOfFocusables","nextFocusable","focusAdjacentRow","rowsInTable","currentRowIndex","nextRow","TableRow","onKeyDown","setFocusAlsoRunsSelect","currentRow","closestTable","handleFocus","TableHead","TableCell","TableCaption","Skeleton","DataTable","columns","data","enablePagination","showPaginationControls","showColumnVisibilityControls","onRowClickHandler","isLoading","noResultsMessage","sorting","setSorting","columnFilters","setColumnFilters","columnVisibility","setColumnVisibility","rowSelection","setRowSelection","normalizedData","useReactTable","getCoreRowModel","getPaginationRowModel","getSortedRowModel","getFilteredRowModel","visibleColumns","bodyContent","idx","rowId","cell","flexRender","headerGroup","header","MarkdownRenderer","markdown","anchorTarget","truncate","Markdown","ERROR_DUMP_STRING_KEYS","ErrorDump","errorDetails","handleCopyNotify","headerText","infoMessage","handleCopy","Copy","ERROR_POPOVER_STRING_KEYS","ErrorPopover","isCopySuccess","setIsCopySuccess","handleCopyWithNotification","DropdownMenuItemType","FilterDropdown","groups","checkedStates","setCheckedStates","entry","radioStates","setRadioStates","handleCheckboxUpdate","groupIndex","newCheckedState","oldCheckedStates","handleRadioUpdate","oldRadioStates","currentItem","Filter","MoreInfo","category","downloads","languages","moreInfoUrl","handleMoreInfoLinkClick","supportUrl","handleSupportLinkClick","numberFormatted","NumberFormat","handleScrollToBottom","User","locale","LucideLink","CircleHelp","VersionHistory","versionHistory","showAllVersions","setShowAllVersions","currentDate","formatTimeString","dateString","dateDiff","yearDiff","monthDiff","dayDiff","timeString","sortedEntries","Footer","publisherDisplayName","fileSize","locales","currentVersion","formattedFileSize","formatBytes","languageNames","codes","displayNames","getCurrentLocale","code","MultiSelectComboBox","entries","selected","hasToggleAllFeature","selectAllText","clearAllText","customSelectedText","onOpenChange","sortSelected","isOpenLocal","setIsOpenLocal","getPlaceholderText","sortedOptions","starredItems","nonStarredItems","aSelected","bSelected","handleSelectAll","handleClearAll","actualIsOpen","ChevronsUpDown","Star","badgesPlaceholder","selectedType","Input","renderCallerButtonContent","callerType","customCaller","FootnoteCallerDropdown","updateCallerType","updateCustomCaller","customCallerInputRef","customCallerSelectRef","isCustomCallerInputFocused","selectedCallerType","setSelectedCallerType","newCustomCaller","setNewCustomCaller","isDropdownOpen","setIsDropdownOpen","handleDropdownOpenChange","_b","_c","_d","GENERATOR_NOTE_CALLER","HIDDEN_NOTE_CALLER","renderNoteTypeButtonContent","noteType","FunctionSquare","SquareSigma","SquareX","formatNoteTypeTooltip","noteTypeString","FootnoteTypeDropdown","handleNoteTypeChange","isTypeSwitchable","footnoteToCrossReferenceOp","op","opCharAttribute","crossReferenceToFootnoteOp","PARAGRAPH_USJ","FootnoteEditor","classNameForEditor","noteOps","noteKey","editorOptions","editorRef","editorParentRef","createRef","setCallerType","setCustomCaller","setNoteType","setIsTypeSwitchable","getDefaultViewOptions","timeout","noteOp","isInsertEmbedOpOfType","rawCaller","parsedCallerType","currentNoteOp","editorInput","innerNoteOps","_e","handleUsjChange","usj","currentNoteType","nodeType","Editorial","FOOTNOTE_EDITOR_STRING_KEYS","makeKey","parentMarker","firstString","part","firstMarker","renderParagraphs","showMarkers","footnoteClosing","markerHierarchy","paragraphs","current","para","isLast","renderContent","allowUnmarkedText","footnotePart","classes","AlertCircle","renderMarkerObject","markerObj","marker","FootnoteItem","footnote","layout","formatCaller","caller","isCallerFormatted","targetRef","remainingContent","footnoteOpening","footnoteCaller","footnoteTargetRef","layoutClass","markerClass","footnoteBodyClass","baseClasses","FootnoteList","footnotes","listId","selectedFootnote","suppressFormatting","onFootnoteSelected","handleFormatCaller","getFormatCallerFunction","handleFootnoteClick","initialFocusedIndex","focusedIndex","setFocusedIndex","handleFootnoteKeyDown","handleListKeyDown","rowRefs","formatTextWithBold","text","parts","lastIndex","regex","OccurrencesTable","occurrenceData","setScriptureReference","classNameForText","referenceHeaderText","occurrenceHeaderText","occurrences","uniqueOccurrences","seen","occurrence","Checkbox","CheckboxPrimitive","getSortingIcon","sortDirection","ArrowUpIcon","ArrowDownIcon","ArrowUpDownIcon","inventoryItemColumn","itemLabel","inventoryAdditionalItemColumn","additionalItemLabel","additionalItemIndex","inventoryCountColumn","countLabel","statusChangeHandler","changedItems","newStatus","approvedItems","onApprovedItemsChange","unapprovedItems","onUnapprovedItemsChange","newApprovedItems","validItem","newUnapprovedItems","unapprovedItem","inventoryStatusColumn","statusLabel","status","CircleCheckIcon","CircleXIcon","CircleHelpIcon","getLinesFromUSFM","getNumberFromUSFM","getBookIdFromUSFM","getStatusForItem","INVENTORY_STRING_KEYS","filterItemData","itemData","statusFilter","textFilter","filteredItemData","processSummaryItems","inventoryItems","itemKey","isString","Inventory","setVerseRef","additionalItemsLabels","scope","onScopeChange","areInventoryItemsLoading","onItemSelected","allItemsText","approvedItemsText","unapprovedItemsText","unknownItemsText","scopeBookText","scopeChapterText","scopeVerseText","filterText","showAdditionalItemsText","noResultsText","showAdditionalItems","setShowAdditionalItems","setStatusFilter","setTextFilter","selectedItem","setSelectedItem","tableData","safeInventoryItems","reducedTableData","newTableData","tableEntry","firstItem","existingEntry","newTableEntry","filteredTableData","allColumns","numberOfAdditionalItems","additionalColumns","rowClickHandler","newSelection","selectedItems","handleScopeChange","handleStatusFilterChange","deepEqual","MARKER_MENU_STRING_KEYS","MenuMarkerIcon","Ban","MarkerMenu","markerMenuItems","commandSearch","setCommandSearch","filteredMarkerItems","markerItem","SIDEBAR_WIDTH","SIDEBAR_WIDTH_ICON","SidebarContext","useSidebar","SidebarProvider","defaultOpen","openProp","setOpenProp","style","side","_open","_setOpen","openState","toggleSidebar","state","directionAwareSide","Sidebar","collapsible","SidebarTrigger","PanelLeft","PanelRight","SidebarRail","SidebarInset","SidebarInput","SidebarHeader","SidebarFooter","SidebarSeparator","SidebarContent","SidebarGroup","SidebarGroupLabel","SidebarGroupAction","SidebarGroupContent","SidebarMenu","SidebarMenuItem","sidebarMenuButtonVariants","SidebarMenuButton","isActive","tooltip","Comp","button","SidebarMenuAction","showOnHover","SidebarMenuBadge","SidebarMenuSkeleton","showIcon","width","SidebarMenuSub","SidebarMenuSubItem","SidebarMenuSubButton","SettingsSidebar","extensionLabels","projectInfo","handleSelectSidebarItem","selectedSidebarItem","extensionsSidebarGroupLabel","projectsSidebarGroupLabel","buttonPlaceholderText","handleSelectItem","projectId","getProjectNameFromProjectId","project","getIsActive","selectedProjectName","ScrollText","SearchBar","onSearch","isFullWidth","inputRef","SettingsSidebarContentSearch","searchValue","scrBookColId","scrRefColId","typeColId","detailsColId","defaultScrRefColumnName","defaultScrBookGroupName","defaultTypeColumnName","defaultDetailsColumnName","getColumns","colInfo","showSourceColumn","showSrcCol","compareScrRefs","toRefOrRange","scriptureSelection","offsetStart","offsetEnd","scrRefToBBBCCCVVV","getRowKey","ScriptureResultsViewer","sources","showColumnHeaders","scriptureReferenceColumnName","scriptureBookGroupName","typeColumnName","detailsColumnName","onRowSelected","grouping","setGrouping","scriptureResults","source","getExpandedRowModel","getGroupedRowModel","selectedRows","keys","selectedRow","scrBookGroupName","typeGroupName","groupingOptions","handleSelectChange","selectedGrouping","handleRowClick","getEvenOrOddBandingStyle","getIndent","groupingState","rowIndex","getBooksForSection","bookIds","isSectionFullySelected","SectionButton","availableBookIds","onToggle","sectionOtShortText","sectionNtShortText","sectionDcShortText","sectionExtraShortText","VISIBLE_BADGES_COUNT","MAX_VISIBLE_BADGES","availableBookInfo","onChangeSelectedBookIds","booksSelectedText","selectBooksText","searchBooksText","noBookFoundText","moreText","isBooksSelectorOpen","setIsBooksSelectorOpen","lastSelectedBookRef","lastKeyEventShiftKey","availableBooksIds","filteredBooksBySection","allBooks","matchingBooks","toggleBook","shiftKey","startIndex","endIndex","booksInRange","shortname","handleKeyboardSelect","toggleSection","sectionBooks","SCOPE_SELECTOR_STRING_KEYS","ScopeSelector","availableScopes","onSelectedBookIdsChange","selectedTextText","currentVerseText","currentChapterText","scopeText","SCOPE_OPTIONS","displayedScopes","scopeId","DEFAULT_SCROLL_GROUP_LOCALIZED_STRINGS","getLocalizeKeyForScrollGroupId","ScrollGroupSelector","availableScrollGroupIds","scrollGroupId","onChangeScrollGroupId","localizedStringsDefaulted","localizedStringKey","localizedStringValue","newScrollGroupString","scrollGroupOptionId","SettingsList","SettingsListItem","primary","secondary","loadingMessage","SettingsListHeader","includeSeparator","getSubMenuGroupKeyForMenuItemId","MenuItemIcon","menuLabel","leading","getGroupContent","items","columnOrSubMenuKey","onSelectMenuItem","groupKey","TabDropdownMenu","menuData","tabLabel","MenuIcon","columnKey","array","TabToolbarContainer","TabToolbar","onSelectProjectMenuItem","onSelectViewInfoMenuItem","projectMenuData","tabViewMenuData","startAreaChildren","centerAreaChildren","endAreaChildren","menuButtonIcon","Menu","EllipsisVertical","TabFloatingMenu","VerticalTabs","TabsPrimitive","VerticalTabsList","VerticalTabsTrigger","VerticalTabsContent","TabNavigationContentSearch","tabList","searchPlaceholder","headerTitle","searchClassName","tab","MenubarMenu","MenubarPrimitive","MenubarSub","Menubar","MenubarTrigger","MenubarSubTrigger","MenubarSubContent","MenubarContent","alignOffset","MenubarItem","MenubarCheckboxItem","MenubarRadioItem","MenubarLabel","MenubarSeparator","simulateKeyPress","getMenubarContent","sortedGroupsForColumn","groupItems","itemsWithSeparator","PlatformMenubar","menubarRef","projectMenuRef","windowMenuRef","layoutMenuRef","helpMenuRef","getRefForColumn","useHotkeys","handler","escKey","spaceKey","mutations","mutation","getToolbarOSReservedSpaceClassName","operatingSystem","Toolbar","appMenuAreaChildren","configAreaChildren","shouldUseAsAppDragArea","menubarVariant","containerRef","UiLanguageSelector","knownUiLanguages","primaryLanguage","fallbackLanguages","onLanguagesChange","onPrimaryLanguageChange","onFallbackLanguagesChange","fallbackLanguagesText","handleLanguageChange","lang","getLanguageDisplayName","uiLang","altName","_f","SmartLabel","createLabel","createComplexLabel","Checklist","listItems","selectedListItems","handleSelectListItem","ResultsCard","cardKey","isDenied","isHidden","additionalSelectedContent","accentColor","Spinner","LoaderCircle","TextField","hasError","helperText","isRequired","defaultValue","onFocus","onBlur","ShadLabel","ShadInput","alertVariants","Alert","AlertTitle","AlertDescription","ContextMenu","ContextMenuPrimitive","ContextMenuTrigger","ContextMenuGroup","ContextMenuPortal","ContextMenuSub","ContextMenuRadioGroup","ContextMenuSubTrigger","ContextMenuSubContent","ContextMenuContent","ContextMenuItem","ContextMenuCheckboxItem","ContextMenuRadioItem","ContextMenuLabel","ContextMenuSeparator","ContextMenuShortcut","DrawerContext","Drawer","shouldScaleBackground","DrawerPrimitive","DrawerTrigger","DrawerPortal","DrawerClose","DrawerOverlay","DrawerContent","hideDrawerHandle","directionStyles","handleStyles","DrawerHeader","DrawerFooter","DrawerTitle","DrawerDescription","Progress","ProgressPrimitive","ResizablePanelGroup","ResizablePrimitive","ResizablePanel","ResizableHandle","withHandle","GripVertical","Sonner","Toaster","Slider","SliderPrimitive","Switch","SwitchPrimitives","Tabs","TabsList","TabsTrigger","TabsContent","Textarea","useEvent","eventHandler","unsubscriber","getUsePromiseOptionsDefaults","usePromise","promiseFactoryCallback","defaultValueRef","optionsDefaultedRef","setValue","setIsLoading","promiseIsCurrent","noopUnsubscriber","useEventAsync","unsubscribe","unsub","useStylesheet","stylesheet","styleElement"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,MAAMA,KAAgBC,GAAoB,EAAE,QAAQ,OAAO;AAuDpD,SAASC,KAAMC,GAAsB;AAC1C,SAAOH,GAAcI,GAAKD,CAAM,CAAC;AACnC;ACzDA,MAAME,KAAsB;AAGrB,SAASC,KAA2B;AACzC,QAAMC,IAAY,aAAa,QAAQF,EAAW;AAClD,SAAIE,MAAc,QACTA,IAEF;AACT;ACLA,MAAMC,KAASC,GAAgB,MAIzBC,KAAeD,GAAgB,QAI/BE,KAAgBC,EAAM,WAG1B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACP,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAAM;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDH,GAAc,cAAcF,GAAgB,QAAQ;AAEpD,MAAMQ,KAAgBL,EAAM,WAG1B,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,GAAGJ,EAAA,GAASC,MAAQ;AAC5C,QAAMI,IAAMb,GAAA;AACZ,2BACGI,IAAA,EACC,UAAA;AAAA,IAAA,gBAAAM,EAACL,IAAA,EAAc;AAAA,IACf,gBAAAS;AAAA,MAACX,GAAgB;AAAA,MAAhB;AAAA,QACC,KAAAM;AAAA,QACA,WAAWb;AAAA,UACT;AAAA,UACAW;AAAA,QAAA;AAAA,QAED,GAAGC;AAAA,QACJ,KAAAK;AAAA,QAEC,UAAA;AAAA,UAAAD;AAAA,UACD,gBAAAE;AAAA,YAACX,GAAgB;AAAA,YAAhB;AAAA,cACC,WAAWP;AAAA,gBACT;AAAA,gBACA,EAAE,cAAciB,MAAQ,MAAA;AAAA,gBACxB,EAAE,aAAaA,MAAQ,MAAA;AAAA,cAAM;AAAA,cAG/B,UAAA;AAAA,gBAAA,gBAAAH,EAACK,IAAA,EAAE,WAAU,gBAAA,CAAgB;AAAA,gBAC7B,gBAAAL,EAAC,QAAA,EAAK,WAAU,cAAa,UAAA,QAAA,CAAK;AAAA,cAAA;AAAA,YAAA;AAAA,UAAA;AAAA,QACpC;AAAA,MAAA;AAAA,IAAA;AAAA,EACF,GACF;AAEJ,CAAC;AACDC,GAAc,cAAcR,GAAgB,QAAQ;AACpD,SAASa,GAAa,EAAE,WAAAT,GAAW,GAAGC,KAA+C;AACnF,SACE,gBAAAE;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWd;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACAQ,GAAa,cAAc;AAe3B,MAAMC,KAAcX,EAAM,WAGxB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACP,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAAM;AAAA,IACA,WAAWb,EAAG,iEAAiEW,CAAS;AAAA,IACvF,GAAGC;AAAA,EAAA;AACN,CACD;AACDS,GAAY,cAAcd,GAAgB,MAAM;AAEhD,MAAMe,KAAoBZ,EAAM,WAG9B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACP,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAAM;AAAA,IACA,WAAWb,EAAG,uCAAuCW,CAAS;AAAA,IAC7D,GAAGC;AAAA,EAAA;AACN,CACD;AACDU,GAAkB,cAAcf,GAAgB,YAAY;ACjG5D,MAAMgB,KAAUb,EAAM,WAGpB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACU;AAAAA,EAAA;AAAA,IACC,KAAAX;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDW,GAAQ,cAAcC,GAAiB;AAkBvC,MAAMC,KAAef,EAAM,WAGzB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAAQ;AAClC,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAc,EAAC,OAAA,EAAI,WAAU,+CAA8C,KAAAD,GAC3D,UAAA;AAAA,IAAA,gBAAAH,EAACY,IAAA,EAAO,WAAU,kDAAA,CAAkD;AAAA,IACpE,gBAAAZ;AAAA,MAACU,GAAiB;AAAA,MAAjB;AAAA,QACC,KAAAX;AAAA,QACA,WAAWb;AAAA,UACT;AAAA,UACAW;AAAA,QAAA;AAAA,QAED,GAAGC;AAAA,MAAA;AAAA,IAAA;AAAA,EACN,GACF;AAEJ,CAAC;AAEDa,GAAa,cAAcD,GAAiB,MAAM;AAGlD,MAAMG,KAAcjB,EAAM,WAGxB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACU,GAAiB;AAAA,EAAjB;AAAA,IACC,KAAAX;AAAA,IACA,WAAWb,EAAG,4DAA4DW,CAAS;AAAA,IAClF,GAAGC;AAAA,EAAA;AACN,CACD;AAEDe,GAAY,cAAcH,GAAiB,KAAK;AAGhD,MAAMI,KAAelB,EAAM,WAGzB,CAACE,GAAOC,MACR,gBAAAC,EAACU,GAAiB,OAAjB,EAAuB,KAAAX,GAAU,WAAU,qCAAqC,GAAGD,GAAO,CAC5F;AAEDgB,GAAa,cAAcJ,GAAiB,MAAM;AAGlD,MAAMK,KAAenB,EAAM,WAGzB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACU,GAAiB;AAAA,EAAjB;AAAA,IACC,KAAAX;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AAEDiB,GAAa,cAAcL,GAAiB,MAAM;AAGlD,MAAMM,KAAmBpB,EAAM,WAG7B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACU,GAAiB;AAAA,EAAjB;AAAA,IACC,KAAAX;AAAA,IACA,WAAWb,EAAG,iCAAiCW,CAAS;AAAA,IACvD,GAAGC;AAAA,EAAA;AACN,CACD;AACDkB,GAAiB,cAAcN,GAAiB,UAAU;AAG1D,MAAMO,KAAcrB,EAAM,WAGxB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACU,GAAiB;AAAA,EAAjB;AAAA,IACC,KAAAX;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AAEDmB,GAAY,cAAcP,GAAiB,KAAK;AAGhD,SAASQ,GAAgB,EAAE,WAAArB,GAAW,GAAGC,KAAgD;AACvF,SACE,gBAAAE;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWd,EAAG,qEAAqEW,CAAS;AAAA,MAC3F,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACAoB,GAAgB,cAAc;ACrIvB,MAAMC,KAAqB,CAChCC,GACAC,GACAC,GACAC,GACAC,MACW;AACX,UAAQJ,GAAA;AAAA,IACN,KAAKK,EAAQ;AACX,aAAOJ,KAAc;AAAA,IACvB,KAAKI,EAAQ;AACX,aAAOH,KAAc;AAAA,IACvB,KAAKG,EAAQ;AACX,aAAOF,KAAc;AAAA,IACvB,KAAKE,EAAQ;AACX,aAAOD,KAAiB;AAAA,IAC1B;AACE,YAAM,IAAI,MAAM,oBAAoBJ,CAAO,EAAE;AAAA,EAAA;AAEnD,GAaaM,KAAsB,CACjCN,GACAO,GACAC,GACAC,GACAC,MACW;AACX,UAAQV,GAAA;AAAA,IACN,KAAKK,EAAQ;AACX,aAAOE,KAAe;AAAA,IACxB,KAAKF,EAAQ;AACX,aAAOG,KAAe;AAAA,IACxB,KAAKH,EAAQ;AACX,aAAOI,KAAe;AAAA,IACxB,KAAKJ,EAAQ;AACX,aAAOK,KAAkB;AAAA,IAC3B;AACE,YAAM,IAAI,MAAM,oBAAoBV,CAAO,EAAE;AAAA,EAAA;AAEnD;AAUO,SAASW,GACdC,GACAC,GACQ;;AAER,WADsBC,IAAAD,KAAA,gBAAAA,EAAoB,IAAID,OAAxB,gBAAAE,EAAiC,kBAC/BC,GAAM,oBAAoBH,CAAM;AAC1D;AAUO,SAASI,GACdJ,GACAC,GACQ;;AAER,WADoBC,IAAAD,KAAA,gBAAAA,EAAoB,IAAID,OAAxB,gBAAAE,EAAiC,gBAC/BF,EAAO,YAAA;AAC/B;AAGO,MAAMK,KAAeF,GAAM,WAAW;AAAA,EAC3C,CAACH,MAAW,CAACG,GAAM,WAAWA,GAAM,eAAeH,CAAM,CAAC;AAC5D,GAGaM,KAAyB,OAAO;AAAA,EAC3CD,GAAa,IAAI,CAACL,MAAW,CAACA,GAAQG,GAAM,oBAAoBH,CAAM,CAAC,CAAC;AAC1E;AA4CO,SAASO,GACdP,GACAQ,GACAP,GACS;AACT,QAAMQ,IAAkBD,EAAM,KAAA,EAAO,YAAA;AACrC,MAAI,CAACC,EAAiB,QAAO;AAE7B,QAAMC,IAAcP,GAAM,oBAAoBH,CAAM,GAC9CW,IAAgBV,KAAA,gBAAAA,EAAoB,IAAID;AAgB9C,SAZE,GAAAY,GAASF,EAAY,YAAA,GAAeD,CAAe,KACnDG,GAASZ,EAAO,YAAA,GAAeS,CAAe,MAMfE,IAC7BC,GAASD,EAAc,cAAc,YAAA,GAAeF,CAAe,KACnEG,GAASD,EAAc,YAAY,YAAA,GAAeF,CAAe,IACjE;AAKN;AC1IO,MAAMI,KAAWC;AAAA,EACtB,CACE;AAAA,IACE,QAAAd;AAAA,IACA,YAAAe;AAAA,IACA,UAAAC;AAAA,IACA,aAAAC;AAAA,IACA,SAAA7B;AAAA,IACA,WAAAvB;AAAA,IACA,WAAAqD,IAAY;AAAA,IACZ,oBAAAjB;AAAA,IACA,cAAAkB;AAAA,EAAA,GAEFpD,MACG;AACH,UAAMqD,IAAeC,EAAO,EAAK,GAE3BC,IAAe,MAAM;AACzB,MAAKF,EAAa,WAChBJ,KAAA,QAAAA,EAAWhB,IAGb,WAAW,MAAM;AACf,QAAAoB,EAAa,UAAU;AAAA,MACzB,GAAG,GAAG;AAAA,IACR,GAEMG,IAAkB,CAACC,MAAkB;AACzC,MAAAJ,EAAa,UAAU,IAEnBH,IACFA,EAAYO,CAAC,IAGbR,KAAA,QAAAA,EAAWhB;AAAA,IAEf,GAEMyB,IAAkBC;AAAA,MACtB,MAAM3B,GAAqBC,GAAQC,CAAkB;AAAA,MACrD,CAACD,GAAQC,CAAkB;AAAA,IAAA,GAGvB0B,IAAgBD;AAAA,MACpB,MAAMtB,GAAmBJ,GAAQC,CAAkB;AAAA,MACnD,CAACD,GAAQC,CAAkB;AAAA,IAAA;AAG7B,WACE,gBAAAjC;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,WAAWd;AAAA,UACT;AAAA,UACA;AAAA,YACE,uBAAuBkC,MAAYK,EAAQ;AAAA,YAC3C,0BAA0BL,MAAYK,EAAQ;AAAA,YAC9C,0BAA0BL,MAAYK,EAAQ;AAAA,YAC9C,yBAAyBL,MAAYK,EAAQ;AAAA,UAAA;AAAA,QAC/C;AAAA,QAGF,UAAA,gBAAArB;AAAA,UAACa;AAAA,UAAA;AAAA,YACC,KAAAlB;AAAA,YACA,OAAOoD,KAAgB,GAAGnB,CAAM,IAAIG,GAAM,oBAAoBH,CAAM,CAAC;AAAA,YACrE,UAAUsB;AAAA,YACV,aAAaC;AAAA,YACb,MAAK;AAAA,YACL,iBAAeR;AAAA,YACf,cAAY,GAAGZ,GAAM,oBAAoBH,CAAM,CAAC,KAAKA,EAAO,kBAAA,CAAmB;AAAA,YAC/E,WAAAnC;AAAA,YAEC,UAAA;AAAA,cAAAqD,KACC,gBAAAlD;AAAA,gBAAC4D;AAAA,gBAAA;AAAA,kBACC,WAAW1E;AAAA,oBACT;AAAA,oBACA6D,IAAa,mBAAmB;AAAA,kBAAA;AAAA,gBAClC;AAAA,cAAA;AAAA,cAGJ,gBAAA/C,EAAC,QAAA,EAAK,WAAU,wBAAwB,UAAAyD,GAAgB;AAAA,cACxD,gBAAAzD,EAAC,QAAA,EAAK,WAAU,gEACb,UAAA2D,EAAA,CACH;AAAA,YAAA;AAAA,UAAA;AAAA,QAAA;AAAA,MACF;AAAA,IAAA;AAAA,EAGN;AACF,GCrHaE,KAAiBC;AAAA,EAC5B;AAAA,EACA;AAAA,IACE,UAAU;AAAA,MACR,SAAS;AAAA,QACP,SAAS;AAAA,QACT,aAAa;AAAA,QACb,SACE;AAAA,QACF,WAAW;AAAA,QACX,OAAO;AAAA,QACP,MAAM;AAAA,MAAA;AAAA,MAER,MAAM;AAAA,QACJ,SAAS;AAAA,QACT,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,MAAM;AAAA,MAAA;AAAA,IACR;AAAA,IAEF,iBAAiB;AAAA,MACf,SAAS;AAAA,MACT,MAAM;AAAA,IAAA;AAAA,EACR;AAEJ,GAoBaC,IAASnE,EAAM;AAAA,EAC1B,CAAC,EAAE,WAAAC,GAAW,SAAAmE,GAAS,MAAAC,GAAM,SAAAC,IAAU,IAAO,GAAGpE,EAAA,GAASC,MAGtD,gBAAAC,EAFWkE,IAAUC,KAAO,UAE3B,EAAK,WAAWjF,EAAG2E,GAAe,EAAE,SAAAG,GAAS,MAAAC,GAAM,WAAApE,EAAA,CAAW,CAAC,GAAG,KAAAE,GAAW,GAAGD,EAAA,CAAO;AAG9F;AACAiE,EAAO,cAAc;AClDrB,MAAMK,KAAUC,GAAiB,MAG3BC,KAAiBD,GAAiB,SAGlCE,KAAgBF,GAAiB,QAGjCG,KAAiB5E,EAAM,WAG3B,CAAC,EAAE,WAAAC,GAAW,OAAA4E,IAAQ,UAAU,YAAAC,IAAa,GAAG,GAAG5E,EAAA,GAASC,MAAQ;AACpE,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAU,EAACqE,GAAiB,QAAjB,EACC,UAAA,gBAAArE;AAAA,IAACqE,GAAiB;AAAA,IAAjB;AAAA,MACC,KAAAtE;AAAA,MACA,OAAA0E;AAAA,MACA,YAAAC;AAAA,MACA,WAAWxF;AAAA;AAAA,QAET;AAAA,QACA;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,MACJ,KAAAK;AAAA,IAAA;AAAA,EAAA,GAEJ;AAEJ,CAAC;AACDqE,GAAe,cAAcH,GAAiB,QAAQ;ACvC/C,SAASM,GACd3C,GACAC,GACA2C,GACQ;AACR,SAAO,GAAG5C,CAAM,IAAIM,GAAuBN,CAAM,CAAC,GAAGC,IAAqB,IAAIG,GAAmBJ,GAAQC,CAAkB,CAAC,IAAIF,GAAqBC,GAAQC,CAAkB,CAAC,KAAK,EAAE,GAAG2C,IAAU,IAAIA,CAAO,KAAK,EAAE;AACxN;ACmBA,SAAwBC,GAAkB;AAAA,EACxC,gBAAAC;AAAA,EACA,oBAAAC;AAAA,EACA,YAAAC,IAAa,CAACC,MAAS,OAAOA,CAAI;AAAA,EAClC,YAAAC,IAAa,CAACD,MAAS,OAAOA,CAAI;AAAA,EAClC,WAAAE,IAAY;AAAA,EACZ,cAAAC,IAAe;AAAA,EACf,IAAAC;AAAA,EACA,mBAAAC;AACF,GAA2B;AACzB,QAAM,CAACC,GAAQC,CAAS,IAAIC,EAAS,EAAK;AAE1C,MAAIX,EAAe,WAAW;AAC5B;AAGF,QAAMY,IAAyB,CAACT,MAAY;AAC1C,IAAAF,EAAmBE,CAAI,GACvBO,EAAU,EAAK;AAAA,EACjB;AAEA,SACE,gBAAApF,EAACgE,IAAA,EAAQ,MAAMmB,GAAQ,cAAcC,GACnC,UAAA;AAAA,IAAA,gBAAAxF,EAACsE,IAAA,EAAe,SAAO,IACrB,UAAA,gBAAAtE;AAAA,MAAC+D;AAAA,MAAA;AAAA,QACC,SAAQ;AAAA,QACR,MAAK;AAAA,QACL,WAAU;AAAA,QACV,cAAYoB;AAAA,QAEZ,UAAA,gBAAAnF,EAAC2F,IAAA,EAAM,WAAU,gBAAA,CAAgB;AAAA,MAAA;AAAA,IAAA,GAErC;AAAA,sBACCnB,IAAA,EAAe,IAAAa,GAAQ,WAAU,uBAAsB,OAAM,SAC5D,UAAA,gBAAArF,EAACS,IAAA,EACC,UAAA,gBAAAT,EAACa,IAAA,EACC,4BAACE,IAAA,EAAa,SAASqE,GACpB,UAAAN,EAAe,IAAI,CAACG,MACnB,gBAAA7E;AAAA,MAACa;AAAA,MAAA;AAAA,QAEC,UAAU,MAAMyE,EAAuBT,CAAI;AAAA,QAC3C,WAAW/F,EAAG,2BAA2BoG,CAAiB;AAAA,QAE1D,UAAA;AAAA,UAAA,gBAAAtF,EAAC2F,IAAA,EAAM,WAAU,sCAAA,CAAsC;AAAA,UACvD,gBAAA3F,EAAC,QAAA,EAAM,UAAAgF,EAAWC,CAAI,EAAA,CAAE;AAAA,QAAA;AAAA,MAAA;AAAA,MALnBC,EAAWD,CAAI;AAAA,IAAA,CAOvB,EAAA,CACH,GACF,EAAA,CACF,EAAA,CACF;AAAA,EAAA,GACF;AAEJ;AAGO,SAASW,GACdd,GACAe,GACAC,IAAyC,CAAC,GAAGC,MAAM,MAAMA,GACzDC,IAAmB,IACnB;AACA,SAAO,CAACf,MAAY;AAElB,UAAMgB,IAA+BnB,EAAe;AAAA,MAClD,CAACoB,MAAiB,CAACJ,EAAcI,GAAcjB,CAAI;AAAA,IAAA,GAE/CkB,IAAwB,CAAClB,GAAM,GAAGgB,EAA6B,MAAM,GAAGD,IAAW,CAAC,CAAC;AAC3F,IAAAH,EAAkBM,CAAqB;AAAA,EACzC;AACF;AC/FO,MAAMC,KAA2B;AAAA;AAAA,EAEtC,WAAW;AAAA;AAAA,EAEX,cAAc;AAAA;AAAA,EAEd,oBAAoB;AACtB,GAEaC,KAAuB;AAAA,EAClCD,GAAyB;AAAA,EACzBA,GAAyB;AAAA,EACzBA,GAAyB;AAC3B;AAEO,SAASE,GAAoBC,GAAa;AAC/C,QAAMC,IAAW,aAAa,KAAKD,CAAG,GAChCE,IAAU,UAAU,KAAKF,CAAG;AAClC,SAAO,EAAE,UAAAC,GAAU,SAAAC,EAAA;AACrB;AAEO,SAASC,GAAgB1E,GAAgB;AAG9C,SAAO2E,GAAmBxE,GAAM,eAAeH,CAAM,CAAC;AACxD;AAEO,SAAS4E,GACdpE,GACAqE,GACA5E,GAC6C;AAC7C,MAAI,CAACO,EAAM,KAAA,KAAUqE,EAAe,WAAW,EAAG;AAGlD,QAAMC,IAAWT,GAAqB;AAAA,IACpC,CAACU,GAAqDC,MAAW;AAC/D,UAAID,EAAQ,QAAOA;AAEnB,YAAME,IAAUD,EAAO,KAAKxE,EAAM,MAAM;AACxC,UAAIyE,GAAS;AACX,cAAM,CAACC,GAAMtC,IAAU,QAAWuC,IAAQ,MAAS,IAAIF,EAAQ,MAAM,CAAC;AAEtE,YAAIG;AAIJ,cAAMC,IAAsBR,EAAe,OAAO,CAAC7E,MAC1CO,GAAmBP,GAAQkF,GAAMjF,CAAkB,CAC3D;AAWD,YARIoF,EAAoB,WAAW,MACjC,CAACD,CAAW,IAAIC,IAOd,CAACD,KAAexC,GAAS;AAE3B,cAAIzC,GAAM,cAAc+E,CAAI,GAAG;AAC7B,kBAAMI,IAAkBJ,EAAK,YAAA;AAC7B,YAAIL,EAAe,SAASS,CAAe,MACzCF,IAAcE;AAAA,UAElB;AAGA,cAAI,CAACF,KAAenF,GAAoB;AACtC,kBAAMsF,IAA0B,MAAM,KAAKtF,EAAmB,QAAA,CAAS,EAAE;AAAA,cACvE,CAAC,CAAA,EAAGU,CAAa,MAAMA,EAAc,YAAY,YAAA,MAAkBuE,EAAK,YAAA;AAAA,YAAY;AAEtF,YAAIK,KAA2BV,EAAe,SAASU,EAAwB,CAAC,CAAC,MAC/E,CAACH,CAAW,IAAIG;AAAA,UAEpB;AAAA,QACF;AAKA,YAAI,CAACH,KAAexC,GAAS;AAQ3B,gBAAM4C,KAN2B,CAACC,MACzB,OAAO,KAAKnF,EAAsB,EAAE;AAAA,YACzC,CAACN,MAAWM,GAAuBN,CAAM,EAAE,YAAA,MAAkByF,EAAS,YAAA;AAAA,UAAY,GAI3BP,CAAI;AAM/D,cALIM,KAA6BX,EAAe,SAASW,CAAyB,MAChFJ,IAAcI,IAIZ,CAACJ,KAAenF,GAAoB;AACtC,kBAAMyF,IAA4B,MAAM,KAAKzF,EAAmB,QAAA,CAAS,EAAE;AAAA,cACzE,CAAC,CAAA,EAAGU,CAAa,MACfA,EAAc,cAAc,YAAA,MAAkBuE,EAAK,YAAA;AAAA,YAAY;AAEnE,YACEQ,KACAb,EAAe,SAASa,EAA0B,CAAC,CAAC,MAEpD,CAACN,CAAW,IAAIM;AAAA,UAEpB;AAAA,QACF;AAEA,YAAIN,GAAa;AACf,cAAIO,IAAa/C,IAAU,SAASA,GAAS,EAAE,IAAI;AACnD,UAAI+C,KAAcA,IAAajB,GAAgBU,CAAW,MACxDO,IAAa,KAAK,IAAIjB,GAAgBU,CAAW,GAAG,CAAC;AACvD,gBAAMQ,IAAWT,IAAQ,SAASA,GAAO,EAAE,IAAI;AAE/C,iBAAO;AAAA,YACL,MAAMC;AAAA,YACN,YAAAO;AAAA,YACA,UAAAC;AAAA,UAAA;AAAA,QAEJ;AAAA,MACF;AAAA,IAGF;AAAA,IACA;AAAA,EAAA;AAGF,MAAId,EAAU,QAAOA;AAGvB;AC9HO,SAASe,GACdC,GACAjB,GACAkB,GACAC,GACkB;AAClB,QAAMC,IAAwBC,EAAY,MAAM;AAC9C,QAAIJ,EAAO,aAAa;AACtB,MAAAE,EAAa;AAAA,QACX,MAAMF,EAAO;AAAA,QACb,YAAYA,EAAO,aAAa;AAAA,QAChC,UAAU;AAAA,MAAA,CACX;AAAA,SACI;AAEL,YAAMK,IAAmBtB,EAAe,QAAQiB,EAAO,IAAI;AAC3D,UAAIK,IAAmB,GAAG;AACxB,cAAMC,IAAevB,EAAesB,IAAmB,CAAC,GAClDE,IAAc,KAAK,IAAI3B,GAAgB0B,CAAY,GAAG,CAAC;AAC7D,QAAAJ,EAAa;AAAA,UACX,MAAMI;AAAA,UACN,YAAYC;AAAA,UACZ,UAAU;AAAA,QAAA,CACX;AAAA,MACH;AAAA,IACF;AAAA,EACF,GAAG,CAACP,GAAQjB,GAAgBmB,CAAY,CAAC,GAEnCM,IAAoBJ,EAAY,MAAM;AAC1C,UAAMK,IAAa7B,GAAgBoB,EAAO,IAAI;AAC9C,QAAIA,EAAO,aAAaS;AACtB,MAAAP,EAAa;AAAA,QACX,MAAMF,EAAO;AAAA,QACb,YAAYA,EAAO,aAAa;AAAA,QAChC,UAAU;AAAA,MAAA,CACX;AAAA,SACI;AAEL,YAAMK,IAAmBtB,EAAe,QAAQiB,EAAO,IAAI;AAC3D,UAAIK,IAAmBtB,EAAe,SAAS,GAAG;AAChD,cAAM2B,IAAW3B,EAAesB,IAAmB,CAAC;AACpD,QAAAH,EAAa;AAAA,UACX,MAAMQ;AAAA,UACN,YAAY;AAAA,UACZ,UAAU;AAAA,QAAA,CACX;AAAA,MACH;AAAA,IACF;AAAA,EACF,GAAG,CAACV,GAAQjB,GAAgBmB,CAAY,CAAC,GAEnCS,IAAsBP,EAAY,MAAM;AAC5C,IAAAF,EAAa;AAAA,MACX,MAAMF,EAAO;AAAA,MACb,YAAYA,EAAO;AAAA,MACnB,UAAUA,EAAO,WAAW,IAAIA,EAAO,WAAW,IAAI;AAAA,IAAA,CACvD;AAAA,EACH,GAAG,CAACA,GAAQE,CAAY,CAAC,GAEnBU,IAAkBR,EAAY,MAAM;AACxC,IAAAF,EAAa;AAAA,MACX,MAAMF,EAAO;AAAA,MACb,YAAYA,EAAO;AAAA,MACnB,UAAUA,EAAO,WAAW;AAAA,IAAA,CAC7B;AAAA,EACH,GAAG,CAACA,GAAQE,CAAY,CAAC;AAEzB,SAAOtE,EAAQ,MACN;AAAA,IACL;AAAA,MACE,SAASuE;AAAA,MACT,UACEpB,EAAe,WAAW,KACzBiB,EAAO,eAAe,KAAKjB,EAAe,QAAQiB,EAAO,IAAI,MAAM;AAAA,MACtE,OAAO;AAAA,MACP,MAAMC,MAAc,QAAQY,KAAeC;AAAA,IAAA;AAAA,IAE7C;AAAA,MACE,SAASH;AAAA,MACT,UAAU5B,EAAe,WAAW,KAAKiB,EAAO,aAAa;AAAA,MAC7D,OAAO;AAAA,MACP,MAAMC,MAAc,QAAQc,KAAcC;AAAA,IAAA;AAAA,IAE5C;AAAA,MACE,SAASJ;AAAA,MACT,UAAU7B,EAAe,WAAW;AAAA,MACpC,OAAO;AAAA,MACP,MAAMkB,MAAc,QAAQe,KAAeD;AAAA,IAAA;AAAA,IAE7C;AAAA,MACE,SAASP;AAAA,MACT,UACEzB,EAAe,WAAW,MACxBiB,EAAO,eAAepB,GAAgBoB,EAAO,IAAI,KACjDpB,GAAgBoB,EAAO,IAAI,KAAK,MAChCjB,EAAe,QAAQiB,EAAO,IAAI,MAAMjB,EAAe,SAAS;AAAA,MACpE,OAAO;AAAA,MACP,MAAMkB,MAAc,QAAQa,KAAgBD;AAAA,IAAA;AAAA,EAC9C,GAED;AAAA,IACDb;AAAA,IACAjB;AAAA,IACAkB;AAAA,IACAE;AAAA,IACAQ;AAAA,IACAC;AAAA,IACAJ;AAAA,EAAA,CACD;AACH;ACjGO,SAASS,GAAY;AAAA,EAC1B,QAAA/G;AAAA,EACA,QAAA8F;AAAA,EACA,iBAAAkB;AAAA,EACA,eAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,WAAArJ;AACF,GAAqB;AACnB,MAAKmC;AAEL,WACE,gBAAAhC,EAACe,IAAA,EACC,UAAA,gBAAAf,EAAC,OAAA,EAAI,WAAWd,EAAG,mCAAmCW,CAAS,GAC5D,UAAA,MAAM,KAAK,EAAE,QAAQ6G,GAAgB1E,CAAM,EAAA,GAAK,CAACmH,GAAGC,MAAMA,IAAI,CAAC,EAAE,IAAI,CAACxE,MACrE,gBAAA5E;AAAA,MAACiB;AAAA,MAAA;AAAA,QAEC,OAAO,GAAGe,CAAM,IAAIM,GAAuBN,CAAM,KAAK,EAAE,IAAI4C,CAAO;AAAA,QACnE,UAAU,MAAMoE,EAAgBpE,CAAO;AAAA,QACvC,KAAKqE,EAAcrE,CAAO;AAAA,QAC1B,WAAW1F;AAAA,UACT;AAAA,UACA;AAAA,YACE,4CACE8C,MAAW8F,EAAO,QAAQlD,MAAYkD,EAAO;AAAA,UAAA;AAAA,UAEjD;AAAA,YACE,+CAA8CoB,KAAA,gBAAAA,EAAkBtE,OAAY;AAAA,UAAA;AAAA,QAC9E;AAAA,QAGD,UAAAA;AAAA,MAAA;AAAA,MAfIA;AAAA,IAAA,CAiBR,GACH,EAAA,CACF;AAEJ;ACjBO,SAASyE,GAAmB;AAAA,EACjC,QAAAvB;AAAA,EACA,cAAAE;AAAA,EACA,WAAAnI;AAAA,EACA,kBAAAyJ;AAAA,EACA,oBAAArH;AAAA,EACA,kBAAAsH;AAAA,EACA,gBAAAzE;AAAA,EACA,mBAAA0E;AAAA,EACA,IAAAnE;AACF,GAA4B;AAC1B,QAAM0C,IAAuBzI,GAAA,GAGvB,CAACmK,GAAeC,CAAgB,IAAIjE,EAAS,EAAK,GAElD,CAACtC,GAAcwG,CAAe,IAAIlE,EAAS,EAAE,GAE7C,CAACmE,GAAYC,CAAa,IAAIpE,EAAS,EAAE,GAEzC,CAACqE,GAAUC,CAAW,IAAItE,EAAmB,OAAO,GAEpD,CAACuE,GAA6BC,CAA8B,IAAIxE,EAEpE,MAAS,GACL,CAACyE,GAAqBC,CAAsB,IAAI1E,EAAS,EAAK,GAI9D2E,IAAa/G,EAAuB,MAAU,GAG9CgH,IAAkBhH,EAAyB,MAAU,GAGrDiH,IAAiBjH,EAAuB,MAAU,GAGlDkH,IAAsBlH,EAAuB,MAAU,GAEvDmH,IAAcnH,EAA8C,EAAE,GAG9DoH,IAA6BvC;AAAA,IACjC,CAACwC,MAAkC;AACjC,MAAA1C,EAAa0C,CAAS,GAClBlB,KACFA,EAAkBkB,CAAS;AAAA,IAE/B;AAAA,IACA,CAAC1C,GAAcwB,CAAiB;AAAA,EAAA,GAK5BmB,IAAgBjH,EAAQ,MACrB4F,IAAmBA,MAAqBjH,IAC9C,CAACiH,CAAgB,CAAC,GAEfsB,IAAuBlH,EAAQ,OACQ;AAAA,IACzC,CAACjC,EAAQ,EAAE,GAAGkJ,EAAc,OAAO,CAAC3I,MAAWG,GAAM,SAASH,CAAM,CAAC;AAAA,IACrE,CAACP,EAAQ,EAAE,GAAGkJ,EAAc,OAAO,CAAC3I,MAAWG,GAAM,SAASH,CAAM,CAAC;AAAA,IACrE,CAACP,EAAQ,EAAE,GAAGkJ,EAAc,OAAO,CAAC3I,MAAWG,GAAM,SAASH,CAAM,CAAC;AAAA,IACrE,CAACP,EAAQ,KAAK,GAAGkJ,EAAc,OAAO,CAAC3I,MAAWG,GAAM,WAAA,EAAa,SAASH,CAAM,CAAC;AAAA,EAAA,IAGtF,CAAC2I,CAAa,CAAC,GAEZ9D,IAAiBnD,EAAQ,MACtB,OAAO,OAAOkH,CAAoB,EAAE,KAAA,GAC1C,CAACA,CAAoB,CAAC,GAGnBC,IAAsBnH,EAAQ,MAAM;AACxC,QAAI,CAACkG,EAAW,KAAA,EAAQ,QAAOgB;AAE/B,UAAME,IAA2C;AAAA,MAC/C,CAACrJ,EAAQ,EAAE,GAAG,CAAA;AAAA,MACd,CAACA,EAAQ,EAAE,GAAG,CAAA;AAAA,MACd,CAACA,EAAQ,EAAE,GAAG,CAAA;AAAA,MACd,CAACA,EAAQ,KAAK,GAAG,CAAA;AAAA,IAAC;AAIpB,WAD6B,CAACA,EAAQ,IAAIA,EAAQ,IAAIA,EAAQ,IAAIA,EAAQ,KAAK,EACrE,QAAQ,CAACsJ,OAAS;AAC1B,MAAAD,EAAcC,EAAI,IAAIH,EAAqBG,EAAI,EAAE,OAAO,CAAC/I,OAChDO,GAAmBP,IAAQ4H,GAAY3H,CAAkB,CACjE;AAAA,IACH,CAAC,GAEM6I;AAAA,EACT,GAAG,CAACF,GAAsBhB,GAAY3H,CAAkB,CAAC,GAGnD6E,IAAWpD;AAAA,IACf,MAAMkD,GAAkBgD,GAAY/C,GAAgB5E,CAAkB;AAAA,IACtE,CAAC2H,GAAY/C,GAAgB5E,CAAkB;AAAA,EAAA,GAO3C+I,IAAuB9C,EAAY,MAAM;AAE7C,IAAIpB,MACF2D,EAA2B;AAAA,MACzB,MAAM3D,EAAS;AAAA,MACf,YAAYA,EAAS,cAAc;AAAA,MACnC,UAAUA,EAAS,YAAY;AAAA,IAAA,CAChC,GACD4C,EAAiB,EAAK,GACtBG,EAAc,EAAE,GAChBF,EAAgB,EAAE;AAAA,EAEtB,GAAG,CAACc,GAA4B3D,CAAQ,CAAC,GAEnCmE,KAAmB/C;AAAA,IACvB,CAAClG,MAAmB;AAGlB,UADmB0E,GAAgB1E,CAAM,KACvB,GAAG;AACnB,QAAAyI,EAA2B;AAAA,UACzB,MAAMzI;AAAA,UACN,YAAY;AAAA,UACZ,UAAU;AAAA,QAAA,CACX,GACD0H,EAAiB,EAAK,GACtBG,EAAc,EAAE;AAChB;AAAA,MACF;AAGA,MAAAI,EAA+BjI,CAAM,GACrC+H,EAAY,UAAU;AAAA,IACxB;AAAA,IACA,CAACU,CAA0B;AAAA,EAAA,GAGvBS,KAAsBhD;AAAA,IAC1B,CAACiD,MAA0B;AAEzB,YAAMnJ,IAAS8H,MAAa,aAAaE,IAA8BlD,KAAA,gBAAAA,EAAU;AACjF,MAAK9E,MAELyI,EAA2B;AAAA,QACzB,MAAMzI;AAAA,QACN,YAAYmJ;AAAA,QACZ,UAAU;AAAA,MAAA,CACX,GACDzB,EAAiB,EAAK,GACtBK,EAAY,OAAO,GACnBE,EAA+B,MAAS,GACxCJ,EAAc,EAAE;AAAA,IAClB;AAAA,IACA,CAACY,GAA4BX,GAAUE,GAA6BlD,CAAQ;AAAA,EAAA,GAGxEsE,KAAyBlD;AAAA,IAC7B,CAACjD,MAA6B;AAC5B,MAAAwF,EAA2BxF,CAAI,GAC/ByE,EAAiB,EAAK,GACtBG,EAAc,EAAE;AAAA,IAClB;AAAA,IACA,CAACY,CAA0B;AAAA,EAAA,GAQvBY,KAAkBxD,GAAmBC,GAAQjB,GAAgBkB,GAAWC,CAAY,GAEpFsD,KAAoBpD,EAAY,MAAM;AAC1C,IAAA6B,EAAY,OAAO,GACnBE,EAA+B,MAAS,GAGxC,WAAW,MAAM;AACf,MAAII,EAAgB,WAClBA,EAAgB,QAAQ,MAAA;AAAA,IAE5B,GAAG,CAAC;AAAA,EACN,GAAG,CAAA,CAAE,GAGCkB,IAAmBrD;AAAA,IACvB,CAACsD,MAAiC;AAEhC,UAAI,CAACA,KAAuB1B,MAAa,YAAY;AACnD,QAAAwB,GAAA;AACA;AAAA,MACF;AAEA,MAAA5B,EAAiB8B,CAAmB,GAEhCA,MAEFzB,EAAY,OAAO,GACnBE,EAA+B,MAAS,GACxCJ,EAAc,EAAE;AAAA,IAEpB;AAAA,IACA,CAACC,GAAUwB,EAAiB;AAAA,EAAA,GAOxB,EAAE,QAAAG,IAAQ,QAAAC,IAAQ,QAAAC,IAAQ,WAAAC,OAAc;AAAA,IAC5C,QAAQrC,KAAA,gBAAAA,EAAmB;AAAA,IAC3B,QAAQA,KAAA,gBAAAA,EAAmB;AAAA,IAC3B,QAAQA,KAAA,gBAAAA,EAAmB;AAAA,IAC3B,WAAWA,KAAA,gBAAAA,EAAmB;AAAA,EAAgC,GAG1DsC,KAAkB3D;AAAA,IACtB,CAAC9G,MACQD,GAAmBC,GAASqK,IAAQC,IAAQC,IAAQC,EAAS;AAAA,IAEtE,CAACH,IAAQC,IAAQC,IAAQC,EAAS;AAAA,EAAA,GAG9BE,KAAmB5D;AAAA,IACvB,CAACtD,MACMkC,IACE,CAAC,CAACA,EAAS,cAAc,CAAClC,EAAQ,SAAA,EAAW,SAASkC,EAAS,WAAW,SAAA,CAAU,IADrE;AAAA,IAGxB,CAACA,CAAQ;AAAA,EAAA,GAGLiF,KAAsBrI;AAAA,IAC1B,MACEsI;AAAA,MACElE;AAAA,MACA7F,IAAqBF,GAAqB+F,EAAO,MAAM7F,CAAkB,IAAI;AAAA,IAAA;AAAA,IAEjF,CAAC6F,GAAQ7F,CAAkB;AAAA,EAAA,GAGvBgH,KAAgBf,EAAY,CAACtD,MAC1B,CAACqH,MAAmC;AACzC,IAAAzB,EAAY,QAAQ5F,CAAO,IAAIqH;AAAA,EACjC,GACC,CAAA,CAAE,GAOCC,KAAqBhE,EAAY,CAACiE,MAA2C;AAGjF,KAAIA,EAAM,QAAQ,UAAUA,EAAM,QAAQ,UACxCA,EAAM,gBAAA;AAAA,EAEV,GAAG,CAAA,CAAE,GAGCC,KAAuBlE;AAAA,IAC3B,CAACiE,MAA6D;AAC5D,UAAIA,EAAM,QAAS;AAEnB,YAAM,EAAE,UAAA3F,GAAU,SAAAC,GAAA,IAAYH,GAAoB6F,EAAM,GAAG;AAG3D,UAAIrC,MAAa,YAAY;AAE3B,YAAIqC,EAAM,QAAQ,aAAa;AAC7B,UAAAA,EAAM,eAAA,GACNA,EAAM,gBAAA,GACNb,GAAA;AACA;AAAA,QACF;AAEA,YAAI9E,KAAYC,IAAS;AAMvB,cALA0F,EAAM,eAAA,GACNA,EAAM,gBAAA,GACNpC,EAAY,OAAO,GACnBE,EAA+B,MAAS,GAEpCxD,MAAWuD,GAA6B;AAE1C,kBAAMqC,KAAkB/J,GAAuB0H,CAA2B;AAC1E,YAAAH,EAAc,GAAGwC,EAAe,IAAIF,EAAM,GAAG,EAAE;AAAA,UACjD;AACE,YAAAtC,EAAcsC,EAAM,GAAG;AAGzB,qBAAW,MAAM;AACf,YAAI9B,EAAgB,WAClBA,EAAgB,QAAQ,MAAA;AAAA,UAE5B,GAAG,CAAC;AACJ;AAAA,QACF;AAAA,MACF;AAGA,WACGP,MAAa,cAAeA,MAAa,WAAWhD,MACrD,CAAC,WAAW,aAAa,aAAa,YAAY,EAAE,SAASqF,EAAM,GAAG,GACtE;AAEA,cAAMG,KACJxC,MAAa,aAAaE,IAA8BlD,KAAA,gBAAAA,EAAU;AACpE,YAAI,CAACwF,GAAe;AAGpB,cAAMC,MAAkB,MAAM;AAC5B,cAAI,CAACpJ,EAAc,QAAO;AAC1B,gBAAMqJ,KAAQrJ,EAAa,MAAM,QAAQ;AACzC,iBAAOqJ,KAAQ,SAASA,GAAM,CAAC,GAAG,EAAE,IAAI;AAAA,QAC1C,GAAA,GAEMjE,KAAa7B,GAAgB4F,EAAa;AAEhD,YAAI,CAAC/D,GAAY;AAEjB,YAAIkE,KAAgBF;AACpB,cAAMG,KAAY;AAElB,gBAAQP,EAAM,KAAA;AAAA,UACZ,KAAK;AACH,YAAII,OAAmB,MACrBE,KAAgBF,KAAiB,IAAIA,KAAiB,IAAIhE;AAC5D;AAAA,UACF,KAAK;AACH,YAAIgE,OAAmB,MACrBE,KAAgBF,KAAiBhE,KAAagE,KAAiB,IAAI;AACrE;AAAA,UACF,KAAK;AACH,YAAAE,KACEF,OAAmB,IAAIhE,KAAa,KAAK,IAAI,GAAGgE,KAAiBG,EAAS;AAC5E;AAAA,UACF,KAAK;AACH,YAAAD,KACEF,OAAmB,IAAI,IAAI,KAAK,IAAIhE,IAAYgE,KAAiBG,EAAS;AAC5E;AAAA,UACF;AACE;AAAA,QAAA;AAGJ,QAAID,OAAkBF,OACpBJ,EAAM,eAAA,GACNA,EAAM,gBAAA,GAGNxC,EAAgBhF,GAAqB2H,IAAerK,GAAoBwK,EAAa,CAAC,GAGtF,WAAW,MAAM;AACf,gBAAME,KAAgBnC,EAAY,QAAQiC,EAAa;AACvD,UAAIE,MACFA,GAAc,eAAe,EAAE,OAAO,WAAW,UAAU,UAAU;AAAA,QAEzE,GAAG,CAAC;AAAA,MAER;AAAA,IACF;AAAA,IACA;AAAA,MACE7C;AAAA,MACAhD;AAAA,MACAwE;AAAA,MACAtB;AAAA,MACA7G;AAAA,MACAlB;AAAA,IAAA;AAAA,EACF,GAGI2K,KAA8B1E,EAAY,CAACiE,MAA4C;AAC3F,QAAIA,EAAM,YAAYA,EAAM,QAAQ,SAASA,EAAM,QAAQ,IAAK;AAEhE,UAAM,EAAE,UAAA3F,GAAU,SAAAC,GAAA,IAAYH,GAAoB6F,EAAM,GAAG;AAE3D,KAAI3F,KAAYC,QACd0F,EAAM,eAAA,GAENtC,EAAc,CAACgD,OAAcA,KAAYV,EAAM,GAAG,GAClD9B,EAAgB,QAAQ,MAAA,GAExBF,EAAuB,EAAK;AAAA,EAEhC,GAAG,CAAA,CAAE;AAOL,SAAA2C,GAAgB,MAAM;AACpB,UAAMC,IAAgB,WAAW,MAAM;AACrC,UACEtD,KACAK,MAAa,WACbQ,EAAe,WACfC,EAAoB,SACpB;AACA,cAAMyC,IAAc1C,EAAe,SAC7B2C,KAAc1C,EAAoB,SAGlC2C,KAAgBD,GAAY,WAC5BE,KAAaH,EAAY,cACzBI,KAAaH,GAAY,cACzBI,KAAiBH,KAAgBC,KAAa,IAAIC,KAAa;AAErE,QAAAJ,EAAY,SAAS;AAAA,UACnB,KAAK,KAAK,IAAI,GAAGK,EAAc;AAAA,UAC/B,UAAU;AAAA,QAAA,CACX,GAGD1D,EAAgBhF,GAAqBmD,EAAO,IAAI,CAAC;AAAA,MACnD;AAAA,IACF,GAAG,CAAC;AAEJ,WAAO,MAAM;AACX,mBAAaiF,CAAa;AAAA,IAC5B;AAAA,EACF,GAAG,CAACtD,GAAeK,GAAUF,GAAY9C,GAAUgB,EAAO,IAAI,CAAC,GAG/DgF,GAAgB,MAAM;AACpB,QAAIhD,MAAa,cAAcE,GAA6B;AAE1D,YAAMsD,IAA0BtD,MAAgClC,EAAO;AAGvE,iBAAW,MAAM;AACf,YAAIwC,EAAe;AACjB,cAAIgD,GAAyB;AAE3B,kBAAMX,IAAgBnC,EAAY,QAAQ1C,EAAO,UAAU;AAC3D,YAAI6E,KACFA,EAAc,eAAe,EAAE,OAAO,UAAU,UAAU,UAAU;AAAA,UAExE;AAEE,YAAArC,EAAe,QAAQ,SAAS,EAAE,KAAK,GAAG;AAK9C,QAAIF,EAAW,WACbA,EAAW,QAAQ,MAAA;AAAA,MAEvB,GAAG,CAAC;AAAA,IACN;AAAA,EACF,GAAG,CAACN,GAAUE,GAA6BlD,GAAUgB,EAAO,MAAMA,EAAO,UAAU,CAAC,GAKlF,gBAAA1H,EAACgE,IAAA,EAAQ,MAAMqF,GAAe,cAAc8B,GAC1C,UAAA;AAAA,IAAA,gBAAAvL,EAACsE,IAAA,EAAe,SAAO,IACrB,UAAA,gBAAAtE;AAAA,MAAC+D;AAAA,MAAA;AAAA,QACC,cAAW;AAAA,QACX,SAAQ;AAAA,QACR,MAAK;AAAA,QACL,iBAAe0F;AAAA,QACf,WAAWvK;AAAA,UACT;AAAA,UACAW;AAAA,QAAA;AAAA,QAGF,UAAA,gBAAAG,EAAC,QAAA,EAAK,WAAU,eAAe,UAAA+L,GAAA,CAAoB;AAAA,MAAA;AAAA,IAAA,GAEvD;AAAA,IACA,gBAAA/L,EAACwE,MAAe,IAAAa,GAAQ,YAAU,IAAC,WAAU,uBAAsB,OAAM,UACvE,UAAA,gBAAAjF;AAAA,MAACK;AAAA,MAAA;AAAA,QACC,KAAK2J;AAAA,QACL,WAAWgC;AAAA,QACX,MAAI;AAAA,QACJ,OAAOjJ;AAAA,QACP,eAAewG;AAAA,QACf,cAAc;AAAA,QAGb,UAAA;AAAA,UAAAG,MAAa,UACZ,gBAAA1J,EAAC,OAAA,EAAI,WAAU,wBACb,UAAA;AAAA,YAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,yBACb,UAAA;AAAA,cAAA,gBAAAJ;AAAA,gBAACW;AAAA,gBAAA;AAAA,kBACC,KAAK0J;AAAA,kBACL,OAAOT;AAAA,kBACP,eAAeC;AAAA,kBACf,WAAWqC;AAAA,kBACX,SAAS,MAAM/B,EAAuB,EAAK;AAAA,kBAC3C,WAAWrF,KAAkBA,EAAe,SAAS,IAAI,cAAc;AAAA,gBAAA;AAAA,cAAA;AAAA,cAExEA,KAAkBA,EAAe,SAAS,KACzC,gBAAA9E;AAAA,gBAAC6E;AAAA,gBAAA;AAAA,kBACC,gBAAAC;AAAA,kBACA,oBAAoBsG;AAAA,kBACpB,YAAY,CAACmC,MAAavB,GAAauB,GAAU,SAAS;AAAA,kBAC1D,YAAY,CAACA,MACX,GAAGA,EAAS,IAAI,IAAIA,EAAS,UAAU,IAAIA,EAAS,QAAQ;AAAA,kBAE9D,WAAWhE,KAAA,gBAAAA,EAAmB;AAAA,kBAC9B,cAAcA,KAAA,gBAAAA,EAAmB;AAAA,gBAAkB;AAAA,cAAA;AAAA,YACrD,GAEJ;AAAA,YAEA,gBAAAvJ,EAAC,OAAA,EAAI,WAAU,wDACZ,UAAAqL,GAAgB,IAAI,CAAC,EAAE,SAAAmC,GAAS,UAAAC,GAAU,OAAAC,IAAO,MAAMC,SACtD,gBAAA3N;AAAA,cAAC+D;AAAA,cAAA;AAAA,gBAEC,SAAQ;AAAA,gBACR,MAAK;AAAA,gBACL,SAAS,MAAM;AACb,kBAAAoG,EAAuB,EAAI,GAC3BqD,EAAA;AAAA,gBACF;AAAA,gBACA,UAAAC;AAAA,gBACA,WAAU;AAAA,gBACV,OAAAC;AAAA,gBACA,WAAWd;AAAA,gBAEX,4BAACe,IAAA,CAAA,CAAK;AAAA,cAAA;AAAA,cAZDD;AAAA,YAAA,CAcR,EAAA,CACH;AAAA,UAAA,EAAA,CACF,IAEA,gBAAAtN,EAAC,OAAA,EAAI,WAAU,uDACb,UAAA;AAAA,YAAA,gBAAAJ;AAAA,cAAC+D;AAAA,cAAA;AAAA,gBACC,SAAQ;AAAA,gBACR,MAAK;AAAA,gBACL,SAASuH;AAAA,gBACT,WAAU;AAAA,gBACV,UAAU;AAAA,gBAET,UAAAvD,MAAc,QACb,gBAAA/H,EAAC4N,IAAA,EAAU,WAAU,iBAAgB,IAErC,gBAAA5N,EAAC6N,IAAA,EAAW,WAAU,gBAAA,CAAgB;AAAA,cAAA;AAAA,YAAA;AAAA,YAGzC7D,KACC,gBAAAhK,EAAC,QAAA,EAAK,UAAU,IAAI,WAAU,6BAC3B,UAAA+B,GAAqBiI,GAA6B/H,CAAkB,EAAA,CACvE;AAAA,UAAA,GAEJ;AAAA,UAID,CAACiI,KACA,gBAAA9J,EAACS,IAAA,EAAY,KAAKyJ,GAEf,UAAA;AAAA,YAAAR,MAAa,WACZ,gBAAA1J,EAAA0N,IAAA,EAEG,UAAA;AAAA,cAAA,CAAChH,KACA,OAAO,QAAQ+D,CAAmB,EAAE,IAAI,CAAC,CAACE,GAAMgD,CAAK,MAAM;AACzD,oBAAIA,EAAM,WAAW;AAErB;AAAA;AAAA;AAAA,oBAGE,gBAAA/N,EAACe,MAAwB,SAAS8K,GAAgBd,CAAe,GAC9D,UAAAgD,EAAM,IAAI,CAAC/L,OACV,gBAAAhC;AAAA,sBAAC6C;AAAA,sBAAA;AAAA,wBAEC,QAAAb;AAAA,wBACA,UAAU,CAACgM,OACT/C,GAAiB+C,EAAc;AAAA,wBAEjC,SAASC,GAAkBjM,EAAM;AAAA,wBACjC,cAAc,GAAGA,EAAM,IAAIM,GAAuBN,EAAM,CAAC;AAAA,wBACzD,KAAKA,OAAW8F,EAAO,OAAOyC,IAAsB;AAAA,wBACpD,oBAAAtI;AAAA,sBAAA;AAAA,sBARKD;AAAA,oBAAA,CAUR,KAbgB+I,CAcnB;AAAA;AAAA,cAEJ,CAAC;AAAA,cAGFjE,uBACE/F,IAAA,EACC,UAAA,gBAAAf;AAAA,gBAACiB;AAAA,gBAAA;AAAA,kBAEC,OAAO,GAAG6F,EAAS,IAAI,IAAIxE,GAAuBwE,EAAS,IAAI,CAAC,IAC9DA,EAAS,cAAc,EACzB,IAAIA,EAAS,YAAY,EAAE;AAAA,kBAC3B,UAAUkE;AAAA,kBACV,WAAU;AAAA,kBAET,UAAAgB;AAAA,oBACC;AAAA,sBACE,MAAMlF,EAAS;AAAA,sBACf,YAAYA,EAAS,cAAc;AAAA,sBACnC,UAAUA,EAAS,YAAY;AAAA,oBAAA;AAAA,oBAEjC7E,IACIG,GAAmB0E,EAAS,MAAM7E,CAAkB,IACpD;AAAA,kBAAA;AAAA,gBACN;AAAA,gBAhBI;AAAA,cAAA,GAkBR;AAAA,cAID6E,KAAYJ,GAAgBI,EAAS,IAAI,IAAI,KAC5C,gBAAA1G,EAAA0N,IAAA,EACE,UAAA;AAAA,gBAAA,gBAAA9N,EAAC,SAAI,WAAU,sEACZ,aAAqB8G,EAAS,MAAM7E,CAAkB,GACzD;AAAA,gBACA,gBAAAjC;AAAA,kBAAC+I;AAAA,kBAAA;AAAA,oBACC,QAAQjC,EAAS;AAAA,oBACjB,QAAAgB;AAAA,oBACA,iBAAiBoD;AAAA,oBACjB,eAAAjC;AAAA,oBACA,iBAAiB6C;AAAA,oBACjB,WAAU;AAAA,kBAAA;AAAA,gBAAA;AAAA,cACZ,EAAA,CACF;AAAA,YAAA,GAEJ;AAAA,YAIDhC,MAAa,cAAcE,KAC1B,gBAAAhK;AAAA,cAAC+I;AAAA,cAAA;AAAA,gBACC,QAAQiB;AAAA,gBACR,QAAAlC;AAAA,gBACA,iBAAiBoD;AAAA,gBACjB,eAAAjC;AAAA,gBACA,WAAU;AAAA,cAAA;AAAA,YAAA;AAAA,UACZ,EAAA,CAEJ;AAAA,QAAA;AAAA,MAAA;AAAA,IAAA,EAEJ,CACF;AAAA,EAAA,GACF;AAEJ;ACtqBO,MAAMiF,KAAmC,OAAO,OAAO;AAAA,EAC5D;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAU,GCHJC,KAAgBrK;AAAA,EACpB;AACF,GASasK,KAAQxO,EAAM,WAGzB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC,EAACqO,GAAe,MAAf,EAAoB,KAAAtO,GAAU,WAAWb,EAAG,UAAUiP,GAAA,GAAiBtO,CAAS,GAAI,GAAGC,GAAO,CAChG;AACDsO,GAAM,cAAcC,GAAe,KAAK;ACdxC,MAAMC,KAAa1O,EAAM,WAGvB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAAQ;AAClC,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAU;AAAA,IAACuO,GAAoB;AAAA,IAApB;AAAA,MACC,WAAWrP,EAAG,2BAA2BW,CAAS;AAAA,MACjD,GAAGC;AAAA,MACJ,KAAAC;AAAA,MACA,KAAAI;AAAA,IAAA;AAAA,EAAA;AAGN,CAAC;AACDmO,GAAW,cAAcC,GAAoB,KAAK;AAGlD,MAAMC,KAAiB5O,EAAM,WAG3B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAExB,gBAAAC;AAAA,EAACuO,GAAoB;AAAA,EAApB;AAAA,IACC,KAAAxO;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,IAEJ,UAAA,gBAAAE,EAACuO,GAAoB,WAApB,EAA8B,WAAU,6CACvC,UAAA,gBAAAvO,EAACyO,IAAA,EAAO,WAAU,oDAAA,CAAoD,EAAA,CACxE;AAAA,EAAA;AAAA,CAGL;AACDD,GAAe,cAAcD,GAAoB,KAAK;ACuBtD,SAASG,GAAsBC,GAAgC;AAC7D,SAAI,OAAOA,KAAW,WACbA,IAEL,OAAOA,KAAW,WACbA,EAAO,SAAA,IAETA,EAAO;AAChB;AAQO,SAASC,GAAoD;AAAA,EAClE,IAAAvJ;AAAA,EACA,SAAAwJ,IAAU,CAAA;AAAA,EACV,WAAAhP;AAAA,EACA,iBAAAiP;AAAA,EACA,yBAAAC;AAAA,EACA,OAAAC;AAAA,EACA,UAAAC,IAAW,MAAM;AAAA,EAAC;AAAA,EAClB,gBAAAC,IAAiBR;AAAA,EACjB,gBAAAS;AAAA,EACA,MAAAC,IAAO;AAAA,EACP,mBAAAC,IAAoB;AAAA,EACpB,iBAAAC,IAAkB;AAAA,EAClB,qBAAAC,IAAsB;AAAA,EACtB,eAAAC,IAAgB;AAAA,EAChB,eAAAC,IAAgB;AAAA,EAChB,YAAAC,IAAa;AAAA,EACb,WAAAvK;AAAA,EACA,GAAGrF;AACL,GAAqB;AACnB,QAAM,CAAC6P,GAAMC,CAAO,IAAInK,EAAS,EAAK,GAEhCoK,IAAcV,KAAkBD,GAEhCY,IAAmB,CACvBC,MAGEA,EAAa,SAAS,KACpB,OAAOA,EAAa,CAAC,KAAM,YAC3B,aAAaA,EAAa,CAAC,GAI3BC,IAAoB,CAACrB,GAAWvJ,MAA0B;AAC9D,UAAM6K,IAAcf,EAAeP,CAAM,GACnCuB,IACJ,OAAOvB,KAAW,YAAY,oBAAoBA,IAASA,EAAO,iBAAiB,QAE/EpI,IAAM,GAAGnB,KAAgB,EAAE,GAAG6K,CAAW,GAAGC,KAAkB,EAAE;AAEtE,WACE,gBAAA9P;AAAA,MAACa;AAAA,MAAA;AAAA,QAEC,OAAOgP;AAAA,QACP,UAAU,MAAM;AACd,UAAAhB,EAASN,CAAM,GACfiB,EAAQ,EAAK;AAAA,QACf;AAAA,QACA,WAAU;AAAA,QAEV,UAAA;AAAA,UAAA,gBAAA5P;AAAA,YAAC4D;AAAA,YAAA;AAAA,cACC,WAAW1E,EAAG,qCAAqC;AAAA,gBACjD,gBAAgB,CAAC8P,KAASE,EAAeF,CAAK,MAAMiB;AAAA,cAAA,CACrD;AAAA,YAAA;AAAA,UAAA;AAAA,UAEH,gBAAA7P,EAAC,QAAA,EAAK,WAAU,sEACb,UAAA;AAAA,YAAA6P;AAAA,YACAC,KAAkB,gBAAA9P,EAAC,QAAA,EAAK,WAAU,4BAA2B,UAAA;AAAA,cAAA;AAAA,cAAI8P;AAAA,YAAA,EAAA,CAAe;AAAA,UAAA,EAAA,CACnF;AAAA,QAAA;AAAA,MAAA;AAAA,MAhBK3J;AAAA,IAAA;AAAA,EAmBX;AAEA,2BACGnC,IAAA,EAAQ,MAAAuL,GAAY,cAAcC,GAAU,GAAG9P,GAC9C,UAAA;AAAA,IAAA,gBAAAE,EAACsE,IAAA,EAAe,SAAO,IACrB,UAAA,gBAAAlE;AAAA,MAAC2D;AAAA,MAAA;AAAA,QACC,SAASyL;AAAA,QACT,MAAK;AAAA,QACL,iBAAeG;AAAA,QACf,cAAYxK;AAAA,QACZ,IAAAE;AAAA,QACA,WAAWnG;AAAA,UACT;AAAA,UACA4P,KAAmBjP;AAAA,QAAA;AAAA,QAErB,UAAU6P;AAAA,QAEV,UAAA;AAAA,UAAA,gBAAAtP,EAAC,OAAA,EAAI,WAAU,mEACZ,UAAA;AAAA,YAAAgP,KAAQ,gBAAApP,EAAC,OAAA,EAAI,WAAU,uBAAuB,UAAAoP,GAAK;AAAA,YACpD,gBAAApP;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,WAAWd;AAAA,kBACT;AAAA,gBAAA;AAAA,gBAGD,UAAA8P,IAAQa,EAAYb,CAAK,IAAIK;AAAA,cAAA;AAAA,YAAA;AAAA,UAChC,GACF;AAAA,UAEA,gBAAArP,EAACmQ,IAAA,EAAY,WAAU,kDAAA,CAAkD;AAAA,QAAA;AAAA,MAAA;AAAA,IAAA,GAE7E;AAAA,IACA,gBAAAnQ;AAAA,MAACwE;AAAA,MAAA;AAAA,QACC,OAAOiL;AAAA,QACP,WAAWvQ,EAAG,uBAAuB6P,CAAuB;AAAA,QAE5D,4BAACtO,IAAA,EACC,UAAA;AAAA,UAAA,gBAAAT,EAACW,IAAA,EAAa,aAAa2O,GAAiB,WAAU,mBAAkB;AAAA,UACxE,gBAAAtP,EAACc,MAAc,UAAAyO,EAAA,CAAoB;AAAA,4BAClC1O,IAAA,EACE,UAAAiP,EAAiBjB,CAAO,IACrBA,EAAQ,IAAI,CAACuB,MACX,gBAAApQ,EAACe,MAAsC,SAASqP,EAAM,cACnD,UAAAA,EAAM,QAAQ,IAAI,CAACzB,MAAWqB,EAAkBrB,GAAQyB,EAAM,YAAY,CAAC,KAD3DA,EAAM,YAEzB,CACD,IACDvB,EAAQ,IAAI,CAACF,MAAWqB,EAAkBrB,CAAM,CAAC,EAAA,CACvD;AAAA,QAAA,EAAA,CACF;AAAA,MAAA;AAAA,IAAA;AAAA,EACF,GACF;AAEJ;AC9KO,SAAS0B,GAAqB;AAAA,EACnC,cAAAC;AAAA,EACA,YAAAC;AAAA,EACA,0BAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,YAAAf,IAAa;AAAA,EACb,cAAAgB;AACF,GAA8B;AAC5B,QAAMC,IAAiBjN;AAAA,IACrB,MAAM,MAAM,KAAK,EAAE,QAAQgN,KAAgB,CAACvH,GAAGyH,MAAUA,IAAQ,CAAC;AAAA,IAClE,CAACF,CAAY;AAAA,EAAA;AAiBf,SACE,gBAAAtQ,EAAA0N,IAAA,EACE,UAAA;AAAA,IAAA,gBAAA9N,EAACoO,IAAA,EAAM,SAAQ,2BAA0B,UAAA,YAAQ;AAAA,IACjD,gBAAApO;AAAA,MAAC4O;AAAA,MAAA;AAAA,QACC,YAAAc;AAAA,QACA,UAnBuB,CAACV,MAAkB;AAC9C,UAAAwB,EAAyBxB,CAAK,GAC1BA,IAAQuB,KACVE,EAAuBzB,CAAK;AAAA,QAEhC;AAAA,QAeM,iBAAgB;AAAA,QAEhB,SAAS2B;AAAA,QACT,gBAAgB,CAAChC,MAAWA,EAAO,SAAA;AAAA,QACnC,OAAO2B;AAAA,MAAA;AAAA,MAHH;AAAA,IAAA;AAAA,IAMN,gBAAAtQ,EAACoO,IAAA,EAAM,SAAQ,yBAAwB,UAAA,MAAE;AAAA,IACzC,gBAAApO;AAAA,MAAC4O;AAAA,MAAA;AAAA,QACC,YAAAc;AAAA,QACA,UAvBqB,CAACV,MAAkB;AAC5C,UAAAyB,EAAuBzB,CAAK,GACxBA,IAAQsB,KACVE,EAAyBxB,CAAK;AAAA,QAElC;AAAA,QAmBM,iBAAgB;AAAA,QAEhB,SAAS2B;AAAA,QACT,gBAAgB,CAAChC,MAAWA,EAAO,SAAA;AAAA,QACnC,OAAO4B;AAAA,MAAA;AAAA,MAHH;AAAA,IAAA;AAAA,EAIN,GACF;AAEJ;ACrEO,IAAKM,uBAAAA,OACVA,EAAA,eAAe,gBACfA,EAAA,eAAe,gBAFLA,IAAAA,MAAA,CAAA,CAAA;AAUL,MAAMC,KAA4B,OAAO,OAAO;AAAA,EACrD;AAAA,EACA;AAAA,EACA;AACF,CAAU,GAcJC,KAAiB,CACrBC,GACAzK,MAEOyK,EAAQzK,CAAG,KAAKA;AA4BlB,SAAS0K,GAAa;AAAA,EAC3B,+BAAAC;AAAA,EACA,iBAAA7E;AAAA,EACA,eAAA8E;AAAA,EACA,iBAAAC;AAAA,EACA,cAAAV;AAAA,EACA,YAAAH;AAAA,EACA,wBAAAE;AAAA,EACA,cAAAH;AAAA,EACA,0BAAAE;AAAA,EACA,kBAAAjH;AACF,GAAsB;AACpB,QAAM8H,IAAkBN,GAAexH,GAAkB,oCAAoC,GACvF+H,IAAaP,GAAexH,GAAkB,+BAA+B,GAC7EgI,IAAkBR,GAAexH,GAAkB,oCAAoC,GAEvF,CAACiI,GAAmBC,CAAoB,IAAIhM;AAAA,IAChD;AAAA;AAAA,EAAA,GAGIiM,IAAwB,CAACC,MAA+B;AAC5D,IAAAF,EAAqBE,CAAO,GAC5BT,EAA8BS,CAAO;AAAA,EACvC;AAEA,SACE,gBAAA3R;AAAA,IAACsO;AAAA,IAAA;AAAA,MACC,WAAU;AAAA,MACV,OAAOkD;AAAA,MAGP,eAAe,CAACxC,MAAkB0C,EAAsB1C,CAA0B;AAAA,MAElF,UAAA,gBAAA5O,EAAC,OAAA,EAAI,WAAU,0CACb,UAAA;AAAA,QAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,sCACb,UAAA;AAAA,UAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,2BACb,UAAA;AAAA,YAAA,gBAAAJ,EAACwO,IAAA;AAAA,cAAe,OAAO;AAAA;AAAA,YAAA,CAAgC;AAAA,YACvD,gBAAAxO,EAACoO,IAAA,EAAM,WAAU,WAAW,UAAAiD,EAAA,CAAgB;AAAA,UAAA,GAC9C;AAAA,UACA,gBAAArR,EAACoO,IAAA,EAAM,WAAU,2BAA2B,UAAA/B,GAAgB;AAAA,UAC5D,gBAAArM,EAAC,OAAA,EAAI,WAAU,0CACb,UAAA,gBAAAA;AAAA,YAACqQ;AAAA,YAAA;AAAA,cACC,YAAYmB,MAAsB;AAAA,cAClC,0BAAAhB;AAAA,cACA,wBAAAC;AAAA,cACA,cAAAC;AAAA,cACA,cAAAJ;AAAA,cACA,YAAAC;AAAA,YAAA;AAAA,UAAA,EACF,CACF;AAAA,QAAA,GACF;AAAA,QACA,gBAAAnQ,EAAC,OAAA,EAAI,WAAU,sCACb,UAAA;AAAA,UAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,2BACb,UAAA;AAAA,YAAA,gBAAAJ,EAACwO,IAAA;AAAA,cAAe,OAAO;AAAA;AAAA,YAAA,CAAgC;AAAA,YACvD,gBAAAxO,EAACoO,IAAA,EAAM,WAAU,WAAW,UAAAmD,EAAA,CAAgB;AAAA,UAAA,GAC9C;AAAA,UACA,gBAAAvR,EAACoO,IAAA,EAAM,WAAU,2BACd,YAAgB,IAAI,CAACpM,MAAmBG,GAAM,oBAAoBH,CAAM,CAAC,EAAE,KAAK,IAAI,GACvF;AAAA,UACA,gBAAAhC;AAAA,YAAC+D;AAAA,YAAA;AAAA,cACC,UAAUyN,MAAsB;AAAA,cAChC,SAAS,MAAML,EAAA;AAAA,cAEd,UAAAG;AAAA,YAAA;AAAA,UAAA;AAAA,QACH,EAAA,CACF;AAAA,MAAA,EAAA,CACF;AAAA,IAAA;AAAA,EAAA;AAGN;ACrIsD,MAAMM,KAAEC,GAAE,IAAI;AAAE,SAASC,GAAED,GAAE,GAAE;AAAY,SAAyB,EAAC,UAAS,WAAU;AAAC,WAAa,KAAyB;AAAA,EAAI,EAAC;AAAC;AAAC,SAASE,KAAG;AAAC,QAAMF,IAAErO,GAAEoO,EAAC;AAAE,SAAaC,KAAN,QAAS,SAASA,MAAKrO,GAAE;AAAC,UAAMoO,IAAE,IAAI,IAAI,gCAAgC,GAAEE,IAAE,IAAI;AAAgB,IAAAA,EAAE,OAAO,QAAOD,CAAC;AAAE,eAAUA,KAAKrO,EAAE,CAAAsO,EAAE,OAAO,KAAID,CAAC;AAAE,UAAMD,EAAE,SAAOE,EAAE,SAAQ,GAAG,MAAM,2BAA2BD,CAAC,WAAWD,EAAE,SAAQ,CAAE,gHAAgH;AAAA,EAAC,EAAE,CAAC,GAAEC;AAAC;ACAzO,MAAMG,KAAe,OAAO,SAApB,OAAqC,OAAO,aAAhB,UAAmC,OAAO,SAAS,kBAAzB,QAAuCC,KAAED,KAAEE,KAAEC,GAAEC,KAAE,EAAC,KAAIC,GAAC;AAAE,SAASC,GAAE,EAAC,eAAcD,GAAE,UAASH,EAAC,GAAE;AAAC,QAAMC,IAAEI,EAAE,MAAI;AAAC,UAAK,EAAC,OAAMT,GAAE,WAAUI,GAAE,OAAMC,GAAE,SAAQI,GAAE,aAAYC,GAAE,MAAKP,EAAC,IAAEI,GAAEC,IAAE9O,GAAE,MAAKsO,CAAC,GAAEW,IAAEV,GAAE,EAAC,UAASM,EAAE,UAAS,MAAKJ,GAAE,WAAUC,GAAE,OAAMC,GAAE,SAAQ,CAAA3O,MAAG+O,EAAE/O,GAAEiP,CAAC,GAAE,OAAMX,EAAC,CAAC;AAAE,WAAO,SAAStO,GAAEsO,GAAE;AAAC,UAAUA,MAAP;AAAgB,YAAYA,MAAT,OAAW,CAAAtO,EAAE,OAAO,MAAI;AAAC,gBAAMsO,IAAED,GAAC;AAAG,cAAGC,EAAE,QAAO,GAAG;AAAC,kBAAMC,IAAE3I;AAAI,YAAA0I,EAAE,OAAOC,CAAC;AAAE,kBAAMF,IAAEG,KAAE,SAAS,gBAAc;AAAK,aAAQJ,GAAC,MAAR,QAAmBC,MAAP,QAAUA,MAAIrO,EAAE,eAAc,MAAKuO,EAAE,OAAM;AAAA,UAAE;AAAA,QAAC,GAAEK,EAAC;AAAA,iBAAiBN,MAAP,KAAS,SAAO,OAAOA;UAAG,KAAI,UAAS;AAAC,kBAAMC,IAAEvO,EAAE,iBAAiBsO,CAAC;AAAE,YAAAtO,EAAE,eAAeuO,GAAEK,EAAC;AAAE;AAAA,UAAK;AAAA,UAAC,KAAI;AAAS,YAAA5O,EAAE,eAAesO,GAAEM,EAAC;AAAE;AAAA,UAAM,KAAI;AAAW,YAAA5O,EAAE,OAAO,MAAI;AAACqO,cAAAA,KAAI,aAAWC,EAAEtO,CAAC;AAAA,YAAC,GAAE4O,EAAC;AAAA,QAAC;AAAA;AAAA,IAAC,EAAEK,GAAED,CAAC,GAAE,CAACC,GAAEH,CAAC;AAAA,EAAC,GAAE,CAAA,CAAE;AAAE,SAAOL,GAAE,MAAI;AAAC,UAAMzO,IAAE6O,EAAE,UAAS,CAACP,CAAC,IAAEK;AAAE,IAAAL,EAAE,YAAqBtO,MAAT,UAAYA,CAAC;AAAA,EAAC,GAAE,CAAA,CAAE,GAAEgP,EAAEV,GAAE,UAAS,EAAC,OAAMK,GAAE,UAASD,EAAC,CAAC;AAAC;ACAnhC,MAAMN,KAAe,OAAO,SAApB,OAAqC,OAAO,aAAhB,UAAmC,OAAO,SAAS,kBAAzB,SAAuCG,KAAE3I;AAAE,SAASyI,GAAE,EAAC,6BAA4BE,IAAE,IAAG,uBAAsB3I,IAAE,IAAG,UAAS,EAAC,GAAE;AAAC,QAAK,CAACiJ,CAAC,IAAE7O,GAAC;AAAG,SAAOoO,GAAE,MAAI;AAAC,QAAG,EAAE,QAAOS,EAAE,uBAAuB,CAAC,EAAC,aAAY7O,GAAE,eAAcoO,GAAE,aAAYW,GAAE,iBAAgBC,GAAE,MAAK,EAAC,MAAI;AAAC,MAAApJ,KAAOwI,EAAE,SAAN,KAAgBW,EAAE,SAAN,KAAYR,KAAG,EAAE,IAAID,EAAC,KAAGU,EAAE,QAAO,KAAI,EAAEhP,GAAE6O,GAAE,CAAC;AAAA,IAAC,CAAC;AAAA,EAAC,GAAE,CAACA,GAAEN,GAAE3I,GAAE,CAAC,CAAC,GAAE;AAAI;ACMvkB,MAAMsJ,KAAkC;AAAA,EAC7C,KAAK;AAAA,EACL,KAAK;AAAA,EACL,SAAS;AAAA,IACP,IAAI;AAAA,IACJ,IAAI;AAAA,IACJ,IAAI;AAAA,IACJ,IAAI;AAAA,IACJ,IAAI;AAAA,IACJ,IAAI;AAAA,EAAA;AAAA,EAEN,WAAW;AAAA,EACX,OAAO;AAAA,EACP,MAAM;AAAA,EACN,MAAM;AAAA,IACJ,WAAW;AAAA,IACX,UAAU;AAAA,IACV,iBACE;AAAA,IACF,mBACE;AAAA,IACF,QAAQ;AAAA,MACN,UAAU;AAAA,IAAA;AAAA,IAEZ,IAAI;AAAA,IACJ,SAAS;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IAAA;AAAA,IAEF,IAAI;AAAA,IACJ,SAAS;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IAAA;AAAA,EACF;AAAA,EAEF,SAAS;AAAA,EACT,MAAM;AAAA,IACJ,MAAM;AAAA,IACN,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,eAAe;AAAA,IACf,WAAW;AAAA,IACX,aAAa;AAAA,IACb,WAAW;AAAA,IACX,wBAAwB;AAAA,EAAA;AAAA,EAE1B,OAAO;AAAA,EACP,aACE;AAAA,EACF,SAAS;AAAA,EACT,MAAM;AAAA,EACN,eAAe;AAAA,IACb,QAAQ;AAAA,IACR,MAAM;AAAA,IACN,SAAS;AAAA,IACT,SAAS;AAAA,IACT,OAAO;AAAA,IACP,MAAM;AAAA,IACN,OAAO;AAAA,IACP,cAAc;AAAA,IACd,SAAS;AAAA,IACT,UAAU;AAAA,IACV,SAAS;AAAA,IACT,SAAS;AAAA,IACT,QAAQ;AAAA,IACR,UAAU;AAAA,IACV,WAAW;AAAA,IACX,UAAU;AAAA,IACV,SAAS;AAAA,IACT,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,UAAU;AAAA,IACV,QAAQ;AAAA,IACR,UAAU;AAAA,IACV,aAAa;AAAA,IACb,OAAO;AAAA,IACP,UAAU;AAAA,IACV,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,KAAK;AAAA,IACL,KAAK;AAAA,IACL,UAAU;AAAA,EAAA;AAAA,EAEZ,gBAAgB;AAAA,EAChB,OAAO;AAAA,EACP,WACE;AAAA,EACF,uBACE;AAAA,EACF,gCACE;AAAA,EACF,kBAAkB;AAAA,EAClB,iBACE;AAAA,EACF,0BACE;AAAA,EACF,kBACE;AAAA,EACF,mBAAmB;AAAA,EACnB,0BACE;AAAA,EACF,kBACE;AAAA,EACF,kBAAkB;AAAA,EAClB,eAAe;AAAA,EACf,gBAAgB;AAAA,EAChB,YAAY;AAAA,EACZ,iBAAiB;AAAA,EACjB,cAAc;AAAA,EACd,aAAa;AAAA,EACb,YAAY;AAAA,IACV,MAAM;AAAA,IACN,OAAO;AAAA,EAAA;AAAA,EAET,IAAI;AAAA,EACJ,QAAQ;AAAA,EACR,MAAM;AAAA,EACN,aAAa;AACf,GCpIMC,KAAkBC,GAAiB,UAQnCC,KAAUD,GAAiB,MAG3BE,KAAiBF,GAAiB,SAGlCG,KAAiBnT,EAAM,WAG3B,CAAC,EAAE,WAAAC,GAAW,YAAA6E,IAAa,GAAG,GAAG5E,KAASC,MAC1C,gBAAAC;AAAA,EAAC4S,GAAiB;AAAA,EAAjB;AAAA,IACC,KAAA7S;AAAA,IACA,YAAA2E;AAAA,IACA,WAAWxF;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDiT,GAAe,cAAcH,GAAiB,QAAQ;ACtB/C,MAAMI,KAAoE;AAAA,EAC/EC;AAAA,EACAC;AAAA,EACAC;AAAA,EACAC;AACF,GCdMC,KAAuBC,GAAc,IAAI,GAEzCC,KAAe;AAAA,EACnB,UAAU;AAAA,EACV,OAAO;AACT;AACA,MAAMC,WAAsBC,GAAU;AAAA,EACpC,YAAY3T,GAAO;AACjB,UAAMA,CAAK,GACX,KAAK,qBAAqB,KAAK,mBAAmB,KAAK,IAAI,GAC3D,KAAK,QAAQyT;AAAA,EACf;AAAA,EACA,OAAO,yBAAyBG,GAAO;AACrC,WAAO;AAAA,MACL,UAAU;AAAA,MACV,OAAAA;AAAA,IACN;AAAA,EACE;AAAA,EACA,qBAAqB;AACnB,UAAM;AAAA,MACJ,OAAAA;AAAA,IACN,IAAQ,KAAK;AACT,QAAIA,MAAU,MAAM;AAElB,eADIC,GAAqBC,GAChBC,IAAO,UAAU,QAAQC,IAAO,IAAI,MAAMD,CAAI,GAAGE,IAAO,GAAGA,IAAOF,GAAME;AAC/E,QAAAD,EAAKC,CAAI,IAAI,UAAUA,CAAI;AAE7B,OAACJ,KAAuBC,IAAc,KAAK,OAAO,aAAa,QAAQD,MAAwB,UAAkBA,EAAoB,KAAKC,GAAa;AAAA,QACrJ,MAAAE;AAAA,QACA,QAAQ;AAAA,MAChB,CAAO,GACD,KAAK,SAASP,EAAY;AAAA,IAC5B;AAAA,EACF;AAAA,EACA,kBAAkBG,GAAOM,GAAM;AAC7B,QAAIC,GAAqBC;AACzB,KAACD,KAAuBC,IAAe,KAAK,OAAO,aAAa,QAAQD,MAAwB,UAAkBA,EAAoB,KAAKC,GAAcR,GAAOM,CAAI;AAAA,EACtK;AAAA,EACA,mBAAmBG,GAAWC,GAAW;AACvC,UAAM;AAAA,MACJ,UAAAC;AAAA,IACN,IAAQ,KAAK,OACH;AAAA,MACJ,WAAAC;AAAA,IACN,IAAQ,KAAK;AAOT,QAAID,KAAYD,EAAU,UAAU,QAAQG,GAAgBJ,EAAU,WAAWG,CAAS,GAAG;AAC3F,UAAIE,GAAsBC;AAC1B,OAACD,KAAwBC,IAAe,KAAK,OAAO,aAAa,QAAQD,MAAyB,UAAkBA,EAAqB,KAAKC,GAAc;AAAA,QAC1J,MAAMH;AAAA,QACN,MAAMH,EAAU;AAAA,QAChB,QAAQ;AAAA,MAChB,CAAO,GACD,KAAK,SAASZ,EAAY;AAAA,IAC5B;AAAA,EACF;AAAA,EACA,SAAS;AACP,UAAM;AAAA,MACJ,UAAArT;AAAA,MACA,gBAAAwU;AAAA,MACA,mBAAAC;AAAA,MACA,UAAAC;AAAA,IACN,IAAQ,KAAK,OACH;AAAA,MACJ,UAAAP;AAAA,MACA,OAAAX;AAAA,IACN,IAAQ,KAAK;AACT,QAAImB,IAAgB3U;AACpB,QAAImU,GAAU;AACZ,YAAMvU,IAAQ;AAAA,QACZ,OAAA4T;AAAA,QACA,oBAAoB,KAAK;AAAA,MACjC;AACM,UAAI,OAAOgB,KAAmB;AAC5B,QAAAG,IAAgBH,EAAe5U,CAAK;AAAA,eAC3B6U;AACT,QAAAE,IAAgBC,GAAcH,GAAmB7U,CAAK;AAAA,eAC7C8U,MAAa;AACtB,QAAAC,IAAgBD;AAAA;AAEhB,cAAMlB;AAAA,IAEV;AACA,WAAOoB,GAAczB,GAAqB,UAAU;AAAA,MAClD,OAAO;AAAA,QACL,UAAAgB;AAAA,QACA,OAAAX;AAAA,QACA,oBAAoB,KAAK;AAAA,MACjC;AAAA,IACA,GAAOmB,CAAa;AAAA,EAClB;AACF;AACA,SAASN,KAAkB;AACzB,MAAIlC,IAAI,UAAU,SAAS,KAAK,UAAU,CAAC,MAAM,SAAY,UAAU,CAAC,IAAI,CAAA,GACxEtM,IAAI,UAAU,SAAS,KAAK,UAAU,CAAC,MAAM,SAAY,UAAU,CAAC,IAAI,CAAA;AAC5E,SAAOsM,EAAE,WAAWtM,EAAE,UAAUsM,EAAE,KAAK,CAACpN,GAAM2L,MAAU,CAAC,OAAO,GAAG3L,GAAMc,EAAE6K,CAAK,CAAC,CAAC;AACpF;AChG6F,SAASiB,GAAE,EAAC,UAASA,GAAE,SAAQ,EAAC,GAAE;AAAC,SAAOE,EAAEH,IAAE,EAAC,UAASG,EAAE,OAAM,EAAC,OAAM,EAAC,QAAO,kBAAiB,OAAM,QAAO,SAAQ,MAAK,GAAE,UAAS,uBAAsB,CAAC,GAAE,SAAQ,GAAE,UAASF,EAAC,CAAC;AAAC;ACAjG,MAAMK,KAAe,OAAO,SAApB,OAAqC,OAAO,aAAhB,UAAmC,OAAO,SAAS,kBAAzB,SAAuCL,KAAEC;AAAE,SAASG,GAAEzO,GAAE;AAAC,SAAM,EAAC,gBAAe,MAAIA,EAAE,WAAU,GAAG,WAAU,CAAAqO,MAAGrO,EAAE,yBAAyBqO,CAAC,EAAC;AAAC;AAAC,SAASQ,KAAG;AAAC,SAAO,SAASR,GAAE;AAAC,UAAK,CAACC,CAAC,IAAEtO,GAAC,GAAGyO,IAAE7I,EAAE,MAAIyI,EAAEC,CAAC,GAAE,CAACA,GAAED,CAAC,CAAC,GAAE,CAACQ,GAAEF,CAAC,IAAEP,EAAE,MAAIK,EAAE,eAAc,CAAE,GAAEM,IAAER,EAAEM,CAAC;AAAE,WAAOH,GAAE,MAAI;AAAC,YAAK,EAAC,gBAAe1O,GAAE,WAAUqO,EAAC,IAAEI,GAAEH,IAAEtO;AAAI,aAAO+O,EAAE,YAAUT,MAAIS,EAAE,UAAQT,GAAEK,EAAEL,CAAC,IAAGD,EAAE,CAAArO,MAAG;AAAC,QAAA+O,EAAE,UAAQ/O,GAAE2O,EAAE3O,CAAC;AAAA,MAAC,CAAC;AAAA,IAAC,GAAE,CAACyO,GAAEJ,CAAC,CAAC,GAAEQ;AAAA,EAAC,EAAEJ,EAAC;AAAC;ACAwlE,SAAS8C,GAAEvR,GAAEsO,GAAE,IAAE,QAAO;AAAC,QAAM,IAAEtO,EAAE,kBAAiB;AAAG,MAAGsO,EAAE,WAAWtO,CAAC,KAAG,CAACyO,GAAEH,CAAC,KAAU,MAAP,MAAS;AAAC,UAAK,CAACK,GAAEP,CAAC,IAAE,GAAEY,IAAEhP,EAAE,WAAU,GAAG4F,IAAE+I,EAAE,QAAO,GAAG,IAAEP,EAAE,QAAO,GAAGU,IAAER,EAAE,GAAG1I,CAAC,GAAE6I,IAAEH,EAAE,GAAG,CAAC;AAAE,QAAGQ,KAAGL,GAAE;AAAC,YAAK,CAACF,GAAEI,CAAC,IAAE6C,GAAExR,CAAC,GAAEoO,IAAExI,EAAE,GAAG,CAAC,GAAEkJ,IAAER,EAAE,GAAGU,IAAE,IAAEpJ,CAAC,GAAE6I,IAAEH,EAAE,GAAGU,IAAEpJ,IAAE,CAAC;AAAE,UAAImJ,GAAEH,IAAE;AAAE,MAAGR,KAAEQ,IAAEL,IAAEI,IAAEA,IAAEJ,GAAEQ,IAAER,IAAEI,IAAEJ,IAAEI,KAAUG,KAAGF,IAAEI,IAAEL,IAAEJ,GAAEQ,IAAE,UAAeN,MAAGG,IAAE,GAAEG,IAAEC,IAAET,IAAEI;AAAE,YAAM8C,IAAEnD,EAAE,OAAO,MAAMM,GAAEG,CAAC;AAAE,MAAA0C,MAAInD,EAAE,WAAmB,MAAV,YAAcA,IAAEO,GAAEP,CAAC,IAAGA,EAAE,SAAOmD;AAAA,IAAE;AAAA,EAAC;AAAC,SAAOnD;AAAC;ACA9mE,SAASoD,GAAE,MAAK,GAAE;AAAC,QAAM,IAAE,IAAI,IAAI,gCAAgC,GAAE,IAAE,IAAI;AAAgB,IAAE,OAAO,QAAO,CAAC;AAAE,aAAUpD,KAAK,EAAE,GAAE,OAAO,KAAIA,CAAC;AAAE,QAAM,EAAE,SAAO,EAAE,SAAQ,GAAG,MAAM,2BAA2B,CAAC,WAAW,EAAE,SAAQ,CAAE,gHAAgH;AAAC;AAAM,MAACqD,KAAe,OAAO,SAApB,OAAqC,OAAO,aAAhB,UAAmC,OAAO,SAAS,kBAAzB,QAAuChM,KAAEgM,MAAG,kBAAiB,WAAS,SAAS,eAAa;AAA8H,EAAE,CAACA,MAAG,EAAE,gBAAe,WAAShM,OAAI,qBAAoB,IAAI,OAAO,WAAW,OAAO;AAA02I,SAASiM,GAAG,GAAE;AAAC,QAAM,IAAElD,GAAE,GAAE,CAAAJ,MAAGF,GAAEE,CAAC,KAAG,CAACA,EAAE,SAAQ,CAAE;AAAE,SAAOF,GAAE,CAAC,KAAGsD,GAAE,GAAE,EAAE,KAAK,GAAE;AAAC;ACArkK,MAAMG,KAAE,OAAO,IAAI,gBAAgB;AAAE,SAASH,KAAG;AAAC,MAAGI,KAAE,EAAE,QAAO,KAAKA;AAAI,MAAI,GAAE,IAAE;AAAG,SAAcC,OAAT,UAAY;AAAC,QAAI,IAAEA;AAAE,SAAIA,KAAE,QAAOC,MAAa,MAAT,UAAY;AAAC,YAAMpM,IAAE,EAAE;AAAE,UAAG,EAAE,IAAE,QAAO,EAAE,KAAG,IAAG,EAAE,IAAE,EAAE,MAAI/I,GAAE,CAAC,EAAE,KAAG;AAAC,UAAE,EAAC;AAAA,MAAE,SAAOwR,GAAE;AAAC,cAAI,IAAEA,GAAE,IAAE;AAAA,MAAG;AAAC,UAAEzI;AAAA,IAAC;AAAA,EAAC;AAAC,MAAGoM,KAAE,GAAEF,MAAI,EAAE,OAAM;AAAC;AAAC,SAASH,GAAE,GAAE;AAAC,MAAGG,KAAE,EAAE,QAAO;AAAI,EAAAA;AAAI,MAAG;AAAC,WAAO,EAAC;AAAA,EAAE,UAAC;AAAQ,IAAAJ;EAAG;AAAC;AAAC,IAAIO,GAAEF;AAAE,SAASG,GAAE,GAAE;AAAC,QAAM,IAAED;AAAE,EAAAA,IAAE;AAAO,MAAG;AAAC,WAAO,EAAC;AAAA,EAAE,UAAC;AAAQ,IAAAA,IAAE;AAAA,EAAC;AAAC;AAAC,IAAIH,KAAE,GAAEE,KAAE,GAAEG,KAAE;AAAE,SAASC,GAAE,GAAE;AAAC,MAAYH,MAAT,OAAW;AAAO,MAAI,IAAE,EAAE;AAAE,SAAgB,MAAT,UAAY,EAAE,MAAIA,KAAG,IAAE,EAAC,GAAE,GAAE,GAAE,GAAE,GAAEA,EAAE,GAAE,GAAE,QAAO,GAAEA,GAAE,GAAE,QAAO,GAAE,QAAO,GAAE,EAAC,GAAWA,EAAE,MAAX,WAAeA,EAAE,EAAE,IAAE,IAAGA,EAAE,IAAE,GAAE,EAAE,IAAE,GAAE,KAAGA,EAAE,KAAG,EAAE,EAAE,CAAC,GAAE,KAAQ,EAAE,MAAP,MAAU,EAAE,IAAE,GAAW,EAAE,MAAX,WAAe,EAAE,EAAE,IAAE,EAAE,GAAW,EAAE,MAAX,WAAe,EAAE,EAAE,IAAE,EAAE,IAAG,EAAE,IAAEA,EAAE,GAAE,EAAE,IAAE,QAAOA,EAAE,EAAE,IAAE,GAAEA,EAAE,IAAE,IAAG,KAAG;AAAM;AAAC,SAASI,GAAE,GAAE,GAAE;AAAC,OAAK,IAAE,GAAE,KAAK,IAAE,GAAE,KAAK,IAAE,QAAO,KAAK,IAAE,QAAO,KAAK,IAAQ,KAAN,OAAQ,SAAO,EAAE,SAAQ,KAAK,IAAQ,KAAN,OAAQ,SAAO,EAAE,WAAU,KAAK,OAAW,KAAN,OAAQ,SAAO,EAAE;AAAI;AAAC,SAASC,GAAE,GAAE,GAAE;AAAC,SAAO,IAAID,GAAE,GAAE,CAAC;AAAC;AAAC,SAASxV,GAAE,GAAE;AAAC,WAAQ,IAAE,EAAE,GAAW,MAAT,QAAW,IAAE,EAAE,EAAE,KAAG,EAAE,EAAE,MAAI,EAAE,KAAG,CAAC,EAAE,EAAE,EAAC,KAAI,EAAE,EAAE,MAAI,EAAE,EAAE,QAAM;AAAG;AAAQ;AAAC,SAAS0V,GAAE,GAAE;AAAC,WAAQ,IAAE,EAAE,GAAW,MAAT,QAAW,IAAE,EAAE,GAAE;AAAC,UAAM,IAAE,EAAE,EAAE;AAAE,QAAY,MAAT,WAAa,EAAE,IAAE,IAAG,EAAE,EAAE,IAAE,GAAE,EAAE,IAAE,IAAY,EAAE,MAAX,QAAa;AAAC,QAAE,IAAE;AAAE;AAAA,IAAK;AAAA,EAAC;AAAC;AAAC,SAASC,GAAG,GAAE;AAAC,MAAI,GAAE,IAAE,EAAE;AAAE,SAAc,MAAT,UAAY;AAAC,UAAMlE,IAAE,EAAE;AAAE,IAAK,EAAE,MAAP,MAAU,EAAE,EAAE,EAAE,CAAC,GAAWA,MAAT,WAAaA,EAAE,IAAE,EAAE,IAAY,EAAE,MAAX,WAAe,EAAE,EAAE,IAAEA,MAAI,IAAE,GAAE,EAAE,EAAE,IAAE,EAAE,GAAW,EAAE,MAAX,WAAe,EAAE,IAAE,SAAQ,IAAEA;AAAA,EAAC;AAAC,IAAE,IAAE;AAAC;AAAC,SAASmE,GAAG,GAAE,GAAE;AAAC,EAAAJ,GAAE,KAAK,MAAK,MAAM,GAAE,KAAK,IAAE,GAAE,KAAK,IAAE,QAAO,KAAK,IAAEF,KAAE,GAAE,KAAK,IAAE,GAAE,KAAK,IAAQ,KAAN,OAAQ,SAAO,EAAE,SAAQ,KAAK,IAAQ,KAAN,OAAQ,SAAO,EAAE,WAAU,KAAK,OAAW,KAAN,OAAQ,SAAO,EAAE;AAAI;AAAC,SAASO,GAAG,GAAE,GAAE;AAAC,SAAO,IAAID,GAAG,GAAE,CAAC;AAAC;AAAC,SAASE,GAAG,GAAE;AAAC,QAAM,IAAE,EAAE;AAAE,MAAG,EAAE,IAAE,QAAmB,OAAO,KAAnB,YAAqB;AAAC,IAAAb;AAAI,UAAM,IAAEG;AAAE,IAAAA,IAAE;AAAO,QAAG;AAAC,QAAC;AAAA,IAAE,SAAOjS,GAAE;AAAC,YAAM,EAAE,KAAG,IAAG,EAAE,KAAG,GAAE4S,GAAG,CAAC,GAAE5S;AAAA,IAAC,UAAC;AAAQ,MAAAiS,IAAE,GAAEP,GAAC;AAAA,IAAE;AAAA,EAAC;AAAC;AAAC,SAASkB,GAAG,GAAE;AAAC,WAAQ,IAAE,EAAE,GAAW,MAAT,QAAW,IAAE,EAAE,EAAE,GAAE,EAAE,EAAE,CAAC;AAAE,IAAE,IAAE,QAAO,EAAE,IAAE,QAAOD,GAAG,CAAC;AAAC;AAAC,SAASE,GAAG,GAAE;AAAC,MAAGZ,MAAI,KAAK,OAAM,IAAI,MAAM,qBAAqB;AAAE,EAAAO,GAAG,IAAI,GAAEP,IAAE,GAAE,KAAK,KAAG,IAAG,IAAE,KAAK,KAAGW,GAAG,IAAI,GAAElB,GAAC;AAAE;AAAC,SAASoB,GAAG,GAAE,GAAE;AAAC,OAAK,IAAE,GAAE,KAAK,IAAE,QAAO,KAAK,IAAE,QAAO,KAAK,IAAE,QAAO,KAAK,IAAE,IAAG,KAAK,OAAW,KAAN,OAAQ,SAAO,EAAE;AAAI;AAAC,SAASC,GAAG,GAAE,GAAE;AAAC,QAAM,IAAE,IAAID,GAAG,GAAE,CAAC;AAAE,MAAG;AAAC,MAAE,EAAC;AAAA,EAAE,SAAOxE,GAAE;AAAC,UAAM,EAAE,KAAIA;AAAA,EAAC;AAAC,QAAM1I,IAAE,EAAE,EAAE,KAAK,CAAC;AAAE,SAAOA,EAAE,OAAO,OAAO,IAAEA,GAAEA;AAAC;AAAC,SAASoN,GAAG,GAAE,IAAE,IAAG;AAAC,QAAM,IAAE,CAAA;AAAG,aAAUpN,KAAK,GAAE;AAAC,UAAM2I,IAAE,EAAE3I,CAAC,GAAE,IAAE0M,GAAW/D,MAAT,SAAW,EAAE3I,CAAC,IAAE2I,CAAC;AAAE,MAAE3I,CAAC,IAAE;AAAA,EAAC;AAAC,SAAO;AAAC;AAACyM,GAAE,UAAU,QAAMR,IAAEQ,GAAE,UAAU,IAAE,WAAU;AAAC,SAAM;AAAE,GAAEA,GAAE,UAAU,IAAE,SAAS,GAAE;AAAC,QAAM,IAAE,KAAK;AAAE,QAAI,KAAY,EAAE,MAAX,WAAe,EAAE,IAAE,GAAE,KAAK,IAAE,GAAW,MAAT,SAAW,EAAE,IAAE,IAAEH,GAAE,MAAI;AAAC,QAAI5D;AAAE,KAAOA,IAAE,KAAK,MAAd,QAAkBA,EAAE,KAAK,IAAI;AAAA,EAAC,CAAC;AAAE,GAAE+D,GAAE,UAAU,IAAE,SAAS,GAAE;AAAC,MAAY,KAAK,MAAd,QAAgB;AAAC,UAAM,IAAE,EAAE,GAAE,IAAE,EAAE;AAAE,IAAS,MAAT,WAAa,EAAE,IAAE,GAAE,EAAE,IAAE,SAAiB,MAAT,WAAa,EAAE,IAAE,GAAE,EAAE,IAAE,SAAQ,MAAI,KAAK,MAAI,KAAK,IAAE,GAAW,MAAT,UAAYH,GAAE,MAAI;AAAC,UAAI5D;AAAE,OAAOA,IAAE,KAAK,MAAd,QAAkBA,EAAE,KAAK,IAAI;AAAA,IAAC,CAAC;AAAA,EAAE;AAAC,GAAE+D,GAAE,UAAU,YAAU,SAAS,GAAE;AAAC,SAAOU,GAAG,MAAI;AAAC,UAAM,IAAE,KAAK,OAAM,IAAEd;AAAE,IAAAA,IAAE;AAAO,QAAG;AAAC,QAAE,CAAC;AAAA,IAAC,UAAC;AAAQ,MAAAA,IAAE;AAAA,IAAC;AAAA,EAAC,GAAE,EAAC,MAAK,MAAK,CAAC;AAAC,GAAEI,GAAE,UAAU,UAAQ,WAAU;AAAC,SAAO,KAAK;AAAK,GAAEA,GAAE,UAAU,WAAS,WAAU;AAAC,SAAO,KAAK,QAAM;AAAE,GAAEA,GAAE,UAAU,SAAO,WAAU;AAAC,SAAO,KAAK;AAAK,GAAEA,GAAE,UAAU,OAAK,WAAU;AAAC,QAAM,IAAEJ;AAAE,EAAAA,IAAE;AAAO,MAAG;AAAC,WAAO,KAAK;AAAA,EAAK,UAAC;AAAQ,IAAAA,IAAE;AAAA,EAAC;AAAC,GAAE,OAAO,eAAeI,GAAE,WAAU,SAAQ,EAAC,MAAK;AAAC,QAAM,IAAED,GAAE,IAAI;AAAE,SAAgB,MAAT,WAAa,EAAE,IAAE,KAAK,IAAG,KAAK;AAAC,GAAE,IAAI,GAAE;AAAC,MAAG,MAAI,KAAK,GAAE;AAAC,QAAGJ,KAAE,IAAI,OAAM,IAAI,MAAM,gBAAgB;AAAE,SAAK,IAAE,GAAE,KAAK,KAAIG,MAAIL;AAAI,QAAG;AAAC,eAAQxD,IAAE,KAAK,GAAWA,MAAT,QAAWA,IAAEA,EAAE,EAAE,CAAAA,EAAE,EAAE,EAAC;AAAA,IAAE,UAAC;AAAQ,MAAAoD,GAAC;AAAA,IAAE;AAAA,EAAC;AAAC,EAAC,CAAC,GAAEe,GAAG,YAAU,IAAIJ,MAAEI,GAAG,UAAU,IAAE,WAAU;AAAC,MAAG,KAAK,KAAG,IAAG,IAAE,KAAK,EAAE,QAAM;AAA+B,OAApB,KAAG,KAAK,MAAb,OAA4B,KAAK,KAAG,IAAG,KAAK,MAAIN,IAAE,QAAM;AAAG,MAAG,KAAK,IAAEA,IAAE,KAAK,KAAG,GAAE,KAAK,IAAE,KAAG,CAACtV,GAAE,IAAI,EAAE,QAAO,KAAK,KAAG,IAAG;AAAG,QAAM,IAAEoV;AAAE,MAAG;AAAC,IAAAM,GAAE,IAAI,GAAEN,IAAE;AAAK,UAAM3D,IAAE,KAAK,EAAC;AAAG,KAAC,KAAG,KAAK,KAAG,KAAK,MAAIA,KAAO,KAAK,MAAT,OAAc,KAAK,IAAEA,GAAE,KAAK,KAAG,KAAI,KAAK;AAAA,EAAI,SAAOA,GAAE;AAAC,SAAK,IAAEA,GAAE,KAAK,KAAG,IAAG,KAAK;AAAA,EAAG;AAAC,SAAO2D,IAAE,GAAEO,GAAG,IAAI,GAAE,KAAK,KAAG,IAAG;AAAE,GAAEC,GAAG,UAAU,IAAE,SAAS,GAAE;AAAC,MAAY,KAAK,MAAd,QAAgB;AAAC,SAAK,KAAG;AAAG,aAAQnE,IAAE,KAAK,GAAWA,MAAT,QAAWA,IAAEA,EAAE,EAAE,CAAAA,EAAE,EAAE,EAAEA,CAAC;AAAA,EAAC;AAAC,EAAA+D,GAAE,UAAU,EAAE,KAAK,MAAK,CAAC;AAAC,GAAEI,GAAG,UAAU,IAAE,SAAS,GAAE;AAAC,MAAY,KAAK,MAAd,WAAkBJ,GAAE,UAAU,EAAE,KAAK,MAAK,CAAC,GAAW,KAAK,MAAd,SAAiB;AAAC,SAAK,KAAG;AAAI,aAAQ/D,IAAE,KAAK,GAAWA,MAAT,QAAWA,IAAEA,EAAE,EAAE,CAAAA,EAAE,EAAE,EAAEA,CAAC;AAAA,EAAC;AAAC,GAAEmE,GAAG,UAAU,IAAE,WAAU;AAAC,MAAG,EAAE,IAAE,KAAK,IAAG;AAAC,SAAK,KAAG;AAAE,aAAQ,IAAE,KAAK,GAAW,MAAT,QAAW,IAAE,EAAE,EAAE,GAAE,EAAE,EAAC;AAAA,EAAE;AAAC,GAAE,OAAO,eAAeA,GAAG,WAAU,SAAQ,EAAC,MAAK;AAAC,MAAG,IAAE,KAAK,EAAE,OAAM,IAAI,MAAM,gBAAgB;AAAE,QAAM,IAAEL,GAAE,IAAI;AAAE,MAAG,KAAK,KAAa,MAAT,WAAa,EAAE,IAAE,KAAK,IAAG,KAAG,KAAK,EAAE,OAAM,KAAK;AAAE,SAAO,KAAK;AAAC,EAAC,CAAC,GAAEU,GAAG,UAAU,IAAE,WAAU;AAAC,QAAM,IAAE,KAAK,EAAC;AAAG,MAAG;AAAoB,QAAhB,IAAE,KAAK,KAAqB,KAAK,MAAd,OAAgB;AAAO,UAAMxE,IAAE,KAAK,EAAC;AAAG,IAAY,OAAOA,KAAnB,eAAuB,KAAK,IAAEA;AAAA,EAAE,UAAC;AAAQ;EAAG;AAAC,GAAEwE,GAAG,UAAU,IAAE,WAAU;AAAC,MAAG,IAAE,KAAK,EAAE,OAAM,IAAI,MAAM,gBAAgB;AAAE,OAAK,KAAG,GAAE,KAAK,KAAG,IAAGH,GAAG,IAAI,GAAEJ,GAAE,IAAI,GAAET;AAAI,QAAM,IAAEG;AAAE,SAAOA,IAAE,MAAKY,GAAG,KAAK,MAAK,CAAC;AAAC,GAAEC,GAAG,UAAU,IAAE,WAAU;AAAC,MAAE,KAAK,MAAI,KAAK,KAAG,GAAE,KAAK,IAAEf,IAAEA,KAAE;AAAK,GAAEe,GAAG,UAAU,IAAE,WAAU;AAAC,OAAK,KAAG,GAAE,IAAE,KAAK,KAAGF,GAAG,IAAI;AAAC,GAAEE,GAAG,UAAU,UAAQ,WAAU;AAAC,OAAK,EAAC;AAAE;AAAWxE,GAAE,EAAC,OAAM,CAAC,GAAE,GAAE,MAAI0E,GAAG,CAAC,GAAE,QAAOhT,GAAE,EAAC,kBAAiB,WAAU,UAAS,GAAE,CAAC,GAAE,MAAK,gCAA+B,SAAS,GAAE,GAAE,GAAE;AAAC,QAAM4F,IAAE,EAAE,UAAS;AAAG,SAAOmN,GAAG,MAAInN,EAAE,SAAS,QAAM,SAAO,EAAE,qBAAqB,CAAA5F,MAAG;AAAC,MAAE,MAAM,MAAI;AAAC,YAAMsO,IAAE,SAAS;AAAc,MAAOtO,MAAP,QAAiBsO,MAAP,QAAUtO,EAAE,SAASsO,CAAC,KAAGtO,EAAE,MAAM,EAAC,eAAc,GAAE,CAAC;AAAA,IAAC,GAAE,EAAC,kBAAiB4F,EAAE,iBAAiB,KAAI,EAAE,CAAC;AAAA,EAAC,CAAC,CAAC;AAAC,EAAC,CAAC;AAAE,SAASqN,KAAI;AAAC,QAAM,IAAE1E,GAAC,GAAG,IAAES,MAAI,IAAEZ,GAAC;AAAG,IAAE,MAAK,GAAG,EAAE,OAAO,CAAC,GAAS,MAAP,QAAU,EAAE,OAAM,GAAGM,GAAE,CAAC,MAAI,EAAE,SAAO;AAAE;AAAC,SAASwE,GAAG,GAAE,IAAED,IAAG;AAAC,SAAO,EAAE,gBAAgB5E,IAAE,QAAI,EAAE,OAAO,CAAC,GAAE,KAAIzI,EAAC;AAAC;AAAU0I,GAAE,EAAC,OAAM,CAAC,GAAE,GAAE,MAAI0E,GAAG,CAAC,GAAE,QAAOhT,GAAE,EAAC,UAASiT,GAAE,CAAC,GAAE,MAAK,kCAAiC,SAAS,GAAE,GAAE,GAAE;AAAC,QAAK,EAAC,UAASrN,EAAC,IAAE,EAAE,UAAS;AAAG,SAAOmN,GAAG,MAAIG,GAAG,GAAEtN,EAAE,KAAK,CAAC;AAAC,EAAC,CAAC;AAA8J,SAASuN,GAAG,GAAE;AAAC,UAAmB,OAAO,EAAE,SAArB,aAA2B,EAAE,MAAK,IAAG,EAAE,UAAQ,CAAA;AAAE;AAAC,SAASC,GAAG,GAAE,GAAE;AAAC,MAAI;AAAE,SAAOd,GAAE,EAAC,GAAG,EAAC,YAAW;AAAC,UAAI,EAAC,GAAG,IAAE;AAAA,EAAO,GAAE,UAAS;AAAC,SAAK,QAAM,KAAI,IAAE,EAAE,IAAI;AAAA,EAAC,EAAC,CAAC;AAAC;AAAC,MAAMe,KAAG/E,GAAE,EAAC,OAAM,OAAG8E,GAAG,MAAI,EAAE,kBAAiB,OAAG,EAAE,uBAAuB,CAAA9E,MAAG;AAAC,IAAE,QAAMA,EAAE;AAAW,CAAC,CAAC,GAAE,MAAK,iCAAgC,CAAC;AAAE,SAASgF,EAAG,MAAK,GAAE;AAAC,QAAM,IAAE,IAAI,IAAI,gCAAgC,GAAE1N,IAAE,IAAI;AAAgB,EAAAA,EAAE,OAAO,QAAO,CAAC;AAAE,aAAU0I,KAAK,EAAE,CAAA1I,EAAE,OAAO,KAAI0I,CAAC;AAAE,QAAM,EAAE,SAAO1I,EAAE,SAAQ,GAAG,MAAM,2BAA2B,CAAC,WAAW,EAAE,SAAQ,CAAE,gHAAgH;AAAC;AAAC,SAAS2N,GAAG,GAAE,GAAE;AAAC,MAAG,KAAG,KAAG,CAAC,MAAM,QAAQ,CAAC,KAAa,OAAO,KAAjB,YAA8B,OAAO,KAAjB,UAAmB;AAAC,UAAM,IAAE,GAAE3N,IAAE;AAAE,eAAU0I,KAAK1I,EAAE,GAAE0I,CAAC,IAAEiF,GAAG,EAAEjF,CAAC,GAAE1I,EAAE0I,CAAC,CAAC;AAAE,WAAO;AAAA,EAAC;AAAC,SAAO;AAAC;AAAC,MAAMsD,KAAG,GAAE4B,KAAG,GAAEC,KAAG,GAAEC,KAAG,GAAEC,KAAG,GAAEC,KAAG,GAAEC,KAAG,GAAEC,KAAG;AAAE,SAASC,GAAG,GAAE;AAAC,SAAO,EAAE,OAAKnC;AAAE;AAAC,SAASoC,GAAG,GAAE;AAAC,SAAO,EAAE,OAAKP;AAAE;AAAC,SAASQ,GAAG,GAAE;AAAC,SAAO,SAAS3F,GAAE;AAAC,WAAOA,EAAE,OAAKkF;AAAA,EAAE,EAAE,CAAC,KAAGF,EAAG,KAAI,OAAO,EAAE,EAAE,GAAE,OAAOE,EAAE,CAAC,GAAE,OAAO,OAAO,GAAE,EAAC,IAAGC,GAAE,CAAC;AAAC;AAAC,MAAMS,KAAG,oBAAI;AAAI,MAAMC,GAAE;AAAA,EAAkE,YAAY7F,GAAEtO,GAAE;AAAjF,IAAAoU,GAAA;AAAQ,IAAAA,GAAA;AAAQ,IAAAA,GAAA;AAAY,IAAAA,GAAA;AAAa,IAAAA,GAAA;AAAU,IAAAA,GAAA;AAAM,IAAAA,GAAA;AAAyB,SAAK,UAAQ9F,GAAE,KAAK,YAAUtO,GAAE,KAAK,UAAQ,oBAAI,OAAI,KAAK,QAAM,EAAC,IAAG4R,GAAE;AAAA,EAAC;AAAA,EAAC,eAAc;AAAC,QAAItD,IAAE,KAAK,UAAU,UAAQ,CAAA;AAAG,UAAMtO,IAAE,KAAK,UAAU,cAAY,KAAK,UAAU,YAAY,KAAK,KAAK,SAAS,IAAE+O;AAAE,eAAUV,KAAK,KAAK,QAAQ,CAAAC,IAAEtO,EAAEsO,GAAED,CAAC;AAAE,WAAOC;AAAA,EAAC;AAAA,EAAC,KAAKA,GAAE;AAAC,UAAMtO,IAAE,KAAK;AAAM,IAAAgU,GAAGhU,CAAC,KAAGsT,EAAG,KAAI,OAAOtT,EAAE,EAAE,CAAC;AAAE,UAAMqO,IAAE,EAAC,eAAc,KAAK,kBAAkB,KAAK,IAAI,GAAE,yBAAwB,KAAK,wBAAwB,KAAK,IAAI,GAAE,SAAQ,KAAK,YAAY,KAAK,IAAI,GAAE,gBAAe,KAAK,eAAe,KAAK,IAAI,EAAC,GAAEzI,IAAE,EAAC,GAAGyI,GAAE,eAAc,KAAK,cAAc,KAAK,IAAI,GAAE,eAAc,KAAK,cAAc,KAAK,IAAI,GAAE,SAAQ,KAAK,QAAQ,KAAK,IAAI,EAAC,GAAEE,IAAE,SAASD,GAAEtO,GAAEqO,GAAE;AAAC,aAAO,OAAO,OAAOC,GAAE,EAAC,QAAOtO,GAAE,IAAG0T,IAAG,eAAcrF,EAAC,CAAC;AAAA,IAAC,EAAErO,GAAE,KAAK,gBAAeqO,CAAC;AAAE,QAAIW;AAAE,SAAK,QAAMT,GAAE,KAAK,UAAU,SAAOS,IAAE,KAAK,UAAU,KAAKV,GAAEC,EAAE,QAAOF,CAAC,IAAG,KAAK,QAAM,SAASC,GAAEtO,GAAEqO,GAAE;AAAC,aAAO,OAAO,OAAOC,GAAE,EAAC,IAAGqF,IAAG,YAAW3T,GAAE,eAAcqO,EAAC,CAAC;AAAA,IAAC,EAAEE,GAAES,GAAEpJ,CAAC;AAAA,EAAC;AAAA,EAAC,MAAM0I,GAAE;AAAC,UAAMtO,IAAE,KAAK;AAAM,QAAIqO;AAAE,IAAArO,EAAE,OAAK2T,MAAIL,EAAG,KAAI,OAAOtT,EAAE,EAAE,GAAE,OAAO4T,EAAE,CAAC,GAAE,KAAK,UAAU,UAAQvF,IAAE,KAAK,UAAU,MAAMC,GAAEtO,EAAE,QAAOA,EAAE,aAAa;AAAG,UAAM4F,IAAE,EAAC,GAAG5F,EAAE,eAAc,WAAU,MAAIqO,GAAE,WAAU,KAAK,UAAU,KAAK,IAAI,EAAC;AAAE,SAAK,QAAM,SAASC,GAAEtO,GAAEqO,GAAE;AAAC,aAAO,OAAO,OAAOC,GAAE,EAAC,IAAGsF,IAAG,QAAO5T,GAAE,eAAcqO,EAAC,CAAC;AAAA,IAAC,EAAErO,GAAEqO,GAAEzI,CAAC;AAAA,EAAC;AAAA,EAAC,SAAS0I,GAAEtO,GAAE;AAAC,SAAK,UAAQA;AAAE,UAAMqO,IAAE,KAAK;AAAM,IAAAA,EAAE,OAAKuF,MAAIN,EAAG,KAAI,OAAOjF,EAAE,EAAE,GAAE,OAAOuF,EAAE,CAAC;AAAE,UAAMhO,IAAE,KAAK,UAAU,YAAU,KAAK,UAAU,SAAS0I,GAAED,EAAE,QAAOA,EAAE,aAAa;AAAE,WAAO,KAAK,QAAM,SAASC,GAAE;AAAC,aAAO,OAAO,OAAOA,GAAE,EAAC,IAAGuF,GAAE,CAAC;AAAA,IAAC,EAAExF,CAAC,GAAE,MAAI;AAAC,YAAMC,IAAE,KAAK;AAAM,MAAAA,EAAE,OAAKwF,MAAIR,EAAG,KAAI,OAAOjF,EAAE,EAAE,GAAE,OAAOyF,EAAE,CAAC,GAAE,KAAK,QAAM,SAASxF,GAAE;AAAC,eAAO,OAAO,OAAOA,GAAE,EAAC,IAAGsF,GAAE,CAAC;AAAA,MAAC,EAAEtF,CAAC,GAAE1I,KAAGA,EAAC;AAAA,IAAE;AAAA,EAAC;AAAA,EAAC,kBAAkB0I,GAAE;AAAC,UAAMtO,IAAE,KAAK;AAAM,QAAIqO;AAAE,WAAOrO,EAAE,OAAK6T,MAAIP,EAAG,KAAI,OAAOtT,EAAE,EAAE,GAAE,OAAO6T,EAAE,CAAC,GAAE,KAAK,UAAU,sBAAoBxF,IAAE,KAAK,UAAU,kBAAkBC,GAAEtO,EAAE,QAAOA,EAAE,aAAa,IAAG,KAAK,QAAM,SAASsO,GAAE;AAAC,aAAO,OAAO,OAAOA,GAAE,EAAC,IAAGwF,GAAE,CAAC;AAAA,IAAC,EAAE9T,CAAC,GAAEqO;AAAA,EAAC;AAAA,EAAC,YAAW;AAAC,WAAgB,KAAK,YAAd,UAAuBiF,EAAG,GAAG,GAAE,KAAK;AAAA,EAAO;AAAA,EAAC,gBAAe;AAAC,IAAS,KAAK,UAAU,SAAxB,UAA8BA,EAAG,KAAI,KAAK,UAAU,IAAI;AAAE,UAAMhF,IAAE,KAAK;AAAM,WAAO,SAASA,GAAE;AAAC,aAAOA,EAAE,MAAIqF;AAAA,IAAE,EAAErF,CAAC,KAAGgF,EAAG,KAAI,OAAOhF,EAAE,EAAE,GAAE,OAAOqF,EAAE,CAAC,GAAErF,EAAE;AAAA,EAAU;AAAA,EAAC,YAAYA,GAAE;AAAC,UAAMtO,IAAE,KAAK,QAAQ,iBAAiB,IAAIsO,CAAC;AAAE,WAAOtO,IAAEA,EAAE,2BAA0B,IAAG;AAAA,EAAM;AAAA,EAAC,6BAA4B;AAAC,UAAMsO,IAAE,KAAK;AAAM,WAAO,SAASA,GAAE;AAAC,aAAOA,EAAE,MAAIoF;AAAA,IAAE,EAAEpF,CAAC,KAAGgF,EAAG,KAAI,OAAOhF,EAAE,EAAE,GAAE,OAAOoF,EAAE,CAAC,GAAE,EAAC,QAAOpF,EAAE,OAAM;AAAA,EAAC;AAAA,EAAC,QAAQA,GAAE;AAAC,UAAMtO,IAAE,KAAK,QAAQ,iBAAiB,IAAIsO,CAAC;AAAE,WAAOtO,IAAEA,EAAE,uBAAsB,IAAG;AAAA,EAAM;AAAA,EAAC,kBAAkBsO,GAAE;AAAC,UAAMtO,IAAE,KAAK,QAAQ,gBAAgBsO,CAAC;AAAE,WAAgBtO,MAAT,UAAYsT,EAAG,KAAI,KAAK,UAAU,MAAKhF,EAAE,IAAI,GAAEtO,EAAE;EAA4B;AAAA,EAAC,cAAcsO,GAAE;AAAC,UAAMtO,IAAE,KAAK,QAAQ,gBAAgBsO,CAAC;AAAE,WAAgBtO,MAAT,UAAYsT,EAAG,KAAI,KAAK,UAAU,MAAKhF,EAAE,IAAI,GAAEtO,EAAE,uBAAsB;AAAA,EAAE;AAAA,EAAC,WAAU;AAAC,UAAMsO,IAAE,KAAK;AAAM,WAAO,SAASA,GAAE;AAAC,aAAOA,EAAE,MAAIwF;AAAA,IAAE,EAAExF,CAAC,KAAGgF,EAAG,KAAI,OAAOhF,EAAE,EAAE,GAAE,OAAOwF,EAAE,CAAC,GAAExF;AAAA,EAAC;AAAA,EAAC,0BAAyB;AAAC,WAAO,KAAK,QAAQ,cAAc,IAAI,KAAK,UAAU,IAAI,KAAG4F;AAAA,EAAE;AAAA,EAAC,iBAAgB;AAAC,QAAI5F,IAAE,KAAK;AAAa,WAAOA,MAAIA,IAAE,IAAI,KAAK,KAAK,UAAU,oBAAkB,CAAA,GAAI,IAAI,CAAC,CAACA,CAAC,MAAIA,CAAC,CAAC,GAAE,KAAK,eAAaA,IAAGA;AAAA,EAAC;AAAA,EAAC,yBAAwB;AAAC,QAAG,CAAC,KAAK,aAAY;AAAC,YAAMA,IAAE,KAAK;AAAM,OAAC,SAASA,GAAE;AAAC,eAAOA,EAAE,MAAIsF;AAAA,MAAE,GAAGtF,CAAC,KAAGgF,EAAG,KAAI,KAAK,UAAU,IAAI,GAAE,KAAK,cAAY,EAAC,QAAOhF,EAAE,QAAO,MAAKA,EAAE,YAAW,QAAOA,EAAE,OAAM;AAAA,IAAC;AAAC,WAAO,KAAK;AAAA,EAAW;AAAC;AAAC,MAAM+F,KAAG,EAAC,KAAIzF,GAAC;AAAE,SAAS0F,KAAI;AAAC,QAAM,IAAE/F,GAAC;AAAG,IAAE,QAAO,KAAI,EAAE,OAAOH,GAAC,CAAE;AAAC;AAAC,MAAMmG,KAAGjG,GAAE,EAAC,QAAOtO,GAAE,EAAC,YAAWqU,IAAG,eAAcA,GAAE,CAAC,GAAE,MAAK,CAAC,EAAC,qBAAoB,IAAEC,GAAE,OAAK,EAAC,qBAAoB,GAAE,aAAY,GAAE,IAAG,kBAAkB,GAAE,EAAC,eAAc,GAAE,YAAW,EAAC,GAAE1O,GAAE;AAAC,QAAM2I,IAAE3I,EAAE,cAAa;AAAG,MAAG,CAAC2I,EAAE,aAAY;AAAC,IAAAA,EAAE,cAAY;AAAG,UAAK,EAAC,qBAAoB3I,EAAC,IAAE2I;AAAE,QAAGiD,GAAE5L,CAAC,EAAE,GAAE,eAAeA,GAAE,CAAC;AAAA,aAAsB,OAAOA,KAAnB,WAAqB,GAAE,OAAO,MAAI;AAAC,MAAAA,EAAE,CAAC;AAAA,IAAC,GAAE,CAAC;AAAA,aAAUA,MAAc,OAAOA,KAAjB,YAA8B,OAAOA,KAAjB,WAAoB;AAAC,YAAM5F,IAAE,EAAE,iBAAiB4F,CAAC;AAAE,QAAE,eAAe5F,GAAE,CAAC;AAAA,IAAC;AAAA,EAAC;AAAC,SAAM,MAAI;AAAA,EAAC;AAAC,GAAE,MAAK,mCAAkC,OAAM,CAAC6O,IAAEC,IAAEL,IAAEgD,IAAE9C,EAAC,EAAC,CAAC,GAAE6F,KAAG,OAAO,IAAI,mCAAmC;AAA8D,SAASC,KAAI;AAAC;AAAC,SAASC,GAAG,GAAE;AAAC,QAAM;AAAC;AAAC,SAASC,GAAG,GAAE;AAAC,SAAO,MAAM,QAAQ,CAAC,IAAE,IAAE,CAAC,CAAC;AAAC;AAAC,MAAMC,KAAG;AAAkB,MAAMC,GAAE;AAAA,EAAyG,YAAYvG,GAAE;AAAtH,IAAA8F,GAAA;AAAM,IAAAA,GAAA;AAAiB,IAAAA,GAAA;AAAoB,IAAAA,GAAA;AAAc,IAAAA,GAAA;AAAU,IAAAA,GAAA;AAAqB,IAAAA,GAAA;AAA+B,SAAK,sBAAoB,oBAAI,OAAI,KAAK,gBAAc,oBAAI,OAAI,KAAK,mBAAiB,oBAAI,OAAI,KAAK,YAAU,oBAAI,OAAI,KAAK,kBAAgBQ,IAAG,KAAK,QAAMtG;AAAE,eAAUtO,KAAKsO,EAAE,MAAK,aAAatO,CAAC;AAAA,EAAC;AAAA,EAAC,OAAO,eAAesO,GAAE;AAAC,UAAMtO,IAAE,CAAC2U,GAAGJ,EAAE,CAAC;AAAE,eAAUlG,KAAKC,EAAE,CAAAtO,EAAE,KAAK2U,GAAGtG,CAAC,CAAC;AAAE,WAAO,IAAIwG,GAAG7U,CAAC;AAAA,EAAC;AAAA,EAAC,OAAO,gBAAgBsO,GAAE;AAAC,UAAMtO,IAAEsO,EAAEkG,EAAE;AAAE,WAAOxU,MAAIA,EAAE,oBAAkB4U,MAAItB,EAAG,KAAItT,EAAE,iBAAgB4U,EAAE,GAAE5U,aAAa6U,MAAIvB,EAAG,GAAG,IAAGtT;AAAA,EAAC;AAAA,EAAC,OAAO,WAAWsO,GAAE;AAAC,UAAMtO,IAAE6U,GAAG,gBAAgBvG,CAAC;AAAE,WAAgBtO,MAAT,UAAYsT,EAAG,GAAG,GAAEtT;AAAA,EAAC;AAAA,EAAC,kBAAiB;AAAC,UAAK,EAAC,qBAAoBsO,GAAE,SAAQtO,GAAE,GAAGqO,EAAC,IAAE,KAAK,sBAAqB,GAAGzI,IAAE,OAAO,OAAO4I,GAAE,EAAC,GAAGH,GAAE,GAAGrO,IAAE,EAAC,SAAQ,CAAAsO,MAAG;AAAC,MAAAtO,EAAEsO,GAAE1I,CAAC;AAAA,IAAC,EAAC,IAAE,CAAA,EAAE,CAAC,GAAE,EAAC,CAAC4O,EAAE,GAAE,KAAI,CAAC;AAAE,eAAUlG,KAAK,KAAK,oBAAmB,EAAG,CAAAA,EAAE,MAAM1I,CAAC;AAAE,WAAOA;AAAA,EAAC;AAAA,EAAC,cAAa;AAAC,QAAI0I,IAAEmG;AAAG,aAASzU,IAAG;AAAC,UAAG;AAAC,QAAAsO,EAAC;AAAA,MAAE,UAAC;AAAQ,QAAAA,IAAEmG;AAAA,MAAE;AAAA,IAAC;AAAC,UAAMpG,IAAE,OAAO,OAAO,KAAK,gBAAe,GAAG,EAAC,SAAQrO,GAAE,CAAC,OAAO,OAAO,GAAEA,EAAC,CAAC;AAAE,WAAOsO,IAAEwG,GAAE,KAAK,eAAezG,CAAC,GAAE,MAAIA,EAAE,eAAe,IAAI,CAAC,GAAEA;AAAA,EAAC;AAAA,EAAC,mBAAmBC,GAAE;AAAC,WAAO,KAAK,iBAAiB,IAAIA,CAAC;AAAA,EAAC;AAAA,EAAC,gBAAgBA,GAAE;AAAC,UAAMtO,IAAE,KAAK,iBAAiB,IAAIsO,EAAE,IAAI;AAAE,QAAGtO,EAAE,QAAOA,EAAE,cAAYsO,KAAGgF,EAAG,KAAIhF,EAAE,IAAI,GAAEtO;AAAA,EAAC;AAAA,EAAC,QAAQsO,GAAEtO,GAAEqO,GAAE;AAAC,UAAMzI,IAAE,KAAK,oBAAoB,IAAI0I,CAAC;AAAE,IAAA1I,IAAEA,EAAE,IAAI5F,GAAEqO,CAAC,IAAE,KAAK,oBAAoB,IAAIC,GAAE,oBAAI,IAAI,CAAC,CAACtO,GAAEqO,CAAC,CAAC,CAAC,CAAC;AAAE,UAAME,IAAE,KAAK,cAAc,IAAIvO,CAAC;AAAE,IAAAuO,IAAEA,EAAE,IAAID,CAAC,IAAE,KAAK,cAAc,IAAItO,GAAE,oBAAI,IAAI,CAACsO,CAAC,CAAC,CAAC;AAAA,EAAC;AAAA,EAAC,aAAaA,GAAE;AAAC,IAAS,KAAK,yBAAd,UAAoCgF,EAAG,GAAG;AAAE,UAAMtT,IAAE2U,GAAGrG,CAAC,GAAE,CAACD,CAAC,IAAErO;AAAE,IAAU,OAAOqO,EAAE,QAAnB,YAAyBiF,EAAG,KAAI,OAAOjF,EAAE,IAAI;AAAE,QAAIzI,IAAE,KAAK,iBAAiB,IAAIyI,EAAE,IAAI;AAAE,QAAYzI,MAAT,UAAYA,EAAE,cAAYyI,KAAGiF,EAAG,KAAIjF,EAAE,IAAI,GAAE,CAACzI,GAAE;AAAC,MAAAA,IAAE,IAAIuO,GAAG,MAAK9F,CAAC,GAAE,KAAK,iBAAiB,IAAIA,EAAE,MAAKzI,CAAC;AAAE,YAAM0I,IAAE,KAAK,UAAU,IAAID,EAAE,IAAI;AAAE,MAAU,OAAOC,KAAjB,YAAoBgF,EAAG,KAAIjF,EAAE,MAAKC,CAAC;AAAE,iBAAUA,KAAKD,EAAE,iBAAe,CAAA,EAAG,MAAK,iBAAiB,IAAIC,CAAC,KAAGgF,EAAG,KAAIjF,EAAE,MAAKC,CAAC,GAAE,KAAK,UAAU,IAAIA,GAAED,EAAE,IAAI;AAAE,iBAAUC,KAAKD,EAAE,gBAAc,CAAA,GAAG;AAAC,cAAMrO,IAAE2U,GAAGrG,CAAC;AAAE,aAAK,QAAQD,EAAE,MAAKrO,EAAE,CAAC,EAAE,MAAKA,EAAE,MAAM,CAAC,CAAC,GAAE,KAAK,aAAaA,CAAC;AAAA,MAAC;AAAC,iBAAS,CAACsO,GAAEtO,CAAC,KAAIqO,EAAE,oBAAkB,CAAA,EAAG,MAAK,QAAQA,EAAE,MAAKC,GAAEtO,IAAE,CAACA,CAAC,IAAE,CAAA,CAAE;AAAA,IAAC;AAAA,EAAC;AAAA,EAAC,sBAAqB;AAAC,QAAG,KAAK,qBAAqB,QAAO,KAAK;AAAqB,UAAMsO,IAAE,CAAA,GAAGtO,IAAE,CAACqO,GAAEzI,MAAI;AAAC,UAAI2I,IAAEF,EAAE;AAAM,UAAG2F,GAAGzF,CAAC,EAAE;AAAO,YAAMS,IAAEX,EAAE,UAAU;AAAK,UAAID;AAAE,MAAA2F,GAAGxF,CAAC,KAAG+E,EAAG,KAAItE,GAAEpJ,KAAG,WAAW,GAAEmO,GAAG3F,IAAEG,CAAC,KAAG+E,EAAG,KAAI,OAAOlF,EAAE,EAAE,GAAE,OAAOwD,EAAE,CAAC,GAAErD,IAAE,OAAO,OAAOH,GAAE,EAAC,IAAGoF,GAAE,CAAC,GAAEnF,EAAE,QAAME;AAAE,YAAM,IAAE,KAAK,oBAAoB,IAAIS,CAAC;AAAE,UAAG,EAAE,YAAUV,KAAK,EAAE,KAAI,GAAG;AAAC,cAAMD,IAAE,KAAK,iBAAiB,IAAIC,CAAC;AAAE,QAAAD,KAAGrO,EAAEqO,GAAEW,CAAC;AAAA,MAAC;AAAC,MAAAT,IAAE0F,GAAG1F,CAAC,GAAEF,EAAE,QAAME,GAAED,EAAE,KAAKD,CAAC;AAAA,IAAC;AAAE,eAAUC,KAAK,KAAK,iBAAiB,OAAM,EAAG,CAAAyF,GAAGzF,EAAE,KAAK,KAAGtO,EAAEsO,CAAC;AAAE,eAAUtO,KAAKsO,EAAE,YAAS,CAACA,GAAED,CAAC,KAAI,KAAK,oBAAoB,IAAIrO,EAAE,UAAU,IAAI,KAAG,GAAG,KAAGqO,EAAE,SAAO,GAAE;AAAC,YAAMrO,IAAE,KAAK,iBAAiB,IAAIsO,CAAC;AAAE,UAAGtO,EAAE,YAAUsO,KAAKD,EAAE,CAAArO,EAAE,QAAQ,IAAIsO,CAAC;AAAA,IAAC;AAAC,eAAS,CAACA,GAAE,GAAGtO,CAAC,KAAI,KAAK,MAAM,KAAGA,EAAE,SAAO,GAAE;AAAC,YAAMqO,IAAE,KAAK,iBAAiB,IAAIC,EAAE,IAAI;AAAE,MAASD,MAAT,UAAYiF,EAAG,KAAIhF,EAAE,IAAI;AAAE,iBAAUA,KAAKtO,EAAE,CAAAqO,EAAE,QAAQ,IAAIC,CAAC;AAAA,IAAC;AAAC,WAAO,KAAK,uBAAqBA,GAAE,KAAK;AAAA,EAAoB;AAAA,EAAC,eAAeA,GAAE;AAAC,UAAMtO,IAAE,KAAK,oBAAmB,GAAGqO,IAAE,IAAI,mBAAgBzI,IAAE,CAAC,MAAIyI,EAAE,MAAK,CAAE,GAAEE,IAAEF,EAAE;AAAO,eAAUA,KAAKrO,GAAE;AAAC,YAAMA,IAAEqO,EAAE,SAASC,GAAEC,CAAC;AAAE,MAAAvO,KAAG4F,EAAE,KAAK5F,CAAC;AAAA,IAAC;AAAC,eAAUqO,KAAKrO,GAAE;AAAC,YAAMA,IAAEqO,EAAE,kBAAkBC,CAAC;AAAE,MAAAtO,KAAG4F,EAAE,KAAK5F,CAAC;AAAA,IAAC;AAAC,WAAO8U,GAAE,GAAGlP,CAAC;AAAA,EAAC;AAAA,EAAC,wBAAuB;AAAC,UAAM0I,IAAE,IAAGtO,IAAE,oBAAI,OAAIqO,IAAE,oBAAI,OAAIzI,IAAE,oBAAI,OAAI2I,IAAE,CAAA,GAAGS,IAAE,CAAA,GAAGZ,IAAE,KAAK,oBAAmB;AAAG,eAAUM,KAAKN,GAAE;AAAC,YAAK,EAAC,WAAUA,EAAC,IAAEM;AAAE,UAAYN,EAAE,YAAX,WAAqBE,EAAE,UAAQF,EAAE,UAAkBA,EAAE,kBAAX,WAA2BE,EAAE,gBAAcF,EAAE,gBAAwBA,EAAE,iBAAX,WAA0BE,EAAE,eAAaF,EAAE,eAAuBA,EAAE,aAAX,WAAsBE,EAAE,WAASF,EAAE,WAAmBA,EAAE,cAAX,WAAuBE,EAAE,YAAUF,EAAE,YAAoBA,EAAE,wBAAX,WAAiCE,EAAE,sBAAoBF,EAAE,sBAAqBA,EAAE,MAAM,YAAUE,KAAK6E,GAAG/E,CAAC,GAAE;AAAC,YAAe,OAAOE,KAAnB,YAAqB;AAAC,gBAAMtO,IAAEqO,EAAE,IAAIC,EAAE,OAAO;AAAE,UAAAtO,KAAGsT,EAAG,KAAIlF,EAAE,MAAKE,EAAE,QAAQ,MAAKtO,EAAE,UAAU,IAAI,GAAEqO,EAAE,IAAIC,EAAE,SAAQI,CAAC;AAAA,QAAC;AAAC,QAAA1O,EAAE,IAAIsO,CAAC;AAAA,MAAC;AAAC,UAAGF,EAAE,MAAK;AAAC,YAAGA,EAAE,KAAK,OAAO,YAAS,CAACE,GAAEtO,CAAC,KAAIoO,EAAE,KAAK,OAAO,QAAO,EAAG,CAAAxI,EAAE,IAAI0I,GAAEtO,CAAC;AAAE,QAAAoO,EAAE,KAAK,UAAQ,OAAO,OAAOG,GAAEH,EAAE,KAAK,MAAM;AAAA,MAAC;AAAC,MAAAA,EAAE,SAAOmF,GAAGvE,GAAEZ,EAAE,KAAK;AAAA,IAAC;AAAC,WAAO,KAAKY,CAAC,EAAE,SAAO,MAAIV,EAAE,QAAMU,IAAGhP,EAAE,SAAOsO,EAAE,QAAM,CAAC,GAAGtO,CAAC;AAAG,UAAM,IAAE,OAAO,KAAKuO,CAAC,EAAE,SAAO,GAAEQ,IAAEnJ,EAAE,OAAK;AAAE,KAAC,KAAGmJ,OAAKT,EAAE,OAAK,CAAA,GAAG,MAAIA,EAAE,KAAK,SAAOC,IAAGQ,MAAIT,EAAE,KAAK,SAAO1I;AAAI,eAAU5F,KAAKoO,EAAE,CAAApO,EAAE,KAAKsO,CAAC;AAAE,WAAOA,EAAE,YAAUA,EAAE,UAAQoG,KAAIpG;AAAA,EAAC;AAAC;AAA6S,MAACyG,KAAG,oBAAI,OAAIC,KAAG1G,GAAE,EAAC,MAAM,GAAE,GAAE,GAAE;AAAC,QAAM1I,IAAE,EAAE,cAAcyN,EAAE,EAAE,QAAO9E,IAAE+D,GAAE,EAAC,iBAAgB,oBAAI,MAAG,CAAC,GAAElE,IAAEgF,GAAG,MAAI;AAAA,EAAC,GAAE,MAAIL,GAAG,MAAI;AAAC,UAAMzE,IAAEF,EAAE,KAAI,GAAG,EAAC,iBAAgBpO,EAAC,IAAEuO,EAAE;AAAM,QAAIF,GAAEK,IAAE;AAAG,IAAA9I,EAAE,MAAM,KAAK,MAAI;AAAC,UAAGoJ,GAAC,EAAG,YAAS,CAACpJ,GAAE2I,CAAC,KAAIvO,EAAE,QAAO,GAAG;AAAC,YAAOuO,EAAE,SAAN,GAAW;AAAC,UAAAvO,EAAE,OAAO4F,CAAC;AAAE;AAAA,QAAQ;AAAC,cAAMoJ,IAAEiG,GAAErP,CAAC,GAAEwI,IAAEY,KAAGA,EAAE,WAAU,KAAI;AAAG,QAAAN,IAAEA,KAAGN,OAAK,CAAC,CAACE,KAAGA,EAAE,IAAI1I,CAAC,IAAGwI,MAAIC,IAAEA,KAAG,oBAAI,OAAIA,EAAE,IAAIzI,CAAC;AAAA,MAAE;AAAA,IAAC,CAAC,GAAE,CAAC8I,KAAGL,KAAGC,KAAGD,EAAE,SAAOC,EAAE,SAAOF,EAAE,QAAMC;AAAA,EAAE,CAAC,CAAC;AAAE,SAAM,EAAC,cAAa,SAASC,GAAE;AAAC,UAAMtO,IAAE0S,GAAG,OAAKtE,EAAE,SAAO2G,IAAI,IAAIzG,CAAC,CAAC,GAAE,EAAC,iBAAgBD,EAAC,IAAEE,EAAE,KAAI;AAAG,QAAI3I,IAAEyI,EAAE,IAAIC,CAAC;AAAE,UAAMU,IAAWpJ,MAAT;AAAW,WAAOA,IAAEA,KAAG,oBAAI,OAAIA,EAAE,IAAI5F,CAAC,GAAEgP,MAAIX,EAAE,IAAIC,GAAE1I,CAAC,GAAE2I,EAAE,QAAM,EAAC,iBAAgBF,EAAC,IAAGrO;AAAA,EAAC,EAAC;AAAC,GAAE,cAAa,CAACqT,EAAE,GAAE,MAAK,mCAAkC,CAAC;AAAK6B,GAAE,gCAAgC;AAAE,MAAMC,WAAWC,GAAC;AAAA,EAAC,OAAO,UAAS;AAAC,WAAM;AAAA,EAAgB;AAAA,EAAC,OAAO,MAAM9G,GAAE;AAAC,WAAO,IAAI6G,GAAG7G,EAAE,KAAK;AAAA,EAAC;AAAA,EAAC,OAAO,WAAWA,GAAE;AAAC,WAAO+G,GAAE,EAAG,eAAe/G,CAAC;AAAA,EAAC;AAAA,EAAC,OAAO,YAAW;AAAC,WAAM,EAAC,IAAG,OAAK,EAAC,YAAWgH,IAAG,UAAS,EAAC,GAAE;AAAA,EAAC;AAAA,EAAC,YAAW;AAAC,WAAM,EAAC,SAAQ,SAAS,cAAc,IAAI,EAAC;AAAA,EAAC;AAAA,EAAC,UAAUhH,GAAE;AAAC,UAAMtO,IAAE,SAAS,cAAc,IAAI;AAAE,WAAOuV,GAAEvV,GAAEsO,EAAE,MAAM,EAAE,GAAEtO;AAAA,EAAC;AAAA,EAAC,iBAAgB;AAAC,WAAM;AAAA;AAAA,EAAI;AAAA,EAAC,WAAU;AAAC,WAAM;AAAA,EAAE;AAAA,EAAC,YAAW;AAAC;EAAQ;AAAC;AAAC,SAASsV,KAAI;AAAC,SAAM,EAAC,MAAKD,GAAE,EAAE;AAAC;AAAC,SAASA,KAAI;AAAC,SAAOG,GAAEL,EAAE;AAAC;AAAC,SAASM,GAAG,GAAE;AAAC,SAAO,aAAaN;AAAE;AAAU7G,GAAE,EAAC,cAAa,CAAC+E,IAAG2B,EAAE,GAAE,MAAK,qCAAoC,OAAM,MAAI,CAACG,EAAE,GAAE,SAAS,GAAE,GAAE,GAAE;AAAC,QAAK,EAAC,cAAavP,EAAC,IAAE,EAAE,cAAcoP,EAAE,EAAE,QAAOzG,IAAE+D,GAAE,EAAC,gBAAe,oBAAI,MAAG,CAAC,GAAElE,IAAE,EAAE,QAAQ,MAAM,cAAY;AAAW,SAAO0G,GAAE,EAAE,gBAAgB7F,IAAE,CAAAX,MAAG;AAAC,QAAG/L,GAAE+L,EAAE,MAAM,GAAE;AAAC,YAAMtO,IAAE0V,GAAEpH,EAAE,MAAM;AAAE,UAAGmH,GAAGzV,CAAC,EAAE,QAAO,SAASsO,GAAEtO,IAAE,IAAG;AAAC,cAAMqO,IAAEW,MAAIpJ,IAAE0I,EAAE,cAAaC,IAAED,EAAE;AAAS,YAAIF;AAAE,QAAApO,KAAGuR,GAAElD,CAAC,IAAED,IAAEC,KAAGD,IAAEuH,GAAC,GAAGC,GAAExH,CAAC,IAAGxI,IAAEwI,EAAE,OAAOG,CAAC,IAAEH,EAAE,IAAIG,CAAC;AAAA,MAAC,EAAEvO,GAAEsO,EAAE,QAAQ,GAAE;AAAA,IAAE;AAAC,WAAM;AAAA,EAAE,GAAEuH,EAAC,GAAE,EAAE,yBAAyBV,IAAG,CAACnV,GAAEqO,MAAI;AAACsD,IAAAA,GAAE,MAAI;AAAC,UAAItD,IAAE;AAAG,YAAK,EAAC,gBAAeW,EAAC,IAAET,EAAE,KAAI;AAAG,iBAAS,CAACA,GAAEH,CAAC,KAAIpO,EAAE,QAAO,EAAG,KAAiBoO,MAAd,YAAgB,CAAAY,EAAE,OAAOT,CAAC,GAAEF,IAAE;AAAA,WAAO;AAAC,cAAMrO,IAAEgP,EAAE,IAAIT,CAAC,GAAEH,IAAE,EAAE,gBAAgBG,CAAC;AAAE,QAAAvO,IAAEA,EAAE,QAAQ,QAAMoO,KAAGC,IAAE,IAAGW,EAAE,IAAIT,GAAE,EAAC,SAAQ+D,GAAElE,CAAC,GAAE,gBAAexI,EAAE2I,CAAC,EAAC,CAAC;AAAA,MAAE;AAAC,MAAAF,MAAIE,EAAE,QAAM,EAAC,gBAAeS,EAAC;AAAA,IAAE,CAAC;AAAA,EAAC,CAAC,GAAE+D,GAAG,MAAI;AAAC,UAAMzE,IAAE,CAAA;AAAG,eAAS,EAAC,SAAQtO,GAAE,gBAAeqO,EAAC,KAAIE,EAAE,MAAM,eAAe,SAAS,CAAAD,EAAE,KAAKyE,GAAG,MAAI;AAAC,YAAMzE,IAAEtO,EAAE;AAAM,MAAGsO,MAAGD,EAAE,QAAMkH,GAAEjH,GAAEF,CAAC,IAAEzI,GAAE2I,GAAEF,CAAC;AAAA,IAAE,CAAC,CAAC;AAAE,WAAO0G,GAAE,GAAGxG,CAAC;AAAA,EAAC,CAAC,CAAC;AAAC,EAAC,CAAC;AAAE,SAASwH,GAAG,GAAE,GAAE;AAAC,SAAOhB,GAAE,EAAE,gBAAgBiB,IAAE,CAAA/V,MAAG;AAAC,UAAMqO,IAAEW,GAAC;AAAG,QAAG,CAACN,GAAEL,CAAC,EAAE,QAAM;AAAG,IAAArO,EAAE,eAAc;AAAG,UAAM4F,IAAE,SAAS0I,GAAE;AAAC,UAAGA,EAAE,WAAW,OAAO,CAAAA,MAAG0H,GAAE1H,CAAC,KAAGA,EAAE,WAAW,EAAE,SAAO,EAAE,QAAM;AAAG,YAAMtO,IAAEsO,EAAE,QAAOD,IAAEC,EAAE,OAAM1I,IAAEyI,EAAE,SAASrO,CAAC,IAAEqO,IAAErO,GAAEuO,IAAE3I,EAAE,QAAO,GAAGoJ,IAAEiH,GAAE1H,CAAC;AAAE,UAAGS,EAAE,UAAS,GAAG;AAAC,cAAMV,IAAEU,EAAE,OAAM;AAAG,YAAIhP,IAAEkW,GAAC;AAAG,YAAGlW,EAAE,OAAO,IAAIsO,GAAE,GAAE,SAAS,GAAEtO,EAAE,MAAM,IAAIsO,GAAE,GAAE,SAAS,GAAEtO,IAAEmW,GAAEnW,CAAC,GAAEA,EAAE,OAAO,GAAG4F,CAAC,EAAE,QAAM;AAAA,MAAE;AAAC,aAAM;AAAA,IAAE,EAAEyI,CAAC,IAAErO,EAAE,WAASoW,KAAEC,KAAEC;AAAE,WAAO,EAAE,gBAAgB1Q,GAAE,MAAM;AAAA,EAAC,GAAEA,EAAC,GAAE,EAAE,gBAAgByQ,IAAE,MAAI;AAAC,UAAM/H,IAAY,OAAO,KAAjB,WAAmB,IAAE,IAAE,EAAE,SAAO;AAAK,QAASA,KAAN,KAAQ,QAAM;AAAG,UAAMD,IAAEW,GAAC;AAAG,QAAG,CAACN,GAAEL,CAAC,EAAE,QAAM;AAAG,UAAMzI,IAAEyI,EAAE,SAAQ,EAAG,IAAI,CAAAC,MAAG2H,GAAE3H,CAAC,EAAE,UAAS,CAAE;AAAE,WAAO,KAAK,IAAI,GAAG1I,CAAC,IAAE,KAAG0I;AAAA,EAAC,GAAEiI,EAAC,CAAC;AAAC;AAAUjI,GAAE,EAAC,OAAM,CAAC,GAAE,GAAE,MAAI0E,GAAG,CAAC,GAAE,QAAOhT,GAAE,EAAC,UAAS,IAAG,WAAU,KAAI,CAAC,GAAE,MAAK,qCAAoC,SAAS,GAAE,GAAE,GAAE;AAAC,QAAK,EAAC,UAAS4F,GAAE,WAAU2I,EAAC,IAAE,EAAE,UAAS;AAAG,SAAOwE,GAAG,MAAI;AAAC,QAAG,CAACnN,EAAE,MAAM,QAAOkQ,GAAG,GAAEvH,CAAC;AAAA,EAAC,CAAC;AAAC,EAAC,CAAC;ACAt1lB,MAAMH,KAAEpO,GAAE,EAAC,MAAK,+BAA8B,CAAC;ACA8D,SAASgP,KAAG;AAAC,SAAOV,GAAC,EAAG,eAAc;AAAE;AAAC,SAASQ,GAAE,GAAE,IAAE,IAAG;AAAC,MAAG,EAAE;AAAS,MAAI,IAAEE;AAAI,SAAO,MAAI,IAAE,EAAE,KAAI,IAAS,MAAL;AAAM;AAAkC,SAASN,GAAEH,GAAE;AAAC,MAAG,CAACO,GAAEP,GAAE,EAAE,EAAE,QAAM;AAAG,QAAMI,IAAEL,GAAC,EAAG,YAAW,GAAGU,IAAEL,EAAE;AAAO,MAAGK,IAAE,EAAE,QAAM;AAAG,WAAQV,IAAE,GAAEA,IAAEU,GAAEV,KAAI;AAAC,UAAMC,IAAEI,EAAEL,CAAC;AAAE,QAAGtO,GAAEuO,CAAC,EAAE;AAAS,QAAGF,GAAEE,CAAC,GAAE;AAAmB,UAAf,CAACH,GAAEG,CAAC,KAAkBA,EAAE,aAAN,EAAe,QAAM;AAAG,YAAMvO,IAAEuO,EAAE,YAAW,GAAGF,IAAErO,EAAE;AAAO,eAAQoO,IAAE,GAAEA,IAAEC,GAAED,KAAI;AAAC,cAAMC,IAAErO,EAAEsO,CAAC;AAAE,YAAG,CAAC1I,GAAEyI,CAAC,EAAE,QAAM;AAAA,MAAE;AAAA,IAAC;AAAA,EAAC;AAAC,SAAM;AAAE;AAAC,SAASmD,GAAE,GAAE;AAAC,SAAM,MAAI9C,GAAE,CAAC;AAAC;ACAxb,SAASM,GAAEhP,GAAE;AAAC,QAAMsO,IAAE,OAAO,SAAS,QAAO,IAAE,CAAAD,MAAG;AAAC,QAAGA,EAAE,WAASC,EAAE;AAAO,UAAMC,IAAEvO,EAAE,eAAc;AAAG,QAAG,SAAS,kBAAgBuO,EAAE;AAAO,UAAM,IAAEF,EAAE;AAAK,QAAa,OAAO,KAAjB,UAAmB;AAAC,UAAIC;AAAE,UAAG;AAAC,QAAAA,IAAE,KAAK,MAAM,CAAC;AAAA,MAAC,QAAS;AAAC;AAAA,MAAM;AAAC,UAAGA,KAAyBA,EAAE,aAAxB,uBAA8CA,EAAE,SAAd,WAAmB;AAAC,cAAMC,IAAED,EAAE;AAAQ,YAAGC,KAAmBA,EAAE,eAAlB,eAA6B;AAAC,gBAAMD,IAAEC,EAAE;AAAK,cAAGD,GAAE;AAAC,kBAAK,CAACC,GAAES,GAAED,GAAEL,GAAE8C,CAAC,IAAElD;AAAE,YAAAtO,EAAE,OAAO,MAAI;AAAC,oBAAMA,IAAE4F,GAAC;AAAG,kBAAGiJ,GAAE7O,CAAC,GAAE;AAAC,sBAAMsO,IAAEtO,EAAE;AAAO,oBAAI4F,IAAE0I,EAAE,QAAO,GAAGO,IAAE,GAAEF,IAAE;AAAE,oBAAGP,GAAExI,CAAC,KAAG2I,KAAG,KAAGS,KAAG,MAAIH,IAAEN,GAAEI,IAAEJ,IAAES,GAAEhP,EAAE,iBAAiB4F,GAAEiJ,GAAEjJ,GAAE+I,CAAC,IAAGE,MAAIF,KAAQI,MAAL,OAAS/O,EAAE,cAAc+O,CAAC,GAAEnJ,IAAE0I,EAAE,YAAWF,GAAExI,CAAC,GAAE;AAAC,kBAAAiJ,IAAEH,GAAEC,IAAED,IAAE8C;AAAE,wBAAMlD,IAAE1I,EAAE;AAAqB,kBAAAiJ,IAAEA,IAAEP,IAAEA,IAAEO,GAAEF,IAAEA,IAAEL,IAAEA,IAAEK,GAAE3O,EAAE,iBAAiB4F,GAAEiJ,GAAEjJ,GAAE+I,CAAC;AAAA,gBAAC;AAAC,gBAAAN,EAAE;cAA0B;AAAA,YAAC,CAAC;AAAA,UAAC;AAAA,QAAC;AAAA,MAAC;AAAA,IAAC;AAAA,EAAC;AAAE,SAAO,OAAO,iBAAiB,WAAU,GAAE,EAAE,GAAE,MAAI;AAAC,WAAO,oBAAoB,WAAU,GAAE,EAAE;AAAA,EAAC;AAAC;AAASA,GAAE,EAAC,OAAM,CAACrO,GAAEqO,GAAEE,MAAID,GAAED,CAAC,GAAE,QAAOE,GAAE,EAAC,UAAsB,OAAO,SAApB,IAA0B,CAAC,GAAE,MAAK,mBAAkB,UAAS,CAAC,GAAEF,GAAEE,MAAIvO,GAAE,MAAIuO,EAAE,UAAS,EAAG,SAAS,QAAM,SAAOS,GAAE,CAAC,CAAC,EAAC,CAAC;ACApa,SAASwC,GAAEpD,MAAK,GAAE;AAAC,QAAME,IAAE,IAAI,IAAI,gCAAgC,GAAE,IAAE,IAAI;AAAgB,IAAE,OAAO,QAAOF,CAAC;AAAE,aAAUA,KAAK,EAAE,GAAE,OAAO,KAAIA,CAAC;AAAE,QAAME,EAAE,SAAO,EAAE,SAAQ,GAAG,MAAM,2BAA2BF,CAAC,WAAWE,EAAE,SAAQ,CAAE,gHAAgH;AAAC;AAAC,MAAM4G,KAAe,OAAO,SAApB,OAAqC,OAAO,aAAhB,UAAmC,OAAO,SAAS,kBAAzB,SAAuC7G,KAAEzI;AAAE,SAAS8P,GAAE,EAAC,QAAOtH,GAAE,eAAc,EAAC,GAAE;AAAC,SAAO,SAASA,GAAEpO,GAAE;AAAC,UAAK,CAACsO,GAAEC,CAAC,IAAEG,EAAE,MAAIN,EAAE,cAAa,CAAE;AAAE,WAAO8G,GAAE,MAAI9G,EAAE,0BAA0B,CAAAA,MAAG;AAACY,MAAAA,GAAE,MAAI;AAAC,QAAAT,EAAEH,CAAC;AAAA,MAAC,CAAC;AAAA,IAAC,CAAC,GAAE,CAACA,CAAC,CAAC,GAAExI,EAAE,MAAI;AAAC,MAAA2I,EAAEH,EAAE,cAAa,CAAE;AAAA,IAAC,GAAE,CAACA,CAAC,CAAC,GAAES,EAAE,MAAI;AAAC,YAAMN,IAAE,CAAA,GAAGF,IAAE,OAAO,KAAKC,CAAC;AAAE,eAAQ1I,IAAE,GAAEA,IAAEyI,EAAE,QAAOzI,KAAI;AAAC,cAAM8I,IAAEL,EAAEzI,CAAC,GAAEiJ,IAAEE,EAAE/O,GAAE,EAAC,SAAQ,CAAAA,MAAGoO,EAAE,SAASpO,CAAC,GAAE,UAAS+O,EAAEJ,IAAE,EAAC,UAAS,MAAK,UAASL,EAAEI,CAAC,EAAC,CAAC,EAAC,CAAC,GAAEM,IAAEZ,EAAE,gBAAgBM,CAAC;AAAE,QAAOM,MAAP,QAAUT,EAAE,KAAKE,GAAEI,GAAEG,GAAEN,CAAC,CAAC;AAAA,MAAC;AAAC,aAAOH;AAAA,IAAC,GAAE,CAACvO,GAAEsO,GAAEF,CAAC,CAAC;AAAA,EAAC,EAAEA,GAAE,CAAC;AAAC;AAAC,SAAS0G,GAAE,EAAC,QAAO1G,GAAE,eAAc,EAAC,GAAE;AAAC,SAAO,SAASA,GAAE;AAAC,UAAMpO,IAAEsO,GAAE,gBAAgBF,CAAC;AAAE,QAAGpO,KAAGA,EAAE,mBAAmBuO,GAAE,IAAI,GAAE;AAAC,iBAAUH,KAAI,CAAC,uBAAsB,oBAAoB,EAAE,CAAApO,EAAE,mBAAmBoO,CAAC,KAAGoD,GAAE,KAAIpD,CAAC;AAAE,aAAM;AAAA,IAAE;AAAC,WAAM;AAAA,EAAE,EAAEA,CAAC,IAAE,OAAKW,EAAE2G,IAAE,EAAC,QAAOtH,GAAE,eAAc,EAAC,CAAC;AAAC;AAAC,SAASuD,GAAEvD,GAAE;AAAC,SAAOA,EAAE,eAAc,EAAG,KAAKQ,GAAER,EAAE,YAAW,CAAE,CAAC;AAAC;AAAC,SAASyD,GAAE,EAAC,iBAAgB7R,GAAE,aAAYsO,IAAE,MAAK,eAAcC,EAAC,GAAE;AAAC,QAAK,CAACF,CAAC,IAAED,GAAC;AAAG,SAAO,SAASA,GAAE;AAAC8G,IAAAA,GAAE,MAAID,GAAExD,GAAErD,CAAC,GAAEa,GAAEb,CAAC,CAAC,GAAE,CAACA,CAAC,CAAC;AAAA,EAAC,EAAEC,CAAC,GAAES,EAAEN,IAAE,EAAC,UAAS,CAACxO,GAAE+O,EAAExM,IAAE,EAAC,SAAQ+L,EAAC,CAAC,GAAES,EAAE+F,IAAE,EAAC,QAAOzG,GAAE,eAAcE,EAAC,CAAC,CAAC,EAAC,CAAC;AAAC;AAAC,SAAShM,GAAE,EAAC,SAAQ,EAAC,GAAE;AAAC,QAAK,CAACgM,CAAC,IAAEH,GAAC,GAAG,IAAE,SAASA,GAAE;AAAC,UAAK,CAACpO,GAAEsO,CAAC,IAAEI,EAAE,MAAIiD,GAAEvD,CAAC,CAAC;AAAE,WAAO8G,GAAE,MAAI;AAAC,eAASlV,IAAG;AAAC,cAAMA,IAAE2R,GAAEvD,CAAC;AAAE,QAAAE,EAAEtO,CAAC;AAAA,MAAC;AAAC,aAAOA,EAAC,GAAGiV,GAAE7G,EAAE,uBAAuB,MAAI;AAAC,QAAApO;MAAG,CAAC,GAAEoO,EAAE,yBAAyB,MAAI;AAAC,QAAApO;MAAG,CAAC,CAAC;AAAA,IAAC,GAAE,CAACoO,CAAC,CAAC,GAAEpO;AAAA,EAAC,EAAEuO,CAAC,GAAE3I,IAAE5F;AAAI,SAAO,IAAc,OAAO,KAAnB,aAAqB,EAAE4F,CAAC,IAAE,IAAE;AAAI;ACAhuE,SAAS2I,GAAE,EAAC,kBAAiBA,EAAC,GAAE;AAAC,QAAK,CAACI,CAAC,IAAE3O,GAAC;AAAG,SAAOsO,EAAE,MAAI;AAAC,IAAAK,EAAE,MAAM,MAAI;AAAC,YAAM3O,IAAE,SAAS,eAAcsO,IAAEK,EAAE,eAAc;AAAG,MAAOL,MAAP,QAAiBtO,MAAP,QAAUsO,EAAE,SAAStO,CAAC,KAAGsO,EAAE,MAAM,EAAC,eAAc,GAAE,CAAC;AAAA,IAAC,GAAE,EAAC,kBAAiBC,EAAC,CAAC;AAAA,EAAC,GAAE,CAACA,GAAEI,CAAC,CAAC,GAAE;AAAI;ACAjJ,MAAM/I,KAAe,OAAO,SAApB,OAAqC,OAAO,aAAhB,UAAmC,OAAO,SAAS,kBAAzB,SAAuCyI,KAAEC;AAAE,SAASF,GAAE,EAAC,SAAQC,EAAC,GAAE;AAAC,QAAK,CAACC,CAAC,IAAEtO,GAAC;AAAG,SAAO4F,GAAE,MAAI2I,GAAED,GAAED,CAAC,GAAE,CAACC,GAAED,CAAC,CAAC,GAAE;AAAI;ACAF,MAAMG,KAAe,OAAO,SAApB,OAAqC,OAAO,aAAhB,UAAmC,OAAO,SAAS,kBAAzB,SAAuCF,KAAE1I;AAAE,SAASkJ,GAAE,EAAC,QAAO9O,GAAE,sBAAqBsO,GAAE,kBAAiB1I,GAAE,cAAaiJ,GAAE,iBAAgBE,GAAE,kBAAiBL,GAAE,cAAaM,GAAE,aAAYP,GAAE,WAAUK,GAAE,gBAAevM,GAAE,eAAc,GAAE,UAAS0S,GAAE,cAAahG,GAAE,gBAAe6F,GAAE,WAAUY,GAAE,IAAGR,GAAE,MAAKS,IAAE,WAAU,YAAWnE,IAAE,IAAG,OAAMK,GAAE,UAASJ,GAAE,eAAcmE,GAAE,GAAGG,EAAC,GAAER,GAAE;AAAC,QAAK,CAAC,GAAElD,CAAC,IAAEjE,EAAEpO,EAAE,YAAY,GAAEmW,IAAE9H,EAAE,CAAAC,MAAG;AAAC,IAAAA,KAAGA,EAAE,iBAAeA,EAAE,cAAc,cAAYtO,EAAE,eAAesO,CAAC,IAAEtO,EAAE,eAAe,IAAI;AAAA,EAAC,GAAE,CAACA,CAAC,CAAC,GAAEqW,IAAE9H,EAAE,MAAI,4BAAYvO,GAAE;AAAC,WAAO,CAAAsO,MAAG;AAAC,iBAAU1I,KAAK5F,EAAE,CAAY,OAAO4F,KAAnB,aAAqBA,EAAE0I,CAAC,IAAQ1I,KAAN,SAAUA,EAAE,UAAQ0I;AAAA,IAAE;AAAA,EAAC,EAAEiH,GAAEY,CAAC,GAAE,CAACA,GAAEZ,CAAC,CAAC;AAAE,SAAO/G,GAAE,OAAK6D,EAAErS,EAAE,YAAY,GAAEA,EAAE,yBAAyB,CAAAA,MAAG;AAAC,IAAAqS,EAAErS,CAAC;AAAA,EAAC,CAAC,IAAG,CAACA,CAAC,CAAC,GAAE2O,EAAE,OAAM,EAAC,yBAAwB,IAAEL,IAAE,QAAO,qBAAoB,IAAE1I,IAAE,QAAO,iBAAgB,IAAEiJ,IAAE,QAAO,oBAAmBE,GAAE,GAASL,KAAN,OAAQ,EAAC,qBAAoBA,EAAC,IAAE,CAAA,GAAG,iBAAgB,KAAgBiH,MAAb,aAAe,CAAC,CAAC3G,IAAE,QAAO,GAASP,KAAN,OAAQ,EAAC,gBAAeA,EAAC,IAAE,CAAA,GAAG,cAAaK,GAAE,mBAAkBvM,GAAE,kBAAiB,GAAE,aAAY,IAAE0S,IAAE,QAAO,iBAAgB,CAAC,KAAG,QAAO,iBAAgBhG,GAAE,gBAAe6F,GAAE,WAAUY,GAAE,iBAAgB,GAAE,eAAcE,GAAE,IAAGV,GAAE,KAAImB,GAAE,MAAKV,GAAE,YAAWnE,GAAE,OAAMK,GAAE,UAASJ,GAAE,GAAGsE,EAAC,CAAC;AAAC;AAAC,MAAMxT,KAAEsM,GAAEC,EAAC;AAAE,SAASF,GAAE5O,GAAE;AAAC,SAAOA,EAAE,eAAc,EAAG,KAAKgP,GAAEhP,EAAE,YAAW,CAAE,CAAC;AAAC;AAAC,MAAMiV,KAAEpG,GAAEI,EAAC;AAAE,SAASA,GAAE,GAAErJ,GAAE;AAAC,QAAK,EAAC,aAAYiJ,GAAE,GAAGT,EAAC,IAAE,GAAE,CAACC,CAAC,IAAErO,GAAC;AAAG,SAAO+O,EAAEL,IAAE,EAAC,UAAS,CAACC,EAAEpM,IAAE,EAAC,QAAO8L,GAAE,GAAGD,GAAE,KAAIxI,EAAC,CAAC,GAAQiJ,KAAN,QAASF,EAAEmG,IAAE,EAAC,QAAOzG,GAAE,SAAQQ,EAAC,CAAC,CAAC,EAAC,CAAC;AAAC;AAAC,SAASiG,GAAE,EAAC,SAAQ9U,GAAE,QAAO4F,EAAC,GAAE;AAAC,QAAMiJ,IAAE,SAAS7O,GAAE;AAAC,UAAK,CAACsO,GAAE1I,CAAC,IAAEwI,EAAE,MAAIQ,GAAE5O,CAAC,CAAC;AAAE,WAAOwO,GAAE,MAAI;AAAC,eAASF,IAAG;AAAC,cAAMA,IAAEM,GAAE5O,CAAC;AAAE,QAAA4F,EAAE0I,CAAC;AAAA,MAAC;AAAC,aAAOA,EAAC,GAAGG,GAAEzO,EAAE,uBAAuB,MAAI;AAAC,QAAAsO,EAAC;AAAA,MAAE,CAAC,GAAEtO,EAAE,yBAAyB,MAAI;AAAC,QAAAsO,EAAC;AAAA,MAAE,CAAC,CAAC;AAAA,IAAC,GAAE,CAACtO,CAAC,CAAC,GAAEsO;AAAA,EAAC,EAAE1I,CAAC,GAAE,CAACyI,GAAEE,CAAC,IAAEH,EAAExI,EAAE,WAAU,CAAE;AAAE,MAAG0I,GAAE,OAAKC,EAAE3I,EAAE,WAAU,CAAE,GAAEA,EAAE,yBAAyB,CAAA5F,MAAG;AAAC,IAAAuO,EAAEvO,CAAC;AAAA,EAAC,CAAC,IAAG,CAAC4F,CAAC,CAAC,GAAE,CAACiJ,EAAE,QAAO;AAAK,MAAIE,IAAE;AAAK,SAAkB,OAAO/O,KAAnB,aAAqB+O,IAAE/O,EAAEqO,CAAC,IAASrO,MAAP,SAAW+O,IAAE/O,IAAU+O,MAAP,OAAS,OAAKJ,EAAE,OAAM,EAAC,eAAc,IAAG,UAASI,EAAC,CAAC;AAAC;ACW7tE,SAASyH,GAAgB;AAAA,EAC9B,aAAAC;AAAA,EACA,WAAApa;AAAA,EACA,sBAAAqa;AACF,GAAqB;AACnB,SACE,gBAAAla;AAAA,IAACma;AAAAA,IAAA;AAAA,MACC,WACEta,KACA;AAAA,MAEF,oBAAkBoa;AAAA,MAClB,aACE,gBAAAja;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,WACEka,KACA;AAAA,UAGD,UAAAD;AAAA,QAAA;AAAA,MAAA;AAAA,IACH;AAAA,EAAA;AAIR;AC7BA,MAAMG,KAAU9G,GASd,MAAS;AAEJ,SAAS+G,GAAe;AAAA,EAC7B,cAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,WAAAC;AAAA,EACA,cAAAC;AAAA,EACA,WAAAC;AAAA,EACA,UAAAxa;AACF,GAOG;AACD,QAAMya,IAAejX;AAAA,IACnB,OAAO;AAAA,MACL,cAAA4W;AAAA,MACA,gBAAAC;AAAA,MACA,WAAAC;AAAA,MACA,cAAAC;AAAA,MACA,WAAAC;AAAA,IAAA;AAAA,IAEF,CAACJ,GAAcC,GAAgBC,GAAWC,GAAcC,CAAS;AAAA,EAAA;AAGnE,2BAAQN,GAAQ,UAAR,EAAiB,OAAOO,GAAe,UAAAza,GAAS;AAC1D;AAEO,SAAS0a,KAAoB;AAClC,QAAMC,IAAUC,GAAWV,EAAO;AAClC,MAAI,CAACS;AACH,UAAM,IAAI,MAAM,iEAAiE;AAEnF,SAAOA;AACT;AC/CO,SAASE,KAGd;AACA,QAAM,CAACC,GAAcC,CAAe,IAAIxV,EAOtC,MAAS,GAELyV,IAAUhT,EAAY,MAAM;AAChC,IAAA+S,EAAgB,MAAS;AAAA,EAC3B,GAAG,CAAA,CAAE,GAECE,IAAQzX,EAAQ,MAAM;AAC1B,QAAIsX,MAAiB;AACnB;AAEF,UAAM,EAAE,OAAAtN,GAAO,SAAA0N,EAAA,IAAYJ;AAC3B,6BACGxb,IAAA,EAAO,MAAI,IAAC,cAAc0b,GACzB,4BAACjb,IAAA,EACC,UAAA;AAAA,MAAA,gBAAAD,EAACM,IAAA,EACC,UAAA,gBAAAN,EAACO,IAAA,EAAa,UAAAmN,EAAA,CAAM,GACtB;AAAA,MACC0N;AAAA,IAAA,EAAA,CACH,EAAA,CACF;AAAA,EAEJ,GAAG,CAACJ,GAAcE,CAAO,CAAC,GAEpBR,IAAYxS;AAAA,IAChB,CACEwF,GACA2N,GACAC,IAAsB,OACnB;AACH,MAAAL,EAAgB;AAAA,QACd,qBAAAK;AAAA,QACA,SAASD,EAAWH,CAAO;AAAA,QAC3B,OAAAxN;AAAA,MAAA,CACD;AAAA,IACH;AAAA,IACA,CAACwN,CAAO;AAAA,EAAA;AAGV,SAAO,CAACC,GAAOT,CAAS;AAC1B;AC5CO,SAASa,GAAc;AAAA,EAC5B,UAAArb;AACF,GAEG;AACD,QAAM,CAACsb,CAAM,IAAIC,GAAA,GAEX,CAACnB,GAAcoB,CAAe,IAAIjW,EAAS+V,CAAM,GACjD,CAAChB,GAAWC,CAAY,IAAIhV,EAAiB,WAAW,GAExD,CAAC0V,GAAOT,CAAS,IAAIK,GAAA,GAErBR,IAAiB,MAAM;AAAA,EAAC;AAE9B,SAAAoB,EAAU,MACDrB,EAAa;AAAA,IAClBsB;AAAA,IACA,CAACC,GAAUC,OACTJ,EAAgBI,CAAS,GAClB;AAAA,IAETC;AAAA,EAAA,GAED,CAACzB,CAAY,CAAC,GAGf,gBAAAla;AAAA,IAACia;AAAA,IAAA;AAAA,MACC,cAAAC;AAAA,MACA,gBAAAC;AAAA,MACA,WAAAC;AAAA,MACA,cAAAC;AAAA,MACA,WAAAC;AAAA,MAEC,UAAA;AAAA,QAAAS;AAAA,QAEAjb,EAAS,EAAE,WAAAsa,EAAA,CAAW;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAG7B;ACrCO,SAASwB,GAAwBC,GAA8C;AACpF,QAAM,CAACT,CAAM,IAAIC,GAAA,GACX,EAAE,cAAAnB,EAAA,IAAiBM,GAAA;AAEzB,EAAAe,EAAU,MACDrB,EAAa;AAAA,IAClBsB;AAAA,IACA,MAAM;AACJ,YAAMM,IAAYC,GAAA;AAClB,aAAID,KACFD,EAASC,CAAS,GAEb;AAAA,IACT;AAAA,IACAH;AAAA,EAAA,GAQD,CAACP,GAAQS,CAAQ,CAAC,GAErBN,EAAU,MAAM;AACd,IAAArB,EAAa,iBAAiB,KAAK,MAAM;AACvC,YAAM4B,IAAYC,GAAA;AAClB,MAAID,KACFD,EAASC,CAAS;AAAA,IAEtB,CAAC;AAAA,EACH,GAAG,CAAC5B,GAAc2B,CAAQ,CAAC;AAC7B;AC9CA,MAAMG,KAAiBtY;AAAA,EACrB;AAAA,EACA;AAAA,IACE,UAAU;AAAA,MACR,SAAS;AAAA,QACP,SAAS;AAAA,QACT,SACE;AAAA,MAAA;AAAA,MAEJ,MAAM;AAAA,QACJ,SAAS;AAAA,QACT,IAAI;AAAA,QACJ,IAAI;AAAA,MAAA;AAAA,IACN;AAAA,IAEF,iBAAiB;AAAA,MACf,SAAS;AAAA,MACT,MAAM;AAAA,IAAA;AAAA,EACR;AAEJ,GAEMuY,KAASzc,EAAM,WAGnB,CAAC,EAAE,WAAAC,GAAW,SAAAmE,GAAS,MAAAC,GAAM,GAAGnE,KAASC,MACzC,gBAAAC;AAAA,EAACsc,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAAvc;AAAA,IACA,WAAWb,EAAGkd,GAAe,EAAE,SAAApY,GAAS,MAAAC,GAAM,WAAApE,EAAA,CAAW,CAAC;AAAA,IACzD,GAAGC;AAAA,EAAA;AACN,CACD;AAEDuc,GAAO,cAAcC,GAAgB,KAAK;AC9B1C,MAAMC,KAAqB3c,EAAM,cAAmD;AAAA,EAClF,MAAM;AAAA,EACN,SAAS;AACX,CAAC,GAQK4c,KAAc5c,EAAM,WAIxB,CAAC,EAAE,WAAAC,GAAW,SAAAmE,GAAS,MAAAC,GAAM,UAAA/D,GAAU,GAAGJ,EAAA,GAASC,MAAQ;AAC3D,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAU;AAAA,IAACyc,GAAqB;AAAA,IAArB;AAAA,MACC,KAAA1c;AAAA,MACA,WAAWb,EAAG,6DAA6DW,CAAS;AAAA,MACnF,GAAGC;AAAA,MACJ,KAAAK;AAAA,MAEA,UAAA,gBAAAH;AAAA,QAACuc,GAAmB;AAAA,QAAnB;AAAA,UAGC,OAAO,EAAE,SAAAvY,GAAS,MAAAC,EAAA;AAAA,UAEjB,UAAA/D;AAAA,QAAA;AAAA,MAAA;AAAA,IACH;AAAA,EAAA;AAGN,CAAC;AAEDsc,GAAY,cAAcC,GAAqB,KAAK;AAGpD,MAAMC,KAAkB9c,EAAM,WAI5B,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,SAAA8D,GAAS,MAAAC,GAAM,GAAGnE,EAAA,GAASC,MAAQ;AAC3D,QAAM8a,IAAUjb,EAAM,WAAW2c,EAAkB;AAEnD,SACE,gBAAAvc;AAAA,IAACyc,GAAqB;AAAA,IAArB;AAAA,MACC,KAAA1c;AAAA,MACA,WAAWb;AAAA,QACTkd,GAAe;AAAA,UACb,SAASvB,EAAQ,WAAW7W;AAAA,UAC5B,MAAM6W,EAAQ,QAAQ5W;AAAA,QAAA,CACvB;AAAA,QACDpE;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,MAEH,UAAAI;AAAA,IAAA;AAAA,EAAA;AAGP,CAAC;AAEDwc,GAAgB,cAAcD,GAAqB,KAAK;AClDxD,MAAME,KAAU;AAAA,EACd,EAAE,QAAQ,QAAQ,MAAMC,IAAU,OAAO,OAAA;AAAA,EACzC,EAAE,QAAQ,UAAU,MAAMC,IAAY,OAAO,SAAA;AAAA,EAC7C,EAAE,QAAQ,aAAa,MAAMC,IAAe,OAAO,YAAA;AAAA,EACnD,EAAE,QAAQ,iBAAiB,MAAMC,IAAmB,OAAO,gBAAA;AAC7D;AAEO,SAASC,KAA0B;AACxC,QAAM,EAAE,cAAA1C,EAAA,IAAiBM,GAAA,GACnB,CAACqC,GAAeC,CAAgB,IAAIzX,EAAmB,CAAA,CAAE,GAEzD8U,IAAiBrS,EAAY,CAACgU,MAA6B;AAC/D,QAAIiB,GAAkBjB,CAAS,KAAKkB,GAAkBlB,CAAS,GAAG;AAChE,YAAMmB,IAAoB,CAAA;AAC1B,MAAAV,GAAQ,QAAQ,CAAC,EAAE,QAAA3V,QAAa;AAC9B,QAAIkV,EAAU,UAAUlV,CAAM,KAC5BqW,EAAQ,KAAKrW,CAAM;AAAA,MAEvB,CAAC,GACDkW,EAAiB,CAACI,MAEZA,EAAK,WAAWD,EAAQ,UAAU,CAACA,EAAQ,MAAM,CAAC/K,MAAMgL,EAAK,SAAShL,CAAC,CAAC,IACnE+K,IAEFC,CACR;AAAA,IACH;AAAA,EACF,GAAG,CAAA,CAAE;AAEL,SAAAtB,GAAwBzB,CAAc,GAGpC,gBAAAva;AAAA,IAACwc;AAAA,IAAA;AAAA,MACC,MAAK;AAAA,MACL,OAAOS;AAAA,MACP,eAAeC;AAAA,MACf,SAAQ;AAAA,MACR,MAAK;AAAA,MAEJ,UAAAP,GAAQ,IAAI,CAAC,EAAE,QAAA3V,GAAQ,MAAM2G,GAAM,OAAA4P,QAClC,gBAAAvd;AAAA,QAAC0c;AAAA,QAAA;AAAA,UAEC,OAAO1V;AAAA,UACP,cAAYuW;AAAA,UACZ,SAAS,MAAM;AACb,YAAAjD,EAAa,gBAAgBkD,IAAqBxW,CAAM;AAAA,UAC1D;AAAA,UAEA,UAAA,gBAAAhH,EAAC2N,GAAA,EAAK,WAAU,gBAAA,CAAgB;AAAA,QAAA;AAAA,QAP3B3G;AAAA,MAAA,CASR;AAAA,IAAA;AAAA,EAAA;AAGP;ACpDA,SAASyW,GAAkB,EAAE,SAAAC,KAAwD;AACnF,QAAM,CAAClC,CAAM,IAAIC,GAAA;AAEjB,EAAAE,EAAU,MAAM;AACd,IAAI+B,KACFA,EAAQ,MAAM;AACZ,MAAAlC,EAAO,gBAAgBmC,IAAsB,MAAS;AAAA,IACxD,CAAC;AAAA,EAEL,GAAG,CAACnC,GAAQkC,CAAO,CAAC;AAGtB;AAEO,SAASE,GAAQ;AAAA,EACtB,aAAA3D,IAAc;AAAA,EACd,WAAA4D,IAAY;AAAA,EACZ,SAAAH;AACF,GAIG;AACD,QAAM,GAAGI,CAAqB,IAAIrY,EAAqC,MAAS;AAQhF,SACE,gBAAArF,EAAC,OAAA,EAAI,WAAU,eAEb,UAAA;AAAA,IAAA,gBAAAJ,EAACub,IAAA,EACE,gBACC,gBAAAvb,EAAC,OAAA,EAAI,WAAU,mFACb,UAAA,gBAAAA,EAACgd,IAAA,CAAA,CAAwB,EAAA,CAC3B,EAAA,CAEJ;AAAA,IAEA,gBAAA5c,EAAC,OAAA,EAAI,WAAU,eACb,UAAA;AAAA,MAAA,gBAAAJ;AAAA,QAAC+d;AAAAA,QAAA;AAAA,UACC,mCACG,OAAA,EAAI,KApBD,CAACC,MAAwC;AACrD,YAAIA,MAAwB,UAC1BF,EAAsBE,CAAmB;AAAA,UAE7C,GAiBY,UAAA,gBAAAhe,EAACga,IAAA,EAAgB,aAAAC,GAA0B,EAAA,CAC7C;AAAA,UAEF,eAAegE;AAAAA,QAAA;AAAA,MAAA;AAAA,MAEhBJ,KAAa,gBAAA7d,EAACke,IAAA,EAAgB,kBAAiB,UAAA,CAAU;AAAA,MAE1D,gBAAAle,EAACyd,MAAkB,SAAAC,GAAkB;AAAA,wBACpCS,IAAA,CAAA,CAAkB;AAAA,IAAA,EAAA,CAErB;AAAA,EAAA,GAEF;AAEJ;AC7DA,MAAMC,KAAkC;AAAA,EACtC,WAAW;AAAA,EACX,OAAO1L;AAAA,EACP,OAAAM;AAAA,EACA,SAAS,CAACU,MAAiB;AACzB,YAAQ,MAAMA,CAAK;AAAA,EACrB;AACF;AAOO,SAAS2K,GAAO;AAAA,EACrB,aAAAC;AAAA,EACA,uBAAAC;AAAA,EACA,UAAAtP;AAAA,EACA,oBAAAuP;AAAA,EACA,aAAAvE,IAAc;AAAA,EACd,WAAA4D,IAAY;AAAA,EACZ,SAAAH;AAAA,EACA,WAAA7d;AACF,GASG;AACD;AAAA;AAAA,IAEE,gBAAAG;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,WAAWd;AAAA,UACT;AAAA,UACAW;AAAA,QAAA;AAAA,QAGF,UAAA,gBAAAG;AAAA,UAACye;AAAAA,UAAA;AAAA,YACC,eAAe;AAAA,cACb,GAAGL;AAAA,cACH,GAAIE,IAAc,EAAE,aAAAA,EAAA,IAAgB,CAAA;AAAA,cACpC,GAAIC,IAAwB,EAAE,aAAa,KAAK,UAAUA,CAAqB,MAAM,CAAA;AAAA,YAAC;AAAA,YAGxF,4BAAC5L,IAAA,EACC,UAAA;AAAA,cAAA,gBAAA3S,EAAC4d,IAAA,EAAQ,aAAA3D,GAA0B,WAAA4D,GAAsB,SAAAH,EAAA,CAAkB;AAAA,cAE3E,gBAAA1d;AAAA,gBAAC0e;AAAAA,gBAAA;AAAA,kBACC,uBAAqB;AAAA,kBACrB,UAAU,CAACC,MAAsB;AAC/B,oBAAA1P,KAAA,QAAAA,EAAW0P,IACXH,KAAA,QAAAA,EAAqBG,EAAkB;kBACzC;AAAA,gBAAA;AAAA,cAAA;AAAA,YACF,EAAA,CACF;AAAA,UAAA;AAAA,QAAA;AAAA,MACF;AAAA,IAAA;AAAA;AAGN;AC3E+a,SAAS3M,GAAExO,GAAEqO,GAAE;AAAC,QAAMC,IAAEC,GAAEF,CAAC,IAAEA,EAAE,KAAK,aAAWA,EAAE;AAAW,MAAIM,IAAE,CAAA;AAAG,QAAMP,IAAE,CAAA;AAAG,aAAUC,KAAKC,EAAE,KAAG,CAACoH,GAAE,IAAIrH,EAAE,QAAQ,GAAE;AAAC,UAAMC,IAAE4G,GAAE7G,GAAErO,GAAEoO,GAAE,EAAE;AAAE,IAAOE,MAAP,SAAWK,IAAEA,EAAE,OAAOL,CAAC;AAAA,EAAE;AAAC,SAAO,SAAStO,GAAE;AAAC,eAAUqO,KAAKrO,EAAE,CAAAqO,EAAE,eAAc,aAAaU,MAAGV,EAAE,YAAYQ,GAAC,CAAE;AAAE,eAAUR,KAAKrO,GAAE;AAAC,YAAMA,IAAEqO,EAAE,YAAW;AAAG,iBAAUC,KAAKtO,EAAE,CAAAqO,EAAE,aAAaC,CAAC;AAAE,MAAAD,EAAE;IAAQ;AAAA,EAAC,EAAED,CAAC,GAAEO;AAAC;AAAC,SAAS6C,GAAExR,GAAEqO,GAAE;AAAC,MAAgB,OAAO,WAApB,OAA2C,OAAO,SAApB,OAAqC,OAAO,WAAhB,OAAuB,OAAM,IAAI,MAAM,gJAAgJ;AAAE,QAAMC,IAAE,SAAS,cAAc,KAAK,GAAE,IAAEK,GAAC,EAAG,YAAW;AAAG,WAAQA,IAAE,GAAEA,IAAE,EAAE,QAAOA;AAAK,IAAAsG,GAAEjV,GAAE,EAAE2O,CAAC,GAAEL,GAAED,CAAC;AAAE,SAAOC,EAAE;AAAS;AAAC,SAAS2G,GAAE,GAAE1G,GAAEI,GAAEF,IAAE,MAAK;AAAC,MAAIK,IAASL,MAAP,QAAUF,EAAE,WAAWE,CAAC;AAAE,QAAMI,IAAET,GAAEG,CAAC,KAAGA,EAAE,gBAAgB,MAAM;AAAE,MAAIQ,IAAER;AAAE,EAAOE,MAAP,QAAU7I,GAAE2I,CAAC,MAAIQ,IAAE/O,GAAEyO,GAAEF,GAAE,OAAO;AAAG,QAAMK,IAAER,GAAEW,CAAC,IAAEA,EAAE,YAAW,IAAG,CAAA,GAAG0C,IAAEzC,GAAE,GAAED,EAAE,QAAO,CAAE;AAAE,MAAIP;AAAE,EAAAA,IAAEiD,KAAYA,EAAE,cAAX,SAAqBA,EAAE,UAAU,GAAE1C,CAAC,IAAEA,EAAE,UAAU,CAAC;AAAE,QAAK,EAAC,SAAQyC,GAAE,OAAMkE,EAAC,IAAElH;AAAE,MAAG,CAACgD,EAAE,QAAM;AAAG,QAAM0D,IAAE,SAAS;AAAyB,WAAQlV,IAAE,GAAEA,IAAE4O,EAAE,QAAO5O,KAAI;AAAC,UAAMqO,IAAEO,EAAE5O,CAAC,GAAE2O,IAAEsG,GAAE,GAAE5G,GAAE6G,GAAEzG,CAAC;AAAE,KAACK,KAAGV,GAAEG,CAAC,KAAGI,KAAGJ,EAAE,iBAAiBF,GAAEI,GAAE,MAAM,MAAIK,IAAE;AAAA,EAAG;AAAC,MAAGA,KAAG,CAACD;AAAG,SAAIR,GAAEmD,CAAC,KAAG9C,GAAE8C,CAAC,MAAIA,EAAE,OAAO0D,CAAC,GAAEvG,EAAE,OAAO6C,CAAC,GAAEkE,GAAE;AAAC,YAAM1V,IAAE0V,EAAE,KAAK3G,GAAEyC,CAAC;AAAE,MAAAxR,MAAI0O,GAAE8C,CAAC,IAAEA,EAAE,gBAAgBxR,CAAC,IAAEwR,EAAE,YAAYxR,CAAC;AAAA,IAAE;AAAA,QAAO,CAAA2O,EAAE,OAAOuG,CAAC;AAAE,SAAOpG;AAAC;AAAC,MAAM4G,KAAE,oBAAI,IAAI,CAAC,SAAQ,QAAQ,CAAC;AAAE,SAASR,GAAElV,GAAEqO,GAAEE,GAAEI,GAAE/I,IAAE,oBAAI,OAAI,GAAE;AAAC,MAAI8I,IAAE,CAAA;AAAG,MAAGgH,GAAE,IAAI1V,EAAE,QAAQ,EAAE,QAAO0O;AAAE,MAAIF,IAAE;AAAK,QAAMgD,IAAE,SAASxR,GAAEqO,GAAE;AAAC,UAAK,EAAC,UAASC,EAAC,IAAEtO,GAAEuO,IAAEF,EAAE,iBAAiB,IAAIC,EAAE,aAAa;AAAE,QAAIK,IAAE;AAAK,QAAYJ,MAAT,OAAW,YAAUF,KAAKE,GAAE;AAAC,YAAMD,IAAED,EAAErO,CAAC;AAAE,MAAOsO,MAAP,SAAkBK,MAAP,SAAWA,EAAE,YAAU,OAAKL,EAAE,YAAU,QAAMK,IAAEL;AAAA,IAAE;AAAC,WAAcK,MAAP,OAASA,EAAE,aAAW;AAAA,EAAI,EAAE3O,GAAEqO,CAAC,GAAE4G,IAAEzD,IAAEA,EAAExR,CAAC,IAAE;AAAK,MAAIuC,IAAE;AAAK,MAAU0S,MAAP,MAAS;AAAC,IAAA1S,IAAE0S,EAAE;AAAM,UAAM5G,IAAE4G,EAAE;AAAK,QAAGzG,IAAE,MAAM,QAAQH,CAAC,IAAEA,EAAEA,EAAE,SAAO,CAAC,IAAEA,GAASG,MAAP,MAAS;AAAC,iBAAS,CAAA,EAAExO,CAAC,KAAI4F,EAAE,KAAG4I,IAAExO,EAAEwO,GAAE,CAAC,GAAE,CAACA,EAAE;AAAM,MAAAA,KAAGE,EAAE,KAAK,GAAG,MAAM,QAAQL,CAAC,IAAEA,IAAE,CAACG,CAAC,CAAC;AAAA,IAAC;AAAC,IAAMyG,EAAE,YAAR,QAAkBrP,EAAE,IAAI5F,EAAE,UAASiV,EAAE,QAAQ;AAAA,EAAC;AAAC,QAAMO,IAAExV,EAAE;AAAW,MAAI8U,IAAE,CAAA;AAAG,QAAMe,KAASrH,KAAN,QAAS,CAACC,GAAED,CAAC,OAAWA,KAAN,QAASM,GAAEN,CAAC,KAAGG;AAAG,WAAQ3O,IAAE,GAAEA,IAAEwV,EAAE,QAAOxV,IAAI,CAAA8U,EAAE,KAAK,GAAGI,GAAEM,EAAExV,CAAC,GAAEqO,GAAEE,GAAEsH,GAAE,IAAI,IAAIjQ,CAAC,GAAE4I,CAAC,CAAC;AAAE,SAAajM,KAAN,SAAUuS,IAAEvS,EAAEuS,CAAC,IAAGxG,GAAEtO,CAAC,MAAI8U,IAAEa,GAAE3V,GAAE8U,GAAEe,IAAE,MAAI;AAAC,UAAM7V,IAAE,IAAI+O;AAAE,WAAOR,EAAE,KAAKvO,CAAC,GAAEA;AAAA,EAAC,IAAEyR,EAAC,IAASjD,KAAN,OAAQsG,EAAE,SAAO,IAAEpG,IAAEA,EAAE,OAAOoG,CAAC,IAAExG,GAAEtO,CAAC,KAAG,SAASA,GAAE;AAAC,WAASA,EAAE,eAAR,QAA2BA,EAAE,mBAAR,YAAwC4O,GAAE5O,EAAE,WAAW,KAAG4O,GAAE5O,EAAE,eAAe;AAAA,EAAC,EAAEA,CAAC,MAAI0O,IAAEA,EAAE,OAAOG,IAAG,KAAGT,GAAEI,CAAC,KAAGA,EAAE,OAAO,GAAGsG,CAAC,GAAEpG;AAAC;AAAC,SAASiH,GAAE3V,GAAEqO,GAAEC,GAAE;AAAC,QAAM,IAAEtO,EAAE,MAAM,WAAU2O,IAAE,CAAA;AAAG,MAAIP,IAAE,CAAA;AAAG,WAAQpO,IAAE,GAAEA,IAAEqO,EAAE,QAAOrO,KAAI;AAAC,UAAM4F,IAAEyI,EAAErO,CAAC;AAAE,QAAG8O,GAAElJ,CAAC,EAAE,MAAG,CAACA,EAAE,eAAaA,EAAE,UAAU,CAAC,GAAE+I,EAAE,KAAK/I,CAAC;AAAA,aAAUwI,EAAE,KAAKxI,CAAC,GAAE5F,MAAIqO,EAAE,SAAO,KAAGrO,IAAEqO,EAAE,SAAO,KAAGS,GAAET,EAAErO,IAAE,CAAC,CAAC,GAAE;AAAC,YAAMA,IAAEsO;AAAI,MAAAtO,EAAE,UAAU,CAAC,GAAEA,EAAE,OAAO,GAAGoO,CAAC,GAAEO,EAAE,KAAK3O,CAAC,GAAEoO,IAAE,CAAA;AAAA,IAAE;AAAA,EAAC;AAAC,SAAOO;AAAC;ACYl+F,SAASyM,GAAqBC,GAAiC;AACpE,QAAMC,IAAuBD,EAAU,cAA2B,0BAA0B;AAC5F,MAAI,CAACC,EAAsB,QAAO;AAElC,EAAAA,EAAqB,MAAA;AAGrB,QAAM5C,IAAY,OAAO,aAAA,GACnB6C,IAAQ,SAAS,YAAA;AACvB,SAAAA,EAAM,mBAAmBD,CAAoB,GAC7CC,EAAM,SAAS,EAAK,GACpB7C,KAAA,QAAAA,EAAW,mBACXA,KAAA,QAAAA,EAAW,SAAS6C,IAEb;AACT;AAQA,SAASC,GACP9e,GACS;AACT,SAAKA,IAEEA,EAAS;AAAA,IACd,CAAC+e,MACKA,KAAS,UAAUA,KAASA,EAAM,KAAK,OAAO,SAAS,IAAU,KAEjE,CAACA,KAAS,EAAE,cAAcA,KAAe,KAEtCD,GAA4BC,EAAM,QAAQ;AAAA,EACnD,IAToB;AAWxB;AAQO,SAASC,GAAiBZ,GAAyD;;AACxF,UAAKpc,IAAAoc,KAAA,gBAAAA,EAAa,SAAb,QAAApc,EAAmB,WACjB8c,GAA4BV,EAAY,KAAK,QAAQ,IADnB;AAE3C;AAQO,SAASa,GAAkBC,GAAqC;AACrE,MAAI,CAACA,KAAQA,EAAK,KAAA,MAAW;AAC3B,UAAM,IAAI,MAAM,qBAAqB;AAGvC,QAAM5D,IAAS6D,GAAqB;AAAA,IAClC,WAAW;AAAA,IACX,OAAO3M;AAAA,IACP,OAAAM;AAAA,IACA,SAAS,CAACU,MAAiB;AACzB,cAAQ,MAAMA,CAAK;AAAA,IACrB;AAAA,EAAA,CACD;AAED,MAAI4L;AAoBJ,MAlBA9D,EAAO;AAAA,IACL,MAAM;AAEJ,YAAM+D,IADS,IAAI,UAAA,EACA,gBAAgBH,GAAM,WAAW,GAC9CI,IAAiBC,GAAsBjE,GAAQ+D,CAAG;AAExD,MAAAG,GAAA,EAAW,MAAA,GACXC,GAAaH,CAAc;AAAA,IAC7B;AAAA,IACA;AAAA,MACE,UAAU;AAAA,IAAA;AAAA,EACZ,GAGFhE,EAAO,iBAAiB,KAAK,MAAM;AACjC,IAAA8D,IAAkB9D,EAAO,eAAA,EAAiB,OAAA;AAAA,EAC5C,CAAC,GAEG,CAAC8D;AACH,UAAM,IAAI,MAAM,wCAAwC;AAG1D,SAAOA;AACT;AAQO,SAASM,GAAkBtB,GAA4C;AAC5E,QAAM9C,IAAS6D,GAAqB;AAAA,IAClC,WAAW;AAAA,IACX,OAAO3M;AAAA,IACP,OAAAM;AAAA,IACA,SAAS,CAACU,MAAiB;AACzB,cAAQ,MAAMA,CAAK;AAAA,IACrB;AAAA,EAAA,CACD,GAEKmM,IAAoBrE,EAAO,iBAAiB,KAAK,UAAU8C,CAAW,CAAC;AAC7E,EAAA9C,EAAO,eAAeqE,CAAiB;AAEvC,MAAIT,IAAO;AAEX,SAAA5D,EAAO,iBAAiB,KAAK,MAAM;AACjC,IAAA4D,IAAOU,GAAuBtE,CAAM;AAAA,EACtC,CAAC,GAGD4D,IAAOA,EAEJ,QAAQ,qBAAqB,EAAE,EAE/B,QAAQ,qBAAqB,EAAE,EAE/B,QAAQ,wBAAwB,IAAI,EAEpC,QAAQ,yCAAyC,WAAW,EAC5D,QAAQ,yCAAyC,WAAW,EAE5D,QAAQ,iCAAiC,WAAW,EACpD,QAAQ,iCAAiC,WAAW,EAEpD,QAAQ,qCAAqC,WAAW,EAExD,QAAQ,qCAAqC,WAAW,EAExD,QAAQ,gBAAgB,OAAO,GAE3BA;AACT;AASO,SAASW,GAA0B5T,GAAkD;AAI1F,SAFuB,CAAC,WAAW,aAAa,aAAa,cAAc,QAAQ,KAAK,EAErE,SAASA,EAAM,GAAG,KACnCA,EAAM,gBAAA,GACC,MAGF;AACT;AC7JA,MAAM6T,KAEF;AAAA,EACF,MAAM;AAAA,IACJ,UAAU;AAAA,MACR;AAAA,QACE,UAAU;AAAA,UACR;AAAA,YACE,QAAQ;AAAA,YACR,QAAQ;AAAA,YACR,MAAM;AAAA,YACN,OAAO;AAAA,YACP,MAAM;AAAA,YACN,MAAM;AAAA,YACN,SAAS;AAAA,UAAA;AAAA,QACX;AAAA,QAEF,WAAW;AAAA,QACX,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,SAAS;AAAA,QACT,YAAY;AAAA,QACZ,WAAW;AAAA,MAAA;AAAA,IACb;AAAA,IAEF,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,MAAM;AAAA,IACN,SAAS;AAAA,EAAA;AAEb;AA6BA,SAASC,GACPC,GACA3W,GACQ;AACR,SAAI2W,MAAS,KACJ3W,EAAiB,4BAA4B,KAAK,eAEvD2W,MAAS,SACJ3W,EAAiB,sBAAsB,KAAK,SAE9C2W;AACT;AAOA,SAAwBC,GAAc;AAAA,EACpC,iBAAAC;AAAA,EACA,QAAAC;AAAA,EACA,SAAAnF;AAAA,EACA,kBAAA3R;AACF,GAAuB;AACrB,QAAM,CAAC+U,GAAagC,CAAc,IAAI7a,EAAgCua,EAAY,GAC5E,CAACO,GAAcC,CAAe,IAAI/a,EAA6B,MAAS,GACxE,CAACgb,GAAqBC,CAAsB,IAAIjb,EAAkB,EAAK,GACvEkb,IAAiBtd,EAAiC,MAAS,GAI3Dud,IAAqBvd,EAAuB,IAAI;AAGtD,EAAAsY,EAAU,MAAM;AACd,QAAIkF,IAAY;AAChB,UAAMhC,IAAY+B,EAAmB;AACrC,QAAI,CAAC/B,EAAW;AAEhB,UAAMiC,IAAY,WAAW,MAAM;AACjC,MAAKD,KACLjC,GAAqBC,CAAS;AAAA,IAChC,GAAG,GAAG;AAEN,WAAO,MAAM;AACX,MAAAgC,IAAY,IACZ,aAAaC,CAAS;AAAA,IACxB;AAAA,EACF,GAAG,CAAA,CAAE;AAEL,QAAMC,IAAa7Y,EAAY,MAAM;AACnC,QAAI,CAACgX,GAAiBZ,CAAW,EAAG;AAEpC,UAAM0C,IAAWpB,GAAkBtB,CAAW;AAC9C,IAAA+B,EAAOW,GAAUT,CAAY;AAAA,EAC/B,GAAG,CAACjC,GAAa+B,GAAQE,CAAY,CAAC,GAEhCtG,IACJ1Q,EAAiB,6BAA6B,KAAK,6BAC/C0X,IAAc1X,EAAiB,oCAAoC,KAAK,gBACxE2X,IAAgB3X,EAAiB,sCAAsC,KAAK,UAC5E4X,IAAgB5X,EAAiB,gCAAgC,KAAK;AAE5E,SACE,gBAAAnJ,EAAC,OAAA,EAAI,WAAU,2BACb,UAAA;AAAA,IAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,8CACb,UAAA;AAAA,MAAA,gBAAAJ,EAAC,QAAA,EAAK,WAAU,6BAA6B,UAAAmhB,GAAc;AAAA,MAC3D,gBAAA/gB,EAAC,OAAA,EAAI,WAAU,oBACb,UAAA;AAAA,QAAA,gBAAAJ,EAAC2S,IAAA,EACC,4BAACE,IAAA,EACC,UAAA;AAAA,UAAA,gBAAA7S,EAAC8S,MAAe,SAAO,IACrB,UAAA,gBAAA9S,EAAC+D,GAAA,EAAO,SAASmX,GAAS,WAAU,iBAAgB,MAAK,QAAO,SAAQ,aACtE,UAAA,gBAAAlb,EAACK,IAAA,CAAA,CAAE,GACL,GACF;AAAA,UACA,gBAAAL,EAAC+S,IAAA,EACC,UAAA,gBAAA/S,EAAC,KAAA,EAAG,aAAc,EAAA,CACpB;AAAA,QAAA,EAAA,CACF,EAAA,CACF;AAAA,QACA,gBAAAA,EAAC2S,IAAA,EACC,UAAA,gBAAAvS,EAACyS,IAAA,EACC,UAAA;AAAA,UAAA,gBAAA7S,EAAC8S,IAAA,EAAe,SAAO,IACrB,UAAA,gBAAA9S;AAAA,YAAC+D;AAAA,YAAA;AAAA,cACC,SAASgd;AAAA,cACT,WAAU;AAAA,cACV,MAAK;AAAA,cACL,SAAQ;AAAA,cACR,UAAU,CAAC7B,GAAiBZ,CAAW;AAAA,cAEvC,4BAAC1a,IAAA,CAAA,CAAM;AAAA,YAAA;AAAA,UAAA,GAEX;AAAA,UACA,gBAAA5D,EAAC+S,IAAA,EACC,UAAA,gBAAA/S,EAAC,KAAA,EAAG,aAAY,EAAA,CAClB;AAAA,QAAA,EAAA,CACF,EAAA,CACF;AAAA,MAAA,EAAA,CACF;AAAA,IAAA,GACF;AAAA,IAEA,gBAAAA,EAAC,SAAI,WAAU,oCACb,4BAACoE,IAAA,EAAQ,MAAMqc,GAAqB,cAAcC,GAChD,UAAA;AAAA,MAAA,gBAAA1gB,EAACsE,IAAA,EAAe,SAAO,IACrB,UAAA,gBAAAlE;AAAA,QAAC2D;AAAA,QAAA;AAAA,UACC,SAAQ;AAAA,UACR,WAAU;AAAA,UACV,UAAUqc,EAAgB,WAAW;AAAA,UAErC,UAAA;AAAA,YAAA,gBAAApgB,EAACohB,IAAA,EAAO,WAAU,gBAAA,CAAgB;AAAA,YAClC,gBAAAphB,EAAC,QAAA,EACE,UACGigB,GADHM,MAAiB,SACaA,IACA,IADchX,CAAgB,EACV,CACrD;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA,GAEJ;AAAA,MACA,gBAAAvJ;AAAA,QAACwE;AAAA,QAAA;AAAA,UACC,WAAU;AAAA,UACV,OAAM;AAAA,UACN,WAAW,CAAChB,MAAM;AAChB,YAAIA,EAAE,QAAQ,aACZA,EAAE,gBAAA,GACFkd,EAAuB,EAAK;AAAA,UAEhC;AAAA,UAEA,4BAACjgB,IAAA,EACC,UAAA,gBAAAT,EAACa,MACE,UAAAuf,EAAgB,IAAI,CAACF,MACpB,gBAAAlgB;AAAA,YAACiB;AAAA,YAAA;AAAA,cAEC,UAAU,MAAM;AACd,gBAAAuf,EAAgBN,MAAS,KAAK,SAAYA,CAAI,GAC9CQ,EAAuB,EAAK;AAAA,cAC9B;AAAA,cACA,WAAU;AAAA,cAEV,UAAA,gBAAA1gB,EAAC,QAAA,EAAM,UAAAigB,GAA2BC,GAAM3W,CAAgB,EAAA,CAAE;AAAA,YAAA;AAAA,YAPrD2W,KAAQ;AAAA,UAAA,CAShB,GACH,EAAA,CACF;AAAA,QAAA;AAAA,MAAA;AAAA,IACF,EAAA,CACF,EAAA,CACF;AAAA,IAEA,gBAAAlgB;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,KAAK4gB;AAAA,QACL,MAAK;AAAA,QACL,UAAU;AAAA,QACV,WAAU;AAAA,QACV,kBAAkB,CAACpd,MAAM;AACvB,UAAIA,EAAE,QAAQ,YACZA,EAAE,eAAA,GACFA,EAAE,gBAAA,GACF0X,EAAA,KACS1X,EAAE,QAAQ,WAAWA,EAAE,aAChCA,EAAE,eAAA,GACFA,EAAE,gBAAA,GACE0b,GAAiBZ,CAAW,KAC9ByC,EAAA;AAAA,QAGN;AAAA,QACA,WAAW,CAACvd,MAAM;AAChB,UAAAuc,GAA0Bvc,CAAC,IACvBA,EAAE,QAAQ,WAAWA,EAAE,QAAQ,QACjCA,EAAE,gBAAA;AAAA,QAEN;AAAA,QAEA,UAAA,gBAAAxD;AAAA,UAACqe;AAAA,UAAA;AAAA,YACC,uBAAuBC;AAAA,YACvB,oBAAoB,CAACtP,MAAUsR,EAAetR,CAAK;AAAA,YACnD,aAAAiL;AAAA,YACA,SAAS,CAACoH,MAAY;AACpB,cAAAV,EAAe,UAAUU;AAAA,YAC3B;AAAA,UAAA;AAAA,QAAA;AAAA,MACF;AAAA,IAAA;AAAA,EACF,GACF;AAEJ;ACzQO,MAAMC,KAA6B,OAAO,OAAO;AAAA,EACtD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAU,GCaGC,KAA0C;AAAA,EACrD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,GCvCMC,KAAoC,CAAC,SAAS,UAAU,YAAY,QAAQ,GAG5EC,KAAqC,CAAC,UAAU,SAAS,GAkClDC,KAAa,CAAC;AAAA,EACzB,SAAA7S;AAAA,EACA,eAAA8S;AAAA,EACA,gBAAAC;AAAA,EACA,kBAAAC;AACF,MAAuB;AAGrB,QAAMC,IAAaze,EAAoB,IAAI,GACrC,CAAC0e,GAAUC,CAAW,IAAIvc,EAA6B,MAAS,GAChE,CAACwc,GAAYC,CAAa,IAAIzc,EAA6B,MAAS,GAEpE0c,IAAcja;AAAA,IAClB,CAAC7C,MAAe;AACd,MAAA2c,EAAY3c,CAAE;AACd,YAAMsJ,IAASE,EAAQ,KAAK,CAACuT,MAAQA,EAAI,OAAO/c,CAAE;AAClD,MAAIsJ,MACFgT,KAAA,QAAAA,EAAgBhT;AAGlB,YAAM1C,IAAU,SAAS,eAAe5G,CAAE;AAC1C,MAAI4G,MACFA,EAAQ,eAAe,EAAE,OAAO,SAAA,CAAU,GAC1CA,EAAQ,MAAA,IAIN6V,EAAW,WACbA,EAAW,QAAQ,aAAa,yBAAyBzc,CAAE;AAAA,IAE/D;AAAA,IACA,CAACsc,GAAe9S,CAAO;AAAA,EAAA,GAGnBwT,IAAuBna;AAAA,IAC3B,CAAC7C,MAAe;AACd,YAAMsJ,IAASE,EAAQ,KAAK,CAACuT,MAAQA,EAAI,OAAO/c,CAAE;AAClD,MAAKsJ,MAELuT,EAAc,CAAC5E,MAAUA,MAASjY,IAAK,SAAYA,CAAG,GACtDuc,KAAA,QAAAA,EAAiBjT;AAAA,IACnB;AAAA,IACA,CAACiT,GAAgB/S,CAAO;AAAA,EAAA,GAIpByT,IAAuB,CAACrW,MAAqC;AACjE,QAAI,CAACA,EAAS,QAAO;AACrB,UAAMsW,IAAMtW,EAAQ,QAAQ,YAAA;AAE5B,QADIA,EAAQ,qBACRuV,GAAkC,SAASe,CAAG,EAAG,QAAO;AAC5D,UAAMC,IAAOvW,EAAQ,aAAa,MAAM;AACxC,QAAIuW,KAAQf,GAAmC,SAASe,CAAI,EAAG,QAAO;AACtE,UAAMC,IAAWxW,EAAQ,aAAa,UAAU;AAChD,WAAIwW,MAAa,UAAaA,MAAa;AAAA,EAE7C,GAEMC,IAAgBxa;AAAA,IACpB,CAACiE,MAA4C;;AAG3C,YAAMQ,IAAgBR,EAAM,QACtBwW,IAAiB,CAACtd,MAAiBA,IAAK,SAAS,eAAeA,CAAE,IAAI,QACtEud,IAAkBD,EAAeV,CAAU,GAC3CY,IAAgBF,EAAeZ,CAAQ;AAY7C,UATyB,CAAC,EACxBa,KACAjW,KACAiW,EAAgB,SAASjW,CAAa,KACtCA,MAAkBiW,MAEoCN,EAAqB3V,CAAa,GAGzD;AAC/B,YACER,EAAM,QAAQ,YACbA,EAAM,QAAQ,eAAe,CAACQ,EAAc,mBAC7C;AACA,cAAIsV,GAAY;AAEd,YAAA9V,EAAM,eAAA,GACNA,EAAM,gBAAA;AACN,kBAAMiW,IAAMvT,EAAQ,KAAK,CAACkD,MAAMA,EAAE,OAAOkQ,CAAU;AACnD,YAAIG,KACFD,EAAYC,EAAI,EAAE;AAAA,UAEtB;AACA;AAAA,QACF;AAGA,YAAIjW,EAAM,QAAQ,eAAeA,EAAM,QAAQ,WAAW;AACxD,cAAI,CAACyW,EAAiB;AAGtB,gBAAME,IAAoB,MAAM;AAAA,YAC9BF,EAAgB;AAAA,cACd;AAAA,YAAA;AAAA,UACF;AAGF,cAAIE,EAAkB,WAAW,EAAG;AAEpC,gBAAMC,IAAeD,EAAkB,UAAU,CAACE,MAAOA,MAAOrW,CAAa;AAC7E,cAAIoW,MAAiB,GAAI;AAEzB,cAAIE;AACJ,UAAI9W,EAAM,QAAQ,cAChB8W,IAAY,KAAK,IAAIF,IAAe,GAAGD,EAAkB,SAAS,CAAC,IAEnEG,IAAY,KAAK,IAAIF,IAAe,GAAG,CAAC,GAGtCE,MAAcF,MAChB5W,EAAM,eAAA,GACNA,EAAM,gBAAA,IACNjK,IAAA4gB,EAAkBG,CAAS,MAA3B,QAAA/gB,EAA8B;AAEhC;AAAA,QACF;AAEA;AAAA,MACF;AAEA,YAAM6gB,IAAelU,EAAQ,UAAU,CAACuT,MAAQA,EAAI,OAAOL,CAAQ;AACnE,UAAIkB,IAAYF;AAEhB,cAAQ5W,EAAM,KAAA;AAAA,QACZ,KAAK;AACH,UAAA8W,IAAY,KAAK,IAAIF,IAAe,GAAGlU,EAAQ,SAAS,CAAC,GACzD1C,EAAM,eAAA;AACN;AAAA,QACF,KAAK;AACH,UAAA8W,IAAY,KAAK,IAAIF,IAAe,GAAG,CAAC,GACxC5W,EAAM,eAAA;AACN;AAAA,QACF,KAAK;AACH,UAAA8W,IAAY,GACZ9W,EAAM,eAAA;AACN;AAAA,QACF,KAAK;AACH,UAAA8W,IAAYpU,EAAQ,SAAS,GAC7B1C,EAAM,eAAA;AACN;AAAA,QACF,KAAK;AAAA,QACL,KAAK;AACH,UAAI4V,KACFM,EAAqBN,CAAQ,GAE/B5V,EAAM,eAAA,GACNA,EAAM,gBAAA;AACN;AAAA,QACF,KAAK,cAAc;AAEjB,gBAAM0S,IAAYgE;AAClB,cAAIhE,GAAW;AACb,kBAAMqE,IAAYrE,EAAU;AAAA,cAC1B;AAAA,YAAA,GAEIjK,IAAWiK,EAAU;AAAA,cACzB;AAAA,YAAA,GAEIsE,IAAUD,KAAatO;AAC7B,gBAAIuO,GAAS;AACX,cAAAhX,EAAM,eAAA,GACNgX,EAAQ,MAAA;AACR;AAAA,YACF;AAAA,UACF;AACA;AAAA,QACF;AAAA,QACA;AAEE,UAAIhX,EAAM,IAAI,WAAW,KAAK,CAACA,EAAM,WAAW,CAACA,EAAM,WAAW,CAACA,EAAM,WAExCmW,EAAqB3V,CAAa,MAE/DkV,KAAA,QAAAA,EAAmB1V,EAAM,MACzBA,EAAM,eAAA;AAGV;AAAA,MAAA;AAGJ,YAAMiX,IAAavU,EAAQoU,CAAS;AACpC,MAAIG,KAAYjB,EAAYiB,EAAW,EAAE;AAAA,IAC3C;AAAA,IACA,CAACvU,GAASsT,GAAaJ,GAAUE,GAAYI,GAAsBR,CAAgB;AAAA,EAAA;AAGrF,SAAO;AAAA,IACL,YAAAC;AAAA,IACA,UAAAC;AAAA,IACA,YAAAE;AAAA;AAAA,IAEA,eAAAS;AAAA;AAAA,IAEA,aAAAP;AAAA,EAAA;AAEJ,GCzOMkB,KAAgBvf;AAAA,EACpB;AAAA,EACA;AAAA,IACE,UAAU;AAAA,MACR,SAAS;AAAA,QACP,SACE;AAAA,QACF,WACE;AAAA,QACF,OACE;AAAA,QACF,aACE;AAAA,QACF,SAAS;AAAA,QACT,eAAe;AAAA,QACf,gBAAgB;AAAA,QAChB,OAAO;AAAA,MAAA;AAAA,IACT;AAAA,IAEF,iBAAiB;AAAA,MACf,SAAS;AAAA,IAAA;AAAA,EACX;AAEJ,GAkBMwf,KAAQ1jB,EAAM;AAAA,EAClB,CAAC,EAAE,WAAAC,GAAW,SAAAmE,GAAS,GAAGlE,EAAA,GAASC,MAE/B,gBAAAC,EAAC,OAAA,EAAI,KAAAD,GAAU,WAAWb,EAAG,UAAUmkB,GAAc,EAAE,SAAArf,EAAA,CAAS,GAAGnE,CAAS,GAAI,GAAGC,EAAA,CAAO;AAGhG;AAEAwjB,GAAM,cAAc;ACnDpB,MAAMC,KAAO3jB,EAAM;AAAA,EACjB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACAyjB,GAAK,cAAc;AAGnB,MAAMC,KAAa5jB,EAAM;AAAA,EACvB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,WAAWb,EAAG,oDAAoDW,CAAS;AAAA,MAC1E,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACA0jB,GAAW,cAAc;AAGzB,MAAMC,KAAY7jB,EAAM;AAAA,EACtB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,MAGH,UAAAA,EAAM;AAAA,IAAA;AAAA,EAAA;AAGb;AACA2jB,GAAU,cAAc;AAGxB,MAAMC,KAAkB9jB,EAAM,WAG5B,CAAC,EAAE,WAAAC,GAAW,GAAGC,KAASC,wBACzB,KAAA,EAAE,KAAAA,GAAU,WAAWb,EAAG,8CAA8CW,CAAS,GAAI,GAAGC,GAAO,CACjG;AACD4jB,GAAgB,cAAc;AAG9B,MAAMC,KAAc/jB,EAAM;AAAA,EACxB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAC,EAAC,OAAA,EAAI,KAAAD,GAAU,WAAWb,EAAG,yBAAyBW,CAAS,GAAI,GAAGC,EAAA,CAAO;AAEjF;AACA6jB,GAAY,cAAc;AAG1B,MAAMC,KAAahkB,EAAM;AAAA,EACvB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,WAAWb,EAAG,iDAAiDW,CAAS;AAAA,MACvE,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACA8jB,GAAW,cAAc;ACnEzB,MAAMC,KAAYjkB,EAAM,WAGtB,CAAC,EAAE,WAAAC,GAAW,aAAAikB,IAAc,cAAc,YAAAC,IAAa,IAAM,GAAGjkB,EAAA,GAASC,MACzE,gBAAAC;AAAA,EAACgkB,GAAmB;AAAA,EAAnB;AAAA,IACC,KAAAjkB;AAAA,IACA,YAAAgkB;AAAA,IACA,aAAAD;AAAA,IACA,WAAW5kB;AAAA,MACT;AAAA,MACA4kB,MAAgB,eAAe,yBAAyB;AAAA,MACxDjkB;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACD+jB,GAAU,cAAcG,GAAmB,KAAK;ACnBhD,MAAMC,KAASrkB,EAAM,WAGnB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACkkB,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAAnkB;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDmkB,GAAO,cAAcC,GAAgB,KAAK;AAG1C,MAAMC,KAAcvkB,EAAM,WAGxB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACkkB,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAAnkB;AAAA,IACA,WAAWb,EAAG,+CAA+CW,CAAS;AAAA,IACrE,GAAGC;AAAA,EAAA;AACN,CACD;AACDqkB,GAAY,cAAcD,GAAgB,MAAM;AAGhD,MAAME,KAAiBxkB,EAAM,WAG3B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACkkB,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAAnkB;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDskB,GAAe,cAAcF,GAAgB,SAAS;AC5C/C,MAAMG,KAAc/Q,GAA4C,MAAS;AAEzE,SAASgR,KAAiB;AAC/B,QAAMzJ,IAAUC,GAAWuJ,EAAW;AACtC,MAAI,CAACxJ;AACH,UAAM,IAAI,MAAM,4DAA4D;AAG9E,SAAOA;AACT;AAEO,MAAM0J,KAAezgB,GAAI,IAAI;AAAA,EAClC,UAAU;AAAA,IACR,SAAS;AAAA,MACP,SAAS;AAAA,MACT,OACE;AAAA,IAAA;AAAA,EACJ;AAAA,EAEF,iBAAiB;AAAA,IACf,SAAS;AAAA,EAAA;AAEb,CAAC,GCFY0gB,KAAsBC,EAAsB,SAG5CC,KAAoBD,EAAsB,OAG1CE,KAAqBF,EAAsB,QAG3CG,KAAkBH,EAAsB,KAGxCI,KAAyBJ,EAAsB;AAsErD,SAASK,GAAa,EAAE,SAAA9gB,IAAU,WAAW,GAAGlE,KAA4B;AACjF,QAAM6a,IAAe/a,EAAM;AAAA,IACzB,OAAO;AAAA,MACL,SAAAoE;AAAA,IAAA;AAAA,IAEF,CAACA,CAAO;AAAA,EAAA;AAEV,SACE,gBAAAhE,EAACqkB,GAAY,UAAZ,EAAqB,OAAO1J,GAC3B,UAAA,gBAAA3a,EAACykB,EAAsB,MAAtB,EAA4B,GAAG3kB,EAAA,CAAO,EAAA,CACzC;AAEJ;AAIO,MAAMilB,KAAyBnlB,EAAM,WAG1C,CAAC,EAAE,WAAAC,GAAW,OAAAmlB,GAAO,UAAA9kB,GAAU,GAAGJ,EAAA,GAASC,MAAQ;AACnD,QAAM8a,IAAUyJ,GAAA;AAChB,SACE,gBAAAlkB;AAAA,IAACqkB,EAAsB;AAAA,IAAtB;AAAA,MACC,KAAA1kB;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACA8lB,KAAS;AAAA,QACTnlB;AAAA,QACA0kB,GAAa,EAAE,SAAS1J,EAAQ,SAAS;AAAA;AAAA,MAAA;AAAA,MAE1C,GAAG/a;AAAA,MAEH,UAAA;AAAA,QAAAI;AAAA,QACD,gBAAAF,EAAC8I,IAAA,EAAa,WAAU,2BAAA,CAA2B;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGzD,CAAC;AACDic,GAAuB,cAAcN,EAAsB,WAAW;AAG/D,MAAMQ,KAAyBrlB,EAAM,WAG1C,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACykB,EAAsB;AAAA,EAAtB;AAAA,IACC,KAAA1kB;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDmlB,GAAuB,cAAcR,EAAsB,WAAW;AAM/D,MAAMS,KAAsBtlB,EAAM,WAGvC,CAAC,EAAE,WAAAC,GAAW,YAAA6E,IAAa,GAAG,UAAAxE,GAAU,GAAGJ,EAAA,GAASC,MAAQ;AAC5D,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAU,EAACykB,EAAsB,QAAtB,EACC,UAAA,gBAAAzkB;AAAA,IAACykB,EAAsB;AAAA,IAAtB;AAAA,MACC,KAAA1kB;AAAA,MACA,YAAA2E;AAAA,MACA,WAAWxF;AAAA;AAAA,QAET;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,MAEJ,UAAA,gBAAAE,EAAC,OAAA,EAAI,KAAAG,GAAW,UAAAD,EAAA,CAAS;AAAA,IAAA;AAAA,EAAA,GAE7B;AAEJ,CAAC;AACDglB,GAAoB,cAAcT,EAAsB,QAAQ;AAGzD,MAAMU,KAAmBvlB,EAAM,WAGpC,CAAC,EAAE,WAAAC,GAAW,OAAAmlB,GAAO,GAAGllB,EAAA,GAASC,MAAQ;AACzC,QAAMI,IAAiBb,GAAA,GACjBub,IAAUyJ,GAAA;AAChB,SACE,gBAAAtkB;AAAA,IAACykB,EAAsB;AAAA,IAAtB;AAAA,MACC,KAAA1kB;AAAA,MACA,WAAWb;AAAA;AAAA,QAET;AAAA,QACA8lB,KAAS;AAAA,QACTnlB;AAAA,QACA0kB,GAAa,EAAE,SAAS1J,EAAQ,SAAS;AAAA;AAAA,MAAA;AAAA,MAE1C,GAAG/a;AAAA,MACJ,KAAAK;AAAA,IAAA;AAAA,EAAA;AAGN,CAAC;AACDglB,GAAiB,cAAcV,EAAsB,KAAK;AAGnD,MAAMW,KAA2BxlB,EAAM,WAG5C,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,SAAAmlB,GAAS,GAAGvlB,EAAA,GAASC,MAAQ;AACrD,QAAM8a,IAAUyJ,GAAA;AAChB,SACE,gBAAAlkB;AAAA,IAACqkB,EAAsB;AAAA,IAAtB;AAAA,MACC,KAAA1kB;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACAW;AAAA,QACA0kB,GAAa,EAAE,SAAS1J,EAAQ,SAAS;AAAA;AAAA,MAAA;AAAA,MAE3C,SAAAwK;AAAA,MACC,GAAGvlB;AAAA,MAEJ,UAAA;AAAA,QAAA,gBAAAE,EAAC,QAAA,EAAK,WAAU,wGACd,UAAA,gBAAAA,EAACykB,EAAsB,eAAtB,EACC,UAAA,gBAAAzkB,EAAC4D,IAAA,EAAM,WAAU,gBAAA,CAAgB,EAAA,CACnC,GACF;AAAA,QACC1D;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGP,CAAC;AACDklB,GAAyB,cAAcX,EAAsB,aAAa;AAGnE,MAAMa,KAAwB1lB,EAAM,WAGzC,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,GAAGJ,EAAA,GAASC,MAAQ;AAC5C,QAAM8a,IAAUyJ,GAAA;AAChB,SACE,gBAAAlkB;AAAA,IAACqkB,EAAsB;AAAA,IAAtB;AAAA,MACC,KAAA1kB;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACAW;AAAA,QACA0kB,GAAa,EAAE,SAAS1J,EAAQ,SAAS;AAAA;AAAA,MAAA;AAAA,MAE1C,GAAG/a;AAAA,MAEJ,UAAA;AAAA,QAAA,gBAAAE,EAAC,QAAA,EAAK,WAAU,wGACd,UAAA,gBAAAA,EAACykB,EAAsB,eAAtB,EACC,UAAA,gBAAAzkB,EAACyO,IAAA,EAAO,WAAU,gCAAA,CAAgC,EAAA,CACpD,GACF;AAAA,QACCvO;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGP,CAAC;AACDolB,GAAsB,cAAcb,EAAsB,UAAU;AAG7D,MAAMc,KAAoB3lB,EAAM,WAGrC,CAAC,EAAE,WAAAC,GAAW,OAAAmlB,GAAO,GAAGllB,KAASC,MACjC,gBAAAC;AAAA,EAACykB,EAAsB;AAAA,EAAtB;AAAA,IACC,KAAA1kB;AAAA,IACA,WAAWb,EAAG,iDAAiD8lB,KAAS,WAAWnlB,CAAS;AAAA,IAC3F,GAAGC;AAAA,EAAA;AACN,CACD;AACDylB,GAAkB,cAAcd,EAAsB,MAAM;AAGrD,MAAMe,KAAwB5lB,EAAM,WAGzC,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACykB,EAAsB;AAAA,EAAtB;AAAA,IACC,KAAA1kB;AAAA,IACA,WAAWb,EAAG,wCAAwCW,CAAS;AAAA,IAC9D,GAAGC;AAAA,EAAA;AACN,CACD;AACD0lB,GAAsB,cAAcf,EAAsB,UAAU;AAG7D,SAASgB,GAAqB,EAAE,WAAA5lB,GAAW,GAAGC,KAAoC;AACvF,SACE,gBAAAE;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWd,EAAG,0DAA0DW,CAAS;AAAA,MAEhF,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACA2lB,GAAqB,cAAc;AC1S5B,SAASxF,GACdC,GACA3W,GACQ;AACR,SAAI2W,MAAS,KACJ3W,EAAiB,6BAA6B,KAAK,eAExD2W,MAAS,SACJ3W,EAAiB,uBAAuB,KAAK,SAE/C2W;AACT;ACUO,SAASwF,GAAY;AAAA,EAC1B,SAAAC;AAAA,EACA,SAAAC,IAAU;AAAA,EACV,kBAAArc;AAAA,EACA,kBAAAsc,IAAmB;AAAA,EACnB,qBAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,iBAAAC,IAAkB;AACpB,GAAqB;AACnB,QAAM,CAACC,GAAWC,CAAY,IAAI1gB,EAAS,EAAK,GAC1C,CAAC6Y,GAAagC,CAAc,IAAI7a,EAAA,GAGhC2gB,IAAmB/iB,EAA8B,IAAI;AAG3D,EAAAsY,EAAU,MAAM;AACd,QAAI,CAACuK,EAAW;AAEhB,QAAIrF,IAAY;AAChB,UAAMhC,IAAYuH,EAAiB;AACnC,QAAI,CAACvH,EAAW;AAShB,UAAMiC,IAAY,WAAW,MAAM;AACjC,MAAKD,KACLjC,GAAqBC,CAAS;AAAA,IAChC,GAAG,GAAG;AAEN,WAAO,MAAM;AACX,MAAAgC,IAAY,IACZ,aAAaC,CAAS;AAAA,IACxB;AAAA,EACF,GAAG,CAACoF,CAAS,CAAC;AAEd,QAAMG,IAAmBne,EAAY,MAAM;AACzC,IAAAie,EAAa,EAAK,GAClB7F,EAAe,MAAS,GACxB0F,KAAA,QAAAA,EAAkB;AAAA,EACpB,GAAG,CAACA,CAAe,CAAC,GAEdM,IAAiBpe,EAAY,YAAY;AAC7C,QAAI,CAACoW,KAAe,CAACwH,EAAqB;AAK1C,IAJ2B,MAAMA;AAAA,MAC/BH,EAAQ;AAAA,MACR/F,GAAkBtB,CAAW;AAAA,IAAA,MAG7B6H,EAAa,EAAK,GAClB7F,EAAe,MAAS,GACxB0F,KAAA,QAAAA,EAAkB;AAAA,EAEtB,GAAG,CAAC1H,GAAawH,GAAqBH,EAAQ,IAAIK,CAAe,CAAC,GAE5DO,IAAc7iB,EAAQ,MAAM;AAChC,UAAM8iB,IAAO,IAAI,KAAKb,EAAQ,IAAI,GAC5Bc,IAAeC;AAAA,MACnBF;AAAA,MACAjd,EAAiB,sBAAsB;AAAA,MACvCA,EAAiB,0BAA0B;AAAA,IAAA,GAEvCod,IAAOH,EAAK,mBAAmB,QAAW;AAAA,MAC9C,MAAM;AAAA,MACN,QAAQ;AAAA,IAAA,CACT;AACD,WAAOI,GAAwBrd,EAAiB,sBAAsB,GAAG;AAAA,MACvE,MAAMkd;AAAA,MACN,MAAAE;AAAA,IAAA,CACD;AAAA,EACH,GAAG,CAAChB,EAAQ,MAAMpc,CAAgB,CAAC,GAE7Bsd,IAAYnjB,EAAQ,MAAMiiB,EAAQ,MAAM,CAACA,EAAQ,IAAI,CAAC,GAGtDmB,IAAWpjB;AAAA,IACf,MACEiiB,EAAQ,KACL,MAAM,GAAG,EACT,IAAI,CAACoB,MAASA,EAAK,CAAC,CAAC,EACrB,KAAK,EAAE,EACP,cACA,MAAM,GAAG,CAAC;AAAA,IACf,CAACpB,EAAQ,IAAI;AAAA,EAAA,GAGTqB,IAAmBtjB,EAAQ,MAAMujB,GAAatB,EAAQ,QAAQ,GAAG,CAACA,EAAQ,QAAQ,CAAC,GAEnFuB,IAAkBxjB,EAAQ,MAAM;AACpC,QAAKmiB,KACAI;AAEL,aACE,gBAAA7lB,EAAA0N,IAAA,EACE,UAAA;AAAA,QAAA,gBAAA1N;AAAA,UAAC+kB;AAAA,UAAA;AAAA,YACC,SAAS,MAAM;AACb,cAAAgB,EAAa,EAAI,GACjB7F,EAAenB,GAAkBwG,EAAQ,QAAQ,CAAC,GAClDK,KAAA,QAAAA,EAAkB;AAAA,YACpB;AAAA,YAEA,UAAA;AAAA,cAAA,gBAAAhmB,EAACmnB,IAAA,EAAO,WAAU,wBAAA,CAAwB;AAAA,cACzC5d,EAAiB,uBAAuB;AAAA,YAAA;AAAA,UAAA;AAAA,QAAA;AAAA,QAE3C,gBAAAnJ;AAAA,UAAC+kB;AAAA,UAAA;AAAA,YACC,SAAS,YAAY;AACnB,cAAIY,KACF,MAAMA,EAAoBJ,EAAQ,EAAE;AAAA,YAExC;AAAA,YAEA,UAAA;AAAA,cAAA,gBAAA3lB,EAAConB,IAAA,EAAO,WAAU,wBAAA,CAAwB;AAAA,cACzC7d,EAAiB,yBAAyB;AAAA,YAAA;AAAA,UAAA;AAAA,QAAA;AAAA,MAC7C,GACF;AAAA,EAEJ,GAAG;AAAA,IACD0c;AAAA,IACAJ;AAAA,IACAtc;AAAA,IACAoc,EAAQ;AAAA,IACRA,EAAQ;AAAA,IACRI;AAAA,IACAC;AAAA,EAAA,CACD;AAED,SACE,gBAAA5lB;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWlB,EAAG,yEAAyE;AAAA,QACrF,cAAc0mB;AAAA,MAAA,CACf;AAAA,MAED,UAAA;AAAA,QAAA,gBAAA5lB,EAACikB,IAAA,EAAO,WAAU,iBAChB,UAAA,gBAAAjkB,EAACokB,MAAe,WAAU,6BAA6B,aAAS,EAAA,CAClE;AAAA,QACA,gBAAAhkB,EAAC,OAAA,EAAI,WAAU,0CACb,UAAA;AAAA,UAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,2EACb,UAAA;AAAA,YAAA,gBAAAJ,EAAC,KAAA,EAAE,WAAU,6BAA6B,UAAA6mB,GAAU;AAAA,YACpD,gBAAA7mB,EAAC,KAAA,EAAE,WAAU,sDAAsD,UAAAumB,GAAY;AAAA,YAC/E,gBAAAvmB,EAAC,OAAA,EAAI,WAAU,YAAA,CAAY;AAAA,YAC1B4lB,KAAWD,EAAQ,iBAAiB,4BAClCrC,IAAA,EAAM,SAAQ,aAAY,WAAU,6BAA4B,UAAA;AAAA,cAAA;AAAA,cAC5DrD,GAA2B0F,EAAQ,cAAcpc,CAAgB;AAAA,YAAA,EAAA,CACtE;AAAA,UAAA,GAEJ;AAAA,UACC2c,KACC,gBAAA9lB;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,MAAK;AAAA,cACL,UAAU;AAAA,cACV,WAAU;AAAA,cACV,KAAKgmB;AAAA,cACL,kBAAkB,CAAC5iB,MAAM;AACvB,gBAAIA,EAAE,QAAQ,YACZA,EAAE,eAAA,GACFA,EAAE,gBAAA,GACF6iB,EAAA,KACS7iB,EAAE,QAAQ,WAAWA,EAAE,aAChCA,EAAE,eAAA,GACFA,EAAE,gBAAA,GACE0b,GAAiBZ,CAAW,KAC9BgI,EAAA;AAAA,cAGN;AAAA,cACA,WAAW,CAAC9iB,MAAM;AAChB,gBAAAuc,GAA0Bvc,CAAC,IACvBA,EAAE,QAAQ,WAAWA,EAAE,QAAQ,QACjCA,EAAE,gBAAA;AAAA,cAEN;AAAA,cAEA,UAAA;AAAA,gBAAA,gBAAAxD;AAAA,kBAACqe;AAAA,kBAAA;AAAA,oBACC,WAAWnf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAMT;AAAA,oBAAA;AAAA,oBAEF,uBAAuBof;AAAA,oBACvB,oBAAoB,CAACtP,MAAUsR,EAAetR,CAAK;AAAA,kBAAA;AAAA,gBAAA;AAAA,gBAErD,gBAAA5O,EAAC,OAAA,EAAI,WAAU,8DACb,UAAA;AAAA,kBAAA,gBAAAJ;AAAA,oBAAC+D;AAAA,oBAAA;AAAA,sBACC,MAAK;AAAA,sBACL,SAASsiB;AAAA,sBACT,SAAQ;AAAA,sBACR,WAAU;AAAA,sBAEV,4BAAChmB,IAAA,CAAA,CAAE;AAAA,oBAAA;AAAA,kBAAA;AAAA,kBAEL,gBAAAL;AAAA,oBAAC+D;AAAA,oBAAA;AAAA,sBACC,MAAK;AAAA,sBACL,SAASuiB;AAAA,sBACT,WAAU;AAAA,sBACV,UAAU,CAACpH,GAAiBZ,CAAW;AAAA,sBAEvC,4BAAC+I,IAAA,CAAA,CAAQ;AAAA,oBAAA;AAAA,kBAAA;AAAA,gBACX,EAAA,CACF;AAAA,cAAA;AAAA,YAAA;AAAA,UAAA;AAAA,UAGH,CAACnB,KACA,gBAAA9lB,EAAA0N,IAAA,EACG,UAAA;AAAA,YAAA6X,EAAQ,WAAW,cAClB,gBAAA3lB,EAAC,OAAA,EAAI,WAAU,wBACZ,UAAAuJ,EAAiB,2BAA2B,EAAA,CAC/C;AAAA,YAEDoc,EAAQ,WAAW,UAAUC,KAC5B,gBAAA5lB,EAAC,SAAI,WAAU,wBACZ,UAAAuJ,EAAiB,uBAAuB,EAAA,CAC3C;AAAA,YAEF,gBAAAvJ;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,WAAWd;AAAA,kBACT;AAAA;AAAA,kBAEA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKA;AAAA;AAAA,kBAEA;AAAA,kBACA;AAAA,oBACE,mBAAmB,CAAC2mB;AAAA,kBAAA;AAAA,gBACtB;AAAA,gBAKF,yBAAyB,EAAE,QAAQmB,EAAA;AAAA,cAAiB;AAAA,YAAA;AAAA,UACtD,EAAA,CACF;AAAA,QAAA,GAEJ;AAAA,QACCE,uBACEpC,IAAA,EACC,UAAA;AAAA,UAAA,gBAAA9kB,EAACwkB,IAAA,EAAoB,SAAO,IAC1B,UAAA,gBAAAxkB,EAAC+D,GAAA,EAAO,SAAQ,SAAQ,MAAK,QAC3B,UAAA,gBAAA/D,EAACsnB,IAAA,CAAA,CAAe,EAAA,CAClB,GACF;AAAA,UACA,gBAAAtnB,EAACklB,IAAA,EAAoB,OAAM,OAAO,UAAAgC,EAAA,CAAgB;AAAA,QAAA,EAAA,CACpD;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAIR;ACtQA,MAAMlH,KAEF;AAAA,EACF,MAAM;AAAA,IACJ,UAAU;AAAA,MACR;AAAA,QACE,UAAU;AAAA,UACR;AAAA,YACE,QAAQ;AAAA,YACR,QAAQ;AAAA,YACR,MAAM;AAAA,YACN,OAAO;AAAA,YACP,MAAM;AAAA,YACN,MAAM;AAAA,YACN,SAAS;AAAA,UAAA;AAAA,QACX;AAAA,QAEF,WAAW;AAAA,QACX,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,SAAS;AAAA,QACT,YAAY;AAAA,QACZ,WAAW;AAAA,MAAA;AAAA,IACb;AAAA,IAEF,WAAW;AAAA,IACX,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,MAAM;AAAA,IACN,SAAS;AAAA,EAAA;AAEb;AAOO,SAASuH,GAAc;AAAA,EAC5B,uBAAAC;AAAA,EACA,UAAAC;AAAA,EACA,kBAAAle;AAAA,EACA,YAAAxG,IAAa;AAAA,EACb,UAAAwK;AAAA,EACA,cAAAma;AAAA,EACA,aAAAC;AAAA,EACA,oBAAAC;AAAA,EACA,UAAAC;AAAA,EACA,cAAAC;AAAA,EACA,0BAAAC;AAAA,EACA,qBAAAjC;AAAA,EACA,qBAAAC;AAAA,EACA,wBAAAiC;AAAA,EACA,iBAAA5H;AAAA,EACA,2BAAA6H;AAAA,EACA,6BAAAC;AAAA,EACA,8BAAAC;AAAA,EACA,oCAAAC;AAAA,EACA,QAAQC,IAAa;AAAA,EACrB,eAAAC,IAAgB;AAClB,GAAuB;AACrB,QAAM,CAAChK,GAAagC,CAAc,IAAI7a,EAAgCua,EAAY,GAC5EuI,IAAkBxlB,GAClB,CAACylB,GAAgBC,CAAiB,IAAIhjB,EAAkB,EAAK,GAC7D,CAACijB,GAAqBC,CAAsB,IAAIljB,EAAkB,EAAK,GACvE,CAACgb,GAAqBC,CAAsB,IAAIjb,EAAkB,EAAK,GACvE,CAACmjB,GAAqBC,CAAsB,IAAIpjB,EAA6B,MAAS,GACtF,CAACqjB,GAAWC,CAAY,IAAItjB,EAAkB,EAAK,GACnD,CAACujB,IAAYC,EAAa,IAAIxjB,EAAkB,EAAK,GACrD,CAACyjB,IAAQC,EAAS,IAAI1jB,EAAkB4iB,CAAU,GAClD,CAACe,IAAgBC,CAAiB,IAAI5jB,EAAkB,EAAK,GAC7D6jB,KAAmBjmB,EAAkD,MAAS,GAC9E,CAACkmB,IAA8BC,EAA+B,IAAI/jB,EAEtE,oBAAI,KAAK;AAGX,EAAAkW,EAAU,MAAM;AACd,QAAI8N,IAAmB;AAWvB,YAT+B,YAAY;AACzC,YAAMC,KAAgBvB,IAClB,MAAMA,EAA6BN,CAAQ,IAC3C;AAEJ,MAAK4B,KACLR,GAAcS,EAAa;AAAA,IAC7B,GAEA,GACO,MAAM;AACX,MAAAD,IAAmB;AAAA,IACrB;AAAA,EACF,GAAG,CAAC5B,GAAUM,CAA4B,CAAC,GAG3CxM,EAAU,MAAM;AACd,QAAI8N,IAAmB;AAEvB,QAAI,CAAC1mB,GAAY;AACf,MAAAgmB,EAAa,EAAK,GAClBS,GAAgC,oBAAI,KAAK;AACzC;AAAA,IACF;AAWA,YATyB,YAAY;AACnC,YAAMG,KAAezB,IACjB,MAAMA,EAA4BL,CAAQ,IAC1C;AAEJ,MAAK4B,KACLV,EAAaY,EAAY;AAAA,IAC3B,GAEA,GACO,MAAM;AACX,MAAAF,IAAmB;AAAA,IACrB;AAAA,EACF,GAAG,CAAC1mB,GAAY8kB,GAAUK,CAA2B,CAAC;AAEtD,QAAM0B,KAAiBlmB,EAAQ,MAAM+jB,EAAS,OAAO,CAAC9B,MAAY,CAACA,EAAQ,OAAO,GAAG,CAAC8B,CAAQ,CAAC;AAG/F,EAAA9L,EAAU,MAAM;AACd,QAAI8N,IAAmB;AAEvB,QAAI,CAAC1mB,KAAc,CAACqlB,GAAoC;AACtD,MAAAoB,GAAgC,oBAAI,KAAK;AACzC;AAAA,IACF;AAmBA,YAjBgC,YAAY;AAC1C,YAAMK,yBAAqB,IAAA;AAE3B,YAAM,QAAQ;AAAA,QACZD,GAAe,IAAI,OAAOjE,OAAY;AACpC,gBAAMmE,KAAU,MAAM1B,EAAmCzC,GAAQ,EAAE;AACnE,UAAI8D,KACFI,GAAe,IAAIlE,GAAQ,IAAImE,EAAO;AAAA,QAE1C,CAAC;AAAA,MAAA,GAGCL,KACFD,GAAgCK,EAAc;AAAA,IAElD,GAEA,GACO,MAAM;AACX,MAAAJ,IAAmB;AAAA,IACrB;AAAA,EACF,GAAG,CAAC1mB,GAAY6mB,IAAgBxB,CAAkC,CAAC;AAEnE,QAAM2B,KAAermB,EAAQ,MAAMkmB,GAAe,CAAC,GAAG,CAACA,EAAc,CAAC,GAIhEI,KAAe3mB,EAAoC,IAAI,GACvDsd,KAAiBtd,EAAiC,MAAS,GAE3D4mB,KAAc/hB,EAAY,MAAM;;AACpC,KAAAhG,IAAAye,GAAe,YAAf,QAAAze,EAAA,KAAAye,KACAL,EAAeN,EAAY;AAAA,EAC7B,GAAG,CAAA,CAAE,GAECkK,KAAahiB,EAAY,MAAM;AACnC,UAAMiiB,IAAY,CAACjB;AACnB,IAAAC,GAAUgB,CAAS,GAIjBd,EAHG,CAAAc,CAGoB,GAEzBnC,KAAA,QAAAA,EAAyBH,GAAUsC;AAAA,EACrC,GAAG,CAACjB,IAAQlB,GAAwBH,CAAQ,CAAC;AAE7C,EAAAlM,EAAU,MAAM;AACd,IAAA8M,EAAkB,EAAK;AAAA,EACzB,GAAG,CAAC1lB,CAAU,CAAC,GAEf4Y,EAAU,MAA2B;AACnC,QAAI5Y,KAAc,CAACmmB,MAAU,CAACE,IAAgB;AAC5C,YAAMgB,IAAQ,WAAW,MAAM;AAC7B,QAAAjB,GAAU,EAAI,GACdnB,KAAA,QAAAA,EAAyBH,GAAU;AAAA,MACrC,GAAGS,IAAgB,GAAI;AACvB,aAAAgB,GAAiB,UAAUc,GACpB,MAAM,aAAaA,CAAK;AAAA,IACjC;AACA,IAAId,GAAiB,YACnB,aAAaA,GAAiB,OAAO,GACrCA,GAAiB,UAAU;AAAA,EAE/B,GAAG,CAACvmB,GAAYmmB,IAAQE,IAAgBd,GAAeT,GAAUG,CAAsB,CAAC;AAExF,QAAMqC,KAAmB3mB;AAAA,IACvB,OAAO;AAAA,MACL,aAAa6F,EAAiB,+BAA+B;AAAA,MAC7D,iBAAiBA,EAAiB,mCAAmC;AAAA,IAAA;AAAA,IAEvE,CAACA,CAAgB;AAAA,EAAA,GAGb+gB,KAA0B5mB,EAAQ,MAAM;AAC5C,QAAIgkB,MAAiB;AACnB;AAEF,QAAIA,MAAiB;AACnB,aAAOne,EAAiB,6BAA6B,KAAK;AAE5D,UAAMghB,IAActK,GAA2ByH,GAAcne,CAAgB;AAC7E,WAAOqd,GAAwBrd,EAAiB,uBAAuB,GAAG;AAAA,MACxE,cAAcghB;AAAA,IAAA,CACf;AAAA,EACH,GAAG,CAAC7C,GAAcne,CAAgB,CAAC,GAE7BihB,IAAU9mB,EAAQ,MAAMkmB,GAAe,MAAM,CAAC,GAAG,CAACA,EAAc,CAAC,GACjEa,IAAa/mB,EAAQ,MAAM8mB,EAAQ,UAAU,GAAG,CAACA,EAAQ,MAAM,CAAC,GAChEE,KAAahnB,EAAQ,MAAM+mB,IAAa,GAAG,CAACA,CAAU,CAAC,GAGvDE,KAAiBjnB,EAAQ,MACzB8kB,KAAkBiC,KAAc,IAC3BD,IAGFA,EAAQ,MAAM,EAAE,GACtB,CAACA,GAASC,GAAYjC,CAAc,CAAC,GAElCoC,KAAmBlnB,EAAQ,MAC3B8kB,KAAkBiC,KAAc,IAC3B,IAEFA,IAAa,GACnB,CAACA,GAAYjC,CAAc,CAAC,GAEzBqC,KAAYnnB;AAAA,IAChB,MACE+mB,MAAe,IACXJ,GAAiB,cACjBzD,GAAwByD,GAAiB,iBAAiB,EAAE,OAAOI,GAAY;AAAA,IACrF,CAACA,GAAYJ,EAAgB;AAAA,EAAA,GAGzBS,KAAkBpnB;AAAA,IACtB,MACEknB,OAAqB,IACjBP,GAAiB,cACjBzD,GAAwByD,GAAiB,iBAAiB,EAAE,OAAOO,IAAkB;AAAA,IAC3F,CAACA,IAAkBP,EAAgB;AAAA,EAAA,GAG/BU,KAAsB7iB,EAAY,YAAY;AAClD,UAAM8Y,IAAW9B,GAAiBZ,CAAW,IAAIsB,GAAkBtB,CAAW,IAAI;AAGlF,QAAIsK,MAAwB,QAAW;AAMrC,MALgB,MAAMb,EAAyB;AAAA,QAC7C,UAAAF;AAAA,QACA,UAAA7G;AAAA,QACA,cAAc4H;AAAA,MAAA,CACf,MAECC,EAAuB,MAAS,GAC5B7H,KACFiJ,GAAA;AAGJ;AAAA,IACF;AAEA,IAAIjJ,KACmB,MAAM+G,EAAyB,EAAE,UAAAF,GAAU,UAAA7G,GAAU,KAExEiJ,GAAA;AAAA,EAGN,GAAG,CAACA,IAAa3L,GAAayJ,GAA0Ba,GAAqBf,CAAQ,CAAC,GAEhFmD,KAAuC9iB;AAAA,IAC3C,OAAO2G,MAAuC;AAC5C,YAAMmS,KAAW9B,GAAiBZ,CAAW,IAAIsB,GAAkBtB,CAAW,IAAI,QAC5E2M,KAAU,MAAMlD,EAAyB;AAAA,QAC7C,GAAGlZ;AAAA,QACH,UAAAmS;AAAA,QACA,cAAc4H,KAAuB/Z,EAAQ;AAAA,MAAA,CAC9C;AACD,aAAIoc,MAAWjK,MACbiJ,GAAA,GAEEgB,MAAWrC,MAAwB,UACrCC,EAAuB,MAAS,GAE3BoC;AAAA,IACT;AAAA,IACA,CAAChB,IAAa3L,GAAayJ,GAA0Ba,CAAmB;AAAA,EAAA;AAG1E,SACE,gBAAA5oB;AAAA,IAACujB;AAAA,IAAA;AAAA,MACC,MAAK;AAAA,MACL,iBAAexgB;AAAA,MACf,IAAI8kB;AAAA,MACJ,WAAW3oB;AAAA,QACT;AAAA,QACA,EAAE,wCAAwC,CAAC6D,EAAA;AAAA,QAC3C;AAAA,UACE,4BAA4B,CAACA,KAAc+kB,MAAiB,cAAcoB;AAAA,UAC1E,oBAAoBnmB,KAAc+kB,MAAiB,cAAcoB;AAAA,UACjE,eAAepB,MAAiB;AAAA,UAChC,iBAAiB,CAACoB,MAAU,CAACnmB,KAAc+kB,MAAiB;AAAA,QAAA;AAAA,MAC9D;AAAA,MAEF,SAAS,MAAM;AACb,QAAAF,EAAmBC,CAAQ;AAAA,MAC7B;AAAA,MACA,UAAU;AAAA,MAEV,UAAA,gBAAAznB,EAACujB,IAAA,EAAY,WAAU,uCACrB,UAAA;AAAA,QAAA,gBAAAvjB,EAAC,OAAA,EAAI,WAAU,iEACb,UAAA;AAAA,UAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,oCACZ,UAAA;AAAA,YAAAkqB,MACC,gBAAAtqB,EAACsjB,IAAA,EAAM,WAAU,yFACd,UAAAgH,IACH;AAAA,YAEF,gBAAAtqB;AAAA,cAAC+D;AAAA,cAAA;AAAA,gBACC,SAAQ;AAAA,gBACR,MAAK;AAAA,gBACL,SAAS,CAACP,MAAM;AACd,kBAAAA,EAAE,gBAAA,GACF0mB,GAAA;AAAA,gBACF;AAAA,gBACA,WAAU;AAAA,gBACV,cAAYhB,KAAS,mBAAmB;AAAA,gBAEvC,UAAAA,KAAS,gBAAAlpB,EAACkrB,IAAA,CAAA,CAAS,sBAAMC,IAAA,CAAA,CAAK;AAAA,cAAA;AAAA,YAAA;AAAA,YAEhCnC,MAAclB,MAAiB,cAC9B,gBAAA9nB;AAAA,cAAC+D;AAAA,cAAA;AAAA,gBACC,SAAQ;AAAA,gBACR,MAAK;AAAA,gBACL,WAAW7E;AAAA,kBACT;AAAA,kBACA;AAAA,kBACA;AAAA,gBAAA;AAAA,gBAEF,SAAS,CAACsE,MAAM;AACd,kBAAAA,EAAE,gBAAA,GACFwnB,GAAqC;AAAA,oBACnC,UAAAnD;AAAA,oBACA,QAAQ;AAAA,kBAAA,CACT;AAAA,gBACH;AAAA,gBACA,cAAW;AAAA,gBAEX,UAAA,gBAAA7nB,EAAC4D,IAAA,EAAM,WAAU,gBAAA,CAAgB;AAAA,cAAA;AAAA,YAAA;AAAA,UACnC,GAEJ;AAAA,UACA,gBAAA5D,EAAC,OAAA,EAAI,WAAU,iEAGb,UAAA,gBAAAI;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,KAAK4pB;AAAA,cACL,WAAW9qB;AAAA,gBACT;AAAA,gBACA;AAAA,kBACE,wEACEqpB;AAAA,gBAAA;AAAA,gBAEJ,EAAE,wBAAwB,CAACA,EAAA;AAAA,cAAgB;AAAA,cAG5C,UAAA;AAAA,gBAAAhb;AAAA,gBACD,gBAAAnN,EAAC,QAAA,EAAK,WAAWonB,GACd,UAAA;AAAA,kBAAAuC,GAAa;AAAA,kBACd,gBAAA/pB,EAAC,QAAA,EAAK,WAAU,gBAAgB,aAAa,cAAa;AAAA,kBACzD+pB,GAAa;AAAA,gBAAA,EAAA,CAChB;AAAA,cAAA;AAAA,YAAA;AAAA,UAAA,GAEJ;AAAA,UACA,gBAAA/pB;AAAA,YAAC0lB;AAAA,YAAA;AAAA,cACC,SAASqE;AAAA,cACT,kBAAAxgB;AAAA,cACA,kBAAkBxG;AAAA,cAClB,cAAA+kB;AAAA,cACA,0BAA0BkD;AAAA,cAC1B,qBAAAlF;AAAA,cACA,qBAAAC;AAAA,cACA,iBAAiB4C;AAAA,cACjB,iBAAiBY,GAA6B,IAAIQ,GAAa,EAAE,KAAK;AAAA,cACtE,sBAAsBf;AAAA,YAAA;AAAA,UAAA;AAAA,QACxB,GACF;AAAA,QACA,gBAAA5oB,EAAA0N,IAAA,EACG,UAAA;AAAA,UAAA4c,MAAc,CAAC3nB,KACd,gBAAA3C,EAAC,OAAA,EAAI,WAAU,oCACb,UAAA;AAAA,YAAA,gBAAAJ,EAAC,OAAA,EAAI,WAAU,UACb,UAAA,gBAAAA,EAAC6jB,MAAU,GACb;AAAA,YACA,gBAAA7jB,EAAC,KAAA,EAAE,WAAU,uCAAuC,UAAA6qB,GAAA,CAAU;AAAA,UAAA,GAChE;AAAA,UAGD,CAAC9nB,KAAcmc,GAAiBZ,CAAW,KAC1C,gBAAAte;AAAA,YAACqe;AAAA,YAAA;AAAA,cACC,uBAAuBC;AAAA,cACvB,oBAAoB,CAACtP,MAAUsR,EAAetR,CAAK;AAAA,cACnD,aAAazF,EAAiB,yBAAyB;AAAA,YAAA;AAAA,UAAA;AAAA,UAG1DxG,KACC,gBAAA3C,EAAA0N,IAAA,EAEG,UAAA;AAAA,YAAA8c,KAAmB,KAClB,gBAAAxqB;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,WAAU;AAAA,gBACV,SAAS,CAACoD,MAAM;AACd,kBAAAA,EAAE,gBAAA,GACFilB,EAAkB,EAAI;AAAA,gBACxB;AAAA,gBACA,MAAK;AAAA,gBACL,UAAU;AAAA,gBACV,WAAW,CAACjlB,MAAM;AAChB,mBAAIA,EAAE,QAAQ,WAAWA,EAAE,QAAQ,SACjCA,EAAE,eAAA,GACFA,EAAE,gBAAA,GACFilB,EAAkB,EAAI;AAAA,gBAE1B;AAAA,gBAEA,UAAA;AAAA,kBAAA,gBAAAzoB,EAAC,OAAA,EAAI,WAAU,UACb,UAAA,gBAAAA,EAAC6jB,MAAU,GACb;AAAA,kBACA,gBAAAzjB,EAAC,OAAA,EAAI,WAAU,oCACb,UAAA;AAAA,oBAAA,gBAAAJ,EAAC,KAAA,EAAE,WAAU,uCAAuC,UAAA8qB,IAAgB;AAAA,oBACnEtC,IAAiB,gBAAAxoB,EAACorB,IAAA,CAAA,CAAU,sBAAMjb,IAAA,CAAA,CAAY;AAAA,kBAAA,EAAA,CACjD;AAAA,gBAAA;AAAA,cAAA;AAAA,YAAA;AAAA,YAGHwa,GAAe,IAAI,CAACU,wBAClB,OAAA,EACC,UAAA,gBAAArrB;AAAA,cAAC0lB;AAAA,cAAA;AAAA,gBACC,SAAS2F;AAAA,gBACT,kBAAA9hB;AAAA,gBACA,SAAO;AAAA,gBACP,kBAAkBxG;AAAA,gBAClB,qBAAA+iB;AAAA,gBACA,qBAAAC;AAAA,gBACA,iBAAiB4C;AAAA,gBACjB,iBAAiBY,GAA6B,IAAI8B,EAAM,EAAE,KAAK;AAAA,cAAA;AAAA,YAAA,KATzDA,EAAM,EAWhB,CACD;AAAA,YAGApD,MAA8B,OAC5B,CAACS,KAAuBxJ,GAAiBZ,CAAW,MACnD,gBAAAle;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,MAAK;AAAA,gBACL,UAAU;AAAA,gBACV,WAAU;AAAA,gBACV,SAAS,CAACoD,MAAMA,EAAE,gBAAA;AAAA,gBAClB,kBAAkB,CAACA,MAAM;AACvB,kBAAIA,EAAE,QAAQ,WAAWA,EAAE,aACzBA,EAAE,eAAA,GACFA,EAAE,gBAAA,IACE0b,GAAiBZ,CAAW,KAAKsK,MAAwB,WAC3DmC,GAAA;AAAA,gBAGN;AAAA,gBACA,WAAW,CAACvnB,MAAM;AAChB,kBAAAuc,GAA0Bvc,CAAC,IACvBA,EAAE,QAAQ,WAAWA,EAAE,QAAQ,QACjCA,EAAE,gBAAA;AAAA,gBAEN;AAAA,gBAEA,UAAA;AAAA,kBAAA,gBAAAxD;AAAA,oBAACqe;AAAA,oBAAA;AAAA,sBACC,uBAAuBC;AAAA,sBACvB,oBAAoB,CAACtP,MAAUsR,EAAetR,CAAK;AAAA,sBACnD,aACE8Y,MAAiB,aACbve,EAAiB,0BAA0B,IAC3CA,EAAiB,yBAAyB;AAAA,sBAEhD,WAAS;AAAA,sBACT,SAAS,CAAC8X,MAAY;AACpB,wBAAAV,GAAe,UAAUU;AAAA,sBAC3B;AAAA,oBAAA;AAAA,kBAAA;AAAA,kBAEF,gBAAAjhB,EAAC,OAAA,EAAI,WAAU,+DACZ,UAAA;AAAA,oBAAAwoB,MAAwB,UACvB,gBAAA5oB,EAAC,QAAA,EAAK,WAAU,iDACb,UAAA4mB;AAAA,sBACCrd,EAAiB,wBAAwB,KACvC;AAAA,sBACF;AAAA,wBACE,cAAc0W;AAAA,0BACZ2I;AAAA,0BACArf;AAAA,wBAAA;AAAA,sBACF;AAAA,oBACF,GAEJ;AAAA,oBAEF,gBAAAnJ,EAACgE,IAAA,EAAQ,MAAMqc,GAAqB,cAAcC,GAChD,UAAA;AAAA,sBAAA,gBAAA1gB,EAACsE,IAAA,EAAe,SAAO,IACrB,UAAA,gBAAAtE;AAAA,wBAAC+D;AAAA,wBAAA;AAAA,0BACC,MAAK;AAAA,0BACL,SAAQ;AAAA,0BACR,WAAU;AAAA,0BACV,UACE,CAAC+kB,KACD,CAAC1I,KACDA,EAAgB,WAAW,KAC3B,CAACA,EAAgB,SAASuH,CAAW;AAAA,0BAEvC,cAAW;AAAA,0BAEX,4BAACvG,IAAA,CAAA,CAAO;AAAA,wBAAA;AAAA,sBAAA,GAEZ;AAAA,sBACA,gBAAAphB;AAAA,wBAACwE;AAAA,wBAAA;AAAA,0BACC,WAAU;AAAA,0BACV,OAAM;AAAA,0BACN,WAAW,CAAChB,MAAM;AAChB,4BAAIA,EAAE,QAAQ,aACZA,EAAE,gBAAA,GACFkd,EAAuB,EAAK;AAAA,0BAEhC;AAAA,0BAEA,4BAACjgB,IAAA,EACC,UAAA,gBAAAT,EAACa,MACE,UAAAuf,KAAA,gBAAAA,EAAiB,IAAI,CAACF,MACrB,gBAAAlgB;AAAA,4BAACiB;AAAA,4BAAA;AAAA,8BAEC,UAAU,MAAM;AACd,gCACE4nB,EADE3I,MAASwH,IACYxH,IAEA,MAFI,GAI7BQ,EAAuB,EAAK;AAAA,8BAC9B;AAAA,8BACA,WAAU;AAAA,8BAEV,UAAA,gBAAA1gB,EAAC,QAAA,EAAM,UAAAigB,GAA2BC,GAAM3W,CAAgB,EAAA,CAAE;AAAA,4BAAA;AAAA,4BAXrD2W,KAAQ;AAAA,0BAAA,IAcnB,EAAA,CACF;AAAA,wBAAA;AAAA,sBAAA;AAAA,oBACF,GACF;AAAA,oBACA,gBAAAlgB;AAAA,sBAAC+D;AAAA,sBAAA;AAAA,wBACC,MAAK;AAAA,wBACL,SAASgnB;AAAA,wBACT,WAAU;AAAA,wBACV,UACE,CAAC7L,GAAiBZ,CAAW,KAAKsK,MAAwB;AAAA,wBAE5D,cAAW;AAAA,wBAEX,4BAACvB,IAAA,CAAA,CAAQ;AAAA,sBAAA;AAAA,oBAAA;AAAA,kBACX,EAAA,CACF;AAAA,gBAAA;AAAA,cAAA;AAAA,YAAA;AAAA,UACF,EAAA,CAEN;AAAA,QAAA,EAAA,CAEJ;AAAA,MAAA,EAAA,CACF;AAAA,IAAA;AAAA,EAAA;AAGN;ACllBA,SAAwBiE,GAAY;AAAA,EAClC,WAAAzrB,IAAY;AAAA,EACZ,uBAAA2nB;AAAA,EACA,SAAA+D;AAAA,EACA,aAAA5D;AAAA,EACA,kBAAApe;AAAA,EACA,0BAAAwe;AAAA,EACA,qBAAAjC;AAAA,EACA,qBAAAC;AAAA,EACA,wBAAAiC;AAAA,EACA,iBAAA5H;AAAA,EACA,2BAAA6H;AAAA,EACA,6BAAAC;AAAA,EACA,8BAAAC;AAAA,EACA,oCAAAC;AAAA,EACA,kBAAkBoD;AAAA,EAClB,wBAAAC;AACF,GAAqB;AACnB,QAAM,CAACC,GAAmBC,CAAoB,IAAIlmB,EAAsB,oBAAI,KAAK,GAC3E,CAACmmB,GAAwBC,CAAyB,IAAIpmB,EAAA;AAG5D,EAAAkW,EAAU,MAAM;AACd,IAAI6P,MACFG,EAAqB,CAACrO,MAAS,IAAI,IAAIA,CAAI,EAAE,IAAIkO,CAAwB,CAAC,GAC1EK,EAA0BL,CAAwB;AAAA,EAEtD,GAAG,CAACA,CAAwB,CAAC;AAE7B,QAAMM,IAAgBP,EAAQ;AAAA,IAAO,CAACQ,MACpCA,EAAO,SAAS,KAAK,CAACpG,MAAY,CAACA,EAAQ,OAAO;AAAA,EAAA,GAG9C9W,IAA2Bid,EAAc,IAAI,CAACC,OAAY;AAAA,IAC9D,IAAIA,EAAO;AAAA,EAAA,EACX,GAEIC,IAA6B9jB;AAAA,IACjC,CAACyG,MAA0B;AACzB,MAAAgd,EAAqB,CAACrO,MAAS,IAAI,IAAIA,CAAI,EAAE,IAAI3O,EAAO,EAAE,CAAC,GAC3Dkd,EAA0Bld,EAAO,EAAE,GACnC8c,KAAA,QAAAA,EAAyB9c,EAAO;AAAA,IAClC;AAAA,IACA,CAAC8c,CAAsB;AAAA,EAAA,GAGnB7D,IAAqB1f;AAAA,IACzB,CAAC2f,MAAqB;AACpB,YAAMoE,IAAeP,EAAkB,IAAI7D,CAAQ;AACnD,MAAA8D,EAAqB,CAACrO,MAAS;AAC7B,cAAM4O,IAAO,IAAI,IAAI5O,CAAI;AACzB,eAAI4O,EAAK,IAAIrE,CAAQ,IACnBqE,EAAK,OAAOrE,CAAQ,IAEpBqE,EAAK,IAAIrE,CAAQ,GAEZqE;AAAA,MACT,CAAC,GACDL,EAA0BhE,CAAQ,GAClC4D,KAAA,QAAAA,EAAyBQ,IAAe,SAAYpE;AAAA,IACtD;AAAA,IACA,CAAC6D,GAAmBD,CAAsB;AAAA,EAAA,GAGtC,EAAE,YAAA3J,GAAY,UAAAC,GAAU,eAAAW,EAAA,IAAkBhB,GAAW;AAAA,IACzD,SAAA7S;AAAA,IACA,gBAAgBmd;AAAA,EAAA,CACjB,GAGKG,IAA0BjkB;AAAA,IAC9B,CAACiE,MAA+C;AAC9C,MAAIA,EAAM,QAAQ,YACZyf,KAA0BF,EAAkB,IAAIE,CAAsB,MACxED,EAAqB,CAACrO,MAAS;AAC7B,cAAM4O,IAAO,IAAI,IAAI5O,CAAI;AACzB,eAAA4O,EAAK,OAAON,CAAsB,GAC3BM;AAAA,MACT,CAAC,GACDL,EAA0B,MAAS,GACnCJ,KAAA,QAAAA,EAAyB,UAE3Btf,EAAM,eAAA,GACNA,EAAM,gBAAA,KAENuW,EAAcvW,CAAK;AAAA,IAEvB;AAAA,IACA,CAACyf,GAAwBF,GAAmBhJ,GAAe+I,CAAsB;AAAA,EAAA;AAGnF,SACE,gBAAAzrB;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,IAAG;AAAA,MACH,MAAK;AAAA,MACL,UAAU;AAAA,MAGV,KAAK8hB;AAAA,MACL,yBAAuBC,KAAY;AAAA,MACnC,cAAW;AAAA,MACX,WAAW7iB;AAAA,QACT;AAAA,QAEAW;AAAA,MAAA;AAAA,MAEF,WAAWssB;AAAA,MAEV,UAAAL,EAAc,IAAI,CAACC,MAClB,gBAAA/rB;AAAA,QAAC;AAAA,QAAA;AAAA,UAEC,IAAI+rB,EAAO;AAAA,UACX,WAAW7sB,EAAG;AAAA,YACZ,iBAAiB6sB,EAAO,WAAW;AAAA,UAAA,CACpC;AAAA,UAED,UAAA,gBAAA/rB;AAAA,YAACunB;AAAA,YAAA;AAAA,cACC,uBAAAC;AAAA,cACA,UAAUuE,EAAO;AAAA,cACjB,kBAAAxiB;AAAA,cACA,UAAUwiB,EAAO;AAAA,cACjB,oBAAAnE;AAAA,cACA,UAAUmE,EAAO;AAAA,cACjB,QAAQA,EAAO;AAAA,cACf,YAAYL,EAAkB,IAAIK,EAAO,EAAE;AAAA,cAC3C,aAAApE;AAAA,cACA,cAAcoE,EAAO;AAAA,cACrB,cAAcA,EAAO;AAAA,cACrB,0BAAAhE;AAAA,cACA,qBAAAjC;AAAA,cACA,qBAAAC;AAAA,cACA,wBAAAiC;AAAA,cACA,iBAAA5H;AAAA,cACA,2BAAA6H;AAAA,cACA,6BAAAC;AAAA,cACA,8BAAAC;AAAA,cACA,oCAAAC;AAAA,YAAA;AAAA,UAAA;AAAA,QACF;AAAA,QA3BK2D,EAAO;AAAA,MAAA,CA6Bf;AAAA,IAAA;AAAA,EAAA;AAGP;ACxIO,SAASK,GAA4B,EAAE,OAAAC,KAA2C;AACvF,2BACGvH,IAAA,EACC,UAAA;AAAA,IAAA,gBAAA9kB,EAACwkB,IAAA,EAAoB,SAAO,IAC1B,UAAA,gBAAApkB,EAAC2D,GAAA,EAAO,SAAQ,WAAU,MAAK,MAAK,WAAU,0CAC5C,UAAA;AAAA,MAAA,gBAAA/D,EAACssB,IAAA,EAAW,WAAU,wBAAA,CAAwB;AAAA,MAAE;AAAA,IAAA,EAAA,CAElD,EAAA,CACF;AAAA,IACA,gBAAAlsB,EAAC8kB,IAAA,EAAoB,OAAM,OAAM,WAAU,gBACzC,UAAA;AAAA,MAAA,gBAAAllB,EAACulB,MAAkB,UAAA,iBAAA,CAAc;AAAA,wBAChCC,IAAA,EAAsB;AAAA,MACtB6G,EACE,cAAA,EACA,OAAO,CAACE,MAAWA,EAAO,YAAY,EACtC,IAAI,CAACA,MAEF,gBAAAvsB;AAAA,QAAColB;AAAA,QAAA;AAAA,UAEC,WAAU;AAAA,UACV,SAASmH,EAAO,aAAA;AAAA,UAChB,iBAAiB,CAACvd,MAAUud,EAAO,iBAAiB,CAAC,CAACvd,CAAK;AAAA,UAE1D,UAAAud,EAAO;AAAA,QAAA;AAAA,QALHA,EAAO;AAAA,MAAA,CAQjB;AAAA,IAAA,EAAA,CACL;AAAA,EAAA,GACF;AAEJ;ACrBA,MAAMC,KAASC,GAAgB,MAGzBC,KAAcD,GAAgB,OAG9BE,KAAcF,GAAgB,OAOvBG,KAAwB9oB;AAAA,EACnC;AAAA,EACA;AAAA,IACE,UAAU;AAAA,MACR,MAAM;AAAA,QACJ,SAAS;AAAA,QACT,IAAI;AAAA,QACJ,IAAI;AAAA,QACJ,MAAM;AAAA,MAAA;AAAA,IACR;AAAA,IAEF,iBAAiB;AAAA,MACf,MAAM;AAAA,IAAA;AAAA,EACR;AAEJ,GAGM+oB,KAAgBjtB,EAAM,WAG1B,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,MAAA+D,GAAM,GAAGnE,EAAA,GAASC,MAAQ;AAClD,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAc;AAAA,IAACqsB,GAAgB;AAAA,IAAhB;AAAA,MACC,WAAWvtB,EAAG0tB,GAAsB,EAAE,MAAA3oB,GAAM,WAAApE,EAAA,CAAW,CAAC;AAAA,MACxD,KAAAE;AAAA,MACC,GAAGD;AAAA,MACJ,KAAAK;AAAA,MAEC,UAAA;AAAA,QAAAD;AAAA,QACD,gBAAAF,EAACysB,GAAgB,MAAhB,EAAqB,SAAO,IAC3B,UAAA,gBAAAzsB,EAACmQ,IAAA,EAAY,WAAU,8BAAA,CAA8B,EAAA,CACvD;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGN,CAAC;AACD0c,GAAc,cAAcJ,GAAgB,QAAQ;AAGpD,MAAMK,KAAuBltB,EAAM,WAGjC,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACysB,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAA1sB;AAAA,IACA,WAAWb,EAAG,uEAAuEW,CAAS;AAAA,IAC7F,GAAGC;AAAA,IAEJ,UAAA,gBAAAE,EAACorB,IAAA,EAAU,WAAU,gBAAA,CAAgB;AAAA,EAAA;AACvC,CACD;AACD0B,GAAqB,cAAcL,GAAgB,eAAe;AAGlE,MAAMM,KAAyBntB,EAAM,WAGnC,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACysB,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAA1sB;AAAA,IACA,WAAWb,EAAG,uEAAuEW,CAAS;AAAA,IAC7F,GAAGC;AAAA,IAEJ,UAAA,gBAAAE,EAACmQ,IAAA,EAAY,WAAU,gBAAA,CAAgB;AAAA,EAAA;AACzC,CACD;AACD4c,GAAuB,cAAcN,GAAgB,iBAAiB;AAGtE,MAAMO,KAAgBptB,EAAM,WAG1B,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,UAAA+sB,IAAW,UAAU,GAAGntB,EAAA,GAASC,MAAQ;AACjE,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAU,EAACysB,GAAgB,QAAhB,EACC,UAAA,gBAAArsB;AAAA,IAACqsB,GAAgB;AAAA,IAAhB;AAAA,MACC,KAAA1sB;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACA+tB,MAAa,YACX;AAAA,QACFptB;AAAA,MAAA;AAAA,MAEF,UAAAotB;AAAA,MACC,GAAGntB;AAAA,MAEJ,UAAA;AAAA,QAAA,gBAAAE,EAAC8sB,IAAA,EAAqB;AAAA,QACtB,gBAAA9sB;AAAA,UAACysB,GAAgB;AAAA,UAAhB;AAAA,YACC,WAAWvtB;AAAA,cACT;AAAA,cACA+tB,MAAa,YACX;AAAA,YAAA;AAAA,YAGJ,UAAA,gBAAAjtB,EAAC,OAAA,EAAI,KAAAG,GAAW,UAAAD,EAAA,CAAS;AAAA,UAAA;AAAA,QAAA;AAAA,0BAE1B6sB,IAAA,CAAA,CAAuB;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA,GAE5B;AAEJ,CAAC;AACDC,GAAc,cAAcP,GAAgB,QAAQ;AAGpD,MAAMS,KAActtB,EAAM,WAGxB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACysB,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAA1sB;AAAA,IACA,WAAWb,EAAG,yDAAyDW,CAAS;AAAA,IAC/E,GAAGC;AAAA,EAAA;AACN,CACD;AACDotB,GAAY,cAAcT,GAAgB,MAAM;AAGhD,MAAMU,KAAavtB,EAAM,WAGvB,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,GAAGJ,KAASC,MACpC,gBAAAK;AAAA,EAACqsB,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAA1sB;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,IAEJ,UAAA;AAAA,MAAA,gBAAAE,EAAC,QAAA,EAAK,WAAU,sFACd,UAAA,gBAAAA,EAACysB,GAAgB,eAAhB,EACC,UAAA,gBAAAzsB,EAAC4D,IAAA,EAAM,WAAU,gBAAA,CAAgB,EAAA,CACnC,GACF;AAAA,MAEA,gBAAA5D,EAACysB,GAAgB,UAAhB,EAA0B,UAAAvsB,EAAA,CAAS;AAAA,IAAA;AAAA,EAAA;AACtC,CACD;AACDitB,GAAW,cAAcV,GAAgB,KAAK;AAG9C,MAAMW,KAAkBxtB,EAAM,WAG5B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACysB,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAA1sB;AAAA,IACA,WAAWb,EAAG,wCAAwCW,CAAS;AAAA,IAC9D,GAAGC;AAAA,EAAA;AACN,CACD;AACDstB,GAAgB,cAAcX,GAAgB,UAAU;AChLjD,SAASY,GAA2B,EAAE,OAAAhB,KAA0C;AACrF,2BACG,OAAA,EAAI,WAAU,sEACb,UAAA,gBAAAjsB,EAAC,OAAA,EAAI,WAAU,wDACb,UAAA;AAAA,IAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,iDACZ,UAAA;AAAA,MAAAisB,EAAM,8BAA8B,KAAK;AAAA,MAAO;AAAA,MAAI;AAAA,MACpDA,EAAM,sBAAsB,KAAK;AAAA,MAAO;AAAA,IAAA,GAC3C;AAAA,IACA,gBAAAjsB,EAAC,OAAA,EAAI,WAAU,wCACb,UAAA;AAAA,MAAA,gBAAAJ,EAAC,KAAA,EAAE,WAAU,4CAA2C,UAAA,iBAAa;AAAA,MACrE,gBAAAI;AAAA,QAACosB;AAAA,QAAA;AAAA,UACC,OAAO,GAAGH,EAAM,SAAA,EAAW,WAAW,QAAQ;AAAA,UAC9C,eAAe,CAACrd,MAAU;AACxB,YAAAqd,EAAM,YAAY,OAAOrd,CAAK,CAAC;AAAA,UACjC;AAAA,UAEA,UAAA;AAAA,YAAA,gBAAAhP,EAAC6sB,IAAA,EAAc,WAAU,sBACvB,UAAA,gBAAA7sB,EAAC2sB,IAAA,EAAY,aAAaN,EAAM,SAAA,EAAW,WAAW,SAAA,CAAU,GAClE;AAAA,YACA,gBAAArsB,EAACgtB,MAAc,MAAK,OACjB,WAAC,IAAI,IAAI,IAAI,IAAI,EAAE,EAAE,IAAI,CAACM,MACzB,gBAAAttB,EAACmtB,IAAA,EAA0B,OAAO,GAAGG,CAAQ,IAC1C,UAAAA,KADcA,CAEjB,CACD,EAAA,CACH;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,IACF,GACF;AAAA,IACA,gBAAAltB,EAAC,OAAA,EAAI,WAAU,oFAAmF,UAAA;AAAA,MAAA;AAAA,MAC1FisB,EAAM,SAAA,EAAW,WAAW,YAAY;AAAA,MAAE;AAAA,MAAKA,EAAM,aAAA;AAAA,IAAa,GAC1E;AAAA,IACA,gBAAAjsB,EAAC,OAAA,EAAI,WAAU,wCACb,UAAA;AAAA,MAAA,gBAAAA;AAAA,QAAC2D;AAAA,QAAA;AAAA,UACC,SAAQ;AAAA,UACR,MAAK;AAAA,UACL,WAAU;AAAA,UACV,SAAS,MAAMsoB,EAAM,aAAa,CAAC;AAAA,UACnC,UAAU,CAACA,EAAM,mBAAA;AAAA,UAEjB,UAAA;AAAA,YAAA,gBAAArsB,EAAC,QAAA,EAAK,WAAU,cAAa,UAAA,oBAAgB;AAAA,YAC7C,gBAAAA,EAACutB,IAAA,EAAc,WAAU,gBAAA,CAAgB;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,MAE3C,gBAAAntB;AAAA,QAAC2D;AAAA,QAAA;AAAA,UACC,SAAQ;AAAA,UACR,MAAK;AAAA,UACL,WAAU;AAAA,UACV,SAAS,MAAMsoB,EAAM,aAAA;AAAA,UACrB,UAAU,CAACA,EAAM,mBAAA;AAAA,UAEjB,UAAA;AAAA,YAAA,gBAAArsB,EAAC,QAAA,EAAK,WAAU,cAAa,UAAA,uBAAmB;AAAA,YAChD,gBAAAA,EAACwtB,IAAA,EAAgB,WAAU,gBAAA,CAAgB;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,MAE7C,gBAAAptB;AAAA,QAAC2D;AAAA,QAAA;AAAA,UACC,SAAQ;AAAA,UACR,MAAK;AAAA,UACL,WAAU;AAAA,UACV,SAAS,MAAMsoB,EAAM,SAAA;AAAA,UACrB,UAAU,CAACA,EAAM,eAAA;AAAA,UAEjB,UAAA;AAAA,YAAA,gBAAArsB,EAAC,QAAA,EAAK,WAAU,cAAa,UAAA,mBAAe;AAAA,YAC5C,gBAAAA,EAACytB,IAAA,EAAiB,WAAU,gBAAA,CAAgB;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,MAE9C,gBAAArtB;AAAA,QAAC2D;AAAA,QAAA;AAAA,UACC,SAAQ;AAAA,UACR,MAAK;AAAA,UACL,WAAU;AAAA,UACV,SAAS,MAAMsoB,EAAM,aAAaA,EAAM,aAAA,IAAiB,CAAC;AAAA,UAC1D,UAAU,CAACA,EAAM,eAAA;AAAA,UAEjB,UAAA;AAAA,YAAA,gBAAArsB,EAAC,QAAA,EAAK,WAAU,cAAa,UAAA,mBAAe;AAAA,YAC5C,gBAAAA,EAAC0tB,IAAA,EAAe,WAAU,gBAAA,CAAgB;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,IAC5C,EAAA,CACF;AAAA,EAAA,EAAA,CACF,EAAA,CACF;AAEJ;AC3FA,MAAMC,KAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAe3B,SAASC,GAAU5K,GAA0B;AAC3C,SAAO,CAAC,EAAEA,EAAG,eAAeA,EAAG,gBAAgBA,EAAG,iBAAiB;AACrE;AAUO,SAAS6K,GACdhP,GACAiP,GACe;AACf,QAAMtrB,IAAQsrB,IACV,GAAGH,EAAkB,KAAKG,CAAmB,KAC7CH;AACJ,SAAO,MAAM,KAAK9O,EAAU,iBAA8Brc,CAAK,CAAC,EAAE;AAAA,IAChE,CAACwgB,MAAO,CAACA,EAAG,aAAa,UAAU,KAAK,CAACA,EAAG,aAAa,aAAa,KAAK4K,GAAU5K,CAAE;AAAA,EAAA;AAE3F;AC9BA,MAAM+K,KAAQnuB,EAAM,WAGlB,CAAC,EAAE,WAAAC,GAAW,cAAAmuB,GAAc,GAAGluB,EAAA,GAASC,MAAQ;AAIhD,QAAMkuB,IAAWruB,EAAM,OAAyB,IAAI;AAGpD,EAAAA,EAAM,UAAU,MAAM;AACpB,IAAI,OAAOG,KAAQ,aACjBA,EAAIkuB,EAAS,OAAO,IACXluB,KAAO,aAAaA,MAC7BA,EAAI,UAAUkuB,EAAS;AAAA,EAE3B,GAAG,CAACluB,CAAG,CAAC,GAGRH,EAAM,UAAU,MAAM;AACpB,UAAMsuB,IAAeD,EAAS;AAC9B,QAAI,CAACC,EAAc;AAEnB,UAAMC,IAAgB,MAAM;AAC1B,4BAAsB,MAAM;AAE1B,QADmBN,GAAqBK,GAAc,iCAAiC,EAC5E,QAAQ,CAAClL,MAAO;AACzB,UAAAA,EAAG,aAAa,YAAY,IAAI;AAAA,QAClC,CAAC;AAAA,MACH,CAAC;AAAA,IACH;AAEA,IAAAmL,EAAA;AAEA,UAAMC,IAAW,IAAI,iBAAiB,MAAM;AAC1C,MAAAD,EAAA;AAAA,IACF,CAAC;AAED,WAAAC,EAAS,QAAQF,GAAc;AAAA,MAC7B,WAAW;AAAA;AAAA,MACX,SAAS;AAAA;AAAA,MACT,YAAY;AAAA,MACZ,iBAAiB,CAAC,UAAU;AAAA;AAAA,IAAA,CAC7B,GAEM,MAAM;AACX,MAAAE,EAAS,WAAA;AAAA,IACX;AAAA,EACF,GAAG,CAAA,CAAE;AAGL,QAAMC,IAAuB,CAAC7qB,MAA2C;AACvE,UAAM,EAAE,SAAS0qB,EAAA,IAAiBD;AAClC,QAAKC,GAEL;AAAA,UAAI1qB,EAAE,QAAQ,aAAa;AAEzB,QAAAA,EAAE,eAAA,GACeqqB,GAAqBK,CAAY,EAAE,CAAC,EAC5C,MAAA;AACT;AAAA,MACF;AACA,MAAI1qB,EAAE,QAAQ,OAAO,SAAS,kBAAkB0qB,KAC9C1qB,EAAE,eAAA;AAAA;AAAA,EAEN;AAEA,SACE,gBAAAxD,EAAC,SAAI,WAAWd,EAAG,gCAAgC,EAAE,UAAU8uB,GAAc,GAG3E,UAAA,gBAAAhuB;AAAA,IAAC;AAAA,IAAA;AAAA,MAGC,UAAU;AAAA,MACV,WAAWquB;AAAA,MACX,KAAKJ;AAAA,MACL,WAAW/uB;AAAA,QACT;AAAA;AAAA,QACA;AAAA;AAAA,QACAW;AAAA,MAAA;AAAA,MAEF,cAAW;AAAA,MACX,mBAAgB;AAAA,MACf,GAAGC;AAAA,IAAA;AAAA,EAAA,GAER;AAEJ,CAAC;AACDiuB,GAAM,cAAc;AAGpB,MAAMO,KAAc1uB,EAAM,WAGxB,CAAC,EAAE,WAAAC,GAAW,cAAAmuB,GAAc,GAAGluB,KAASC,MACxC,gBAAAC;AAAA,EAAC;AAAA,EAAA;AAAA,IACC,KAAAD;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,QACE,sEAAsE8uB;AAAA,MAAA;AAAA,MAExE;AAAA,MACAnuB;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDwuB,GAAY,cAAc;AAG1B,MAAMC,KAAY3uB,EAAM,WAGtB,CAAC,EAAE,WAAAC,GAAW,GAAGC,KAASC,wBACzB,SAAA,EAAM,KAAAA,GAAU,WAAWb,EAAG,iCAAiCW,CAAS,GAAI,GAAGC,GAAO,CACxF;AACDyuB,GAAU,cAAc;AAGxB,MAAMC,KAAc5uB,EAAM,WAGxB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAAC;AAAA,EAAA;AAAA,IACC,KAAAD;AAAA,IACA,WAAWb,EAAG,uEAAuEW,CAAS;AAAA,IAC7F,GAAGC;AAAA,EAAA;AACN,CACD;AACD0uB,GAAY,cAAc;AAG1B,SAASC,GAAoCC,GAA8C;AACzF,EAAA9uB,EAAM,UAAU,MAAM;AACpB,UAAM+uB,IAAMD,EAAO;AACnB,QAAI,CAACC,EAAK;AAEV,UAAMjM,IAAgB,CAAClf,MAAqB;AAC1C,UAAKmrB,EAAI,SAAS,SAAS,aAAa,GAExC;AAAA,YAAInrB,EAAE,QAAQ,gBAAgBA,EAAE,QAAQ,aAAa;AACnD,UAAAA,EAAE,eAAA,GACFA,EAAE,gBAAA;AACF,gBAAMorB,IAAaF,EAAO,UAAUb,GAAqBa,EAAO,OAAO,IAAI,CAAA,GAGrE9d,IAAQge,EAAW,QAAQ,SAAS,aAA4B,GAChE3L,IAAYzf,EAAE,QAAQ,eAAeoN,IAAQ,IAAIA,IAAQ;AAC/D,UAAIqS,KAAa,KAAKA,IAAY2L,EAAW,UAC3CA,EAAW3L,CAAS,EAAE,MAAA;AAAA,QAE1B;AAEA,QAAIzf,EAAE,QAAQ,aACZA,EAAE,eAAA,GACFmrB,EAAI,MAAA,KAGFnrB,EAAE,QAAQ,eAAeA,EAAE,QAAQ,cACrCA,EAAE,eAAA;AAAA;AAAA,IAEN;AAEA,WAAAmrB,EAAI,iBAAiB,WAAWjM,CAAa,GAEtC,MAAM;AACX,MAAAiM,EAAI,oBAAoB,WAAWjM,CAAa;AAAA,IAClD;AAAA,EACF,GAAG,CAACgM,CAAM,CAAC;AACb;AAGA,SAASG,GACPC,GACAC,GACAhnB,GACA;AACA,MAAIinB;AAMJ,SALIjnB,MAAc,eAAegnB,IAA2B,IAC1DC,IAAgBF,EAAgBC,IAA2B,CAAC,IACnDhnB,MAAc,gBAAgBgnB,IAA2BD,EAAgB,SAAS,MAC3FE,IAAgBF,EAAgBC,IAA2B,CAAC,IAE1DC,KACF,sBAAsB,MAAMA,EAAc,OAAO,GAC1C,MAEF;AACT;AAGA,SAASC,GACPC,GACAC,GACApnB,GACA;AACA,MAAIqnB;AAMJ,SALIrnB,MAAc,eAAeonB,IAAkBD,EAAY,SAAS,IACtEE,IAAUF,EAAYC,IAAkB,CAAC,IAChCpnB,MAAc,aAAaonB,IAAkB,MACtDC,IAAUF,EAAYC,IAAkB,CAAC,IAEvCC,KACF,sBAAsB,MAAMA,EAAQ,OAAO,GACpC,MAEF;AACT;AAGA,MAAMC,KAAWzvB,EAAM,WAGrB,CAAC,EAAE,WAAAC,GAAW,WAAAyvB,GAAW,UAAAtsB,GAAU,wBAAAusB,IAAyB,IAAO,GAAGzvB,EAAA,GAASC,MAAQ;AAIvF,QAAM2uB,IAAS9uB,EAAM,OAA4B,IAAI;AAGrD,EAAAA,EAAM,UAAU,MAAM;AACpB,IAAI,OAAOG,KAAQ,aACjBA,EAAI2uB,EAAO,OAAO,IACT3uB,KAAO,aAAaA,MAC7BA,EAAI,UAAU2uB,EAAO;AAAA,EAEzB,GAAG,CAAC3uB,CAAG,CAAC,GAGR0uB,GAAoCC,CAAM;AAG1C,QAAMI,IAAkBlvB,EAAM;AAAA,IAC5B,MAAO8uB,EAAO,UAAUb,GAAqBa,EAAO,OAAO,IAAI,CAAA;AAAA,IAC/D,CAACA,CAAM;AAAA,EAAA,GAIHhM,IAAgB9iB,EAAM;AAAA,IAC1B,CAAC4D,MAAgD;AAC/C,YAAM,EAAE,SAASgsB,EAAA,IAAed;AAChC,UAAI,CAACc,KAAc,CAACA,EAAW,cAAe;AAE9C,YAAMC,IAAeD,EAAW,QAAQ,OAAO,GACzCN,IAAcO;AAAA;AAAA;AAAA,QAGf5B,GAAqB4B,CAAY,EAA4B;AAAA,UAC5D,CAACxjB,MAAYA,EAAQ,YAAY;AAAA,QAAA;AAAA,UAEnC,CAAA,GACEkjB,IAAkBD,EAAY,QAAQM,CAAU,GAChDT,IAA2BD,EAAgB;AAAA;AAAA;AAAA,QAG/C,SAAS;AAAA,MAAA;AAGX,UAAItrB,EAAE,QAAQ,eAAeA,EAAE,QAAQ;AACrC,QAAAA,EAAE,eAAA,GACFyrB,GAAiBC,GAAaC,GAAiB3rB,EAAE,GAAG;AAAA,eAC3CA,EAAE,QAAQ,eAAeA,EAAE,QAAQ;AAC5C,QAAAA,EAAE,eAAA,GACFqrB,GAAmCC,GAAiBC,GAA0BvrB,EAAE,GAAG;AAAA,eAC1EA,EAAE,QAAQ,UAAU;AAC7B,QAAAA,EAAE,eAAA;AACF,cAAM6oB,IAAQmD,EAAW,QAAQ,OAAO;AACxC,QAAInD,KACFA,EAAM,MAAA;AAAA,MAEV;AAGA,MAAAiD,KAAA,QAAAA,EAAY9rB;AAAA,IACd;AAAA,IACA,CAACkrB,GAAQI,GAAiBQ,CAAS;AAAA,EAAA,GAG/BI,IAAc9vB,EAAM;AAAA,IACxB,CAAC4D,MAA6C;AAC5C,MAAI+rB,qBAAmC/rB;AAAA,IACzC;AAAA,IACA,CAAC+rB,GAAwBvsB,CAAQ;AAAA,EAAA;AAGnC,SACE,gBAAAhD;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAK0uB;AAAA,MACL,UAAU;AAAA,MACV,WAAWhM;AAAA,MACX,SAASgN;AAAA,MACT,WAAWxwB;AAAA;AAAA,QAET;AAAA,QACA;AAAA,QACA;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV,CAAC;AACDuvB,GAAS,cAAc;AAGvB,MAAMM,KAAY/vB,EAAM,WAGtB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAAC;AAAA,EAAA;AAAA,IACC,KAAAD;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACD6vB,GAAU,cAAc;AAGxB,MAAMC,KAAYhwB,EAAM,WAGtB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAAC;AAAA,EAAA;AAAA,IACC,KAAAD;AAAA,IACA,WAAWb,EAAG,2DAA2DW,CAAS;AAAA,IACjF,GAAGC;AAAA,EAAA;AACN,CACD;AACD8vB,GAAU,cAAc;AAGxB,MAAMC,KAAejwB,EAAM,WAGzB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAAC;AAAA,EAAA;AAAA,IACC,KAAAD;AAAA,IACA,WAAWb,EAAG,+CAA+CW,CAAS;AAAA,IACrE,GAAGC;AAAA,EAAA;AACN,CACD;AACD+vB,GAAa,cAAc;AC1V3B,SAASC,GAAS,EAAE,WAAAjwB,GAAW,GAAGC,KAA+C;AAC/E,SACE,gBAAAE;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWd,EAAG,qDAAqDW,CAAS;AAAA,MAC3E,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;ACyCO,SAASiwB,GAAyB;AAAA,EACvC,SAAAC;AAAA,EACA,MAAAC;AAAA,EACA,kBAAAC,IAAmB;AAAA,EACnB,wBAAAC,IAAyB;AAAA,EACzB,8BAAAC,IAA+B;AAAA,EAC/B,cAAApC,IAAe;AAAA,EACf,mBAAAqC,IAAoB,MAAM;AAAA,EAAC;AAAA,EAC3B,IAAAhrB;AAAA,EACA,WAAAirB,IAAY;AAAA,EACZ,kBAAAC;AACF,GAAkC;;AAChC,QAAM,CAACC,GAASC,CAAU,IAAIhrB,EAAuB,CAAA,CAAE,GACjD,CAACirB,GAAeC,CAAgB,IAAIlrB,EAA6B,CAAA,CAAE,GACnE,CAACmrB,GAAkBC,CAAmB,IAAIprB,EAA0B,CAAA,CAAE,GACtE,CAACqrB,GAAcC,CAAe,IAAItrB,EAAS,CAAA,CAAE,GAE7CurB,IAAiBttB,EAAQ,MAAMusB,KAAQ,CAAA,GAAI,CAACA,CAAI,CAAC,GAEjD5D,IAAQ4E,GAAc;AAAA,IAC1B,MAAMD;AAAA,IACN,SAAAhB;AAAA,IACA,iBAAiBkB,GAAA;AAAA,IACjB,GAAIhB,KAAoB,EAAE,uBAAuBiB,KAAsB;AAAA,IACvE,iBAAiBV;AAAA,IACjB,mBAAmBW,GAAA;AAAA,IACnB,uBAAuBT;AAAA,IACvB,qBAAqBU,GAAA;AAAA,IACrB,0BAA0BR;AAAA,IAC1B,sBAAsBE;AAAA,IACtB,OAAO;AAAA,MACL,SAAAP;AAAA,MACA,eAAAE;AAAA,MACA,kBAAAE;AAAA,MACA,cAAAE;AAAA,IAAA;AAAA,EACF,CACD,GAEKQ,IAAiBjF,EAAM,sBAAA;AAC7B,MAAIkF;AAEJ,SAAIjB,IAGFiB,IADuB,MAAM,KAAK,EAAE,QAAQ,GAAA,CAAU,EAAE,IAAI,CAACpoB,GAAGqoB,MAAQ,gBAAgBA,CAAG,EAAE,EAChE,IAAI,CAACC,MAChC,gBAAAzxB,EAACqvB,IAAA,EACC,UAAA,gBAAArvB,EAAC4vB,IAAA,EAAU,SAAS0B,EAAe,UAAUtB,EAAQ,QAAQ,WAAU,sBACrE,UAAA,gBAAAhwB,EAAC,OAAA,EAAI,WAAU,qBACb,UAAA,gBAAAA,EAAC8vB,IAAA,EAAS,WAAU,mCAAkC,EAAA,CACxD,EAAA,CACF,EAAA,GALa2B,CAMf,CACD,MACQvvB,IAAAmqB,EAAM,YAAA,EAAc,SAApB,gBAAAnqB,EAA0B,UAAS,IAC5CqvB,IAAclF,EAAM,YAAA,EAAc,KAAK,IAAI,CAACsC,MAC1C,gBAAA3uB;AAAA,IAACqvB;AAAA,IAAA;AAAA,MACC,SAAS,MAAMgB,EAAkB1B,GAAKtC,CAAK;AAAA,MAE3C,cAAYsC,EAAI,cAAA,KAAmB;AAAA,MAElC,YAAI,kBAAkB,IAAI,CAAC+C,wBACzB9B,IAAA,EACE,UAAA+B,GAAWD,EAAK,OAAO,UAAU,MAAMA,EAAK,YAAY,EAAA,GAD3CA,EAAK,EAErB,CACD;AAAA,IAAA;AAAA,IAPI/C,EAAI;AAAA,EAAA,CASZ,IAED4C,IACE,gBAAAvxB,EAACqvB,IAAA,EACC,UAAA,gBAAArvB,EAAC4vB,IAAA,EAAU,SAASI,EAAQ,QAAQ,WAAU,0BAC3C,UAAAO,EAAA,CACH,GACF,GAKF,gBAAAnwB,EAAC,OAAA,EAAI,WAAU,UAAS,IAAAiF,GACrB,UAAA;AAAA,IAAA+qB,KAAgC,gBAAApwB,EAACosB,MAAqB,OAAAC,EAAA,CAAc;AAAA,IACrE,gBAAAjsB,EAAC2tB,MAAM,cAAAC,GACL,UAAA;AAAA,MAAA,gBAAAhuB,EAACsuB,IAAA,EAAY,cAAAN,GACV,UAAA3B,EAAM,gBAAA,EAAkB,IAAI,CAACuF,MAC5B,gBAAA5xB,EAACqvB,IAAA,EACE,UAAAuC,EAAY,QAAQ,IAAI,CAACC,MAEtB,gBAAA7xB,EAAC2vB,IAAA,EACE,UAAAkC,EAAO,gBACJ,SACAF,GAAWE,EAAO,OAAO,UAAU,QAAQA,EAAO,WAAA,CAAY,EAAA,GAHpDA,EAAO,EAIvB,CAEH,EAAA,GATYD,EAAY,EAU3B,CACD,EAAA,CACH;AAAA,MACA,gBAAA5xB,EAACuuB,MAAW,UAAAgD,EAAA,CAAY;AAAA,IAAA,GAC1B;AAAA,IACCrB,KACC,gBAAA9vB,EAAC,OAAA,EAAI,WAAU,+DACb,UAAA;AAAA,MAAA,gBAAAJ;AAAA,QAAC+D;AAAA,QAAA;AAAA,UACC,SAAQ;AAAA,UACR,MAAK;AAAA,UACL,SAAS,MAAMsoB,EAAM,aAAA;AAAA,UACrB,UAAU,CAACA,EAAM,mBAAA;AAAA,UAClB,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,MAGD,gBAAArsB;AAAA,QAAC+D;AAAA,QAAA;AAAA,UACC,SAAQ;AAAA,UACR,MAAK;AAAA,UACL,SAAS,MAAMsoB,EAAM,SAAA;AAAA,UACrB,UAAU,CAACA,EAAM,eAAA;AAAA,UAClB,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,IAED,GACF;AAAA,IAED6D,KAAoBC,KAA0B,gBAAAnwB,EAACqtB,IAAA,EAAoB,OAAAhB,EAAA,CAAc;AAAA,EAAA,GACpF;AAEJ;ACrJO,SAASyF,GAAiB;AAAA,EAC/B,IAAAzsB;AAAA,EACA,UAAA0sB;AAAA,EACA,WAAAlyB;AAAA,EACA,cAAAmyB;AAAA,EACA,UAAAC;AACF,GAA0B;AACxB,QAAMpjB,IAAiCnL;AAAA,IACrC,OAAO;AAAA,MACL,WAAW;AAAA,QACT,GAAG;AAAA,UACD,OAAO;AAAA,YACL,QAAQsuB;AAAA,UAAA;AAAA,QACV;AAAA,MACF;AAAA,IACF;AAAA,IAEF,CAACA,CAAY;AAAA,EAAA;AAEf,SACE,gBAAAhyB;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,IAAAqF;AAAA,MACA,WAAWnG;AAAA,QACT;AAAA,QACA;AAAA,UACE,kFACE+yB;AAAA,QAAA;AAAA,QAEJpyB;AAAA,MAAA;AAAA,MAGF,UAAA,gBAAAG,EAACkyB,IAAA,EAAS,SAAArjB,GAAmB,UAAAkjB,EAAA,CAAS;AAAA,IAAA;AAAA,EAAA;AAG5C;ACpDO,MAAMI,KAAyB,OAAO,OAAO;AAAA,EAClD;AAAA,EACA;AACF,CAAU,GAcJphB,KAAiB,CACrBC,GACAzK,MAEOyK,EAAQzK,CAAG,KAAKA;AAmBlB,SAAS6rB,GAAU;AAAA,EACxB,cAAAC;AAAA,EACA,kBAAAC;AAAA,EACA,kBAAA/oB;AAAA,EACA,IAAAlE;AACF,GAAmB;AACjB,QAAMktB,IAAaxhB,GAAexH,GAAkB,6BAA6B,GAC3EipB,IAAczhB,GAAexH,GAAkB,mCAAmC;AAExF,WAASkpB,IAAa;AACpB,cAAU,UAAU,UAAUJ,CAAY,GACtCC,KACFA,EAAA;AAAA,EAEJ;AAEA,SACE,gBAAAlyB;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,IAAAiF;AAAA,MACA,WAAU;AAAA,MAEV,UAAA;AAAA,QAAA,gBAAAjF,EAAC,OAAA,EAAI,WAAU,2EACb,UAAA;AAAA,UAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,wEACb,UAAA;AAAA,YAAA,gBAAAJ,EAAC,OAAA,EAAI,WAAU,oGACZ,UAAAuyB,GACH;AAAA,YACA,gBAAAvyB,EAAC,OAAA,EAAI,WAAU,yGACZ,UAAAwyB,EAAA,CACH;AAAA,UAAA,GACF;AAAA,UACA,gBAAAxyB,EAAC+D,GAAA,EAAO,SAAQ,aAAY,MAAK,QAAO,WAAU,UAAS,SAAS,MAAM0uB,KACxE,UAAA,gBAAAzyB,EAAC0yB,MAAK,EAAA,CACR;AAAA,QAAA,GACF;AAAA,QACA,gBAAA1yB,EAAC,SAAI,WAAU,sBACb,4BAAC,OAAA,EAAI,WAAU,cAAc,UAAAqyB,EAAA,CAAa,EAAA,CAC5C;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGN;AC5EO,MAAMM,KAA4B,OAAO,OAAO;AAAA,EACrD,GAAGR;AAAA,EACH;AACF,CAAU;AAqBH,SAASS,GAAa;AAAA,EAC3B,cAAAP;AAAA,EACA,kBAAAC;AAAA,EACA,kBAAA/oB;AAAA,EACA,UAAArJ;AAAA,EACA,WAAAL;AAAA,EACA,IAAAwF;AACF,GAAsB;AACpB,QAAM,CAACwtB,GAAeC,CAAgB,IAAIrtB,EAAkB,EAAK,GAE3DstB,IAA6B,MAAM;AACvC,IAAAD,EAAiB,EAAI,GACjBR,KACFA,EAAA;AAAA,EAEJ;AAQA,SACE,gBAAAlyB,EAACgE,IAAA,EAAQ,cAPc,CAACuL,MAAkB;AAC1C,IAAKA,KACHmjB,EAAiB,EAAK;AAAA,EAE1B,GAII,UAAA;AAAA,IAAA,gBAAA9yB,EAACsE,IAAA,EAAe,SAAO,IAAE,UAAApE,EAAA,CAAS;AAAA,sBACjCsE,IAAA,EAAe,IAAAa,GAAQ,WAAWnG,EAAG,2BAA2BW,CAAS,GACvE,UAAA;AAAA,MAAAgzB,KAAiBtpB,EAAiB,qCAAqC,uBACrE6E,IAAA,EAAO,UAAA7E,EAAiB,qCAAqC,GAAE;AAAA,MAElE,gBAAAvJ;AAAA,QAACoyB;AAAA,QAAA;AAAA,UACC,cAAAC;AAAA,UACA,kBAAkBU;AAAA,UAClB,kBAAAxpB;AAAA,QAAA;AAAA,MAAA;AAAA,IACF,EAAA,CACF;AAAA,EAAA,GACF;AAEJ;AC1DO,IAAKypB,uBAAAA,OACVA,EAAAA,EAAA,QAAA,CAAA,IAAA,SACAA,EAAAA,EAAA,QAAA,CAAA,IAAA,SAFUA,IAAAA,MAAA,CAAA,CAAA;AA0CL,SAASC,GAAe,EAAE,IAAA5tB,GAAI,OAAAkY,GAAO,QAAA2V,KAA+B;AAEzE,QAAM,CAACC,GAAeC,CAAgB,IAAI3tB;AAAA,IACxC,OAAO;AAAA,MACLytB,EACG;AAAA,QAAI,CAAC9iB,GAAOQ,MACXR,EAAM,aAAa,IAA6B,CAACQ,GAAO,CAAA,CAAE,IAAI;AAAA,MAAA,EAE/D,OAAO,CAACyiB,MAAU,CAAC,CAACA,CAAK;AAAA,IAAA;AAAA,EAC9B,GAEI,CAACC,GAAaC,CAAc,IAAI9tB,EAAiC,CAAA,CAAE,GAEnE+tB,IAAuB,CAACC,GAAoB7iB,MAAkB;AAClE,UAAM8iB,IAAkB,CAACP,EAAcM,CAAU,EAAE7iB,CAAK;AAExD,IAAAwiB,EAAiB,CAACO,OAChBA,EAAiBF,CAAU,EAAE7iB,CAAK,IAAI8iB,GAC/B,EAAE,GAAGC,EAAA,EACb;AAGD,UAAM1uB,IAAOiuB,EAAOO,CAAU,EAAE,MAAM7iB,CAAK;AAC3C,IAAA3L,EAAK,SAASA,EAAK,IAAIyuB,CAAe;AAAA,EACxC,GAEME,IAAoB,CAACH,GAAoBzkB,MAAkB;AAE/D,IAAAukB,EAAe,CAACM,OACdA,EAAeJ,CAAU,IAAIzkB,GACtB,EAAE,GAAG6kB,EAAA,EACb;AAGD,UAAMC,IAAcZ,EAAOO,CAAU,EAAE,MAAM,KAAK,CAACxuB,MAASA,EAAK,OAAO+J,CAAK;AAC7E,IAAI8kB,IACFA,EAAY,SAAS9kB,CAAK,IAE1B,QAAQ,MAAM,+CAA+CA,CAAK,IAAI;AAAA,EAE1E;AAEA,SACE,gBAAAhP,EAAC,OAAA,EAAI,IAAAqF,GAEH,UAAA,gBAAAjF,EAAC0kB,IAAA,EACC,UAAA;AAAA,IAAA,gBAAA9kB,EAACwkB,MAAoB,SAAO,IAC1B,UAAA,gBAAApkB,EAAC2D,GAAA,EAAO,SAAQ,WACd,UAAA;AAAA,MAAA,gBAAA/D,EAAC+zB,IAAA,EAAO,MAAM,IAAI,WAAU,yBAAwB;AAAA,MACnDxW;AAAA,MACD,gBAAAvd,EAACmQ,IAAA,EAAY,MAAM,IAAI,WAAU,wBAAA,CAAwB;AAAA,IAAA,EAAA,CAC3D,EAAA,CACF;AAAA,IACA,gBAAAnQ,EAACklB,MACE,UAAAgO,EAAO,IAAI,CAAC9iB,GAAOqjB,wBACjB,OAAA,EACC,UAAA;AAAA,MAAA,gBAAAzzB,EAACulB,IAAA,EAAmB,YAAM,MAAA,CAAM;AAAA,MAChC,gBAAAvlB,EAAC0kB,IAAA,EACE,UAAAtU,EAAM,aAAa,IAClB,gBAAApQ,EAAA8N,IAAA,EACG,UAAAsC,EAAM,MAAM,IAAI,CAACnL,GAAM2L,wBACrB,OAAA,EACC,UAAA,gBAAA5Q;AAAA,QAAColB;AAAA,QAAA;AAAA,UACC,SAAS+N,EAAcM,CAAU,EAAE7iB,CAAK;AAAA,UACxC,iBAAiB,MAAM4iB,EAAqBC,GAAY7iB,CAAK;AAAA,UAE5D,UAAA3L,EAAK;AAAA,QAAA;AAAA,MAAA,EACR,GANQA,EAAK,EAOf,CACD,GACH,IAEA,gBAAAjF;AAAA,QAAC6kB;AAAA,QAAA;AAAA,UACC,OAAOyO,EAAYG,CAAU;AAAA,UAC7B,eAAe,CAACzkB,MAAU4kB,EAAkBH,GAAYzkB,CAAK;AAAA,UAE5D,YAAM,MAAM,IAAI,CAAC/J,wBACf,OAAA,EACC,UAAA,gBAAAjF,EAACslB,IAAA,EAAsB,OAAOrgB,EAAK,IAAK,UAAAA,EAAK,OAAM,EAAA,GAD3CA,EAAK,EAEf,CACD;AAAA,QAAA;AAAA,MAAA,GAGP;AAAA,wBACCugB,IAAA,CAAA,CAAsB;AAAA,IAAA,KA7BfpV,EAAM,KA8BhB,CACD,EAAA,CACH;AAAA,EAAA,EAAA,CACF,EAAA,CACF;AAEJ;ACtHO,SAAS4jB,GAAS;AAAA,EACvB,IAAA3uB;AAAA,EACA,UAAA4uB;AAAA,EACA,WAAAC;AAAA,EACA,WAAAC;AAAA,EACA,aAAAC;AAAA,EACA,yBAAAC;AAAA,EACA,YAAAC;AAAA,EACA,wBAAAC;AACF,GAAkB;AAUhB,QAAMC,IAAkB,IAAIC,GAAa,MAAM;AAAA,IAC7C,UAAU;AAAA,IACV,gBAAgB;AAAA,EAAA,CACjB,EAAE,OAAO,OAAO,OAAOP,CAAS,EAAE,OAAO,CAAC7hB,GAAWtM,MAAcsM,IAAItM,GAAG,CAAC,CAAC,GAGvE2uB,IAAuB,MAAM;AACjC,WAAO,SAAS,GAAG,SAAS,KAAK,YAAY;AAAA,EAC/C;AAEA,SACE,gBAAAt0B;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,IAAAiF;AAAA,MACA,WAAU;AAAA,MAET,UAAA;AAAA,QAAA4uB,KACC,gBAAA7zB,EAAC,OAAA,EAAI,WAAU,gDACb,UAAA;AAAA,UAAA,gBAAAJ,EAAC,OAAA,EAAI,WAAU,WACb,UAAA,gBAAAA,EAAC,UAAK,WAAU,kDAAkD,aAAS,EAAA,CAC7E;AAAA,UACA,gBAAAA,EAAC,QAAA,EAAK,WAAU,iCAAgC,UAAA,WAAA,CAAQ;AAAA,QAAA,GAC1D;AAAA,QAEF,gBAAAI,EAAC,OAAA,EAAI,WAAU,wDACb,UAAA;AAAA,UAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,oBACb,UAAA;AAAA,YAAA,gBAAAJ,EAAC20B,IAAA,EAAK,WAAU,gBAAA,CAAgB;AAAA,YAChC,gBAAA30B,EAAC,QAAA,EAAK,WAAU,kDAAkD,UAAAw0B,EAAA,CAAgB;AAAA,UAAA,GACpF;AAAA,UACA,gBAAAx0B,EAAC,QAAA,EAAK,WAAU,iCAAgC,UAAA,QAAA,CAAK;AAAA,QAAA,GACvD;AAAA,QACA,gBAAAI,EAAC,OAAA,EAAI,WAAU,wDACb,UAAA;AAAA,UAAA,gBAAAJ,EAAC,OAAA,EAAI,WAAU,oBACZ,UAAAm0B,EAAU,MAAM,GAAG,CAAC,EAAE,IAAI,CAACS,MAC1B,gBAAA50B,EAAC,QAAA,EAAkB,WAAU,kDAC1B,UAAA40B,EAAO,cAAY,GADXA,CAEX,CACD,EAAA,CACH;AAAA,UACCT,EAAU,SAAS,KAClB,gBAAA/zB;AAAA,YAAC;AAAA,YAAA;AAAA,cACC,MAAK;AAAA,cACL,SAAS,MAAMs0B,EAAA;AAAA,cACf,WAAU;AAAA,cACX,UAAA;AAAA,gBAAA;AAAA,gBACGP,EAAU,SAAS;AAAA,gBAAE;AAAA,cAAA;AAAA,YAAA;AAAA,UAAA;AAAA,QACzB,GAEJ;AAAA,SACEC,KAAeE,MACf,gBAAAl0B,EAAC,OAAA,EAAI,WAAU,wCACZ,UAAA;AAAA,UAAAg0B,KACC,gBAAAp0B,EAAC,OAAA,EAAI,WAAU,oBACb,UAAA,gBAAAI;AAAA,YAAC2D;AAAA,YAAA;AAAA,cACC,SAAS,MAAMswB,EAAA;AAAA,cACf,SAAQ;AAAA,cACR,WAAU;AAAA,cACX,UAAA;AAAA,gBAAA;AAAA,gBAEC,gBAAAr0B,EAAC60B,IAAA,EAAW,WAAU,gBAAA,CAAgB;AAAA,cAAA;AAAA,YAAA;AAAA,UAAA,GAE1C;AAAA,UAEDP,KACC,gBAAAt0B,EAAC,OAAA,EAAI,WAAU,oBACb,UAAA,gBAAAI;AAAA,YAAC2D;AAAA,YAAA;AAAA,cACC,SAAS,MAAMwwB,EAAA;AAAA,cACf,SAAQ;AAAA,cACR,WAAU;AAAA,cACX,UAAA;AAAA,gBAAA;AAAA,gBAEC,gBAAAv0B,EAAC80B,IAAA,EAAW,WAAU,gBAAA,CAAgB;AAAA,cAAA;AAAA,YAAA;AAAA,UAAA,EACxC,CACF;AAAA,QAAA,EAAA,CAEJ;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAIR;ACrGO,SAASC,GAAe,EAAE,IAAA1vB,GAAI,gBAAA2vB,KAAuC;AAC1E,QAAM,CAACC,GAAiBC,CAAkB,IAAIzvB,EAAS,EAAK,GACtD0vB,wBAAkB,KAAA;AAQxB,WAASC,EAAiBC,GAAoB;AAC5C,UAAM7O,IAAO,IAAI,KAAK6O,CAAU,GAC1BC,IAAW,IAAI,KAAKH,EAAY,YAAY3O,EAAK,SAAS,GAC1D+O,IAAWD,EAAS,eAAA,IAAmB,MACvCE,IAAYF,EAAS,YAAA,GACrBG,IAAUH,EAAS,WAAA,IAAe;AAGxC,QAAII,IAAa;AACjB,WAAIH,IAAW,IACbG,IAAa,GAAGH,EAAS,UAAU,QAAQA,MAAa,IAAI,KAAK,GAAG,SAC3DC,IAAY,IACrBE,IAAa,GAAGF,EAAU,UAAU,SAASA,MAAc,IAAI,KAAK,GAAG,SAC9DC,MAAY,IACrBC,IAAa,UAEbA,IAAa,GAAGD,EAAQ,UAAU,OAAOA,MAAY,IAAI,KAAK,GAAG,QAG5DC;AAAA,EACT;AAGA,QAAMC,IAAgB,OAAO,QAAQX,CAAc,EAAE,KAAK,CAAC3iB,GAAGtM,MAAMA,EAAE,CAAC,EAAE,cAAcsM,EAAE,CAAC,CAAC,CAAC;AAE5F,SACE,gBAAAjS,EAAC,OAAA,EAAI,WAAU,UAAS,IAAAiF,GACtB,UAAA;AAAA,IAAA,gBAAArF,EAAC,MAAA,EAAG,WAAU,+BAA8B,UAAA,cAAU;AAAA,sBACrD,MAAA,EAAG,WAAU,8DACV,WAAAi1B,IAAkBU,IAAgBA,EAAc,MAAM,GAAG,CAAC,GAAG,IAAI,CAACtC,MAClE,gBAAAjzB,EAAC,OAAA,EAAmB,WAAU,sCAC5B,UAAA;AAAA,MAAA,gBAAAJ,EAAC,OAAA,EAAI,WAAU,sBACb,UAAA,gBAAAA,EAAC,QAAG,WAAU,uBACZ,UAAA,gBAAAA,EAAC,QAAA,EAAM,UAAAqzB,EAAM,CAAC,EAAE,YAAA,CAAY,GAC9B,GACF;AAAA,MACA,gBAAAjzB,EAAC,OAAA,EAAI,WAAU,gCACb,UAAA;AAAA,QAAA,gBAAAA,EAAC,OAAA,EAAI,UAAA;AAAA,UAAA;AAAA,UAASizB,EAAM,CAAC;AAAA,QAAA,GAAE;AAAA,0BACtB,OAAA,EAAK,UAAA+B,EAAiB/B,EAAM,CAAC,EAAE,IAAI,EAAA,CAAE;AAAA,MAAA,EAAA,CACxC;AAAA,IAAA,EAAA,GATQA,EAAM,CAAC,CAUjB,CACD,EAAA,CACH;AAAA,IACCsC,EAAc,SAAS,KACtB,gBAAA31B;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,MAAK;AAAA,QACL,SAAS,MAAMk1B,EAAmB,CAACD,CAAe;AAAA,QAClD,WAAU;AAAA,QAET,cAAkB,8BAA8B;AAAA,MAAA;AAAA,IAAA;AAAA,EACnD,GAEJ;AAEJ;AChEO,SAASW,GAAO;AAAA,EACrB,IAAAvwB;AAAA,EACA,sBAAAwwB;AAAA,EACA,UAAAC;AAAA,EACA,SAAAC;AAAA,EACA,gBAAAf;AAAA,EACA,gBAAAgB;AACF,GAAgB;AAEd,QAAMC,IAAoBvyB,EAAQ,MAAMwyB,GAAYJ,CAAQ,GAAG,CAACA,CAAQ,CAAC,GAanEK,KALmB,CAACC,MAAoB;AAC5C,UAAMC,IAAe,IAAI,KAAK,aAAaC,MAAoB,EAAE,MAAM,YAAY;AACnF,WAAOF,EAAM,IAAI,CAACG,MAASF,EAAa,GAAGE,CAAI,CAAC;AAAA,EAClD,GAEuCR,CAAO;AAE9C,SACE,gBAAA/1B,EAAC,SAAI,IAAAqF,GAAQ,WAAU,8BACrB,UAAA,gBAAAjF,EAAC,OAAA,EAAI,WAAU,4CACZ,UAAA;AAAA,IAAA,OAAO,QAAQ40B,CAAc,EAAE,SAAS,KACvC,gBAAAh1B,EAAC+0B,MAAe,gBAAAC,GAAgC;AAAA,IAElD,gBAAA50B,EAAC,OAAA,EAAI,WAAU,wCACb,UAAA;AAAA,MAAA,gBAAAJ,EAAC,MAAA,EAAG,WAAU,+BAA8B,UAAA,eAAW;AAAA,MACvD,gBAAAI,EAAC,OAAA,EAAI,WAAU,2EACb,UAAA;AAAA,QAAA,gBAAAA,EAAC,KAAA,EAAE,WAAU,iDACX,UAAA;AAAA,UAAA,gBAAAJ,EAAC,UAAK,UAAA,YAAA,CAAS;AAAA,UACf,gBAAAA,EAAC,QAAA,EAAK,WAAU,oBAAoB,UAAA61B,GAAqB;AAAA,UACzD,gBAAA71B,EAAC,UAAK,UAAA,OAAA,CAAI;AAAA,UACV,gBAAAA,EAAC,QAAA,EAAK,WAAU,oBAAoB,UAAAi2B,EAAA,CAAkB;AAAA,QAAA,GACxD;AAAA,0BACC,OAAA,EAAI,WAAU,qFACb,UAAA,gBAAA71B,EAAC,KAAA,EAAE,WAAU,iDACX,UAAA;AAAA,UAAA,gBAAAJ,EAAC,UAAK,UAAA,UAAA,CAAO;AAAA,UACb,gBAAAA,EAAC,QAAA,EAAK,WAAU,oBAAoB,UAAAg2B,GAAe;AAAA,UACnD,gBAAAh2B,EAAC,UAAK,UAAA,YAAA,CAAS;AAAA,4BACd,QAAA,EAAK,WAAU,oBAAoB,UAAAm2B,EAAc,KAAK,IAAI,EAAA,CAAE;AAAA,QAAA,EAAA,CAC/D,EAAA,CACF;AAAA,MAAA,EAAA,CACF;AAAA,IAAA,EAAA,CACF;AAAA,EAAA,EAAA,CACF,EAAA,CACF;AAEJ;ACdO,SAASK,GAAoB;AAAA,EAClC,SAAAC;AAAA,EACA,UAAAC;AAAA,EACA,UAAAznB;AAAA,EACA,aAAAgL;AAAA,EACA,qBAAA0c,IAAsB;AAAA,EACtB,eAAAC,IAAgB;AAAA,EAChB,cAAAC,IAAe;AAAA,EACf,qBAAAtnB,IAAsB;AAAA,EACtB,oBAAAunB;AAAA,EACA,QAAAvxB,IAAS;AAAA,EACT,cAAAwxB,IAAe;AAAA,EACf,YAAArnB,IAAa;AAAA,EACb,cAAAsnB,IAAe;AAAA,EACf,MAAA5nB,IAAO;AAAA,EACP,WAAAvP,IAAY;AAAA,EACZ,SAAAmE,IAAU;AAAA,EACV,IAAAqB;AACF,GAA6B;AAC3B,QAAM,CAAC4xB,GAAaC,CAAc,IAAIzxB,EAAS,EAAK,GAE9CnC,IAAe4E;AAAA,IACnB,CAACqV,MAAkB;;AACjB,YAAMvO,KAAQ9M,IAAAu0B,EAAQ,KAAK,CAACpD,MAAUA,EAAM,UAAU9V,CAAK,MAA7C,gBAAArb,EAAgD;AAC9D,MAAK8M,KACLC;AAAA,QACEynB,EAAS,SAAS1nB,CAAK,IAAI0nB,EAAS,OAAO,CAACzxB,MAASA,MAAS+J,CAAK,IAAI,CAAC,GAAG0nB,GAAU1nB,CAAK;AAAA,MAAA;AAAA,IAE9F;AAAA,IACA,CAACynB,GAASC,GAAUznB,CAAQ;AAAA,EAAA,GAGxBkoB,IAAqB,MACrBL,KACG7c,GAGHmd,IAAgB1zB,EAAQ,MAAM;AAClC,QAAI,CAACszB,EAAc,QAAOP;AAE1B,UAAMY,IAAeZ,EAClB,OAAO,CAACrU,MAAQA,EAAI,OAAO,EAC3B,KAAK,CAAC/P,GAAGtM,MAAMsM,EAAE,MAAM,cAActM,EAAE,KAAK,CAAC,GAC1CuxB,IAAkBb,EACrB,OAAO,CAACrU,MAAQ,CAACA,EAAI,OAAO,EAC5B,KAAK,CAAC/P,GAAGtM,MAAM;AACd,YAAMwxB,IAAYb,EAAS,SAASrkB,EAAE,KAAK,GACrCmlB,IAAYd,EAAS,SAAS3wB,EAAE,KAAK;AAC3C,aAAIwxB,KAAa,CAACC,IAAkB,KAChC,CAACD,KAAaC,IAAkB,IAC7BnlB,EAAE,MAAM,cAActM,EAAE,KAAK;AAAA,IACtC,CAAC;AAEH,WAAO,CAAC,GAAGsxB,GAAc,GAAGC,CAAe;AAAA,EAC7C,GAAG,CAACb,GAASC,GAAUM,CAAY,CAAC,GAE9BS,IAAkB,MAAM;AAC5B,IAAAxoB,EAASwnB,EAAQ,IAAI,CAACpD,MAAUA,EAAM,KAAK,CAAC;AAAA,EAC9C,GAEMqE,IAAiB,MAAM;AAC3B,IAAAzoB,EAAS,CAAA,CAAE;AAAA,EACb,GAEM0oB,IAAepyB,KAAU0xB;AAG/B,SACE,gBAAAj3B,EAAC,SAAI,IAAAqF,GAAQ,WAAAxF,GACX,4BAACuE,IAAA,EAAQ,MAAMuzB,GAAc,cAJNZ,KAAgBG,GAKrC,UAAA;AAAA,IAAA,gBAAAl3B,EAACsE,IAAA,EAAe,SAAO,IACrB,UAAA,gBAAAlE;AAAA,MAAC2D;AAAA,MAAA;AAAA,QACC,SAAAC;AAAA,QACA,MAAK;AAAA,QACL,iBAAe2zB;AAAA,QACf,WAAU;AAAA,QACV,UAAUjoB;AAAA,QAEV,UAAA;AAAA,UAAA,gBAAAtP,EAAC,OAAA,EAAI,WAAU,yDACZ,UAAA;AAAA,YAAAgP,KACC,gBAAApP,EAAC,SAAI,WAAU,mDACb,4BAAC,QAAA,EAAK,WAAU,iEACb,UAAAoP,EAAA,CACH,EAAA,CACF;AAAA,YAEF,gBAAApP;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,WAAWd;AAAA,kBACT;AAAA,gBAAA;AAAA,gBAGD,UAAAi4B,EAAA;AAAA,cAAmB;AAAA,YAAA;AAAA,UACtB,GACF;AAAA,UACA,gBAAAn3B,EAAC43B,IAAA,EAAe,WAAU,kDAAA,CAAkD;AAAA,QAAA;AAAA,MAAA;AAAA,IAAA,GAEhF;AAAA,sBACCpzB,IAAA,EAAe,OAAM,SAAQ,WAAU,oBACtC,4BAAC/D,IAAA,EACC,UAAA;AAAA,MAAA,gBAAAT,EAACW,MAAa,aAAa,UAAUsZ,EAAY,YAAA,CAAa,OAAO;AAAA,MACpE0c,KACC,gBAAAv2B,EAAC,OAAA,EAAI,WAAU,iDACb,UAAA;AAAA,QAAA,gBAAAJ,EAAC+D,KAAO,SAAQ,SAAQ,MAAK,MAAK,SAAS0zB,GACxC,UAAAb,EAAA,CACH;AAAA,QACA,gBAAA52B,EAAC+D,KAAO,SAAQ,SAAQ,MAAK,MAAK,SAAS2zB,GACxC,UAAAb,EAAA,CACH;AAAA,MAAA,GACF;AAAA,wBAEDh2B,IAAA,EACC,UAAA;AAAA,QAAA,gBAAAb,EAACc,MAAc,UAAAyO,EAAA,CAAoB;AAAA,QACnC,gBAAAvP,EAACe,IAAA,EACE,UAAAq2B,EAAc,IAAI,CAACzoB,MAEhB,gBAAAvO;AAAA,UAACa;AAAA,UAAA;AAAA,YAEC,OAAO0N,EAAO;AAAA,YACd,UAAUrL;AAAA,YACV,WAAU;AAAA,YAEV,UAAA;AAAA,cAAA,gBAAAtD,EAAC,OAAA,EAAI,WAAU,OACb,UAAA,gBAAAA;AAAA,gBAAC4D;AAAA,gBAAA;AAAA,kBACC,WAAW1E;AAAA,oBACT;AAAA,oBACAw3B,EAAS,SAAS/nB,EAAO,KAAK,IAAI,mBAAmB;AAAA,kBAAA;AAAA,gBACvD;AAAA,cAAA,GAEJ;AAAA,cACCA,EAAO,WAAW,gBAAA3O,EAAC63B,IAAA,EAAK,WAAU,iBAAgB;AAAA,cACnD,gBAAA73B,EAAC,OAAA,EAAI,WAAU,gBAAgB,YAAO,OAAM;AAAA,cAC3C2O,EAAO,kBACN,gBAAA3O,EAAC,SAAI,WAAU,wCACZ,YAAO,eAAA,CACV;AAAA,YAAA;AAAA,UAAA;AAAA,UAlBG2O,EAAO;AAAA,QAAA,CAsBjB,EAAA,CACH;AAAA,MAAA,EAAA,CACF;AAAA,IAAA,EAAA,CACF,EAAA,CACF;AAAA,EAAA,EAAA,CACF,EAAA,CACF;AAEJ;AC7LO,SAASolB,GAAO;AAAA,EACrB,SAAA0C;AAAA,EACA,UAAAC;AAAA,EACA,UAAAznB;AAAA,EACA,aAAAgL;AAAA,EACA,qBAAA1K;AAAA,EACA,oBAAAunB;AAAA,EACA,YAAApnB;AAAA,EACA,cAAAsnB;AAAA,EACA,MAAA5nB;AAAA,EACA,WAAAvP;AAAA,EACA,mBAAAi4B;AAAA,EACA,IAAAzyB;AACF,GAAgB;AACd,SACE,gBAAAjF,EAAC,OAAA,EAAI,IAAAiF,GAAQ,WAAU,oCACrB,UAAA;AAAA,IAAA,gBAAArF;AAAA,MAACw2B;AAAA,MAAA;AAAA,QACC,SAAAC;AAAA,QACA,UAAAC;AAAA,QACA,UAAAznB;AAAA,QACA,aAAAgL;AAAA,QACA,qBAAA1K;AAAA,QACA,oBAAAunB;AAAA,QACA,YAAApnB;AAAA,QACA,cAAAsnB;AAAA,QACA,MAAA5nB;AAAA,QACA,WAAAvP;AAAA,MAAA;AAAA,IAAA;AAAA,IAED62B,EAAS,SAAS,IACjB,gBAAA12B,EAAC,OAAA,EAAI,WAAU,iDACZ,UAAA02B,EAAS,IAAI,CAAC3rB;;AACb,6BAAA3K,EAACkjB,IAAA,EAAiB,SAAQ,SAAQ,WAAU,oCAC1C,UAAA;AAAA,QAAA,gBAAAtjB;AAAA,UAAC+D;AAAA,UAAA;AAAA,YACC,SAAQ;AAAA,YACR,MAAK;AAAA,YACL,WAAU;AAAA,YACV,SAAS,MAAMkL,EAASynB,EAAS,OAAO,CAACqB,MAAiBA,MAAiBhtB,CAAI,CAAC;AAAA,YAEhF,UAAA,gBAAA/K,EAACK,IAAA,EAAE,WAAU,gBAAA,CAAgB;AAAA,UAAA;AAAA,QAAA;AAAA,SAE9B6B,IAAAu0B,EAAQ,KAAK,CAACpD,MAAUA,EAAM,UAAUtoB,CAAI,MAA5C,gBAAA7I,EAA+C;AAAA,MAAA,KATtC6I,CAUZ;AAAA,KACD,GACH,IAEA,gBAAA/K,EAACoO,MAAO,UAAA0pB,EAAA,CAAkB;AAAA,EAAA,GAE9B;AAEJ;ACtDO,MAAME,KAAQp4B,EAAM;AAAA,EACzB,CAAC,EAAE,WAAAC,GAAW,MAAAkL,GAAM,GAAGjL,EAAA,GAASC,MAE5B,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,MAAA+K;AAAA,MACA,WAAW7L;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAEF,KAAAE;AAAA,MAEC,GAAGD;AAAA,IAAA;AAAA,EAAA;AAIZ;AACAk4B,GAAM,cAAc;ACApB,MAAMC,KAA4B,CAChCC,GACA3uB,GACA4uB,MAEID,MAAe,cAEf,gBAAA93B,EAAA0N,IAAA,EACE,UAAA;AAAA,EAAA,gBAAA9N,EAAC,OAAE,UAAA,IAAA,CAAC;AAAA,EAAI;AAAA,EAAEuJ,EAAiB,gDAAgD;AAAA,GAC7E,IAIA2uB,MAAe,WAEf,gBAAA93B,EAAA0N,IAAA,EACE,UAAA;AAAA,EAAA,gBAAA9N,EAAC,OAAE,UAAA,IAAA,CAAC;AAAA,EAAI;AAAA,EAAEuJ,EAAiB,6CAA6C;AAAA,GAC1E,IAKF,gBAAAnJ,EAAA0N,IAAA,EACE,UAAA;AAAA,EAAA,gBAAA9N,EAAC,OAAG,UAAAm4B,EAAA,CAAa;AAAA,EAAI;AAAA,EAAE5uB,EAAiB,6CAA6C;AAAA,GACvF;AAIG,SAAS6uB,GAAuB;AAAA,EACrC,YAAAF;AAAA,EACA,kBAAAG;AAAA,EACA,cAAAF;AAAA,EACA,oBAAAG;AAAA,EACA,kBAAA/uB;AACF,GAAgC;AAG9B,QAAMgvB,IAAuBl1B,EAAyB,IAAI,GAGpDm1B,IAAwBn1B,EAAuB,IAAI,GAGnDo1B,IAA6Bp1B,EAAO,EAAK,GACzC,CAACq1B,GAAoBC,CAAqB,IAAIlzB,EAA6ByyB,CAAU,GACrF,CAACU,GAAiBC,CAAkB,IAAIpzB,EAAiB0yB,CAAY,GACrE,CAACW,GAAgBC,CAAiB,IAAItzB,EAAkB,EAAK;AAGnE,EAAAkW,EAAU,MAAM;AACd,IAAAgd,EAAsBT,CAAU;AAAA,EAClC,GAAG,CAACA,CAAU,CAAC,GAGfvc,EAAU,MAAM;AACd,IAAIid,MAAoBT,KACtBU,EAAmBV,CAAY;AAAA,EAKnC,GAAG,CAACA,CAAY,CAAC;AAEjB,QAAMa,IAA2B,CAACrpB,MAAkB;AAClD,IAAA8oB,EAA2B,UAAU,IACrCM,EAAkBppB,CAAI,GACjBA,MAGC+oB,MAAuB,YAAYE,KACrCP,EAAiBK,CAAkB,GACnCJ,EAAmBM,CAAe,MAElCD,EAAsBT,CAAU,GAChCW,EAAmBV,CAAY;AAAA,EAGrC,GAEMzV,IAAgB,CAACvW,MAAyC;;AAC9D,IAAAA,EAAM,gBAAA,GAGH,SAAS,kBAAkBqsB,EAAsB,WAAWrsB,EAAM,QAAQ,eAC3EA,EAAM,QAAQ,iBAEdjK,IAAAq2B,EAAqB,YAArB,QAAAr2B,EAA8B,SAC9Bu2B,EAA2B,UAAU,MAC5B,SAAS,kBAAkBF,EAAqB,WAAWpsB,EAAM,QAAQ,cAClF8sB,IAAAT,EAAsB,YAAtB,QAAAS,EAA+B,SAC/BR,EAA2B,UAAU,MAErC,SAAS,kBAAkBF,EAAqB,WAChDpsB,EAAM,QAAQ,iBACd+sB,IAAAX,EAAqB,YAArB,gBAAAW,EAA8B,oBAAmB,OAEjDC,IAAAX,EAAsB,YAAtB,QAAAW,EAA+B,SAC/BV,EAA2B,UAAU,KAKrCC,MAAuB,YACvBvsB,EAAM,QAAQ,YACb,SAAS,kBAAkBqsB,EAAsB,WAChD,SAAS,kBAAkBD,EAAqB,YAElDS,EAAyB,EAAK;AAAA,EAElC;AAEA,SACE,gBAAA54B,EAAC0kB,IAAA,EAAa,MAAMgU,GAAgB,cAAcE,GAChD,UAAA;AAAA,IAAA,gBAAAh5B,EAAC2S,IAAA,EACC,4BAACE,IAAA,EACC,UAAA;AAAA,MAAA,gBAAA7S,EAAC8S,MAAe,SAAO,IACrB,4BAAC0R,IAAA,EAAoB,SAAO,IAC1B,UAAA,gBAAAxkB,EAAC+D,GAAA,EAAO,SAAQ,WAAU,WAAU,UACjC,UAAAk0B,GAA0BC,GAAY3uB,GAAkB4uB,CAAY,GACvE,GACF,EAAA,CACF;AAAA,MACA,gBAAAn4B,EAAC+S,IAAA,EACE,UAAAxJ,EAAiB,yCAAyC,EAAA,CAC7D;AAAA,IAAA,EAAA,CACF,EAAA,CACF;AAAA,IACA,gBAAAnJ;AAAA,MAAC8kB;AAAA,MAAA;AAAA,QACC,WAAU;AAAA,QACV,SAAS,MAAM;AACb,UAAIuT,EAA2B,YAASA,EAA2B,UAAU;AAAA,QAC/E;AAAA,QACA,WAAW/V;AAAA,QACX,aAAa,MAAM;;AACjB,UAAI+V,EAA2B,aAASv2B,IAAAq2B,EAAqB,YAArB,QAAAr2B,EAA8B;AAAA,QACxE;AAAA,QAEA,UAAA;AAAA,UAAA,gBAAAlC,EAACulB,IAAA,EACE,UAAAhc,EAAiB,uCAAuC,EAAA,CAC3D;AAAA,4BACCic,IAAA,EAAsB;AAAA,UACvB,gBAAAxlB;AAAA,YAAColB;AAAA,YAAA;AAAA,cACC,SAASsT,MAAuB;AAAA,cAChC,iBAAiB,MAAMC,EAAsB,WAAW;AAAA,cAExD,UAAA,gBAAAv4B,EAAC,OAAA,EAAI,WAAU,wCACb,UAAA;AAAA,gBAAA,gBAAAJ,EAAC,QAAA,EAAM,UAAAuJ,EAAiB,gDAAgD,EAAA,CAAE;AAAA,gBAC1E,gBAAAvJ,EAAC,QAAA,EAAK,WAAU,0BAA0B,UAAAo5B,GAAA,CAAsB;AAAA,cAAA,EAAA,CAClE;AAAA,YAAA;AAAA,UAAA;AAAA,UAEF,gBAAAp5B;AAAA,YAAColB;AAAA,YAAA;AAAA,cACC,SAASsT,MAAuB;AAAA,cAChC,iBAAiB,MAAMC,EAAsB,QAAQ;AAAA,cAErD,UAAA,gBAAAv4B,EAAC,OAAA,EAAI,WAAU,wCACb,UAAA;AAAA,gBAAA,gBAAAJ,EAAC,QAAA,EAAM,UAAAuJ,EAAiB,6CAA6C,EAAA,CAAE;AAAA,gBACvE,gBAAAvJ,EAAC,QAAA,EAAK,WAAU,0BAA0B,UAAAq5B,GAAA,CAAmB;AAAA,cAAA,EAAA,CAC/D;AAAA,YAAA;AAAA,UAAA;AAAA,UAEF,gBAAAr5B;AAAA,YAAColB;AAAA,YAAA;AAAA,cACC,KAAKoT;AAAA,cACL,SAASE,MAAuB;AAAA,cAChC,iBAAiB,MAAMC,EAAsB,QAAQ;AAAA,cACrD,SAAS,CAACxsB,MAAU;;AAClB,gBAAAA,EAAM,gBAAA,GACNssB,EAA2B,UAAU,KACrCv2B,IAAAq2B,EAAqB,YAArB,QAAAr2B,EAA8B;AAAA,cAChC;AAAA,cACA,UAAU,CAACiK,MAAUA,EAAM,eAAA;AAAA,cAE3B,UAAA,gBAAA/L,EAAC,OAAA,EAAI,WAAU,wCACb,UAAA;AAAA,gBAAA,gBAAAJ,EAAC,QAAA,EAAM,UAAAuJ,EAAiB,6CAA6C,EAAA,CAAE;AAAA,gBACvE,gBAAAvJ;AAAA,kBAACg4B;AAAA,kBAAA;AAAA,oBACC,UAAU;AAAA,oBACV,aAAa,CAAC7rB,MAAU;AACtB,sBAAAA,EAAM,gBAAA,GACNwsB,EAAsB,QAAQ,GAC9BF,EAA2B,UAAU;AAAA,oBACvC;AAAA,oBACA,KAAKF;AAAA,oBACL,WAAU;AAAA,oBACV,OAAOK;AAAA,oBACP,WAAW,CAACzsB,MAAU;AACpB,sBAEIA,EAAM,QAAQ,WACdA,EAAM,QAAQ,aACdA,EAAM,QAAQ,eACdA,EAAM,QAAQ,eACdA,EAAM,QAAQ,gBAGhBA,EAAM,gBAAA;AAAA,oBACV;AAAA,oBACA,WAAW;AAAA,oBACX,UAAU,CAACA,MAAU0sB,EAAmB1sB,EAAM,OAAO,KAAK;AAAA,kBAAA;AAAA,gBAAA;AAAA,cAC5D,EAAA,CACF;AAAA,YAAA;AAAA,UAAA;AAAA,QACF;AAAA,MAAA;AAAA,IAAA;AAAA,EACF,GACF;AAEJ;ACrNA,MAAMmtB,KAA8B,CAClCC,GACAhwB,MAEIgwB,MAAa,MAEb,gBAAAn5B,EAAA0N,IAAA,EACE,UAAA;AAAA,EAAA,gBAAA9N,EAACw5B,IAAA,EAAe;AAAA,EAAE;AAAA,EAAEjwB,EAAiB,0CAA0C;AAAA,GACjF,IAIAgwB,MAAa,OAEb,gBAAAn5B,EAAA0N,IAAA,EACE,UAAA;AAAA,EAAA,gBAAA9N,EAACy5B,IAAA,EAAY;AAAA,EAAE;AAAA,EAAElwB,EAAiB,yCAAyC;AAAA,GAC7E,IAKF,gBAAAnJ,EAAA0N,IAAA,EACE,UAAA;AAAA,EAAA,gBAAA9N,EAAC05B,IAAA,EAAQ;AAAA,EAAE;AAAA,EAAEnwB,EAAiB,gDAAgD;AAAA,GAChF,GAIEowB,KAAwB,CAC5BJ,GACAhwB,MACG;AACH,MAAIgwB,MAAa;AACf,WAAOhwB,EAAiB,gDAAgD;AAG1E,MAAIqwB,IAAiBrwB,EAAiB,yCAAyC;AAC/E,SAAIgwB,MAAa,QACfK,IAAiBrwB,EAAiB,0CAA0C,IAGvEqd,GAAwBrd,EAAiB,mCAAmC,KAAK,IAAI;AAAA,IAC1F,UAAUqwB;AAAA,EAAA,CACX;AACH;AAEO,SAASC,GAAqB;AAAA,EACnC,UAAAN;AAAA,EACA,sBAAAO;AAAA,EACA,kBAAAvwB;AAAA,EACA,kBAAAwwB;AACF,GAA8B;AAC5B,2BACGjV,IAAA,EACC,UAAA;AAAA,IAAA,gBAAA9kB,EAAC2S,IAAA,EACC,4BAACE,IAAA,EACC,UAAA;AAAA,MAAA,gBAAA7S,EAAC8S,MAAe,SAAO,IACrB,4BAAC0R,IAAA,EAAoB,SAAO,IAC1B,UAAA,gBAAAxkB,EAAC+D,GAAA,EAAO,SAAQ,WAAU,WAAU,UACjC,UAAAu1B,GAA4BC,GAAUhwB,CAAgB,GACzD,GACF,EAAA,CACF;AAAA,MACA,gBAAAvJ,EAAC+S,MACC,UAAA,gBAAA/S,EAAC,KAAA,EAAG,aAAsBu5B,GAAUhwB,CAAgB,GAAE,EAAA,CACxD;AAAA,IAAA,EAAA,CACF,EAAA,CACF;AAAA,IACA,gBAAAnJ,EAAC8kB,IAAA,EAAoB,WAAU,cAC7B,UAAA;AAAA,MAAA,gBAAAllB,EAACulB,IAAA,EACE,UAAAhc,EAAiB,yCAAyC,EAAA,CAC7D;AAAA,wBACCic,IAAA,EAAsB;AAAA,MACvB,gBAAAplB;AAAA,QAACglB;AAAA,QAAA;AAAA,UACC,UAAUmU,MAAa,OAAO,CAACQ;AAAA,UAC/B,SAASR,MAAa;AAAA,UACtB,iBAAiB,MAAMO,EAAqB,GAAG;AAAA,UAC/C,WAAU;AAAA,UAEV,UAAA;AAAA,YAAA,gBAAA95B,EAAC05B,IAAA,EAAQ;AAAA,YACT,gBAAA15B,EAAC,QAAA,EAAM,UAAAuJ,EAAiB,gDAAgD,EAAA,CAAE;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,MAE5E,gBAAAnJ;AAAA,QAACglB;AAAA,QAAA;AAAA,UACC,UAAUmU,MAAa,OAAO,CAACQ;AAAA,UAC/B,SAASR,MAAa;AAAA,UACtB,iBAAiB,MAAMO,EAAqB,GAAG;AAAA,UAC/C,WAAU;AAAA,UAEV,UAAA;AAAA,YAAA,gBAAA95B,EAACw5B,IAAA,EAAe;AAAA,YAChB,gBAAAx5B,EAAC,QAAA,EAAM,UAAAuJ,EAAiB,0CAA0C,EAAA,CAAE;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,MAEtE,gBAAAnJ;AAAA,QAACglB;AAAA,QAAA;AAAA,UACC,UAAUmU,MAAa,OAAO,CAACQ;AAAA,UAC/B,SAASR,MAAa;AAAA,UACtB,iBAAiB,MAAMO,EAAqB,IAAI;AAAA,UAChD,WAAU;AAAA,UAEV,UAAA;AAAA,YAAA,gBAAA95B,EAACy5B,IAAA,EAAY;AAAA,YACb,gBAAAz5B,EAAC,QAAA,EAAM,UAAAuJ,EAAiB,yCAAyC,EAAA,CAAE;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,IACrE,EAAA,CACF;AAAA,EAAA,GACF;AAEJ;ACrEA,SAASywB,GAA2BC,GAAa;;AAI/C,QAAMC,KAAkBh4B,IAAA+3B,EAAG,eAAH,gBAAA/3B,EAAe;AACvC,EAAIg4B,EAAgB,UACdA,EAAgB,UAAU,SAC5BA,EAAgB,QAAQ,OAGtBA,EAAgB,UAAU,SAC5BA,EAAgB,QAAQ,OAGtBA,EAAgB,UAAU,SAC5BA,EAAgB,QAAQ;AAG9B;AAOA,SAASC,GAA2BF,GAAa;;AAI/C,QAAMC,KAAkBh4B,IAAA+3B,EAAG,eAAH,gBAAA/3B,EAAe;AACvC,EAAIg4B,EAAgB,UACdA,EAAgB,UAAU,SAC5BA,EAAgB,QAAQ,OAGtBA,EAAgB,UAAU,SAC5BA,EAAgB,QAAQ,OAGtBA,EAAgB,UAAU,SAC5BA,EAAgB,QAAQ;AAG9B;AAOA,MAAME,KAAqB;AAAA,EACzB,MAAM;AAAA,EACN,SAAS;AAAA,EACT,SAAS;AAAA,IACP;AAAA,MACE,MAAM;AAAA,IAAA;AAAA,EACR;AAEJ;AAOA,SAAwBC,GAAe;AAAA,EACrC,oBAAAC;AAAA,EACA,SAAAC;AAAA,EACA,QAAAla;AAAA,EACA,SAAAnF;AAAA,EACA,QAAApT;AAAA,EACA,SAAA0yB;AAAA,EACA,eAAAC;AAAA,EACA,kBAAAlxB;AACF,GAAwB;AAGtB,QAAMmxB,IAAYr3B,EAAyB,IAAI,GACzCs3B,IAAkBC,GAAA,GAElB,CAAC1C,GAAY2C,CAAa,IAAIp1B,EAA6B,WAAW,GACtE,CAAC0yB,GAAc2C,CAAe,IAAIr1B,EAAiB,GAAG,GAEtD,CAAC8zB,GAAUwB,CAAW,IAAIt1B,EAAiB,GAAG,GAE9C,CAACs0B,GAAkBiB,CAAmB,IAAIv1B,EAAkB,EAAK,GAGjEoJ,IAAUnL;AAAA,IACd,OAAO;AAAA,MACL,GAAG+2B;AAAA,MACH,mBAAmBA,EAAc,qBAAqB;AAAA,MACtD,eAAe;AAAA,MACf,MAAM,EAAE,GAAIA,EAAc,QAAQQ,GAAA,GAA0B,UAAU,WAAA;AAAA,IAAW;AAAA,IAEnF,CAACR,CAAa;AAAA,EAAA;AAKhB,EAAA9e,EAAU,MAAM;;AACd,KAAAzZ,IAAAw4B,EAAU,YAAV,QAAAx4B,EAAmB;AAAA,EACrB,CAAC,GAGDyZ,EAAU,MAAM;;AACd,QAAIuf;AACJ,UAAMC,IAASZ,KAAA,gBAAAA,EAAS,GAAG;AAC3B,QAAIY,KAAUC,GAAsB,QAAQD,CAAM,GAAG;AACnD,YAAME,KAAYn5B,IAAAi5B,EAAO,OAAO,SAAd,gBAAAj5B,EAAoB;AAEtC,UAAIo5B,IAAuC;AAC3C,MAAID,MAAcjC,KAChBkC,IAAmB,cACVD,MAAchC,KACvBiC,IAAmB,WACVD,KACTP,EAAgBO,CAAS,GAE3BR,EAAcS,CAAgB,GAE9BP,IAAY9B,IAAAkC,EAAO,OAAO,SAAd,gBAAAlC,EAAoB,UAAS,GAAG,GAC5CiC,IAAU,WAAW,MAAM;;AAEzB,SAAAh5B,IAAAw4B,EAAU,YAAV,QAAAx4B,EAAmB,YAAY,CAACi5B,CAAM;AAAA,MACxC,GAAG,CAAC;AAAA,IACN;AAEA,WAAO,MAAM;AACX,MAAID,KACF,aAAaA,CAAO;AAAA,IAExB;AAAA,EACF,GAAG,CAACX,GAASC,CAAO,CAAC;AAErB,QAAMzZ,IAAa7Y,EAAY,MAAM;;AACnC,UAAMqzB,KAAgBtC,KAAA/2B,IAAAw4B,EAAU,YAAV,gBAAAx4B,EAAmB,WAAW,OAA9B,gBAAA+2B,EAAkC,GAAG;AAC3D,IAAIsC,KAAiBH,GAAsB,QAAQG,CAAa,MAC1DA,EAAc,OAAO,SACnBrD,MAAe,WACjBqD,EAAc,OAAO,KAAK,SAASpD,IAEnCoD,EAAc,OAAO,KAAK,SACxBrD,MAAe,cAAckB,KAAwBC,KAG3DhZ,EAAO,CAACkb,CAAa,CAAC;AAAA,EAE1B,GAAG,CAACrD,GAAYC,GAAc9X,CAAM,CAAC,GAE/BoS,IAAa,MAAM;;AACvB,UAAM+I,KAAct5B,IAAAy4B,EAAgB,YAAhB,gBAAAz4B,EAAyB,uBAAuB,gBAAgB;AACpF,IAAIs5B,KAAA,QAAAA,EAAa,eACf,UAAU,UAAU,UAAUA,EAAY,WAAW;AAAA,EAEzD,GAEM1B,IAAuB,CAAC9qB,MAAkB;;AAC9C,IAAA+rB,EAAY/rB,CAAK;AAGjB,UAAMusB,KAAgBtC,KAAA/2B,IAAAw4B,EAAU,YAAV,gBAAAx4B,EAAmB,WAAW,OAA9B,gBAAA+2B,EAAkC,GAAG;AAC3D,QAAIsC,KAAiBH,GAAsB,QAAQG,CAAa,GAAG;AACjE,MAAIA,EAAc,OAAO,SAAMA,EAAc,OAAO,KAAK,QAAQvsB;AAGjE,YAAMysB,KAAetC,KAAAD,IAAAqC,EAAc,OAAO,SAArB,gBAAArC,EAA2B,aAA3B,gBAAAC,EAAqC;AAC1D,MAAII,MAAa,OAAOvqB,MAAU,MAChCysB,KAAA,QAAAA,EAAc,QAAQ,CAACxB,MAAOD,GAA2BC,CAAE,KAClDV,MAAa,OAAOvqB,MAAU,QACvCysB,KAAA,QAAAA,EAAc,QAAQ,CAACxB,MAAOE,GAA2BF,CAAE,MAI7DyB,IAAAhB,EAAU,YAAV,QAAAgB,EAAmB,YAAY,CAACH,GAAe,EAAE,QAAQ,EAAA,CAAG;AAAA,IAC9D;AAAA,EACF,GAEMI,IAAkB,CAACC,MAAa;;AACpC,UAAMT,KAASlC,KAAA/2B,IAAAw4B,EAAU,YAAV,gBAAAx4B,EAAmB,WAAW,OAA9B,gBAAA+2B,EAAkC,GAAG;AACpD,QAAIkC,KAAUC,GAAsB,QAAQD,CAAM,GAAG;AAEnD,MAAIS,EAAI,QAAQ,SAAS,KACvB,WAAW,MAAM;;AAGf,SAAA15B,IAAAw4B,EAAU,YAAV,QAAAx4B,EAAmB,YAAY,CAAC,EAAE,QAAQ,EAAA,GAAK,EAAE,QAAQ,EAAA,CAAG;AAAA,MAC9D,GAAG,CAAC;AAEN,YAAM25B,KAAkB3C,IAAAiC,EAAO,OAAO,SAAd,gBAAAjC,EAAoB,OACtCuC,KAAeC,KAAAvC,IAAAgC,EAAO,OAAO,SAAd,gBAAAhC,EAAoB,aAApB,gBAAAuC,EAA8B;AACnD,MAAKG,KAAiBb,EAAoB,EAAK,GAG7CA;AAAA,QADEa,MAAoB,MAEpB,CAAC,EAACJ,KAAA,QAAAA,EAAc,MAAM,CAACxB,MAAO;;AAC5B,cAAI,GAAC/3B,KAAA+3B,EAAG,eAAH,QAAA/3B,GAAe,MAAM,QAAO;AAIjC,gBAAM45B,MAAY7C,KAAAgB,EAAG,eAAH,gBAAAhB,GAAe,MAAgC;AACjE,iBAAO6C,MAAa,QAAQA,MAAa,QAAQA,MAAa;AAAA,QAChE,MAIA,CAAC,EAACL,KAAA,QAAAA,EAAc,MAAM,CAACxB,MAAO;;AAC5B,cAAI,GAAC/3B,KAAA+3B,EAAG,eAAH,QAAA/3B,GAAe,MAAM,QAAO;AAIjC,gBAAM45B,MAAY7C,KAAAgB,EAAG,eAAH,gBAAAhB,GAAe,MAAgC;AACjE,iBAAO6C,MAAa,QAAQA,MAAa,QAAQA,MAAa;AAAA,QAChE;AAAA,MAXC;AAAA,IAcP;AACE,MAAAd,EAAoB,EAAK;AAAA,EAE7B;AAEA,SACE,gBAAA56B,EAAC,OAAA,EAAI,WAAU,yCACb,UAAA;AAAA,IAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,WACb,UAAA;AAAA,MAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,oBACb,UAAA;AAAA,QAAA,gBAAAJ;AAAA,UAAC65B;AAAA,UAAA;AAAA,YACC,kBAAAE;AAAA,YACA,UAAAR;AAAA,YACA,sBAAAO;AAAA,YACA,kBAAAvwB;AAAA,UAAA;AAAA,QAAA;AAAA,QAEF,gBAAAvJ;AAAA,UAACo4B;AAAA,UAAA;AAAA,YACC,YAAAF;AAAA,YACA,kBAAkB2C;AAAA,YAClB,cAAA1C;AAAA,YACA,oBAAoB2C;AAAA,YACpB,kBAAAvxB;AAAA,UAAA;AAAA,QAAA;AAAA,MACF,GACF;AAAA,MACA,gBAAAnJ,EAAC,OAAA,EAAI,WAAU,6CACb,UAAA;AAAA,QAAA,gBAAAJ,EAAC2S,IAAA,EACC,4BAACE,IAAA,EACC,UAAA;AAAA,UAAA,gBAAA7S,EAAC8S,MAAe,SAAO,IACrB,UAAA,gBAAA9S,EAAC+D,GAAA,EAAO,SAASmX,GAAS,WAAU,iBAAgB,MAAK,QAAO,SAAQ,aACtE,UAAA,gBAAAlb,EAACK,IAAA,CAAA,CAAE,GACL,GACF;AAAA,4BACC0S,IAAA,EACC,UAAA,gBAAA/S,EAAC,OAAG,UAAAuJ,EAAiB,uCAAuC,GAAE,EAAA,CAChE;AAAA,QAAA,EAAA,CACF,EAAA,CACF;AAAA,QACA,gBAAAvJ,EAAC2S,IAAA,EACC,UAAA,gBAAAvS,EAACyS,IAAA,EACC,UAAA;AAAA,UAAA,gBAAA7S,EAAC8S,IAAA,EAAe,SAAO,IACrB,UAAA,gBAAA9S;AAAA,YAAC+D;AAAA,YAAA;AAAA,cACC,SAASgd;AAAA,cACT,WAAU;AAAA,cACV,MAAK;AAAA,cACL,SAAQ;AAAA,cAER,4BAACnd,IAAA,CAAA,CAAM;AAAA,YAAA;AAAA,UAAA,GAEX;AAAA,UACA,gBAAA5D,EAAC+S,IAAA,EACE,UAAAxJ,EAAiB,qCAAqC,EAAA,CACzD;AAAA,QAAA,EAAA,CACF,EAAA,CACF;AAAA,MAAA,EAAA,CACF;AAAA,IAAA,GACF;AAAA,IACA,gBAAAnJ;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,KAAKu6B;AAAA,QACL,WAAU;AAAA,QAEV,UAAA;AAAA,UAAA,gBAAA36B,EAAC,OAAA,EAAI,WAAWs6B,GACd,UAAA,gBAAAt6B;AAAA,YAAC+7B;AAAA,YAAA;AAAA,cACC,SAAAltB;AAAA,cACA,aAAa8sB;AAAA,cACb,YAAYvB;AAAA,cACZ,gBAAgB,MAAM;AAAA,cAAC;AAAA,cACvB,QAAAtyB;AAAA,cACA,KAAK4yB;AAAA,YAAA;AAAA,UAAA,GAET;AAAA,4BACC,OAAA,EAAI,WAAU,sCACb,UAAA,gBAAA16B,EAAC2S,IAAA,EACC,4BAACE,IAAA,EACC,UAAA;AAAA,YAAA,gBAAA7S,EAAC8S,MAAe,SAAO,IACrB,UAAA,gBAAA9S,EAAC+D,GAAA,EAAO,SAAS0uB,GAAY,WAAU,iBAAgB,SAAQ,SAAQ,MAAK,QAC1E,UAAA,gBAAAzyB,EAAC0yB,IAAA,CAAA,CAAK,GACR,GACF;AAAA,8BACC3f,IAAA,EACC,UAAA,gBAAA/S,EAAC,OAAG,UAAAuJ,EAAiB,qCAAqC,GAAE,EAAA,CAC9D;AAAA,UAAA,EAAA,CACF,GACF,EAAA,CACF;AAAA,QAAA;AAAA,MAAA;AAAA,IAAA;AAAA,EACF,GACF;AAEJ;AChWO,MAAMyyB,KAA8B,OAAO,OAAO;AAAA,EACvD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAU;ACbV,SAASC,GAAQC,GAAkC9gB,GAAmC;AACpF,MAAI,CAACA,KAAWA,EAAQ,WAAW,UAAU8gB,KAAgB;AAE7D,QAAMC,IAAc/gB,EAAQ,KAAK,CAACghB,MAAS,OAAOA,KAAS,QAAQ;AACnE,MAAID;AACF,WAAO,OAAOD,KAAgB,SAAS,IAAIC,EAAY,MAAM,GAAG,EAAE,CAAC;AAIrE,QAAME,IACJ,OAAOjhB,EAAQ,CAAC,KAAM,WAAW,eAAgBA,EAAQ,CAAC,EAAE,UAAU;AACxE,SAAO,OAAO8gB,KAAgB,SAAS,IAAIG,CAAW;AACxD;AAEA,SAASC,GACPJ,GACA9gB,GACAmhB,IAAc,IACdC,IAA+C,QAC9B;AACjB,MAAI,CAACphB,KAAWA,EAAQ,WAAW,EAAG;AAEtC,QAAMqhB,IAA4B,CAAA,GAE5BC,IAAgC,CAAA;AACtC,MAAIC,IAA2B,CAAA;AAE/B,SAAAvhB,EAAQ,QAAQ,CAACghB,MAAS;AACxB,IAAI,OAAOA,KAAS,YAAYA,EAAK,WAAW,QAE1CO,EAAQ,SAAS,KAAGD,EAAW,KAAKC,CAAO,GAG/CA,IAAU,CAACP,CAAI,KAEfO,EAAQ,KAAKP,CAAI;AAAA,EAErB,CAAC,GAEGO,EAAQ,SAAS,KAAGD,EAAW,KAAKC,CAAO,GAExCD,EAAW,IAAI,CAACE,GAAMxzB,MAAM;AACjC,UAAMyzB,IAASzzB,MAAMszB,EAAW,SAAS;AACzC,6BACG,KAAA,EACE,UAAA;AAAA,MAAAI,GAAcZ,GAAcU,GAAML,GAAa,IAAME,CAAe;AAAA,MACpEI,KAAUL;AAAA,IAAA,EAAA,GAFLP,GAAQC,GAAcU,CAAI,CAGlC;AAAA,EAEJ,CAAC;AACH;AAEA,SAASE,GACPZ,GACA9gB,GACAmhB,IAAc,IACdQ,IAAoB,IACpBN,IAA4B,IACX;AACjB,MAAI,GAACrhB,KAAWA,EAAQ,WAAW;AAEnC,WAAOA,EAAQ,IAAI,CAAC4hB,MAAiB;AACnC,UAAI,OAAOA,KAAiB,UAAU;AAEpC,cAAMz2B,IAAM,GAAG21B,CAAY,SAASc,EAAa,MAAM,GAAG,EAAE,CAAC;AAC7D,YAAID,GAAmB;AACrB,gBAAME,IAAU/9B,EAAG,QAAQg9B,CAAY,EAAE;AACzC,iBACE,gBAAAl8B,EAAC,QAAA,EAAe,WAAWi9B,GACxB,eADQ12B,CAEX;AAAA,QAEJ;AACA,eACE,gBAAAnG;AAAA,UAAC;AAAA,UAAA;AAAA,YAEC,WAAU;AAAA,YAEV,UAAA;AAAA,cAAA,gBAAAJ,EAACk9B,IAAA,EAAY,WAAU,oCAAA,CAAoC;AAAA,cAC3D,gBAAAl9B,EAAC,UAAM,UAAAg9B,EAAA,CAAa;AAAA,cACpB,gBAAAh9B,EAACk9B,IAAA,EAAY,WAAU,oCAAA,CAAoC;AAAA,YAAA;AAAA,UAAA;AAAA,UALtD32B;AAAA,QAAA;AAAA,MAQX;AAEA,aAAO42B;AAAA,QACLH;AAAA,QACAf,GAAQ,GAAGC,CAAY,KAAKc,EAAa,MAAM,IAAI,CAACA,CAAY,CAAC;AAAA,QACjET;AAAA,QACA,CAAC,GAAGE,GAAiBP,KAAgB,SAAS;AAAA,MAAA;AAAA,IAElD,CAAC;AACH;AAEA,SAASiB,GACPC,GACA72B,GACAg2B,GACAE,IAA4B,CAAA,GACX;AACjB,QAAM,EAAE,QAAAY,MAAWD;AAEnB,2BACG,QAAA,EACE,UAAA;AAAA,IAAAC,IACCd,uBAAgB,QAAA,EAAK,WAAU,UAAU,UAAA,KAAKc,CAAM,KAAI,IAExD,gBAAAr9B;AAAA,MAACk9B;AAAA,MAAA;AAAA,QACC,WAAU;AAAA,QACV,cAAW;AAAA,MAAA;AAAA,IAAA;AAAA,IAGdJ,GAAcO,GAAQD,EAAU,SAASb,GAAa,IAAM;AAAA,MAC3D,GAAGE;AAAA,MACHY,KAAU;AAAA,IAAA,CACX;AAAA,EAAA,EAAA,GAZQ92B,CAaX;AAEJ;AAGO,SAAS+2B,GAAa;AAAA,EAC3B,UAAAC;AAAA,EACA,QAAAC,IAAS;AAAA,EACT,cAAAC;AAAA,EACA,aAAAlB,IAAc;AAChB,GAAsB;AACpB,QAAMmB,IAASD,IAAeA,EAAaF,EAAS,MAAM,IAAIA,EAAS,QACjEI,IAAoBD,MAAWH,EAAS;AAG9C,MAAIK,GACAC,IAAmBN,EAAS;AAEhC,EACE,MAAM,QAAQA,EAAS,OAAO,KAC9BA,EAAS,QAAQ,SAAS,KAC1B,OAAOA,EAAS,QAAQ,CAAC,KAAM,aAC9BA,EAAS,QAAQ,CAAC,EAAE,WAAW,QAAQA,EAAS,QAAQ,CAAC,EAAE,WAAW,UAEvE,CAACK,GAAW,GAAGC,CAAgB,IAAIN,EAAS;AAG9C,QAAMO,IAAkBvB,IACtB,gBAAAv8B,EAAC,QAAA,EAAK,WAAU,UAAU,UAAA,KAAKu9B,EAAS,MAAM,IAAA,CAAI,IAChD,QAEEf,IAAkBD,IACtB,gBAAAv8B,EAAC,QAAA,EAAK,WAAU,UAAU,UAAA,MAAMu9B,EAAS,MAAM,IAAA,CAAI,IACjD,QAEEQ,IAAiBL;AAAA;AAAA,EAGrB,gBAAAt9B,EAAC,UAAK,WAAWlB,EAAG,+BAA+B,EAAE,WAAWy+B,GAAmB,GAChF,UAAA;AAAA,IAAAD;AAAA,IAAQ;AAAA,EAAA,GACX,GAEIM,IAAoBJ,KACxB,gBAAAx9B,EAAA0N,IAAA,EAAG,UAAA;AAAA,IAAAgvB,GAAcS,EAAS,QAAQ,CAACK,CAAS,GAAGrB,GAAa,EAAK;AAAA,IAAE;AAAA,EAAA,GAAC,GAGhE0B,IAAcT,MAAW,eAAe,eAAe,YACvDU,IAAc3B,IAAc,mBAAmB,IAC/C4B,IACJX,MAAW,eAAe,kBAAkB,+CACxCY,IAAcl/B,EAAG++B,GAAaC,CAAW;AAE/C,SACE,gBAAA99B,EAAA0N,IAAA,EACE,UAAA;AAAA,IAAA,gBAAA1N,EAAC,OAAA,EAAI,WAAWlB,EAAG,6DAA6Dk/B,CAAW,GACxF,UAAA;AAAA,MAAAN;AAAA,MACAC;AAAA,IAAA,GACH;AAAA,sBACC,OAAA,EAAI,WAAW7+B,EAAG,6DAA6Dk/B,CAAW,GACxF,UAAAJ,GACH;AAAA,IACA,gBAAAh+B;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,WAAWd;AAAA,UACT;AAAA,UACAi/B;AAAA,UACAC;AAAA,QAAA;AAAA,QAGD,UAAAP,KAAoBA,EAAiB,SAAS,KAC7C,gBAAA79B,EAAA8N,IAAA,EAAG,UAAAwuB,GAAiBiB,EAAS,QAAQM,GAAkBtB,GAAaC,CAAe,EAAA,CAAE;AAAA,MAAA;AAAA,IAAA;AAAA,EAEzF,GACF;AAEJ;AC3LO,SAAS6B,GAAa;AAAA,EAC3B,WAAAx+B;AAAA,EACA,mBAAAyF;AAAA,EACA,WAAAg5B;AAAA,EACA,QAAAd,IAAS;AAAA,EACT,QAAAe;AAAA,EACA,kBAAAC;AAAA,EACA,aAAAjC,IAAc;AAAA,EACd,oBAAAkC,IAAqB;AAAA,EACrB,cAAAhB;AAAA,EACA,oBAAAiB;AACF,GAAsB;AACpB,QAAMC,IAAqBlB,KAAgBmB,GAAwBN,GAAW,MAAS,GACjFO,IAAsB,CAACtB,GAAwB3sB,MAAkB;AACrE,IAAA8tB,KAAA,QAAAA,EAAqBnB,GAAU3sB,GAAO2tB;AAAA,EACxC,GAEMO,IAAsBN,IACxBF,EAAU,UAAU,CAAChsB,MAAMA,MAAMksB,CAAgB,IACjD,IAEE,CAACO,GAAcC,CAAe,IAAIv5B,EAAiBq5B,CAAmB,GAEtEG,IAAwB,CAC5Bz7B,GACA+5B,GACA3sB,MACG;AACH,QAAK0tB,EAAU;AAEf,cAAQ96B,EAAE,KAAA;AAAA,QACR,KAAK;AAAA,QACL,KAAK;AACH,UAAAA,EAAE,eAAA,GACFk7B,KAAA,QAAAA,EAAqBnB,GAAU3sB,GAAO2tB;AACtC;AAAA,MAGA;AAAA,EAEN,GAEMW,IAAoB,CAAC17B,MAA2C;AACpE,QAAK86B,EAAU;AAEf,cAAQ96B,EAAE,KAAA;AAAA,QACR,KAAK;AACH,UAAAA,EAAE,eAAA,GACFw7B,EAAgB,CAAC1hB,MAAS,KAAK,IAAIA,IAAO,GAAGghB,EAAU,SAAS,CAAC,CAAC;AAClE;AAAA,QAEF,KAAK;AACH,UAAA96B,EAAE,eAAA,GACFw7B,EAAgB,CAAC1hB,MAAS,KAAK,IAAIA,IAAO,GAAG,CAAC,CAAC;AAC/C;AAAA,MAGA;AAAA,EAEN,GAEM6hB,IAAU97B,EAAiC,EAAE;AAEnD,SAAAsY,EAAU,MAAM;;AACd,IAAIojB,KAAgB,KAAKA,IAAeI,EAAQ,QAAQ,YACtDj9B,IAAAi9B,EAAQ,QAAQJ,CAAY,MAA5B,QAAA78B,EAA+B;AAAA,EAEnC,GAAG,CAAC68B,CAAY,CAAC,GAQf,gBAAA/+B;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,MAAK;AAAA,MACL,cAAW;AAAA,MACX,UAAU++B,IAAe,IAAI,IAAI;AAAA,MACjC,WAAW7/B,EAAG,gCAAgCW,CAAS;AAAA,MACvD,WAAWq/B;AAAA,MAEX,UAAA,gBAAAl/B;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,WAAWd;AAAA,YACT;AAAA,YACA;AAAA,YACAs+B,MAAW,eACP,+CACA;AAAA,YACJ,CAACiB,KAAsB;AAAA,UAAA;AAAA,UAGxB,UAAAH,EAAU,IAAI,CAACf,GAAU/L,MAAQ;AAChC,kBAAMzuB,IAAaw6B,MAAaiB,GAC1Bj4B,IAAM,GAAGg4B,CAAM,IAAI/M,CAAG;AAC5B,mBACE,gBAAApxB,EAAA0N,IAAA,EACE,UAAA;AAAA,cAAA,gBAAA9N;AAAA,gBAAC;AAAA,gBAAA;AAAA,kBACC,KAAK,CAACgjB,MAAO;AACX,oBAAAmc,EAAQ,QAAQ3N,CAAG,IAAIxO;AAAA,kBACzB;AAAA,kBACA,MAAK;AAAA,kBACL,iBAAejgB;AAAA,kBAEf,eAAaw6B,EAAS;AAAA,kBACtB,cAAYx6B,IAAa,aAAa;AAAA,kBACtC,UAAUyuB,MAAQuN,IAAe,IAAI;AAAA,kBACrC,WAAW7/B;AAAA,oBACT;AAAA,oBACAw/B,KAAsB;AAAA,oBACtB;AAAA,oBACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAMA;AAAA,oBACA;AAAA,oBACAlB,MAAW,eAAe,kBAAkB;AAAA,oBAC5Cl4B;AAAA,kBAAA;AAAA,kBAEF,SAAS,MAAMu5B,EAAoBtB,GAAU/L,CAAG;AAAA,kBAChD,WAAW,CAAChuB,MAAMy7B,EAAsBz7B,GAAG+5B,GAAU/L,CAAG;AAAA,kBAExD,UAAA,gBAAAxxB;AAAA,oBAACs9B;AAAA,oBAAA;AAAA,sBACC,UAAAC;AAAA,sBACA,QAAAC;AAAA,sBACA,cAAc,MAAMmB,EAAmBpB,EAAS,QAAQ/L,CAAG;AAAA,sBAC3D,aAAA+K;AAAA,oBAAA;AAAA,kBAAA;AAAA,gBACF;AAAA,gBA3BKh2B;AAAA,cAAA;AAAA,cA8BNirB,IAAM8M,EAAU,SAAS,KAAKd,MAAW,cACxC,gBAAAx9B,EAAC6jB,IAAA,EAAU,UAAU,IAAI,WAAU,gBAAA,CAAgB;AAAA,YAAA,GAEvD;AAAA,UAEJ,CAAC;AAAA,QAAA;AAAA,MAAA;AAAA,IACH;AAAA,EAAA;AAGN;ACpIA,SAASub,GAAmBC,GAA2B;AACrD,QAAMC,IAAqB,CAAA;AAC3B,MAAIC,IAAY;AAEhB,QAAMC,IAAQ;AACd,MAAIhzB;AAIJ,UAAQA,IAAQgzB,EAAM,KAAKH,CAAI,OAAO;AAEpC,IAAI7yB,EAAM,QAAQ+yB,KAChBD,EAAM,KAAKD,EAAK,UAAUE,GAAW/yB,EAAM,KAAK,CAAC,GAGnD8yB,EAAM,uBAAM,UAAA,EAA0B,UAAA9yB,EAAM,CAAC,EAAA,GAArBA,EAAM,KAAiB,CAAS,GACxD+yB,IAAYC,EAAM;AAIpB,SAAID,IAAYF,EAAK,UACnBC,EAAM,KAAKD,EAAK,UAAUE,CAAS,CAAC,GAG/BD,EAAM,SAAS,IAAIA,IAAQ,CAACD,CAAI;AACzC;AAsBO,SAASI,GAAiB;AAAA,EAC/B,gBAAAC;AAAA,EACA,uBAAAC;AAAA,EACA,kBAAAp2B;AAAA,EACA,kBAAAq2B;AACF,GAA0B;AACxB,QAAMC,IACJt2B,EAAiB,wDAAwD,GACrEu2B,IACJv2B,EAAiB,yDAAyD,GAEtEw2B,IAAyCr8B,EAAQ,MAAM;AAC3D,UAAMs8B,IAA+C,CAAA,GAC/CC,wBAAW,IAAA;AAEjB,WAAAP,EAAe,QAAQ,CAACQ,MAAe;AACrC,YAAM35B,IAAM,GAAG25B,EAAW,UAAU,IAAI,IAAIA,EAAW,UAAU,UAAU,IAAIA,EAAW,UAAU,QAAQ,IAAIA,EAAW,IAAI;AAE/H,MAAKD,EAAK,IAAI15B,CAAG,MACf05B,EAAK,IAAI15B,CAAG,GACZy5B,EAAkB,KAAKE,CAAU;AAAA,IAErC,CAAC,GAEMF;AAAA,EACT,GAAG,CAACN,CAAc,CAAC;AAEnB,SACE,gBAAAt/B,EAAC2tB,IAAA,EAAM,cAAY,IACjB,UAAA;AAAA,IAAA,gBAAA/tB,EAACsuB,IAAA,EAAY,cAAY,IACvB,UAAA,gBAAAluB,EAACivB,IAAA,EACC,UAAA;AAAA,MAAA,gBAAArvB,EAAC2vB,MAAW,UAAAkQ,EAAA,CAAoB;AAAA,MAChC,gBAAA7/B,EAAC2vB,MAAW,UAAAmQ,EAAA,CAAqB;AAAA,IAAA,EAAA,CACnC,EAAA,CACF;AAAA,IACA,gBAAA9/B,EAACuuB,MACE,UAAAwR,EAAY,SAAS,KACpBA,EAAY,IAAI,CAACG,MACf,gBAAA9/B;AAAA,MAACivB;AAAA,MAAA;AAAA,QAIC,SAAS,MAAM;AACb,UAAAsQ,EAAsBO,EAAW,SAAS;AAAA,QAC5C;AAAA,QAEA,UAAA;AAAA,UAAA,gBAAAlgC,EAAC4vB,IAAA,EAAW,UAAA5jB,GAAak0B,EAAW,WAAW,SAAS,GAAE;AAAA,4BACzDtQ,IAAA,EAAU,WAAWgQ,GACnB,UAAAR,GAAmBc,EAAW,IAAI,EAAA,CACrC;AAAA,QAAA;AAAA,MAAA;AAAA,MAVK,GAAGA,EAAW,UAAU,IAAI,IAAIA,EAAW,UAAU,UAAU,IAClEA,EAAW,UAAU,QACvB,IAAIA,EAAW,IAAI;AAAA,IAAA,CAUtB,EAAA,CACL;AAAA,EAAA,GACF;AAEJ;AC5GO,MAAMC,KAAWvgC,EAAM,WAG5B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACogC,GAAkB;AAAA,EAAlB;AAAA,IACC,KAAArgC;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,IAEJ,UAAA,gBAAAE;AAAA,MAACogC,GAAkB;AAAA,MAAlB;AAAA,QACC,WAAWlhC,EAAG,2DAA2D;AAAA,QAEzE,UAAA,gBAAAc,EAAC4D,IAAA,EAAM,WAAU,gBAAA,CAAgB;AAAA,MAAA;AAAA,IAAA;AAAA,EACnC;AACF,CACD;AACDu8B,GAAS,cAAcC,GAAkB,KAAK;ACX9C,MAAMC,KAAiB,CAACC,MAClBA,MAAkB,QACb,gBAAAtgC,EAACugC,IAAA,EAAY,WAAU,wBAAA,CAAwB,IAEpDD,MAAkB,SACb,gBAAAtgC,EAACwgC,IAAA,EAAc,WAAU,wBAAA,CAAwB,IAEnD,gBAAAxgC,EAACygC,IAAA,EAAgB,WAAU,wBAAA,CAAwB,GAS/CC,KAAsB,CAACC,OAC3B;AAAA,EACL,aAAa;AAAA,EACb,YAAY,CAAChS,MAA4BA,EAAI,MAAM,CAAC;AAAA,EACpD,QAAQ,CAAC,EAAE,QAAApC,EAAA,MACT,gBAAAnsB,EAAC2D,GAAA,EAAO,SAAQ,SAAQ,SAAS,MAAMwoB,EAAO,cAAc,MAAS,GAClE,UAAA;AAAA,IAAAoU;AAAA,IACAN,GAAe9T,EAAO,YAAA,CAAa;AAAA,EAAA,EAAA,CACtC;AAAA,IAeOqU,KAAgC,CAC3CC,GACAC,OAEO;AAAA,EACL,aAAa,OAAOA,CAAmB;AAAA,EACvC,YAAY,CAACnS,MAA4BA,EAAI,MAAMmS,CAAmB;AAAA,EACtE,QAAQ,CAAC,EAAE,QAAAvU,EAAA,MACT,gBAAAnsB,EAAC2D,GAAA,EAAO,SAAQ,SAAQ,SAAS,MAAMwoB,EAAO,cAAc,MAAS,GAClE,UAAA;AAAA,IAAAsU;AAAA,IACAR,GAAe9T,EAAO,YAAA,CAAa;AAAA,EAAA,EAAA,CACtC;AAAA,IAYOwU,KAAuB,CAACC,OAC5B;AAAA,EACL,aAAa;AAAA,EACb,QAAQ,CAAC,EAAE,QAAAzU,QACT,gBAAAvsB,EAAC,SAAI,WAAU,0CACb,UAAA,gBAAAI,EAAC2D,GAAA,EAAO,SAAQ,SAAQ,SAAS,MAAMwoB,EAAO,cAAc,MAAS,GAClE,UAAA;AAAA,IAAAyU;AAAA,IACAX,GAAe9T,EAAO,YAAA,CAAa;AAAA,EAAA,EAAA,CACtC,EAAA,CACF;AAAA,EAEF,MAAM,CAAC,EAAE,KAAAoC,QAAU,gBAAA3uB,EAAC,OAAA,EAAI,WAAU,0BAA0B,UAAA2uB,EAAI,SAAS,OAAO,EAAA,CAAE;AAAA,IAchFsS,KAAsB,CAC1BC,GACAC,GACAC,GACAC,GACAC,GACAC,MACG;AACH,MAAIC,IAA6B,CAAC,GAAGJ,CAAa;AAClD,EAAAF,EAAa,QAAQ,CAACj8B,MAAS;AAC7B,IAAIk8B,MAAc,aACXK,EAAiB,SAASv8B,CAAI,KACjCu8B,EAAiB,KAAKv8B,CAAI,IAG5Bu8B,IAAmBA,EAAiB,OAAO,CAACC,MAAcA,MAAcx8B,CAAI;AAAA,EAEhF,CAAC,GACDo8B,EAAsBG,CAAgB;AAEtC,MAAIE,IAA+B,CAAC,GAAGJ,CAAe;AACtD,EAAAJ,EAAa,QAAQ,CAACj8B,MAAS;AAC7B,IAAIk8B,MAAc,eACXO,EAAmB,SAASz8B,CAAI,KACnCy8B,EAAmB,KAAKz8B,CAAI,IAG9By8B,IAAqBA,EAAmB,OAAO,CAACC,MAAmBA,MAAmB18B,CAAI;AAAA,EAE9F,CAAC,GACDs8B,EAAwBG,CAAkB;AAC5C,GAcaE,KAAwB,CACnCC,GACAT,GACAC,GACAC,GACAC,OAEO;AAAA,EACL,aAAa;AAAA,EACb,QAAQ,CAAC,EAAE,QAAAhV,QAEP,gBAAAvsB,EAAC,OAAA,EAAI,WAAU,6BACb,UAAA,gBAAAI,EAAC2D,GAAA,EAAO,SAAQ,SAAQ,SAAS,MAAMwoB,EAAO,cAAc,MAAS,GAClE,UAAA;AAAA,IAAAsV;AAAA,IACAxB,GAAe9T,EAAO,YAAA,CAAa;AAAA,EAAA,EAAA,CACtC,EAAA,CACF;AAAA,EAGJ,MAAM,CAAC,EAAE,KAAAoC,QAAU;AACjB,UAAMmT,IAAiBnT,EAAI,SAAS,QAAQ,GACtC1pB,IAAe0pB,EAAI,SAAS,MAAM;AACxC,6BACGnS,IAAA,EAAY,OAAOslB,GAAQ,SAAQ,WAAU,MAAK,UACjD,UAAA;AAAA,MAAA,gBAAA9hC;AAAA,QAAC0c;AAAA,QAAA;AAAA,UACC,SAAS,CAACvQ,MAAU;AAClB,YAAAA,EAAM,gBAAA,GACN80B;AAAA,cACE,CAACh8B,CAAI;AAAA,cACL;AAAA,cACAm8B;AAAA,cACAC;AAAA,cACAC;AAAA,cACAC;AAAA,YAAA;AAAA,UAEJ;AAAA,UACA,OAAM;AAAA,UAEN,4BAACQ,IAAA,CAAA,CAAgB;AAAA,QAAA;AAAA,MAAA;AAAA,MAEnB,gBAAA/hC;AAAA,QAAC0c;AAAA,QAAA;AAAA,UACC,SAAS,CAACvQ,MAAU;AAClB,YAAAA,EAAM,gBAAA,GACN80B;AAAA,cACE,CAACh8B,CAAI;AAAA,cACL;AAAA,cACAm8B;AAAA,cACAC;AAAA,cACAC;AAAA,cACAC;AAAA,YAAA;AAAA,UAEJ;AAAA,UACA,OAAM;AAAA,UAEN,4BAACS,IAAA,CAAA,CAAY;AAAA,QAAA;AAAA,MAAA;AAAA,MAEf,gBAAAhiC;AAAA,QAAC0c;AAAA,QAAA;AAAA,UACC,SAAS,CAACvQ,MAAU;AAClB,YAAAA,EAAM,gBAAA,GACN80B;AAAA,cACE,CAACh8B,CAAI;AAAA,cACL;AAAA,cACAm8B;AAAA,cACAC;AAAA,cACAC;AAAA,cACAC;AAAA,YAAA;AAAA,UAEJ;AAAA,UACA,OAAM;AAAA,UAEN,4BAACU,IAAA,CAAA,CAAe;AAAA,QAAA;AAAA,MAAA;AAAA,IAClB,GACF;AAAA,EAEJ;AAAA,ICrLSC,KAAmB,CAAC7C,MAExBA,EAAK,MAAM,oCAAoC,GAS3C8C,KAAoB,CAAC9C,MAAqC;AAErE,QAAMG,IAAQ,mBACRhzB,IAAQ6yB,EAAK,MAAMG,CAAK;AAE9B,MAAIhzB;AACF,WAAO,CAACA,EAAM,CAAC;AAGnB,GASa41B,KAAoB,CAAC/C,MAAyB;AAEzD,QAAM7yB,IAAQ6yB,EAAK,MAAM,qBAAqB;AAC9C,SAAI7yB,IACKA,EAAM,CAAC,IAET;AACT,GAUa61B,KAAmB,CAC9Bp9B,GACAm8B,GACAE,MAEIA,EAAgB,SAASr8B,CAAI,IAAU,eACvCm8B,EAAc,SAASn8B,CAAI,IAAU,aAClC,WCrBIq9B,KAAwB,OAAO,OAAO;AAAA,EACjD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAU,GAyBJC,KAAiB,CACrBC,GACAC,GACAC,MACyB;AACzB,MAAIC,IAAyCH;AAE7C,SAAIC,MAAiB,UACnBE,IAAmBA,EAAiB;AAAA,IAClC,CAAC19B,MACEw9B,MAAiB,cAAcx9B,EAAK,WAAW,cAC/Cw9B,MAAiB,gBAAgBx9B,EAAK,WAAW,gBACjDw9B,MAAiB,aAAax9B,EAAK,WAAW;AAAA,EAAA,IAIjDy9B,MAAe,OACjBC,IAAmBA,EAAiB,OAAO,CAAC19B,MAASA,EAAK,MAAM,CAAC,EAAE,SAASy9B,CAAU,CAAC,IAElFC;AACT,GAUMC,KAAsB,CAC1BC,GACAzB,GACAE,MAEOuB,EAAe,IAAI,CAAC59B,MAAS;AAClC,QAAM69B,IAAUC,GAAS99B,EAAK,GAAG,IAAIA,EAAK,MAAMA,EAAK,IAAI,CAAC;AAG1D,SAAO;AAAA,IACL,OAHY89B,GAAS99B,EAAK,GAAG,IAAI,CAACA,EAAK,GAAG,IAAIA,EAAK;AAAA,IAInD,OAAOA,EAAK;AAAA,IACZ,QAAQA,EAAK,UAAUo9B,GAAiBS,GAAS1B,GAAeE,CAAe;AAAA,IAC/E,aAAar8B,EAAK,eAAe,CAAA;AAAA,EAAC;AAEtC,CAAC,GAWG8L,KAAiB,CACrBC,GACAzK,MAEOyK,EAAQzK,CAAG,KAAKA;AA+ClB,SAASy8B,GAAU;AAAA,EACxB,gBAAAH;AAAA,EACA,aAAAI;AAAA,EACA,kBAAA15B;AAAA,EACA,uBAAA25B;AAAA,EACA,eAAA9B;AAAA,EACA,iBAAAE;AAAA,EACA,OAAA6B;AAAA,EACA,eAAAC;AAAA,EACA,SAAApT;AAAA,EACA,IAAA3qB;AAAA,EACA,0BAAAg+B,IAA2B;AAAA,EAC3B,uBAAA7b;AAAA,EACA,gBAAA8b;AACF,GAAmB;AACjB,QAAMC,IAAexyB,GAAexH,GAAkB,yBAAyB,GACzEi6B,IAAoBzyB,GAAexH,GAAkB,8BAA8B,GACnFk6B,IAAsB1yB,GAAexH,GAAkB,gCAAgC,GACvFm6B,IAAmB3yB,GAAexH,GAAkB,6BAA6B,GACjFo6B,IAAgB5yB,GAAexH,GAAkB,uCAAuC,GACxFq6B,IAAmB7yB,GAAexH,GAAkB,mCAAmC,GACvFs6B,IAAiB9yB,GAAexH,GAAkB,iCAAiC,GACnFu6B,IAAa/yB,GAAexH,GAAkB,iCAAiC,GAC/Ew6B,IAA0BhzB;AAAAA,IAC9BxH;AAAA,IACA;AAAA,EAAA,GAEIy6B,IAAgBjzB,GAAexH,GAAkB,gCAAgC,GAEjF,CAAC06B,GAAqBC,CAAsB,IAAIz+B,EAAkB,EAAK,GACvE,CAACg9B,GAAc0B,CAAe,IAAI1+B,EAAuB,KAAK,GAC9D,CAACi9B,GAAY0B,CAAa,IAAI3+B,EAAiB,EAAE,GACjD,CAAC4+B,GAAcC,CAAe,IAAI7+B,EAAmB,CAAA,CAAE,GAEvD8+B,IAAkC7gC,EAAQ,MAAM;AACpD,UAAM8gC,IAAqB3B,KAAkB,CAAA;AAC7C,WAAI2B,EAAmB,WAAW,IAAU,CAAA,IACrC5B,GAAoB4B,GAAoBpD,GAAeE,CAAe;AAAA,EAC/E,GAAG,CAACuB,GAAgBzB,GAAeE,CAAe,CAAC,GAE7CmD,IAAyC/gC,EAAQ,MAAM;AAC3D,QAAIugC,EAAqB,QAAOM;AAEhC,UAAMG,IAAqC,CAAA;AAE3C,WAAAH,EAAU,QAAQ,CAACI,OAAe;AAChC,YAAMC,KAAYD,GAAW,MAAM,CAAC,GAE9BE,KAAgBH,EAAa;AAAA,QACjC,CAACI,OAAkBA,GAAc,MAAM,CAAC,MAAMF;AAAA,MAAA;AAGhD,MAAIC,MACFA,GAAc,SAASF,GAAW,OAClCE,GAAc,cAAcA,GAAc,YAAY,OAAOF,GAAW,WAAW,KAEnFD,EAAa,KAAK;AAAA,QAChB,OAAO,CAACE,EAAS;AAAA,QACjB,OAAOD,GAAW;AAAA,QAClB,aAAaA,GAAW;AAAA,QACxB,QAAQA,GAAW;AAAA,MAAA,CACpB;AAAA,IAEL,CAAC,GAEMD;AAAA,EACT,GAAG,CAACT,GAAqBM,CAAS,CAAC,GAE7BQ,IAA0CrhC,EAAQ,MAClD+gC,EAAiB,WAAW,IAAU,CAAA,IACnClC,GAAekC,GAAkBhC,GAAcC,CAAU,GAC/D,CAAC+B,GAAkBhC,GAAcC,CAAU,CAAC,GAEzCsC,KAA8CthC,EAAQ,MAAM;;AAChE,QAAI,CAACugC,EAAqB,QAAOjU;AAEjC,UAAMiV,KAA0B/iC,KAAAghC,KAAA,gBAAAA,EAAuB,iBAAvB,gBAAAhhC,GAAqC;AACrE,QAAI,CAAC+iC,EAAyB,QAAOjV;AAErC,UAAMkV,KAAqD,CAAA;AAE3D,aAASt0B,KAAQ,GAAGA,KAAQq0B,GAAyBr0B;AACnD,MAAAs0B,GAAkB;AAAA,QAChBtE;AAAA,YACE3H,KAAAiK,KAAA,gBAAAA,EAAuB,iBAAvB,gBAAAjK,GAAsCroB,QAAU;AAAA,UAChDA,KAAQ;AAAA,QAAA;AAAA,MACV;AAIJ,WAAO,CAAC,GAAGs0B,IAAmB,GAAGlV,CAAO;AAAA,EAC1C,GAAG,CAACkT,KAAA,gBAAAA,EAAuB,cAAclT,GAASiU,CAAmB,CAAC;AAEtE,EAAAtoB,EAAU,MAAM;AACd,IAAIopB,EAAkB,WAAW,IAC/BT,EAAgB,CAAA,CAAE,IACTS,EAAkB,WAAW,KACtCT,EAAgBS,EAAkB,CAAC,EAAE,KAAK;AAAA,EAE9C,GAAG,CAACA,CAAiB,CAAC;AAEtB,QAAMI,KAAkB,CACtBxW,GACAtC,OACG;AACH,IAAAA,GAAM,gBAAgB,MAAM;AAC1B,YAAM+Y,KAAkC,CAAA;AACxC,aAAAA,GAAazW,EAAI,KAAK,IAAI,IACnByW;AAAA,IACT,CAAC;AAED,UAAMC,KAAgB1W,EAAI,SAAS;AACnC,IAAA2V,EAAgBe,EAAa,GAGzB/B,KAAkB+B,GAAc,SAAS,KAC3C/B,EAAe+B,GAAc,CAAC,CAAC;AAAA,EAEnC,GAEMC,KAAoB,CAACt2B,MAAkB;AAC3C,QAAIA,MAAU,UAAUA,MAAU,aAAaA,MAAU;AACvD,MAAAo0B,EAAcp0B,CAAK;AAAA;AAEnB,YAAM,IAAI,MAAM,wBAAwBA,CAAK,EAAE;AAAA,EAEnD,GAEMu2B,KAA2B,CAACv2B,MAAkB;AAClD,QAAIA,MAAU,SAASA,MAAU,cAAcA,MAAU,gBAAgBA,MAAU;AACjF,MAAAm1B,EAAgBn1B,CAAK;AAAA;AAErB,YAAM,IAAI,MAAM,gCAAgCA,CAAK,EAAE;AAAA,EAE3D,GAEM0wB,KAA4Ch8B,EAAQ,MAAM;AAC9D,QAAI+gC,EAAiB,WAAW,KAAKJ,EAAa,WAAW,UAAU,CAAA;AACvE,UAAMnE,IAAauE,EAAiB,OAAO,CAACE,OACnCa;AAAA,MACLvB,IAAsBU,GAAW,QAAQ,CAACA,GAAW,MAAM,CAAC,CAAC;AAAA,MAC7DN;AAAA,IAAA,CAEH;AACD,QAAInE,EAAW,SAAS,EAAG,OAAM,IAAI,MAAM,6BAA6B;AACxE,WAAIA,EAAW,WAAW,IAAU,CAAA,IAC7BA,EAAW,CAAC,EAAE;AAAA,EACvB,GAAG,CAACmE,GAAcJ,GAAqBQ,CAAgB,CAAC;AAExD,SACE,gBAAArkC,EAAC,OAAA,EAAI,IAAAiF,GAAQ,WAAU,wCACrB,UAAA;AAAA,IAAA,gBAAAjF,EAAC,OAAA,EAAI,WAAU,4BACb,UAAA;AAAA,MAAA,gBAAAA;AAAA,QAACosB;AAAA,QAAA;AAAA,UACC,eAAe,CAACxd,MAAUu2B,GAAyBv2B,CAAK;AAAA,UACxD,cAAcyzB;AAAA,UAEd,UAAA;AAAA,YAAA,gBAAAziC,EAAC6sB,MAAc,WAAU,UACvB,4BAACF,IAAA,EAAY,aAAY,iBAAgB,EAAA,CAC3C;AAAA,8BACCK,IAAA,EACC,UAAA;AAAA,cAAA,gBAAAhtB,EAACmtB,IAAA,EAAW,OAAM,OAAO,UAAAoW,GAAa;AAAA,cACtC,gBAAAvjC,EAACmtB,IAAA,EAAW,OAAM,YAAY,UAAAqW,GAAkB;AAAA,cAChD,gBAAAxjC,EAACmtB,IAAA,EAAW,OAAM,cAAc,UAAAsW,GAAoB;AAAA,cACpD,gBAAAzjC,EAACmtB,IAAA,EAAW,OAAM,WAAW,UAAAuW,EAAA,CAAiB;AAAA,YAAA,EAAA,CAChD;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,MAEF,gBAAAtjC,EAACosB,MAAO,eAAe,CAACxd,MAAUs2B,GAAkBt2B,CAAK,GAAG,cAAcm0B,GACxE,UAAA;AAAA,QAAA,gBAAAnjC,EAAC6sB,MAAc,WAAU,UACvB,4BAACF,IAAA,EAAY,aAAY,gBAAe,EAAA,CAC1C;AAAA,0BACCK,IAAA,EACC,UAAA;AAAA,UAAA,gBAAAhtB,EAACmtB,IAAA,EAAW,OAAM,QAAQ,UAAAwW,GAAc;AAAA,UACxC,gBAAA3jC,EAACmtB,IAAA,EAAW,OAAM,WAAW,UAAAyW,GAAiB;AAAA,UAC9C,gBAAA5jC,EAACmtB,IAAA,EAAW,OAAM,SAAS,UAAA0W,EAAA,CAAe;AAAA,QAAA,EAAA,CAC5C;AAAA,MAAA,GACF;AAAA,MACA,gBAAA7jC;AAAA,QAACg4B;AAAA,QAAA;AAAA,UACC,WAAU;AAAA,UACV,aAAa8L;AAAA,UACb,OAAOpB;AAAA,UACP,UAAU,CAACv2B,MAAU;AACnB,YAAAi4B,EAAcj4B,EAAM,OAAO,KAAK;AAAA,UAClC;AAAA,QAAA;AAAA,MAAA;AAAA,MAED+2B,KACC,gBAAA9iC,EAAC,OAAA,EAAI,WAAU,0DACb,UAAA;AAAA,QAAA,gBAAAJ;AAAA,UAACmgC;AAAA,UAAA;AAAA,YACC,WAAU;AAAA,YACV,SAAS8D;AAAA,YACT,iBAAiB,CAAC5e,MAAqB;AACrC,cAAA6e,EAAuB7e,CAAO;AAAA,YAChC;AAAA,UAAA;AAAA,QAAA;AAAA,0BAEDjX,IAAA,EAAM,WAAU,gDACd,WAAA80B,KAAA,gBAAAA,EAAuB,iBAAgBa,EAAA,CAC1C;AAAA,MAAA,EAAA,CACF;AAAA,IAAA,GAEJ;AAAA,IACA,gBAAA/jC,EAAC,OAAA,EAAI,WAAU,6DACb,UAAA,gBAAAA;AAAA,MAAC+vB;AAAA,MAAA;AAAA,QACC,SAASiV;AAAA,QACT,MAAMD;AAAA,QACN,mBAAmBI;AAAA,QACnB,cAAY;AAAA,QACZ,WAAW9B;AAAA,QACX,kBAAkBW;AAAA,MAAA;AAAA,IAAA,GAEtB;AAAA,IACCtE,GAAe,SAAS,KACvB,gBAAA1/B,EAAC,OAAA,EAAI,WAAU,6DACb,UAAA,gBAAAA;AAAA,MAACy/B;AAAA,MAAA;AAAA,QACC,kBAAkBjY;AAAA,QAClB,gBAAAkY;AAAA,QACA,uBAAuBuD;AAAA,QACvB,kBAAA15B;AAAA,MAAA;AAAA,IAAA,EACF,CACF;AAAA,EAAA,GAEJ;AAEJ;AC3aO,MAAMk8B,KAA0B,OAAO,OAAO;AAAA,EACnD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAU;AAoCV,SAASC,GAAe,EAAE,MAAAt2B,GAAM,WAAAvP,KAAwD;AAEtF,SAAO,gBAAAG,EADeoP,KAAQu2B,IACtB,EAAc,WAAA9lC,GAAsB,MAAM,GAAA,CAAI;AACxD;AAGO,SAAS+lC,GAAW,EAAE,kBAAAr8B,GAAkB,iBAAAs8B,KAAoC;AACjF,QAAM,CAACC,GAAeC,CAAgB,IAAItgC,EAAiB,EAAE,GAEvDugC,IAAsBtiC,EAAQ,MAAM;AACxC,UAAMlB,IAAQsjC,EAAc,KAAA,EAAO,YAAA;AACnC,WAAKtjC,IAIEqjC,EAAgB;AAAA,MACrB,CAACI,MAAA;;AACC,iBAAA/jC,IAAA+jC,EAAW,WAAX,gBAAA/jC,EAAmB,cAAc,SAASM,OAC1CyjC,EAAW,MAAM,YAAA,EAAc,SAASzjC,CAAK;AAAA;AAAA,IAAA,IANxCqjC;AAAA,EAQX,GAAG,CAACC,GAAeD,CAAe,CAAC;AAEnC,2BACGplC,IAAA,EAAQ,WAAU,UAAS,cAAc,IAAO,MAAI,IACnD,UAAA;AAAA,IAAA,gBAAAT;AAAA,MAACW;AAAA,MAAA;AAAA,QACC,OAAOmlC;AAAA,QACP,eAAe,CAAC92B,MAAU+2B,EAAiB/2B,CAAK;AAAA,QAChD,aAAazF,EAAiB,gCAAgC;AAAA,MAAA;AAAA,IAAA;AAAA,sBAE/D1I,IAAA,EACC,UAAA;AAAA,MAAA,gBAAAb,EAACc,IAAA,EAAc,UAAAyI,EAAiB,wBAAwB,EAAA,CAAE;AAAA,MAC1D,gBAAAvJ,EAACe,IAAA,EACE,UAAAilC,EAAoB,IAAI,CAAC/gC;;AACxB,+BAAA7E;AAAA,UAACa;AAAA,UAAA;AAAA,YACC,WAAU;AAAA,YACV,UAAUgE,EAAK,gBAAgBA,EAAK;AAAA,YACpC,UAAUA,EAAK;AAAA,YAGf,UAAA;AAAA,cAAA,gBAAAjF,EAAC,OAAA,EAAI,WAAU,UACZ,UAAAiF,EAAK,SACJ,gBAAAjF,EAAC,QAAA,EAAK,WAAU,cAAc,UAAAiF,EAAK,QAAO,IAE1C,gBAAAjF,EAAC,SACC,UAAA,gBAAAA,EAAC0lC,IAAA,EAAe,MAAMzgC,EAAK,KAAA,CAAM,GACnC,EAAA,CAEJ;AAAA,gCACC,OAAA,EACC,UAAA;AAAA,gBAAA,gBAAAjF,EAAC,KAAA,EAAE,WAAU,cAAc,UAAAiF,EAAK,OAAM;AAAA,gBACrCA,EAAK,YACJ,gBAAAjF,EAAC,OAAE,WAAU,uCAAuC,YAAK,SAAA,CAAS;AAAA,cAAA,GAEtE;AAAA,eACEiF,EAAK,gBAAgBA,EAAK,mCACzB/D,IAAA,EAAgB,WAAU,gBACxB,UAAA+D,EAAK,eACFsE,EAAiB,+BAA+B,IAChDA,EAAiB,+BAA+B,EAAA,CACtD;AAAA,YAAA;AAAA,UAAA;AAAA,UAtBG,QAAQtE,EAAK,YAAU/C,IAAA+C,EAAK,SAAL,gBAAA/C,EAAW,KAAI,IAAI+C,EAAK,MAAM,WAAW,KAAK,EAAE,CAAC;AAAA,QAAA;AAAA,OAyBhF,EAAA,CACH;AAAA,IAAA,EAAA,CACF;AAAA,EAAA,GACF;AAEJ;ACtGA,MAAMihC,KAAgB,SAChBC,KAAqB,QAerBC,KAAiBxmC,EAAM,cAA+C,MAAS;AAGrF,SAASymC,KAAa;AACpB,QAAMxrB,IAAUjb,EAAM,WAAWwmC,EAAc;AAC/C,MAAI,CAACvrB;AACH,UAAM,IAAI,MAAM,mDAAmD;AAGrE,SAAOA;AACT;AAOA,MAAMyrB,KAAkB1mC,EAAM;AAAA,EAa5B,CACE;AAAA,IACE,aAAA2mC,IAAc;AAAA,IACd,MAAMC;AAAA,IACN,cAAcC;AAAA,IACd,WAAA5mC;AAAA,IACA,OAAA6mC;AAAA,IACA,UAAAxmC;AAAA,IACA,MAAAymC,IAAO;AAAA,IACP,GAAG7mC;AAAA,EAAA,GAELC,MACG;AAIH,UAAM,CAAC6mC,GAAOC,CAAQ,IAAIjnC,EAAM,SAAS2mC,CAAW,GAC9ChhC,IAASihC,KAAYI,GACrBh3B,IAAUhQ,EAAM;AAAA,MACpB,CAACoP,MAAmD;AAClD,cAAM83B,IAAY,OAAO93B,KAAU,aAAaA,EAAMzJ,CAAM,IAAIyJ;AAChE,QAAIy3B,IACFA,EAAYK,CAAS,IAErBD,EAASC,CAAS;AAAA,MAEtB;AAAA,MACA,CAACL,GAAalhC,CAAM;AAAA,IAAA,GAIhBwhC,IAAgBnnC,EAAM,YAAY,MAC/BgQ,EAAQ,CAACD,MAAS,CAACA,CAAI,GAC7B,CAACC,CAAO,CAAC,GAkBNo3B,IAAQzhC,IAAS,aAAa,aAI9B0hC,IAFiB3nC,GAAA,MAEY,QAAQqnC,IADhBA,MAAS,YAAY,cAAc,WAGxDhsB,IAAe/a,EAAM;AAAA,MACzB,OAAO;AAAA,QACL,OAAAonC;AAAA,QACA,MAAMzhC;AAAA,QACN,SAAAqK;AAAA,QACA,eAAAm3B;AAAA,QACA,MAAME;AAAA,MAAA;AAAA,MAER,CAACD,GAAOzhC,GAAQqK,GAASm3B,GAAeE,CAAkB;AAAA,IAAA;AAG5D,WACE,gBAAAjnC,EAAComC,GAAe,UAAf,EAAwB,OAAOzrB,GAC9B,UAAA,gBAAA3a,EAAC2S,IAAA,EAAgB,eAAe,GAC9B,UAAA,gBAAA3S;AAAA,MAAC;AAAA,MAAA;AAAA,QACC;AAAA;AAAA,UAEE;AAAA,YACE,mBAAmBkmC;AAAA,YACnB,wBAAwBC;AAAA,YACxB,GAAGO;AAAA,UAAA;AAAA;AAAA,QAGP,WAAWxnC;AAAA;AAAA,UAET;AAAA,UACAW;AAAA,QAAA;AAAA,QAEF,KAAAE;AAAA,QACC,GAAGD;AAAA,QAEH,UAAAI;AAAA,MAAA;AAAA,IAAA,GAEL,EAAA,CACF;AAAA,EAEJ;AACF;AACAomC,GAAgB,cAAc;AAG9B,MAAMY,KAAUtnC,EAAM,WAMpB,CAAC,EAAE,SAAAoE,IAAU,WAAW,aAAAmjC,IAAc,aAAa,WAAAtnC,GAAW,UAAAK,GAAU,GAAGJ,EAAA,GAASC,MAAQ;AAC5F,QAAM8a,IAAUwrB,GAAA;AAEhB,SAAIc,MAAgB,SAEhB,gBAAAnnC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWd;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAEF,KAAAE;AAAA,MACC,GAAGD;AAAA,MAEH,UAAAI;AAAA,IAAA;AAAA,EAAA,IAML,gBAAAE;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAL;AAAA,MACA,WAAU;AAAA,MACV,cAAY8a,EAAQ;AAAA,MACpB,oBAAkBA,EAAQ,UAAU,cAAcssB,IAAc;AAAA,MAChE,gBAAcnjC;AAAA,MACd,aAAW6W,EAAQ;AAAA,MAGnB,UAAA;AAAA,QAAA,gBAAA7a;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAWd;AAAA,cACT;AAAA,cACA;AAAA,cACA;AAAA,cACA8E,MAAY,cAAcA,MAAY,UAClC,4FACA;AAAA,YAAA;AAAA,UACN;AAAA,QAAA;AAAA,QAEF,gBAAAhE;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAWd;AAAA;AAAA,cAET;AAAA,cACA2b,EAAQ,SAAS,YACb,yFACA;AAAA;AAAA,cAEJ7W,MAAY,cAAcA,MAAY,UAClC,wGACA;AAAA,cACJnE;AAAA,YAAA;AAAA,YAED,GAAGC;AAAA,YAEJ,UAAA,gBAAAE;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,gBAAa;AAAA,gBACb,WAAU;AAAA,gBAET,UAAAE;AAAA,cAAA;AAAA,YAAA;AAAA,UACH;AAAA,QAAA;AAAA,MACF;AAAA,IAAA;AAAA,EAAA;AAGN,CAAC;AACDgnC,GAAQ,cAAc;AAGtB,MAAME,KAAiBxnC,EAAM,WAG3B,CAAC,EAAE,WAAAC,GAAW,SAAA2N,GAAS,GAAG1N,EAAA,GAASC,MAAQ;AAC3C,QAAM8a,IAAUwrB,GAAA;AAEhB,SACE,gBAAAjmC;AAAA,IAAC2D;AAAA,IAAA;AAAA,MACC,KAAAhE;AAAA,MACA,gBAAa;AAAA,MACb,SAAQ;AAAA,MACR,MAAK;AAAA,MACL,WAAWb,EAAG,iBAAiBW,CAAS;AAAA,MACxC,SAAS,CAACsM,MAAU;AAClB,QAAAqB,KAAA,QAAAA,EAAUrB,IACV0O,EAAQ,cAAA;AAAA,MACV;AAAA,MACC,GAAG/a;AAAA,MAEH,UAAA;AAAA,QAAA+a,EAAQ,SAAS,YAAY,gBAAA7a,EAACqnC,IAAA,CAAA,CAAU,sBAAMC,IAAA,EAAW;AAAA,QAC1D,gBAAAtnC,EAAC,QAAA,EAAK,WAAU,cAAa,UAAA,iBAAA,CAAc;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGjD,CAAC;AACDonC,GAAe,cAAc;AAG7B,MAAMG,KAAc3nC,EAAM;AAAA,EACxB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAAQ;AAChC,UAAM,EAAE,eAAAgnC,EAAA,IAAkBV,GAAA;AAE1B,WACE,gBAAArmC;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,MAAK;AAAA,QACL,KAAAD;AAAA,QACA,gBAAa;AAAA,QACb,cAAW;AAAA,QACX,UAAU;AAAA,QACV,SAASgnC;AAAA,QACT,OAAM;AAAA,QACN,WAAW7nC;AAAA,UACT;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACAW;AAAA,QAAA;AAAA,QAED,GAAGC;AAAA,MAAA;AAAA,IAAA;AAAA,EAGV;AACF;AACAynC,GAAY,cAAc;AAG1B,MAAMC,KAAe5nC,EAAM;AAAA,EACzB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAEtB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,WAAWb;AAAA;AAAA,QAET;AAAA,QACA;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA;AAIZ;AACA0nC,GAAa,cAAc;AAG3B,MAAMC,KAAe7nC,EAAM,WAGzB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAExB,gBAAAC;AAAA,EAACg4B;AAAA,EAAA;AAAA,IACC,KAAAj4B;AAAA,IACA,gBAAa;AAAA,IACb,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AAAA,CAGT;AACD2nC,GAAa,cAAc;AAG3B,MAAMC,KAAgB9nC,EAAM;AAAA,EAC1B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAEtB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,gBAAa;AAAA,MACb,WAAWb,EAAG,uCAAuCW,CAAS;AAAA,MAC7D,GAAGC;AAAA,IAAA;AAAA,EAAA;AAIZ;AACA4nC,GAAc,cAAc;AAG5B,MAAMC,KAAgB/nC,EAAM;AAAA,EAC1B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAEtB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,gBAAa;AAAA,MACb,WAAWb,EAAG,uCAAuCW,CAAS;AAAA,MAC7D,GAAGC;AAAA,IAAA;AAAA,EAAA;AAIZ;AACA6nC,GAAc,cAAc;AAG5B,MAAMC,KAAmBhoC,EAAM,WAG7B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAExB,gBAAAC;AAAA,EAAC6jB;AAAA,EAAA;AAAA,IACC,KAAA9jB;AAAA,IACA,gBAAa;AAAA,IACb,WAAWb,EAAG,0CAA0CW,CAAS;AAAA,IAChE,GAAGC;AAAA,EAAA;AAAA,CAGT;AACD8nC,GAAiB,cAAc;AAG/B,MAAMC,KAAiBjoC,EAAM;AAAA,EAC3B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAEtB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,gBAAa;AAAA,MACb,WAAWb;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA;AAIZ;AACA+nC,GAAe,cAAc;AAG7B,MAAMC,KAAeloC,EAAM;AAAA,EACzB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAEtB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,gBAAa;AAAA,MACb,WAAWb,EAAG,+DAA+DW,CAAS;AAAA,MACrF,GAAGC;AAAA,IAAA;AAAA,EAAA;AAIZ;AACAgoC,GAAa,cAAc;AAG3B,MAAMC,KAAoBnoC,EAAM,WAG9B,CAAC,EAAE,WAAAC,GAAW,SAAAqE,IAAU,IAAO,GAAGpE,EAAA,GAASC,MAIzC,gBAAAC;AAAA,EAHWkE,IAAUC,KAAO;AAAA,EAG3B;AAAA,IACC,KAAApE;AAAA,IACA,gBAAa;AAAA,IACb,WAAWb;AAAA,MACT;AAAA,MACA;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AAAA,CAGT;AACDioC,GAAkB,cAAc;AAGhC,MAAMC,KAAqBpoC,EAAM,WAG/B,CAAC,EAAE,WAAAC,GAAW,SAAAqE,IAAU,IAAO,GAAGpE,EAAA,GAASC,MAIzC,gBAAAC;AAAA,EAHWkE,IAAUC,KAAO;AAAA,EAG3B;AAAA,IACC,KAAApE;AAAA,IACA,gBAAa;AAAA,IACb,WAAWb;AAAA,MACT;AAAA;AAAA,MAEA;AAAA,MACA;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AAAA,CAGT;AACDkoC,GAAmB,cAAc;AAGjC,MAAMC,KAAsBroC,EAAM;AAAA,EAChC,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,gBAAa;AAAA,MACb,WAAWb,EAAG,wBAAwBW,CAAS;AAAA,MAC9C,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACAmoC,GAAoB,cAAc;AAGlC,MAAMC,KAActoC,EAAM;AAAA,EACxB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,gBAAa;AAAA,MACb,WAAWb,EAAG,qDAAqDW,CAAS;AAAA,MAC3E,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACAooC,GAAY,cAAc;AAG1B,MAAMC,KAAkBvoC,EAAM;AAAA,EAC5B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,gBAAa;AAAA,MACb,WAAWb,EAAG,kCAAkCW,CAAS;AAAA,MACxD,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACAqoC,GAAgB,cAAc;AAE9B,MAAMC,KAA4BtkC;AAAA,EAChC;AAAA,EACA;AAAA,IACE,UAAU;AAAA,MACR,SAAS;AAAA,QACP,SAAS;AAAA,QACT,SACE;AAAA,MAAA;AAAA,MAEJ,MAAM;AAAA,QACJ,SAAS;AAAA,QACT,IAAI;AAAA,QACJ,IAAI;AAAA,MAAA;AAAA,IACN;AAAA,IAEF,iBAAiB;AAAA,MACf,SAAS;AAAA,MACT,MAAM;AAAA,IAAA;AAAA,EACR;AAEJ,GAGMukC,KAAoBzoC,EAAM;AAAA,EAQ9B,CACE;AAAA,IACE,SAAAsE,IAAU;AAAA,IACV,UAAAokC,IAAW;AAAA,IACX,SAAAtkC,IAAU;AAAA,IACV,MAAAC,IAAO;AAAA,IACP,SAAAskC;AAAA,IACA,WAAA1oC;AAAA,IACA,GAAGC;AAAA,EAAA,GAELC,MACG;AACH,UAAMyoC,IAAOtkC,IAAUC,KAAO,UACxB,EAAE,OAAA6iC,EAAA,IAAUX,GAAA,GAEZoC,IACJ,gBAAAzoC;AAAA,MAACwoC;AAAA,MAAA;AAAA,QACC,KAAAzoC;AAAA,QACA,gBAAa;AAAA,QACb,aAAWkE;AAAA,QACX,eAAaqkC;AAAA,QACb,WAAWppC,EAAGkpC,GAA0B,EAAE,SAAApkC,GAAS,MAAAC,EAAA,CAAM,GAAGpE,CAAS;AAAA,QACpE,GAAGC;AAAA,MAAA;AAAA,IAAA;AAIR,WAAKyoC,KAID,OAAOA,KAAY,aAErBA,IAAU;AAAA,MACR,UAAUA;AAAA,IAAA,sBAKX11B,IAAA,EACC,UAAA;AAAA,MAAA,gBAAA7S,EAAC8S,IAAA,EAAe,SAAO,IAAE,UAAA21B,GAAO;AAAA,MAChC,gBAAAzoC,EAAC+S,IAAA,EAAe,MAAK,SAAQ,OAAM,UAAS,QAAQi0B,MAAU,aAAc,GAAGuB,EAAA,CAAS;AAAA,IAAA,GAC1F,KAdOE;AAAA,EAgBX;AACF;AACAJ,GAAkB,cAAc;AAGhC,MAAMK,KAAoB9oC,EAAM,WAM9B,CAAC,EAAE,WAAAC,GAAW,SAAAqE,IAAU,IAAO,aAAAykC,IAAc,IAAO,GAAG7oC,EAAA,GAASC,MAI9D,gBAAAC;AAAA,EAHWkE,IAAUC,KAAO;AAAA,EAG3B;AAAA,IACC,KAAApE;AAAA,IACA,gBAAa;AAAA,IACb,WAAWb;AAAA,MACT;AAAA;AAAA,MAEA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACAypC,KACE;AAAA,MACF9oC;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AAAA,CAGT;AACD4oC,GAAkB,cAAc;AAGhC,MAAME,KAAmBhpC,EAAM;AAAA,EAC7B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,gBAAa;AAAA,MACb,WAAWb;AAAA,QACT;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACA8oC,GAAiB,cAAc;AAG/B,MAAMC,KAAsBjpC,EAAM,WAKhC,CAAC,EAAE,WAAAC,GAAW,UAAAipC,IAAW,IAAO,GAAGhpC,EAAA,GAASC,MAAQ;AAEpD,QAAMgpC,IAAQnpC,EAAM,QAAQ,MACnB,GAAG,KAAK,MAAM,KAAK,WAAW,EAAE,IAAI,EAAE,KAC5C,CAAA,CAAE;AAEL,SACE,gBAAAQ;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAL;AAAA,MACA,gBAAa;AAAA,MACb,WAAWb,EAAG,iEAAiEW,CAAS;AAAA,MACvF,GAAGC;AAAA,MAEH,UAAA;AAAA,QAAAgpC,KACC,gBAAA9oC,EAAC8vB,IAAA,EAAS,WAAU,2BAA0B,gBAAa,sBAAqB;AAAA,QAElF,gBAAA9vB;AAAA,UAAC8vB;AAAA,UAAA;AAAA,YACC,WAAU;AAAA,YACV,gBAAa;AAAA,YACb;AAAA;AAAA,cAEE;AAAA,gBACE,oBAAoBiZ;AAAA,cAAA;AAAA;AAAA,UACtB;AAAA,QAAA;AAAA,MAEJ;AAAA,IAAA;AAAA,EAAA;AAGN,CAAC;AACDF,GAAoB,cAAc;AAGlC,MAAMG,KAAiBppC,EAAM;AAAA,EAC3B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,gBAAa;AAAA,MACb,WAAWb;AAAA,QACT;AAAA,QACA;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACAkpC,GAAe,cAAc;AAG7B,MAAMC,KAAqBrpC,EAAM;AAAA,EAC/B,CAAC,EAAE,GAAGE,EAAA,GAASC,MAAQ,gBAAAC,EAAC,MAAA,EAAG,KAAAD,GAAW,GAAGD,EAAA,CAAO;AAClD;AACAmpC,GAAmB,cAAc;AAGjC,MAAMC,KAAuBtpC,EAAM,WAOjC,CAAC,EAAE,SAAAsE,IAAU,IAAO,MAAAD,IAAO,MAAM,UAAAqkC,GAAU,WAAAzoC,GAAW,GAAGC,EAAA,GAASC,MAIhE,gBAAAC;AAAA,EAHWkE,IAAUC,KAAO;AAAA,EAG3B;AAAA,IACC,KAAApE;AAAA,IACA,gBAAa;AAAA,IACb,aAAWkE;AAAA,IACX,eAAaqkC;AAAA,IACb,WAAWppC;AAAA,MACT;AAAA,MACA;AAAA,MACA+E,MAAS,QAAQ;AAAA,MACjBA,MAAS,QAAQ;AAAA,MACjB;AAAA,MACApE;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AAAA,CAGT;AACDopC,GAAqB,cAAc;ACnpB5B,SAASC,GAAgB;AAAA,EAC9B,IAAA9jC;AAAA,EACA,iBAAA+jC;AAAA,EACA,aAAAC;AAAA,EACA,yBAAAC;AAAA,EACA,qBAAAC;AAAA,EACA,6BAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,uBAAAC;AAAA,EACA,WAAA7pC;AACF,GAAyB;AACvB,QAAM8pC,IAAmBzhC;AAAA,IACvB,CAACjD,GAAc2kC,MAAuB;AACpC,MAAAN,EAAwBrkC,GAAM2kC,CAAS;AAAA,IACzC;AAAA,IACA,CAACN,CAAuB;AAAA,EAAA,GAGpBO,IAA8B3hC;AAAA,IAClC,CAAC0hC,MAAsB;AACrB,YAAME,IAAUT,EAAY,KAAK,CAACr1B,MAASA,EAAK,cAAc41B,CAAS;AACvE,aAAOE,IAAUA,EAAQ,cAAcF;AAAA,IACzC;AAAA,IACA,CAACP,CAAW;AAAA,EAAA,GAGRU,IAA0C7hC;AAAA,IAC9C,CAACqV,MAAkB,CAACgsB,EAAoB,aAAahsB,MAAUgsB,EAAoB;AAAA,IACnF,CAACA,CAAmB;AAAA,EAAA;AAGtB,SACE,gBAAAvpC;AAAA,IAACknC;AAAA,IAAA;AAAA,MACC,IAAA7hC;AAAA,MACA,aAAY;AAAA,MACZ,SAAQ;AAAA,MACR,WAAWnG,EAAG,uCAAuCW,CAAS;AAAA,MAE9D,4BAACgoC,IAAA,EACC,UAAA;AAAA,QAAA,gBAAAznC,EAAC0nC,IAAA,EACC,UAAA;AAAA,UAAA,gBAAA9nC,EAAC+nC,IAAA,EAAkB,WAAU,cAC1B,UAAAyB,GACH;AAAA,UACA,gBAAAxpC,EAACioC,IAAA,EACC,UAAA,gBAAAjoC,EAACkoC,IAAA,EACE,iBAAO,QAAQkB,CAAe,EAAE,IAAI,CAAC,CAAC7iC,GAAKgX,CAAK,wBAC9C4qB,IAAA,EACC,UAAA,gBAAAnoC;AAAA,YAACqoC;AAAA,YAAA;AAAA,cACC,SAAS,MAAMsB,EAAiBpjC,CAAG;AAAA,cACnC,UAAUwjC,EAAYxjC,CAAG;AAAA,cAEzB,UAAA,gBAAAvG,EAAC,QAAA,EAAK,WAAU,WAAW,UAAAud,EAAA,CAAM;AAAA,YAAA;AAAA,UAAA,KALfhX,CAOtB,CACD,EAAA,CACH,EAAA,CACF;AAAA,QAAA,GACF;AAAA,0BACCuhC,IAAA,EACC,UAAA;AAAA,UAAA,gBAAA9nC,EAAC+nC,IAAA,EAAkB,WAAU,cAAc,UAAA0B,GAA0B;AAAA,UACrE,gBAAAzpC,EAACioC,IAAA,EAAoB,WAAU,WAC7B,UAAA,gBAAAjoC;AAAA,YAAC4O;AAAA,YAAA;AAAA,cACC,eAAc;AAAA,cACd,iBAAiB1P,EAAG,aAAa;AAAA,gBAC/B,0DACEqqC,KAAA,gBAAAA,EAAqB;AAAA,cAAA,CACxB;AAAA,cACD,yBAAwB;AAAA,cACxB,SAASF,EAAY,QAAQ,CAACr1B,MAASA,EAAK,SAAS;AAAA,cACrD,gBAAgB61B;AAAA,cAChB,mBAAmBH;AAAA,cACnB,UAAU,CAACE,MAAsB;AAC/B,sBAAMI,IAAsBH,EAA4BD,CAAS;AACjE,gBAAAD,EAAiBK,GAAqBJ,CAAS;AAAA,cACjD;AAAA,cACA,QAAOL,KAAA,gBAAAA,EAAqB,cAAa;AAAA,cACzC,wBAAOU,IAAA,CAAA,CAAW;AAAA,YAAA;AAAA,UAAA,EACpB,CACF;AAAA,QAAA,EAAA,CACF;AAAA,MAAA,EAAA,CACF;AAAA,IAAA;AAAA,EAAA;AAGN;AC5FO,MAAMC,KAAYpnC;AAAA,EACvB,CAAC,EAAE,OAAAkM,GAAO,UAAAm7B,GAAU,aAAAlwB,GAAa,aAAAmwB,GAAa,WAAAvqC,GAAW,YAAA6P,IAAa,IAAO,IAAArK,EAAA,GAAMglC,MAAa;AAC9F,UAAMlqC,IAAiBb,GAAA;AAEvB,WACE,gBAAAc,EAAC,OAAA,EAAI,IAAAiF,GAAQ,WAAWnG,EAAG,eAAe,EAAE,aAAakrC,EAAA,GAAevqC,CAAS,GAC/E,UAAA;AAAA,MAAA,gBAAAG;AAAA,QAACY;AAAA,QAAA;AAAA,UACC,WAAW1B;AAAA,YACT;AAAA,YACA,EAAE,cAAciB,MAAQ,MAAA;AAAA,YACxB,EAAE,aAAaA,MAAQ,MAAA;AAAA,UAAM;AAAA,QAC/B;AAAA,MAAA;AAAA,MAEF,gBAAAH;AAAA,QAACg4B;AAAA,QAAA;AAAA,UACC,KAAKqS;AAAA,UACL,WAAU;AAAA,UACV,aAAApwB;AAAA,UACA,OAAAjL;AAAA,UACA,UAAU,CAACxL,MAAM2mC,EAAS3mC,EAAE,OAAO,KAAK;AAAA,UACxC,UAAUkM;AAAA,QAAA;AAAA,MAAA;AAAA,MAEXV,KACC,gBAAA5O;AAAA,QAAC2D;AAAA,QAAA;AAAA,UACC,SAAQ;AAAA,UACR,MAAK;AAAA,UACL,WAAW7E;AAAA,YACT;AAAA,YACA,EAAE,aAAaiB,MAAQ,MAAA;AAAA,YACvB,EAAE,cAAcA,MAAQ,MAAA;AAAA,UAAM;AAAA,UAEhC,SAAS,MAAM;AACb,YAAAgqC,EAAS,EAAE;AAAA,UACb;AAAA,UAEA,UAAA;AAAA,YAAA,gBAAAnqC,EAACK,IAAA,EAAE,WAAU,gBAAA,CAAgB;AAAA,YAC7B,gBAAAL,EAAC,QAAA,EAAK,WAAU,cAAa,UAAA,QAAA,CAAK;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,IACpC,GAEJ;AAAA,EAEJ;AACF;AAEAkqC,GAAU,cAAc;ACvEjB,SAASI,GAA6B;AAAA,EAC3C,IAAAjlC;AAAA,EACA,iBAAA+jC;AAAA,EACA,aAAAC;AAAA,EACA,UAAAnpC;AAAA,EACA,yBAAAopC;AAAA,EACA,qBAAAC;AAAA,EACA,aAAAgB;AAAA,EACA,UAAAJ;AAAA,EACA,6BAAAX;AAAA,EACA,2BAAAC;AAAA,EACA,uBAAAC;AACF,GAAsC;AACpC,SACE,gBAAAtpC,EAAC,OAAA,EAAI,WAAU,+CACb,UAAA;AAAA,IAAA,gBAAAJ,EAAC,OAAA,EAAI,WAAU,mEACb,UAAA,gBAAAA;AAAA,MAACkqC;AAAA,MAAA;AAAA,QACC,WAAU;AAAA,QACV,OAAOK;AAAA,QACP,UAAAJ;AAAA,QACA,aAAY;AAAA,MAAA;AAAA,IAAA,GAEhB;AAAA,IACA,gBAAA/pC;AAAA,MAACkmC;AAAA,MAAA;AAAA,QACC,IAAAjhC;AAAA,QACA,WAAU;AAAA,QAEV,UAAA;AAAA,UAAA,gBAAArF;AAAA,YAACmpC;AAAA,YAAA;AAAA,cACC,WAAU;AAAA,cACV,iBAAAC;AAAA,cACA,aAAAC;AAAA,cACA,yBAAAC;AAAA,cACA,qBAAAC;AAAA,cACA,6BAAAC;AAAA,cACA,2BAAAC;AAAA,cACA,uBAAAC;AAAA,YAAA;AAAA,UAAA;AAAA,UAEF,gBAAA1pC,EAACwnC,IAAA,EAAa,WAAU,oBAAoB,UAAAtnC,EAAA,CAAS;AAAA,QAAA;AAAA,MAAA;AAAA,IAAA;AAAA,EACvD,GACF;AAEJ;AC0CA,MAAMsqC,KAAe,WACfC,KAAc,UACdC,KAAY,UACZC,KAAe,WAEfC,KAA0B,uBAC1BC,KAA0B,kBAC1BC,KAAwB,QACxBC,KAA2B;AAiCjC,SAASC,GACPC,GACAC,GACqC;AACrC,QAAMC,IAAaD,KAAoB;AACvC,SAAO;AAAA,IACL;AAAA,MACE,YAAY,CAACvc,MAAQ,GAAGA,EAAI,MAAM,IAAI,IAAIA,EAAI,MAAM,UAAU,IAAIA,EAAI,MAAM,QAAQ;AAAA,MACpF,IAAI6b;AAAA,MACJ,SAAQS,KAAA,gBAAAA,EAAS,iCAAgCL;AAAA,MACjD,MAAM,CAAC52B,MAAS;AACd,cAAM2a,IAAM3a,EAAK,IAAI;AACrB,eAAIA,EAAK,IAAI,iBACJ7R,GAAM,oBAAoBwsB,EAAI,MAAM,IAAI,IAE1C3a,EAAK,IAAI,qBAAqBw2B,KAAex+B,GAAa2iB,EAAI,KAAK,IAAI;AAAA,MAChF;AAAA,MACA,kBAAkB,CAACA,MAAQxsB,GAAM,eAAewsB,EAAI,MAAM,IAAI;AAAA,MAC9D,WAAW,CAACtc,GAAGtM,MACNqlC,GAAe/4B,EAAE,SAAS,OAAOtM,EAAE,SAAS,KAAK;AAAA,MAE1D,gBAAgB;AAAA,IAAA;AAAA,IAElB;AAAA,MACE,YAAY,CAAC4oB,MAAQ3iB,GAAa2iB,EAAI,KAAK;AAAA,MAC3C,IAAI8b;AAAA,MACJ,QAAQ;AAAA,MACR,MAAM,CAACz2B,MAAS;AACd,cAAM2a,IAAM3a,EAAK,IAAI;AACrB,eAAOA,EAAK,IAAI,aAAA,IAAiB,SAAYhI,GAAa2iB,EAAI,KAAK;AAAA,MACrE;AAAA,MACA,WAAW,CAACtc,GAAGtM,MACNqlC,GAAe/4B,EAAE,SAAS,OAAOtM,EAAE,SAAS,KAAK;AAAA,MAE1D,gBAAgB;AAAA,IAAA;AAAA,IAElB;AAAA,MACE,YAAY,CAAC4oB,MAAQA,EAAI,OAAO;AAAA,MAChC,IAAI+b;AAAA,MACJ,QAAQS,KAAcF,KAAA,gBAAAA,EAAS,mBAAkBH,KAAyB;AAAA,MAC1E,MAAM,CAAC92B,MAAUm3B,KAAcn3B,EAAK,IAAI,iBAAiBA,EAAK,SAAA,IAAa;AAAA,MAC3E,kBAAkB,CAAC2a,MAAQA,EAAI,OAAO;AAAA,MACtC,WAAW,CAACtc,GAAGtM,MACbsM,EAAE,SAAS,OAAO,YAAY,cAActM,EAAE,SAAS,OAAO,WAAW;AAAA,MAC3E,gBAAgB;AAAA,IAAA;AAAA,IAElB;AAAA,MACE,YAAY,CAAC4oB,MAAQA,EAAI;AAAA,MACzB,IAAIgc;AAAA,MACJ,SAAQM,KAAA,gBAAAA,EAAS,sBAAqBF;AAAA,MACtC,MAAM,CAAC/2B,MAASA,EAAK,SAAA;AAAA,MACrB,gBAAgB;AAAA,IAAA;AAAA,EAClB;AAEJ;AAEA,MAAMq3B,KAAe,CAACC,MAA2C;AAC/D,MAAI,EAAE,YAAYA,EAAmB;AACnC,UAAM,IAAI,MAAM,oCAAoC;AACtD,MAAIA,EAAmB,OAAO,EAAE,YAAYA,EAAmB;AAC7D,UAAM,IAAI,MAAM,kCAAkC;AACpD,QAAM,EAAE,QAAQC,EAAA,IAAgBD,EAAmB;AACnD,MAAIE,IAAoB;AAExB,SADIF,EAAmB,QAAM,EAAE,QAAQE,EAAA,IAAcF,EAAmB,MAEtE,CAACA,EAAmB,OACpBF,GAAeE,EAAmB,OAAOA,EAAmB,GAAG,MAAM,IAE9D,GAAGG,GAAkBH,EAAmB,KAAK,CAAC,IAAIC,CAAW,KAC/D,GAAGE,GAAkBH,EAAmB,KAAK,CAAC,IAAIC,CAAW,IAAIE,GAAkBH,EAAmB,GAAG,CAAC,IAAIE,CAAS;AAChI,GAEME,KAAY,CAAC/c,MACjB,GAAG0c,GAAa,EAAE,OAAO1c,EAAI,OAAO,KAAKA,EAAI,KAAK,CAAC,IAAIA,EAAI,OAAO,WAAW,IAAIA,EAAI,MAAM;AAWtF,SAASgd,GAAuB;AAAA,EACrC,SAAAC;AAAA,EACA,mBAAAC,IAAoB;AAAA,EACpB,kBAAAX,IAAmB;AAAA,EACnB,8BAAAY;AAAA,EACA,wBAAAC;AAAA,EACA,gBAAAC;AAAA,EACA,mBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,IAAA7mC;AACF,GAAgC;AAC9B,QAAM,CAAC8mC,GAAUC,CAAW,IAAI3mC,EAAwB,CAAA,CAAE,GACpD,CAAC+qB,GAASC,CAAU,IAAIhrB,EAAuB,CAAC,EAAE,IAAI+kC,IAAc,MAAM,GAAA,CAAO,CAAC,GAClF,CAAC1Z,GAAcC,CAAe,IAAItrB,EAA4B,CAAA,CAAE,GAEhE4mC,IAAmB3oC;AAAA,IACvB,MACEkoC,EAAQ,QAAQ,CAACU,MACRA,EAAO,KAAK,IAAI,CAACrnC,OAAU;AAAA,MAChC,GAAGA;AAAA,MACH,QAAQqnC,EAAO;AAAA,IAAA,EACf,CACH;AAAA,IACH,CAACV,CAAO;AAAA,EAAA,GAGJ5b,IAAUtsB;AAAA,IACd,MACEsnC;AAAA,MACE;AAAA,QACE,8BAAAc;AAAA,QACA,gBAAAE;AAAA,QACA,mBAAAC;AAAA,MAAA;AAAA,MAEFf;AAAA,IAAA;AAAA,IAEJ,CAACY,GAA8BE,GAAgBC,GAAmBf,CAAgB;AAAA,EAAA;AAGpF,EAAAvvB,EAAU,MAAM;AAEd,IAAIwwB,EAAS,SAASzB,EAAS,IAC7Bja,EAAW;AAAA,MACT,EAAE,IAAIia,IAAW,MAAM,GAAA;AAAA,MACvB,EAAE,IAAIF,IAAc,MAAM,GAAA;AAAA,IAAM,CACjC,IAED/Z,EAAW,CAAC,EAAE,IAAI+Z,IAAc,MAAM,GAAA,CAAO,CAAC;AAAA,EAElD,GAAG,CAAC2B,CAAQ,CAAC;AAEb,QAAM9f,IAAQ4E,GAAc;AAAA,IAC1B,MAAMob;AAAA,IACN,SAAArc;AAAA,IACA,OAAO;AAAA,MACL,UAAAmc;AAAA,MACA,SAAA3b;AAAA,MACA,cAAAM;AAAA,IAAA;AAAA,IAEF,kBAAkBsb;AAAA,IAClB,iBAAiB3b;AAAA,IACjB,sBAAsBM;AAAA,IACtB,qBAAqBwb,GAAA;AAAA,IACrB,oBAAoBC,GAAA;AAAA,IACpB,iBAAiBtb,GAAA;AAAA,IACjB,mBAAmBE,GAAA;AAAA,IACnB,UAAUsa;AAAA,IACV,mBAAmB;AAAA,IACnB,yBAAyB;AAAA,IACzB,uBAAuB;AAAA,EAAA,CACxB;AAED,EAAA/vB,EAAU,MAAM;AACd,QAAIuwB,GAAe;AACjB,YAAMO,IAAepgB,EAAM,oBAAA,EAAsB,UAC3CqgB,IAAO,OAAO,KAAKD,CAAY;AACrC,UAAIC,EAAK,WAAW,GAAG;AACrB,cAAMC,IAAcN,EAAiB,KAAK,CAAC1d,MAAQ+c,GAAU/c,CAAG,MAAM+d,EAAK,CAAC,CAAC,KAAK;AAClF,QAAIC,OAA2BA,CAAW;AAAA,MAC5C;AAAA,IACF;AAAA,EACF,GAAG,CAAC7b,GAAcub,GAAkBH,GAAe7f,CAAK,CAAC;AAGzD,QAAMugB,IAAmBb,KAA0BlB,IAC7CgC,IAAgBb,KAAkBlB,IAElCgC,IAAkB;AAAA,IACtB,EAAE,OAAO,eAAe,OAAO,GAAC;AAAA,IAChC,EAAE,OAAO,YAAYF,CAAgB,IAAI,OAAO,CAACpC,EAAY,EAAA;AAAA,IAC7D,EAAE,OAAO,YAAYqC,CAAa,IAAI,OAAO,CAACnC,EAAS,EAAA;AAAA,IACvD;AAAA,MACE,OAAO,YAAYkC,CAAgB,QAAQC,CAAa;AAAA,MACxD,OAAO,CAACrC,IAAcE,EAAS;AAAA,IAAA;AAAA,IAEjC;AAAA,MACE,OAAO,YAAYmC,CAAa,QAAQD,CAAgB;AAAA,MACxD,OAAO,CAAClC,IAAWF,EAAY;AAAA,IAAA;AAAA,EACjC,GAGIuC,IAAqB,CAACC,MAA6B;AACvD,IAAAZ,EAAY,KAAK,MAAMY,CAAgB,CAAC;AAAA,EAC1C,GAEMC,IAAiB,CAACte,GAAkCxiB,MAAsB;AAC9E,IAAI,CAACwiB,EAAI,aAAA,KAAkB,CAACA,EAAI,mBAC9BA,EAAI,yBAAA,EAA2BxiB,CAAK;AAAA,EAExC,GAEM+gC,IAA2B,CAACve,GAAkC/d,MAC9D+d,EAAI,aAAA,IAAuB,KAKxBzvB,EAAG,cAAc0R,IAAQ,MAAM,IAAI,SAAS,KAAK,GAGpDu8B,IAAY,CAChBC,GACAze,GACA+C,MACG;AACH,QAAI,GAAA0b,KAAA,gBAAAA,EAAe,YAAW,KAAKze,EAAI,QAAQ+C,EAAK,OAAO,gBAAA,IAC3D;AAAA,UAAI/C,EAAI;AACN,gBAAQA,EAAI,OAAA;AAAA,UACV,KAAK;AACH,mBAAO;AAAA,UACT;AACE;AAAA,QAAO;AAGb,cAAQA,EAAI,OAAA;AAAA,QACV,KAAK;AACH,iBAAO;AAAA,QACT,KAAK;AACH,iBAAO;AAAA,QACT;AACE;AAAA,MAAO;AAAA;AAAA,EAEb;AAEA,SACE,gBAAAvuB,EAAC,OAAA,EAAI,IAAAiF,GAAQ,WAAU,kDACpB,UAAA;AAAA,IAAA,CAACwmC,KACA,gBAAAzrC;AAAA,MAACosB;AAAA,MAAA;AAAA,QACC,OAAO,KAAK,UAAU2f,CAAQ;AAAA,QAC9B,eAAe,CAACn9B,MAAU;AACxB,UAAA+9B,EAAmB/9B,CAAK;AAAA,QAC1B;AAAA,QAEA,UAAA;AAAA,UAAA,gBAAAhP,EAAC6sB,IAAA,EAAc,WAAU,mBACvB,UAAA,gBAAA7sB,EAAC2sB,MAAY,GACf;AAAA,UACA,gBAAA3sB,EAACgtB,IAAA,EAAc,UAAS,gBACtB,UAAA,gBAAAhtB,EAAC0sB,MACE,UAAAogB,EAAgB,IAAI,CAACn+B,MACpB,gBAAA3O,EAACmtB,IAAA,EAA8B,OAAO,KAAK,UAAUxe,EAAO,KAAK,GAC9D,UAAAA,EAAO,SADOA,EAAO,KAExB,CACD,EAAA,CACH,EAAA,CACF;AAAA,QAAA;AAAA,MAAA;AAAA,IAAA;AAAA,IAGJ,gBAAAvO,EAAC2tB,IAAA,EAAM,WAAU,6DACd,UAAA;AAAA,MAAA8d,KACC,gBAAA7rC,EAACsuB,MACE,UAAAjC,EAAM,gBAAA,EAAkB,IAAI,CAACuF,MAC5B,gBAAA5xB,EAACqvB,IAAA,EACE,YAAY,QACV,OAAO,CAACpa,MAAMA,EAAE,OAAO,UAAU,MAAM,EACvC,IAAI,CAAC4c;AAAA;AAAA,QAEJ,gBAAA7xB,EAAC2vB,IAAA,EAA0B,SAASkC,EAAO,SAAS,WAAU,mBAC3D,UAAAA,EAAO,gBAAgB,SACtB,gBAAAzxB,EAAC,OAAA,EACE,UAAA;AAAA,UAAAyxB,EAAO,OAAO,gBACb,gBAAA7xB;AAAA,YAAC+D;AAAA,YAAA;AAAA,cACC,SAAQ;AAAA,cACR,OAAO,sBAAsB8tB,EAAO,OAAO,UAAU,MAAM;AAAA,cAC3D,SAASA,EAAO,OAAO,yBAAA;AAAA,cACvB,MAAK;AAAA,cAEJ,UAAAA,EAAO,OAAO,aAAA,IAAiB,OAAO;AAAA,YAAA;AAAA,UAAA,IAEvC;AAAA,UAAW;AAAA,UACdF,GAAWE,EAAO,OAAO,UAAU,QAAQA,EAAO,YAAY;AAAA,QAAA,GACjE,EAAA,GAdYA,EAAO,EAgBvB;AAAA,OACD,KAtBUD,EAAY,EAuB3B,CACD,EAAA,CACH;AAAA,MAEF,gBAAA5xB,EAACuuB,MACE,UAAAlC,EAAM,cAAc,KAAK,IAAI,CAACsC,GAAK0e,MAAa;AAC/C,cAAMltC,IAAiBb,GAAA;AACvB,eACE,gBAAAU;AAAA,UAACqvB;AAAA,UAAA;AAAA,YACC,cAAYV,EAAI,cAAA,IAAkB,aAAa;AAAA,YAE/C,WAAWzvB,EAAGguC,EAAyBve,GAAK0e,CAAQ,CAAC;AAAA,YACrD,SAAS,CAAClhC,MAAU8gC,EAAete,GAAKxiB,CAAK;AAAA,YAE5C,UAAAwiB,EAAI,gBAAA,EAAkB,IAAI,CAAC+C,MAAS;AACnC,kBACE,EAAAA,EAAK,sBACJA,EAAK,OAAO,UAAU,kBACrB,CAACA,EAAK,aAAA,MACLA,EAAK,OAAO,UAAU,OAAOgZ,MAAa,CAACQ;AAGhD,uBACE,gBAAAlrC;AAAA,kBAAC4vB;AAAA,kBAAA;AAAA,oBAOC,WAAW1wB;AAAA,sBACTwyB,EAAK,OAAO,UAAU;AAAA,sBACtB;AAAA,sBACAyb,EAAUhB,GAAUxd,GAAK+C,CAAI;AAAA,oBAAA;AAAA,oBAG7B,UACIA,EAAK,iBAEL,gBAAAtxB;AAAA,sBAAC2D;AAAA,sBAAA;AAAA,wBACC,SAAQ;AAAA,wBACR,SAAS4qB,EAAI,yBAAA;AAAA,wBACb,MAAK;AAAA,wBAEJ,UAAA;AAAA,0BAAAA,EAAI,cAAA,KAAmB,gBAAA3uB,EAACmQ,IAAA,CAAA,CAAY;AAAA,0BACpC,CAACwe,EAAI,oBACHxuB,MAAQ,QAAQ,gBAAAH,EAAC8I,IAAA,CAAA,CAAa,IAAK,gBAAA9I,EAAC6I,IAAA,CAAA,CAAY;AAAA,0BAAK;AAAA,0BACvD8oB,GAAWD,EAAK,OAAO,UAAU,MAAMA,EAAK,YAAY;AAAA,0BAAE;AAAA,0BAC1D/C,EAAI,QAAQ;AAAA,0BAAO;AAAA,wBAAA;AAAA,sBAAA;AAAA,oBAAA,IAYnBgD,GAAWD,EAAK,OAAO,UAAU,MAAMA,EAAK,YAAY;AAAA,kBAC9D;AAAA,kBArCEA,EAAK;AAAA,gBAAA;AAAA,YAwChB,CAAC;AAAA,UAAA;AAAA,UAtDI/C,EAAI;AAAA,QAAA;AAAA,MAyDf,CAAC,EAAA,CACH;AAAA,IAAA,EAAA,CACF;AAAA,EAAA,GACF;AAEJ;ACteO,MAAM2e,KAAqB,CAACC,GAAmBnsC,MAC7CmsC,EAAQ,OAAO,CAACvrC,MAAW;AAChC,MAAI;AACF,WAAOiM,GAAkBjM,CAAM,MAAMZ;AAAA,EACvC,QAAQ;AACN,WAAO;AAAA,EACT;AACF,CAAC,GAWUosC,KAAyB,CACpCD,GACAnsC,GACAgQ,MACGk8B,GAAmBC,GAASnsC,CAAO,EAAE,MAAM,CAACY,MAAWoP,EAAgB,SAASpP,CAAM,CAAC;ACpB5F,SAASyrC,GAAc;AAAA,EACrB,SAAArsC;AAAA,EACA,kBAAAssC;AAAA,EACA,iBAAAt8B;AAAA,EACA,UAAAu8B;AAAA,EACA,kBAAApkC;AACF,GAMG;AACD,QAAMmG,IAAa49B,GAAmBI,GAAkBtsC,CAAO,EAAE,WAAW,GAEtEwsC,IAAqBrkC,EAAiB,8BAA8B,GACpEskC,IAAqBtkC,EAAiB,8BAA8B,GACpEukC,IAAqBvkC,EAAiB,8BAA8B,GACpEwkC,IAAwBxkC,EAAiB,iCAAiC;AAEhF,SACE,gBAAAvJ;AAAA,IAAC+D;AAAA,IAAA;AAAA,MACC,SAAQ;AAAA,MACR,MAAK;AAAA,MACL,SAAS,MAAM4pC,EAASvsC,CAAO;AAAA,MAC/B,WAAWlC;AAAA,QACTsuC,GAAuBE,GAAkBtsC,GAASgQ,CAAe,KAC/D,CAAC1B,KACD;AAAA,MAAA;AAAA,MAEJ,UAAUA;AAAA,MAET,UAAAhO;AAAA,QACCN;AAAA,QACAwsC;AAAA,QACAC;AAAA,QACAC;AAAA,QACAC;AAAA,MAAA;AAAA,IACF;AAAA,EAAA;AAGN;AC1BA,MAAMC,KAAuB,GAEvBC,KAAqB;AA6BpB,SAASh9B,GAAa;AAAA,EAC3B,mBAAAi9B;AAAA,EACA,iBAAA98B;AAAA,EACA,yBAAA+8B;AAAA,EACA,kBAAA5kC;AAAA,EACA,oBAAAtH;AACF,GAAsB;AACpB,QAAMmsC,IAAoB7kC,EAAiB,wCAAwC,GAC7E8kC,IAAkB9kC,EAAiB,sCAAsC,GACzE+kC,IAAkB/kC,EAAiB,sCAAsC,GACzEqtB,IAAgBrtB,EAAiB,oCAAoC,GACrEstB,IAAettB,EAAiB,mCAAmC,GACnEglC,IAAkBhlC,EAAiB,uCAAuC,GAC1EilC,IAAWjlC,EAAiB,8BAA8B,GAE1D,EAAE,QAAAkC,GAAQ,QAAAC,GAAQ,QAAAC,GAAQ,WAAAC,MAAc;AAAA,IAC5C,QAAQrC,KAAA,gBAAAA,EAAmB;AAAA,IAC3B,QAAQA,KAAA,gBAAAA,EAAmB;AAAA,IAC3B,QAAQA,KAAA,gBAAAA,EAAmB;AAAA,IAC3B,WAAWA,KAAA,gBAAAA,EAAmB;AAAA,EAAgC,GAG1D,CAACklC,GAAqBC,CAAsB,IAAIjpC,EAAS,EAAK,GAC9D,CAACmE,GAAYC,CAAa,IAAIpE,EAAS,EAAE,GACzCkpC,IAAsBtrC,EAA2B,MAAS,GAC1DurC,IAAuBvrC,EAAO,EAAK;AAEzC,MAAI6qC,EAAkB,WAAW/rC,GAAM,WAAW;AAChD,UAAM,IAAI,MAAM,6DAA6D;AAG/E,QAAM0sC,IAAoBnrC,EAAQ,MACzBvB,GAAM,WAAW;AAAA,IACtB,CAACH,GAAQ4O,MACPs9B,EAAkBt9B,CAAK,MAAM,OAAO,CAACzO,GAAM,WAAWA,GAAM,eAAeH,CAAM,CAAC;AAAA,EAAA,GAErF,CAACksC,CAAiB,CAAC,GAEhBY,IAAyBprC,EAAQ,MAAM;AAC3C,QAAI,CAACkG,EAAW,QAAQ;AACtB,YAAMmlC,IAAsC;AAAA,QAC1C,CAACttC,EAAQ,EAAE,GAAG,CAAA;AAAA,QACd,CAACA,EAAQ,EAAE,GAAG,CAAA;AAAA,QACd,CAACA,EAAQ,EAAE,GAAG,CAAA;AAAA,QACd,CAACA,EAAQ,KAAK,GAAG,CAAA;AAAA,MAAC;AAGpB,aAAAotC,EAAkB,QAAQ,CAAC7sC,MAAW;AACpC,cAAMZ,KAAU6M,GAAkBjM,CAAM;AACxC,QAAA+sC,EAAS3tC,EAAO,EAAE,KAAKY,CAAM;AAAA,MAC/B,CAAC,GAEM+sC;AAAA,IACT;AAEA,UAAMjkC,IAAgB+jC,EAAkB;AAAA,MAAO,CAAC7sC,MAC9CO,GAAmBP,GAAQ4H,GAAY3H,CAAkB;AAAA,IAAA,GAGrD+sC,IAA2C;AAAA,MAC/C,CAACvtC,EAAQ,EAAE,GAAG,CAAA;AAAA,MACd,CAACA,EAAQ,EAAE,GAAG,CAAA;AAAA,MACd,CAACA,EAAQ,EAAE,GAAG,CAAA;AAAA,MACd,CAACA,EAAQ,KAAK,GAAG,CAAA;AAAA,IAAC;AAGpB,WAAAqJ,EAAc,QAAQ,CAAC9I,MAAW;AAChC,YAAMZ,IAAU6M,GAAkBjM,CAAM;AACxC,MAAAgtC,EAAc5tC,CAAO,EAAE,KAAKY,CAAM;AAAA,IACpC,CAAC,GAEMgtC;AAAA,EACT,GAAG,CAACH,GAAmBjlC,GAAY3H,CAAkB,CAAC,GAEhDgtC,IAAa/mC;AAAA,IACjB,CAAClG,GAAgBktC,IAAW,OAAU;AACpC,UAAI,CAACA,KAAY,CAACP,EAAoB,SAAS;AAC7C,QAAAR;AAAA,UACE/8B,EAAgB,SAASpP,CAAM,IAC3BoP,EAAgB,OAAO,CAAC/L,OAAOA,OAAOrD,CAAM,IAC5C,CAAC,GAAGoP,GAAiBpP,CAAM;AAAA,QAAA,GAEjC2sC,EAAoB,UAAU3sC;AAC9B;AAAA,MACF;AAEA,YAAMu9B,IAAYsP,EAAkB,UAAU,CAACxpC,OAAOA,OAAOspC,EAAoB,OAAO,GAClF5rB,IAAe8rB,EAAkB,UAAU,CAACxpC,OAAOA,OAAOrD,CAAM;AAEtE,UAAIu9B,MAAc,MAAMxc,MAAiB,GAAI;AAE7C,YAAM,CAACosB,IAAYC,EAAQ,IAAI;AAAA,QAC7B,KAAK,IAAI7P,GAAWxc,CAAY;AAAA,QAChC,KAAK,IAAIwc,GAAWxc,CAAY;AAAA,MAAA,GAE5BssB,KAAeR,EAAkB,MAAMM,IAAYC,KAAW,CAAC,EAAE,IAAI,CAAC/pC,OAAOA,EAAE;AAErF,MAAA8oC;AAAA,QACE/8B,EAAgB,SAASpP,CAAM,IAC3BoP,EAAgB,OAAO,CAACk+B,OAAc,CAACD,GAAa,SAASC,EAAS,CAAC,IACvE,CAAC,GAAG,oBAAI,IAAI,CAAC,GAAGl+B,GAAiB,GAAGi+B,EAAY,CAAC,CAAC;AAAA,MAAA;AAAA,IAE1D;AAAA,IACA,CAACj+B,GAAiB+8B,GAAyBU,CAAiB;AAAA,EAAA,GAGxDU,IAAuB,CAACvtC,MAAmB;AAC/C,IAAAitC,EAAWjtC,GAAQ4sC,EAAqB,OAAO,GAC/CA,EAAqB,UAAU;AAAA,EACjC,GAEMrrC,IAAkB,CAAC4I,GAAmBnK,MAAmB;AAC7D,IAAAmK,EAAM,eAAA,GACN8iC,EAAWjtC,GAAQmK,EAAM,QAAQ;AAAA,EACnC,GAEMqjC,IAAgBtnC;AAAA,IACpB,CAAC9G,MAAqB;AACpB,YAAMquC,IAAenC,GAAmBuB,GAAmBztC,CAAO,EAAE,IAAI,CAACY,MAAWA,CAAM;AAC1F,MAAAmsC;AAAA,QACEX,GAAuBqB,GAAmBztC,GAASgQ,CAAe,IAC9DA,EAAgB,OAAO,CAACk+B,MAAc,CAACG,EAAa,SAASH,CAAS,CAAC,IACvE,CAAC,GAAG,oBAAI,IAAI,CAAC,GAAGl+B,GAAiB,GAAGq+B,CAAY,CAAC,CAAC;AAAA,MAAA;AAAA,IAE1D;AAAA,IACA,CAACr+B,GAAiB+8B,GAAyBU,CAAiB;AAAA,EAAA,GAGxDpX,IAAkB,MAAM;AAC5B,IAAA0W,EAAwBU,EAAkB,IAAI,CAAC7sC,MAAWA,CAAM,CAAC;AAAA,EACnE,GAEM01B,IAAiB,MAAM;AAC3B,IAAAyW,EAAwB,CAAA,CAAE;AAAA,EAC5B;AAEA,SACE,gBAAA/tC,EAAC,OAAA,EAAI,WAAU,gBACb,UAAA;AAAA,IAAA,gBAAAJ,EAAC,OAAA,EAAI,WAAU,iCACZ,UAAA,OAAO,OAAOyB,CAAO,EAAE,IAAI,CAACL,MAEzB,gBAAApB;AAAA,MAACytC;AAAA,MAAA;AAAA,QAEC,SAAArsC;AAAA,QACA,kBAAkBytC;AAAA,QAClB,iBAAAz9B;AAAA,QACA,UAAUo+B;AAAA,QACV,kBAAAjmC;AAAA,MAAA;AAAA,MALKnI;AAAA,IAAA,CAQV,EAAA,CACH;AAAA,IAEA,gBAAAhB;AAAA,MAACgE;AAAA,MAAA;AAAA,QACC,MAAMqqC;AAAA,QACN,cAAc,CAAC9+B,MAAS;AACtB,UAAA++B,EAAuB/+B,CAAI,GACtBA,KACH9F,EAAc,EAAE;AAAA,QAEpB;AAAA,QAEA,UAAA;AAAA,UAAA,gBAAA7J,EAACsE,IAAA,EAAe,SAAO,IACrB,UAAA,gBAAAlE;AAAA,YAAC2D;AAAA,YAAA;AAAA,cACC,SAAQ;AAAA,cACR,MAAK;AAAA,cACL,iBAAe0qC;AAAA,cACf,WAAU;AAAA,cAET,UAAA;AAAA,gBAAAr9B,EAAgB,SAAS,IACtB,GAAGg9B,CAAiB,KAAKh9B,EAAgB,MAAM,KAC/Ci9B;AAAA,gBACJ,gBAAAruC,EAAC43B,IAAA,EAAe,WAAU,kDAAA,CAAkD;AAAA,cAAA;AAAA,YAAA;AAAA,UAAA,GAEhF;AAAA,UACA,gBAAA53B,EAACwE,IAAA,EAAe,WAAU,oBAAmB,OAAM,SACjD,UAAA,gBAAApE;AAAA,YAACK;AAAA,YAAA;AAAA,cACC,cAAc;AAAA,cACd,WAAW,CAAC+C,MAAM;AAChB,gBAAIA,EAAE,QAAQ,YAEZorC,EAAqB,UAAUprC,EAAE;AAAA,cAErC;AAAA,cAEA,UAAA;AAAA,gBAAA,gBAAAxD;AAAA,kBAACW;AAAA,kBAAA;AAAA,oBACC,aAAa2tC;AAAA,oBACb,OAAO1kC;AAAA,oBACP,eAAeC;AAAA,kBAAA;AAAA,gBAAA;AAAA,gBAEjB,gBAAAzJ,EAAC,OAAA,EAAI,WAAU,iDACb,UAAA;AAAA,kBAAA,gBAAAJ,EAAC+D,KAAO,SAAQ,SAAQ,MAAK,MAAK,SAAS0zB,GACxC,UAAAb,EAAA,CACH;AAAA,kBACA,gBAAA52B,EAAC+D,KAAO,SAAQ,SAAQ,MAAK,MAAK,SAAS2zB,GACxC,UAAAb,EAAA,CACH;AAAA,gBAAA,GACF;AAAA,kCACCh2B,IAAA,EACC,UAAA;AAAA,kBAAA,gBAAAb,EAACc,MAAc,UAAAytC,EAAA,CAAgB;AAAA,kBAC9B,OAAO,OAAO9sC,CAAO,EAAE,IAAI,CAACL,GAASwP,MAAU;AAC9C,0BAAM6+B,IAAeX,EAAuB1tC,CAAO;AAEnD,wBAAIquC,EAAa,WAAW;AAE5B,+CACG3hC,IAAA,EACC,UAAA;AAAA,wBAAA,gBAAA9N;AAAA,0BAACe;AAAA,0BAAA;AAAA,4BACC,SAASI,GAAmBC,GAASqK,GAAQC,GAAQC,GAAQC,CAAS;AAAA,4BAErE,UAAA6jC,EAAa,IAAI,CAACztC,MACjB,gBAAAhC;AAAA,8BAAC6C;AAAA,8BAAA;AAAA,gCAEC,QAAAb;AAAA,gCACA,YAAYoP,EAAgB,SAASpP,CAAM;AAAA,gCAC3C,UAAU,MAAMutC,EAAqBvtC,CAAM;AAAA,gCAC3C,aAAa,CAACmK,OAAU5I,EAAgB4I,IAAOnK,CAAM;AAAA,gCACrD,SAASiM,GAAkBjM,CAAM;AAAA,gCACjC,WAAS;AAAA,gCACT,oBAAAC;AAAA,gCACA,cAAc0C,GAAqB3C,GAAQC,CAAkB;AAAA,gCAC7D,WAAU;AAAA,8BAAA;AAAA,8BATLD;AAAA,4BAAA,CAWR;AAAA,0BAAA;AAAA,wBAAA;AAAA,wBAEF4O,IAAQ,OAAO,OAAOnP,CAAO,EAAE,SAAS,uBAAMT,IAAA,CAAA,CAAiB;AAAA,sBAAA,EAAA,GAnBnDI,CAoBf;AAAA,kBAEJ,CAAC;AAAA,gBAAA,EAAA,CACH;AAAA,cAAA;AAAA,YAAA;AAAA,UAAA,EACF,CACF;AAAA,QAAA;AAAA,MAAA;AAAA,IAAA;AAAA,IAGDgQ,EAAgB,SAAS,KACxB,gBAAAhR,EAAC,OAAA,EAAI,WAAU,yCACZ,UAAA;AAAA,MAAAgR,EACE;AAAA,QACC;AAAA,QACAA,EAAgB,WAAW68B,KACvBA,KACAD;AAAA,MAAA,EAEL,IAAI,CAAChsC,wBACHshB,IAAA,EAAM,WAAU,yBAAqC,SAAQ,aAC3D,UAAAvhB,GAAqBC,GAAQC,CAAkB,EAAA,GADJD,CAE9C,CACD;AAAA,MACFoP,EAAgB,SAAS68B,MACxB,gBAAAjuC;AAAA,QAACsjB;AAAA,QAAA;AAAA,UACC,WAAU;AAAA,UACV,SAAQ;AAAA,UACR,UAAA,IAAIlS,EAAgB,SAAS48B,EAAoB,IAAIQ,CAAQ;AAAA,QAAA;AAAA,MAAA;AAAA,IAAG,EAAA,CAEtE;AAAA,EAAA,GAEJ;AAEJ;AChTO,MAAMkB,KAA6B,OAAO,OAAO;AAAA,EACtD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,CAAU,GAeJ3+B,KAAiB,CACrBC,GACAzK,MAEOyK,EAAQzK,CAAG,KAAKA;AAkDlB,SAASopC,GAAc;AAAA,EAC5B,OAAAxM;AAAA,EACA,iBAAAyM;AAAA,EACA,eAAAxM;AAAA,EACA,mBAAA8K;AAAA,EACA,iBAAA98B;AAAA,EACA,yBAAAy+B;AAAA,EACA,kBAAAtmC;AAAA,EACA,oBAAAtH;AAAA,EACA,IAAAoD;AACF,GAAuB;AACrB,QAAMyqC,IAAmB/+B;AAAAA,IACvBxH;AAAA,IACA;AAAA,EAAA,GAEIwmC,IAAmBh/B;AAAAA,IACvBxH;AAAA,IACA;AAAA,EAAA,GAEIymC,IAAqBj/B;AAAAA,IACzBxH;AAAA,IACA;AAAA,EAAA,GAEI8H,IAAkBN,GAAexH,GAAkB,uCAAuC,GAC1FgI,IAAkBR,GAAexH,GAAkB,uCAAuC,GAC1F0mC,IAAYl/B,GAAexH,GAAkB,gCAAgC,GAC7E8kC,IAAkBt9B,GAAexH,GAAkB,uCAAuC,GAE1F2mC,IAAoE;AAAA,IACxE,EAAE,OAAO,gBAAgB,OAAOJ,GAAkB,IAAI,sBAAA;AAAA,IACtD,EAAE,OAAO,SAAS,OAAOC,GAAkB,IAAI,cAAA;AAAA,IAC/C,EAAE,OAAO,WAAW,OAAOC,GAAoB,IAAI,gBAAA;AAAA,IACnD,EAAE,OAAO,QAAQ,OAAO3+B,GAAiB,IAAI,aAAA;AAAA,IAC7C,EAAE,OAAO,iBAAiB,OAAOE,GAAiB,IAAI,iBAAA;AAAA,EAAiB,GAGnE4+B,IAAkBP,IACpBM,EAAc,OAAO,CAACvhC,MAAWihC,EAAgB,SAASjhC,EAAO,KAAK,CAAC,IACvEuhC;AAEJ,SACE,gBAAA9vC,EAAC,OAAA,EAAI,IAAAiF,GAAQ,WAAU,oBACrB,UAAA;AAAA,IAAA,gBAAAjF,EAAC,OAAA,EAAI,WAAU,oBACb,UAAA;AAAA,MAAA,gBAAAJ,EAACoO,MAAO,UAAA6hC,EAAA,CAAU;AAAA,MAClB,gBAAAjwC;AAAA,QAACsO;AAAA,QAAA;AAAA,UACC,OAAO60B;AAAA,UACP,eAAeC;AAAA,UACf,WAAU;AAAA,UAET,UAAA+M,EAAgB,IAAI,CAAC,EAAE,OAAAnhC,GAAO,OAAAuO,GAAO,IAAI6yB,EAAA,MACxC,gBAAAhwC,EAAC,OAAA,EAAkB,WAAU,2BAC3B,UAAA;AAAA,YAAA,gBAAAJ,EAACwO,IAAA,EAAe,WAAU,WAAU,OAAAQ,GAAc,IAAIohC,GAAS;AAAA,YAC/D,gBAAApwC,EAACoO,IAAA,EAAM,SAASgiC,GAAU,UAAA7yB,EAAA,CAAM;AAAA,UAAA,EAAA,GAFxB6yB,CAGV,CACD;AAAA,QAAA;AAAA,MAAA;AAAA,IACH,GACF;AAAA,IAECjN,MAAU,mBACT,gBAAA/iC,EAAC,OAAA,EAAI,WAAU,oBACb,UAAA;AAAA,MAAA,gBAAAJ,EAACoO,MAAO,UAAAigC,EAAA,CAAgB;AAAA,MACxB,gBAAAruC;AAAA,QAACiR;AAAA,QAAA;AAAA,UACC,mBAAAi9B;AAAA,UACA,iBAAA98B;AAAA,UACA,yBAAyBy+B;AAAA,UACzB,kBAAAtmC;AAAA,UACA,oBAAAtH;AAAA,QAAA;AAAA,MAAA;AAAA,IACF,EAAA,CACF;AAAA,EAAA,GAEJ;AAEJ;AChKA,MAAMouC,KAAyC;AAAA,EAC7C,CAACC,EAA+B,WAAW,CAAC,GAAG;AAAA,EAC/C,CAACA,EAA+B,CAAC,CAAC,GAAG;AAAA,EACrC,CAACA,EAA+B,CAAC,CAAC,GAAG;AAAA,EACrC,CAACA,EAA+B,CAAC,CAAC,GAAG;AAAA,EACrC,CAACA,EAA+B,CAAC,CAAC,GAAG;AAAA,EACrC,CAACA,EAA+B,CAAC,CAAC,GAAG;AAAA,EACrC,CAACA,EAA+B,CAAC,CAAC,GAAG;AAAA,EACrC,CAACA,EAA+B,CAAC,CAAC,GAAG;AAAA,EACrC,CAACA,EAA+B,CAAC,CAAC,GAAG;AAAA,EACrC,CAACA,EAA+B,CAAC,CAAC,GAAG;AAAA,EACrC,CAACA,EAA+B,CAAC,CAAC,GAAG;AAAA,EACrC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AAAA,EACtC,CAACA,EAA+B,EAAE,CAAC,GAAG;AACxC;AAgEO,SAASC,GAAoB;AAAA,EAClC,yBAAAC;AAAA,EACA,eAAAC;AAAA,EACA,uBAAAC;AAAA,EACA,kBAAAnnC,IAAmB,CAAA;AAAA,EACnB,MAAAtF,IAAO;AAAA,EACP,WAAApE;AAAA,EACA,IAAAwF;AACF,GAA6B;AAC3B,QAAMsrC,IAA4B;AAAA,IAChC,GAAGN;AAAA,IACH,GAAG,OAAO;AAAA,MACR,OAAO,QAAQ9mC,CAAgB,EAAE;AAAA,QAC/B,CAAC,CAACqnC,GAAoBC,CAAoB,MAAwB;AAAA,UAChED;AAAA,UACAA,MAAuBC,KACvBD,KAAsBP,KAClBA,GAAuCO,CAAkB,IACzDC;AAAA,QAAA;AAAA,MACN;AAAA,IACF;AAAA,EACF,GAGI1wC,IAAiBb,GAAA;AAEvB,SACE,gBAAAc;AAAA,IAACosB;AAAA,IAAA;AAAA,MACC,OAAO,GAAGikB,CAAa;AAAA,MACvB,eAAe,CAACK,MACdJ;AAAA,QACEI,MAAyB,cAAc,SAAY,SAASA,GAAsB,EAAE;AAAA,MAAA;AAAA,MAIxF,UAAA;AAAA,QAAA,gBAAA9wC,EAAC6sB,MAAc,MAAA5oB,GAAY,WAAW/E,EAAG,oBAAoBW,CAAS,GACpE,UAAA,gBAAAG;AAAA,UAAC2sB;AAAA,UAAA;AAAA,YACC,aACEgkB,EAA0BL,EAA+BG,CAAa,CAAC,KACvEA;AAAA,UAAA;AAAA,QAAA,GAGN;AAAA,QACA,gBAAAzwC;AAAA,UAACgtB;AAAA,UAAA;AAAA,YACC,IAAA3nB;AAAA,YACA,OAAOlF,MAAQ,QAAQ,QAAQ;AAAA,YAE/B,OAAO,EAAE,QAAQ,IAAA;AAAA,YAEhB,YAAwB,IAAI,CAAC4wC,MAC5B,gBAAA/wC,EAACmtB,IAAA,EAA0C,OAAO,GAAG4jB,CAAmB,IACrE,UAAAJ,EAA0BL,EAA+BS,CAAmB,CAAC,KAD/D,GAAGA,CAAmB,EAEvC,CACD;AAAA,UAAA;AAAA,QAAA;AAAA,MACH;AAAA,IAAA;AAAA,EAAA;AAGN;ACtJO,SAASC,GAAa,EAAE,UAAA9wC,KAA+B;AAC5D,SAAO,gBAAAF,EAAC,OAAA,EAAI,WAAU,kBAAkB,UAAAE,EAAA,CAAS;AACnD;AAyBO,SAAS+wC,GAAiB;AAAA,EAC/B,SAAAC;AAAA,EACA,WAAAC;AAAA,EACA,UAAAjxC;AAAA,EACA,WAAAowB,IAAY;AAAA,EACZ,gBAAA8gB;AACF,GAA0B;AACxB,SACE,gBAAAhxC,EAAC,OAAA,EAAI,WAAU,mEACb,UAAA;AAAA,IAAA,gBAAAA,EAAC,OAAA,EACC,UAAA;AAAA,MAAA,gBAAAJ,EAAC,KAAA,EAAE,WAAU,6CAA6C,UAAAkxC,GAAQ;AAAA,MAClE,gBAAAlxC,EAAC,KAAA,EAAE,WAAU,2EACV,UAAAmxC,EAAA,CACH;AAAA,IAAA,GACF;AAAA,IAEC7gB,sBACE,KAAA,EAAE,WAAU,uCAAuC,UAAA8gB,EAAA,CAAe,IAEnE,gBAAApxC,EAAC,OAAA,EAAK,UAAAE,EAAA,CAAS;AAAA,EAAA,GAEnB;AAEJ;AAsBO,SAASmxC,GAAmB;AAAA,EACjC,SAAAH;AAAA,EACA,WAAAC;AAAA,EACA,kBAAAG,IAAmB;AACrB,GAA4B;AAC1B,SACE,gBAAAlxC,EAAC,OAAA,EAAI,WAAU,wBACb,UAAA;AAAA,IAAA,gBAAAA,EAAC,OAAA,EACC,UAAA;AAAA,MAAA,gBAAAJ,EAAC,MAAA,EAAG,WAAU,6BAA6B,UAAAkxC,GAAQ;AAAA,MACnD,gBAAAlxC,EAAC,KAAA,EAAE,WAAU,uCAAuC,UAAAmxC,EAAA,CAAU;AAAA,IAAA,GAChE;AAAA,IACCG,IAAmB,gBAAAtxC,EAAC6jB,IAAA,CAAA,CAAU,IAAK;AAAA,EAAA,GACtC;AAEJ;AC9EO,SAAS0tB,GACdre,GACA7tB,GACoB;;AACpB,UAAOnD,IAAA,OAAO,QAAQgxB,CAAM,EAAE;AAAA,IAC5B,CAAC,CAAA,EAAGlkB,CAAK,MAAM,cAAcA,KAASA,EAAM,aAAa3J;AAAA,EAAA,MADpD,gBAAAnD,EAEH;AACN;AClBA,SAASsvC,GAAa,EAAE,MAAApiC,GAAM,WAAAqiC,GAAW,SAAAC,KAA8B;AACrE,SAAOtiC,IACL,gBAAApP;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWd,EAAG,yBAAyBwyC,IAAU,YAAY,SAAS;AAAA,MACtE,KAAKtiC;AAAA,MACL,KAAK,GAAGsiC,IAAU,YAAY,UAAU,aAAaD,CAAS;AAAA,IAAA;AAAA,EAAA,IAE9D;AACN;ACaA,MAAME,KAAkB,CACtBze,GACA0e,GACAC,GACAC,MAEKD,IAEyB,OAAO,QAAQ3e,CAAM,EAChD;AAAA,EACC,CAAC,CAAC3sB,GAAK6J,CAAK,MACT,YAAYA,KAASA,EAAM,WAAWyhC,KAAuBtrC,MAAQsrC;AAAA,EAEzE,KAAK,CAAC,CAAA,EAAGx/B,CAAC,GAAG,CAAA,EAAGtM,CAAC,MAAMsM,EAAE,QAAQtM,EAAE,KAAK,EAEd,QAAQ,CAAC,CAACgsC,CAAQ,MAC1BH,EAChB,OAAO,CAAC3sC,MAASA,EAAK,UAAU8sC,CAAQ,EACxC,KAAK,CAAC1/B,GAAGtM,MAAMsM,EAAE,QAAQtM,EAAE,KAAK,EAChC,IAAI,CAACd,wBAED4N,IAAA,EACC,UAAA;AAAA,EAAA,gBAAA7S,EAAC8S,IAAA,EAAe,SAAO,IACpB,UAAA,aAAa7N,IACZ,gBAAA7E;AAAA,IAAC+kB;AAAA,IAAA;AAAA,MAEC,SAAS,MAAM;AAGb,QAAA2sB,EAAiB7sC,CAAiC;AAAA,MACpD;AAAA,MAEC,UAAA;AAAA,QAAAA,EAAK,kBACJ,gBAAAjF,EAACwxC,IAAA,EAAa,MAAMvsC,EAAK,gBAAgB,WAAWA,EAAK,OAAO,SAAO,GAAA,CAAC;AAAA,QAEzEA,EAAK;AAAA,QACLA,EAAK,iBACJ,gBAAAjF,EAACwxC,IAAA,EAAa,MAAMvsC,EAAK,eAAe,WAAWA,EAAK,MAAA,CAAO;AAAA,MAAA;AAAA,IAAA;AAAA,IAZ5D,sBAAsBA,EAAK,KAAK,IAAIA,EAAK,OAAO;AAAA,EAAA,sBAgBtD2f,IAAA,EACC,UAAA;AAAA,IAAA,gBAAA5kB,EAAC+kB,IAAA,EAAwB,YAAK,MAAA,CAAM;AAAA,IAEpC,gBAAA/kB,EAAC2kB,IAAA,EACC,UAAA,gBAAA3kB,EAACilB,IAAA,EACE,UAAA0sB;AAAA,MACCze;AAAA,MACA0e;AAAA,MACAL,GAAgCre,GAAQjuB,EAAK,EAAE;AAAA,MAC/C6sC;AAAA,IAAA,GAEJ,EAAA,CACF;AAAA,EAAA,KAZoB,qBAAqB7sC,EAAK,KAAK,IAAIA,EAAK,EAAE,EAahE,GAEJ;AAAA,EACCA,EAAK,WAAW,gBAAAjF,EAAC+S,IAAA,EAAgB,YAAK,QAAA,CAAQ;AAAA,EAAA,GApCnC,WAAW9N,EAAK,KAAK,IAAI,aAAaA,IAAOA,EAAK,UAAUA,EAAK,EAAE,EAqCjF,CAEH,CAGJ,IAzDwB;AA4F3B,SAAwB+sC,GAAgB;AAAA,EACtC,kBAAAF;AAAA,EACA,UAAAG;AAAA,EACA,UAAAC;AAAA,EACA,MAAA9iC;AAAA,EACA,WAAAvP;AAAA,EACA,SAAAmE;AAAA,EACA,eAAAwL,IAAgB;AAAA,EAChB,IAAAnK;AACF,GAAyB;AACvB,SACE,gBAAAjF,EAAC0kB,MAAa,SAAA9gB,GACZ,UAAA;AAAA,IAAA,gBAAAhE,EAACwkB,MAAoB,cAAY0tB,GAAU,WAAAryC,GAAsB,SAAO,IAAC,IAAAwF,GACvE,UAAA,gBAAArF,EAAC+D,GAAA,EAAO,SAASyL,GAAe,MAAK,QAClC,eAAQ,gBAAAxP,EAACmyC,IAAA,EAAS,GACrB,EAAA,CACF;AAAA,IACA,gBAAAnyC,EAACklB,IAAA,EAAoB,OAAM,SAAQ,WAAU,cAC1C,UAAA,OAAO,QAAQ+sB,EAAS,OAAO,EAC7B,OAAO,CAAC,CAAA,EAAG1lB,CAAM,MAAM,OAAOA,KAAW,QAAQ,EACjD,KAAK,CAAC,CAAA,EAAGla,CAAC,GAAG,CAAA,EAAGtM,CAAC,MACZ,OAAOsM,KAAM,aAAa,OAAOtM,KAAM,YAAkB,IACtDsM,EAAE,QAAQtM,EAAE,KACpB,EACA,IAAI,CAAC,CAACqsC,CAAS,GAAGxhC,GAAOyhC,MACxB,gBAAAjyC,EAAC0N,IAAA,EACC,UAAA;AAAA,MAAA,gBAAA9N,EAAC0kB,IAAA,EACC,UAAA,gBAAA1kB,EAAC2S,IAAA,EACE,UAAAg/B,GAAgBM,EAAS,QAAQA,EAAS,OAAOG,GAAWN,CAAgB,EAAA,CAC/E,GACF;AAAA,MAEClhC,IAAQyhC,EAAM,SAAS,uBAAM7sB,IAAA,CAAA,CAAsB;AAAA,IAAA,EAAA,GAPvC4sB,CAQf,CACD,EAAA,CACL;AAAA,EAAA,GACF;AAEJ;AClHO,MAAME,KAAsB1yC,EAAM;AAAA,EACvC,CAAC,EAAE,IAAAyF,GAAI,WAAAxF,GAAW,UAAAK,EAAA,GAAYH,MAC5B,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAD;AAAA,MACA,WAAW,sLAAsLF,CAAS;AAAA,MAC1M,IAAAwF;AAAA,MAEC,UAAAnF;AAAA,IAAA;AAAA,EAAA;AAGP;ACRO,SAASqyC,GAAW;AAAA,EACzB,yBAAAC;AAAA,EACA,0BAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,IAAAttC;AAAA,EACA,WAAAxF;AAAA,EACA,mBAAA+yC;AAAA,EACA,oBAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,gBAAAC;AACF,GAAoB;AAClB,2BACGT,IAAA,EAAoB,WAAW,uBAAuBzyC,CAAS,IAAI,IAAAwF,GACjE,UAAA;AAAA,IAAAqtC,KACC,gBAAA1yC;AAAA,MAACgyC;AAAA,MAAA;AAAA,QACC,kBAAkBQ;AAAA,QAClB,UAAUE;AAAA,QACV,UAAS;AAAA,QACT,MAAMK,KAAkB,gBAAA/yC,EAACgzC,IAAA,CAAA,CAAK;AAAA,QAC9B,eAAc;AAAA,MAAA;AAAA,IAAA;AAAA,IAGjBJ,KACC,gBAAA5yC,EAAC,OAAA,EAAI,WAAU,6IACZ,UAAA4yC,GACH;AAAA,IAEDC,KACC,gBAAA7yC,EAAC,OAAA,EAAI,WAAU,6LACZ,UAAA6yC,GACH;AAAA,IAEF,gBAAAzyC,EAAC,OAAA,EAAI,WAAU,mJACZ,UAAA;AAAA,MAAAuyC,KACC,gBAAA3yC;AAAA,QAACgyC;AAAA,QAAA;AAAA,UACC,kBAAkBS;AAAA,UAClB,UAAUE;AAAA,UACV,UAAS;AAAA,UACT,wBAAOM,IAAA,EAAiB;AAAA,UACxB,WAAU;AAAA,QAAA;AAAA,MAAA;AAAA,MAGbH;AAAA,IAAA,EAAA,CACH;AAAA,EAAA,GACF;AAEJ;AC/FO,SAASI,GAAgB;AAAA,EAC9B,yBAAAV;AAAA,EACA,iBAAAE;AAAA,EACA,IAAArtC;AAAA,EACA,WAAAxF;AAAA,EACA,gBAAAkzC;AACF,GAA0B;AACxB,SACE,gBAAA/yC,EAACsyC,IAAA,EAAoB,WAAU,0BAAyB,IAAAjtC,GACrD,UAAAqtC,KACC,gBAAA1yC;AAAA,IAACgyC;AAAA,IAAA;AAAA,MACC,kBAAkBQ;AAAA,MAClB,UAAUE;AAAA,MACV,UAAS;AAAA,MACT,MAAMK;AAAA,MACN,WAAW,uCAAuClzC,CAAS;AAAA,MAC3D,eAAc;AAAA,IAAA;AAAA,EAAA,GAGpB;AAEJ;ACJO,MAAMszC,KAAevzC,EAAM,WAGhC,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAAQ;AAClC,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAU;AAAA,IAACozC,GAAc;AAAA,IAAd;AAAA,MACC,aAAY;AAAA,MACZ,KAAArzC;AAAA,MACA,WAAWb,EAAG,2DAA2DW,CAAS;AAAA,MACjF,GAAGC;AAAA,MACJ,KAAAK;AAAA,IAAA;AAAA,EAAA;AAGN,CAAC;AAEDgzC,GAAa,cAAcC,GAAc,KAAK;AAGvC,MAAMC,KAAmBzzC,EAAM,WAGpC,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACozC,GAAc;AAAA,EAAd;AAAA,IACC,KAAArzC;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDuzC,GAAiB,cAAcD,GAAc,KAAK;AAG3C,MAAME,KAAsB1zC,EAAM,WAGvC,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACozC,GAAc;AAAA,EAAd;AAAA,IACC,KAAArzC;AAAA,IACC,GAAGD;AAAA,IACJ,WAAWZ;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,EACF;AACF,CACD,GAGY0zC,KAAsB3zC,EAAM,WAGvC,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACozC,GAAc;AAAA,EAAd;AAAA,IACC,KAAArzC;AAAA,IACA,WAAWb;AAAA;AAAA,MAET;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDyzC,GAAoB,cAAcH,GAAc,QAAQ;AClCjD,SAASI,GAA2B;AAAA,EACzC,SAAAC;AAAA,EACA,aAAAlJ;AAAA,EACA,UAAAJ;AAAA,EACA,mBAAAuJ;AAAA,EACA,aAAAC;AAAA,EACA,iBAAAC;AAAA,EACA,IAAAvuC;AACF,GAAoC;AAClC,SACE,gBAAAjF,EAAC,OAAA,EAAI,IAAAiF,GAAQ,WAAU,UACrB,UAAA;AAAA,IAAA,gBAAAjF,EAAC,OAAA,EAAI,WAAU,2CACZ,UAAA;AAAA,MAAAuzC,IAAc,gBAAA3zC,EAAC,MAAA,EAAI,UAAA2zC,EAAA,CAAY,IAAQ;AAAA,MACxC,gBAAA3zC;AAAA,QAACkqC;AAAA,QAAA;AAAA,UACC,WAAW0J;AAAA,UACX,OAAOrJ;AAAA,UACP,UAAAJ;AAAA,UACA,aAAauJ;AAAA,QAAA;AAAA,MAAA;AAAA,IACf,GACF;AAAA,sBACCP,IAAA,EACC,UAAA;AAAA,MAAA,gBAAAnzC,EAACqzC,IAAA,EACE,UAAAI,EAAQ,IAAI,CAACI,MACZ,gBAAA7zC,EAACszC,IAAA,EAAkC,OAAOO,EAAI,OAC3C,UAAAA,EAAI,MAAA,GADmBA,EAAI,GAE9B,CACD,GACH;AAAA,MACCJ,EAAQ,IAAI,CAACI,MACZ,gBAAA7zC,EAACuzC,IAAA,EAAkC,OAAOM,EAAI,OAC3C,UAAAA,EAAI,QAAA,GADmBA,EAAI,GAE9B,CACD;AAAA,IAAA,EAAA,CACH;AAAA,EAAA,GACF;AAEJ;AChFA,SAASC,GAAY,EAAE,GAAGh0C,KAA6D;AACrF,SAAO,gBAAAE,EAAC+zC,EAAiB,MAAjB,EAAuB,GAAGj0C,EAAA,CAAO;AAC3C;AAcA,SAASk0C,GAAW,EAAE,GAAGl0C,KAA4D;AACnF,2BAAQi0C,EAAiB,KAAjB,EAAqB,aAAU,eAAe,GAAGj0C,GAAO;AAClE;AAEA,MAAMm0C,KAAUr0C,EAAM,WAKpB,CAAC,EAAE,WAAAC,GAAW,SAAAmE,IAAU,WAAW,GAAGlE,EAAA,GAASC,MAAQ;AAEvD,QAAM4a,IAAe/a,EAAM;AAAA,IACzB,OAAO;AAAA,MACL,SAAAoE;AAAA,IAAA;AAAA,IAEF,CAACA,CAAO;AAAA,EAAA;AAEV,SACE,gBAAAhE,EAACqkB,GAAY,UAAZ,EAAqB,OAAO1J,GAE3B,UAAA,gBAAA3a;AAAA,IAAC+zC,EAAiB;AAAA,IAAjB;AAAA,MACC,KAAAh0C;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA,GAER;AAEJ,CAAC;AACDm0C,GAAQ,cAAcF,EAAiB,KAAK;AAE5C,MAAMG,KAAiBt0C,EAAM,WAG3B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAAQ;AAClC,QAAM8a,IAAUyJ,GAAA;AAChB,SACE,gBAAAtkB;AAAA,IAAC+zC,EAAiB;AAAA,IAAjB;AAAA,MACC,KAAAh0C;AAAA,MACA,WAAWb;AAAA,QACT;AAAA;AAAA,QAEA;AAAA,QACAqlB,GAAa,EAAE,SAAS1J,EAAQ,SAAS,WAAAhb,GAAW;AAAA;AAAA,MAAA;AAAA,MAErD,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV,CAAC;AACDo0C,GAAe,cAAcH,EAAiB,QAAQ;AAEtD,MAAMI,KAAoBv0C,EAAM,WAK9B,CAAC,EAAE,WAAAC,GAAW,OAAAmlB,GAAO,UAAA9kB,GAAU,GAAGJ,EAAA,GAASC,MAAQ;AACnD,QAAM8a,IAAUyJ,GAAA;AAChB,SACE,gBAAAlkB;AAAA,IAAC2zC,EAAiB;AAAA,IAAjB;AAAA,MACC,KAAAh0C;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACA8lB,KAAS;AAAA,QACTT,GAAa,EAAE,SAAS1J,EAAQ,SAAS,WAAAhb,GAAW;AAAA;AAAA,QACpDA;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,MAEH,UAAA;AAAA,QAAAI;AAAA,QACD,gBAAAF,EAAC8I,IAAA,EAAa,WAAU,2BAAA,CAA2B;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGzD,CAAC;AACDqrC,GAAkB,cAAcJ,EAAiB,WAAW;AAE5D,MAAMK,KAAoBx0C,EAAM,WAG9B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAAQ;AAClC,QAAM8a,IAAUyJ,GAAA;AAChB,SACE,gBAAAtkB;AAAA,IAAC+zC,EAAiB;AAAA,IAAjB;AAAA,MACC,KAAAh0C;AAAA,MACA,WAAWb;AAAA,QACT;AAAA;AAAA,QAEA;AAAA,UACE,iBAAiB2b,EAAQ,YAAY;AAAA,QAAA;AAAA,QAEvChb;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV,CAAC;AACDs0C,GAAkB,cAAcL,EAAiB,WAAW;AAE5D,MAAMM,KAAiBz0C,EAAM,WAG3B,CAAC,EAAE,WAAAC,GAAW,OAAA4E,IAAQ,SAAS,aAAA6vC,IAAc,IAAI,YAAA5vC,IAAa,GAAG,GAAG5E,EAAA,GAASC,MAAQ;AACrF,QAAM8a,IAAUyJ,GAAA;AAChB,SACE,gBAAAtkB,EAAC+zC,EAAiB,QAAjB,EACC,UAAA,gBAAA/zC;AAAA,IAAC+zC,EAAiB;AAAA,IAAjB;AAAA,MACC,KAAAh0C;AAAA,MACA,OAAA0E;AAAA,MACA,aAAA6vC;AAAA,MACA,YAAA5vC;AAAA,MACA,WAAWxF;AAAA,QACT;AAAA;AAAA,QAEA;AAAA;AAAA,QAEA;AAAA,UACE,iBAAiB2b,EAAQ,YAAY;AAAA,QAAA;AAAA,QAEvChb;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA,GAER;AAEJ,CAAC;AACDu0C,GAAe,cAAcN,EAAiB,QAAQ;AAEtD,MAAMQ,KAAc30C,EAAM,WAKxB,CAAC,EAAE,WAAAC,GAAW,OAAAmlB,GAAO,GAAGllB,EAAA,GAASC,MAAQ;AACzC,QAAM8a,IAAUyJ,GAAA;AAChB,SACE,gBAAAtkB;AAAA,IAAC+zC,EAAiB;AAAA,IAAjB;AAAA,MACC,KAAAh0C;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACA8lB,KAAS;AAAA,QACTT,GAAa,EAAE,SAAS1J,EAAQ,SAAS,WAAAhb,GAAW;AAAA;AAAA,QACpDA;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV,CAAC;AACDy0C,GAAY,cAAcR,EAAiB,KAAK;AAEhD,MAAMS,KAAsB50C,EAAM,WAGhC,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,SAAAmlB,GAAS,GAAGvlB,EAAA,GAASC,MAAQ;AACrD,QAAM8a,IAAUyJ,GAAA;AAChB,SACE,gBAAAlkB;AAAA,IAAC2zC,EAAiB;AAAA,IAAjB;AAAA,MACC,KAAAh0C;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACAqlB,GAAa,EAAE,SAAS1J,EAAQ,SAAS,WAAAhb,GAAW;AAAA;AAAA,QACpDA;AAAA,MAAA;AAAA,MAEF,SAAAwlB;AAAA,MACC,GAAGvlB;AAAA,MAEJ,UAAA;AAAA,QAAA,gBAAAE,EAAC,QAAA,EAAK,WAAU,qFACd,UAAA,gBAAAA,EAAC+zC,EAAiB,eAAjB,EACC,UAAA,gBAAA/zC,EAAC4D,IAAA,EAAM,WAAU,gBAAA,CAAgB,EAAA,CACnC,GACF;AAAA,QACC1D;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGP,CAAC;AACDs0C,GAAoB,cAAcT,EAAiB,aAAa;AAEhE,MAAMU,KAAmB70C,EAAM,WAG7B,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,GAAGJ,EAAA,GAASC,MAAQ;AAC5C,QAAM8a,IAAUyJ,GAAA;AAChB,SACE,gBAAAlkB;AAAA,IAAC2zC,EAAiB;AAAA,IAAjB;AAAA,MACC,KAAAh0C;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACAqlB,GAAa,EAAE,SAAS1J,EAAQ,SAAS,WAAAhb,GAAW;AAAA;AAAA,QACpDA;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,MAEJ,UAAA;AAAA,QAAA,gBAAAE,EAAC,QAAA,EAAK,WAAU,qFACd,UAAA,gBAAAA,EAAC+zC,EAAiB,eAAjB,EACC,UAAA,gBAAA/zC,EAACyO,IAAA,EAAO,WAAU,gCAAA,CAAgC,EAAA,CACpD,GACF;AAAA,QACCvO;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGP,CAAC;AACDu0C,GAAiB,cAAcV,EAAiB,UAAU;AAE1D,MAAMW,KAAe90C,EAAM,WAKzB,CAAC,EAAE,WAAAC,GAAW,OAAAmlB,GAAO,GAAGllB,KAASC,MACjC,gBAAAC;AAAA,EAAC+zC,EAAiB;AAAA,EAAjB;AAAA,IACC,KAAAh0C;AAAA,IACA,WAAWb,EAAG,iDAAiD8lB,KAAS,WAAWnlB,CAAS;AAAA,IAC3F,GAAGC;AAAA,EAAA;AACN,CACD;AACD40C,GAAa,cAAcX,EAAiB,MAAM;AAElD,MAAMY,KAAmB/0C,EAAM,WAG7B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAAC+zC,EAAiB;AAAA,EAAjB;AAAA,IACC,KAAAh0C;AAAA,IACA,WAAWb,EAAG,wCAAwCW,CAAS;AAAA,IAC9D,GAAGC;AAAA,EAAA;AACN,CACD;AACD60C,GAAiB,cAAcZ,EAAiB,UAAU;AC1N1D,MAAMa,KAAmB,CAAC70C,GAAmC2sC,MAA8B;AACzF,aAAW,MAAM;AACf,IAAAA,EAAK,QAAQ,CAACnmC,MAAQ;;AACpB,OAAArE,IAAAnC,EAAI,YAAJ,QAAAmC,EAAa,cAAc,IAAI,cAAc,WAAWqE,CAAG;AAAA,IAC7D,CAAC;AAAA,EACH,GAAG,CAAC;AACN,GAEMsuC,KAAoB,CACxB3hB,GACA0e,GACAC,GACAC,MACG;AACH,MAAI,CAACD,EAAoB;AAEzB,QAAMiD,IAAwB,OAAO,QAAQ5hB,CAAM,EAChD;AAAA,IACC,CAAC,CAAC3sB,GAAK6J,CAAK,MACT,YAAYA,KAASA,EAAM,WAAWyhC,KAAuBtrC,MAAQsrC;AAAA,EAAA,EAEzE,KAAK,CAAC,CAAA,EAAGx/B,CAAC,GAAG,CAAA,EAAGtM,CAAC,MAAMsM,EAAE,QAAQtM,EAAE,KAAK;AAE3C,SAAO+uC,EAAsB,QAAQ,CAAC,CAAC/C,CAAQ,GAAGnhC,MAAU;AAC1D,UAAMmkC,IAAanD,EAChB,OAAO,CAAC3sC,MAASA,EAAK,UAAU8sC,CAAQ,EACxC,KAAK,CAAC1/B,GAAGtM,MAAMsM,EAAE,QAAQtM,EAAE,KAAK,EAChC,IAAI,CAACd,wBAED4N,IAAA,EACC,UAAA;AAAA,MAAA,gBAAA7S,EAAC8S,IAAA,EAAe,SAAO,IACpB,UAAA,aAAa7N,IACZ,gBAAA7E;AAAA,QAACm0C;AAAA,QAAA;AAAA,UAEC,SAAS,MAAM;AAGb,YAAAzC,EAAiB7sC,CAAiC;AAAA,UACpD;AAAA,UAEC,UAAA;AAAA,YAAAA,EAAK,kBACJ,gBAAAjF,EAACwxC,IAAA,EAAa,MAAMvsC,EAAK,gBAAgB,WAAWA,EAAK,OAAO,SAAO,GAAA,CAAC;AAAA,YAEzEA,EAAK;AAAA,YACLA,EAAK,iBACJ,gBAAAjF,EAACwxC,IAAA,EAAa,MAAMvsC,EAAK,eAAe,WAAWA,EAAK,MAAA,CAAO;AAAA,UAAA;AAAA,QAAA;AAAA,QAZ5D,gBAAgBA,EAAK,KAAK,IAAIA,EAAK,OAAO;AAAA,MAAA,sBAgBhD+uC,IAAA,EACC,UAAA;AAAA,QAAA,gBAAAh0C,EAACm0C,IAAA,EAAmB,YAAK,MAAA,CAAM;AAAA,0BAC9BC,IAAA,EACE,UAAAS;AAAA,UACC3hB;AAAA,UACA0e;AAAA,UACAL,GAAgCre,GAAQjuB,EAAK,EAAE;AAAA,UAC/C6sC;AAAA,QAAA,EACF,CACF;AAAA,MAAA,KATe,eAAe7sC,EAAK,KAAK,IAAIA,EAAK,EAAE,EAUrD,GAEJ;AAAA,MACCA,EAAK,WAAW,gBAAAjF,EAAC+S,IAAA,EAAgB,YAAK,QAAA,CAAQ;AAAA,IAAA,EAAA,GAjCnC,WAAW9N,EAAK,KAAK,IAAI,aAAaA,IAAOA,EAAK,UAAUA,EAAK,EAAE,EAkCjF,CAEH,GAEG+vC,IAAqB,CAAC,GAAGD,CAAU;AACzC,WAAIA,EAAW,SAAS,KAAKnkC,IAAQkkC,EAAsB,SAAS,KAClEE,EAAmB,KAAK,gBAAAh1C,EAAC20C,IAAA,CAAA,GAAsB,aAAa5C,CAAQ,EAAI,CAAE,GAGrEiD;AAAA,EACT,CAAC;AACH;AAqBO,SAASC,GAAgB;AAAA,EAC9B,UAAAhD;AAAA,EACA,kBAAAH;AAAA,EACA,cAAA/a;AAAA,EACA,SAAA/yB;AACF,GAAyB;AAGvB,QAAMkxC,IAAa7xC,EAAuB,MAAU,GAE9C8xC,IAAiB9xC,EAA0B,MAAU,GAErD+xC,IAAgB/xC,EAA0B,MAAU,GAEpDgyC,IAAgBhyC,EAA0B,MAAU,GAEpDiyC,IAAcjyC,EAA0B,MAAU,GAElDkyC,IAAkB,CAACnD,MAAsB;AAC7C,YAAQA,GAAA;AAAA,MACN,KAAK;AACH,eAAO+C;AAAA,MACT,KAAK;AACH,eAAOC;AAAA,MACT,KAAK;AACH,eAAOC;AAAA,MACT,KAAK;AACH,eAAOC;AAAA,MACT;AACE;AAAA,IAAO;AAAA,EAEb;AA6DA,MA1DAE,GAAW,CAAC,OAAO,SAAS,SAAS,SAAS,OAAO,GAAG,CAACrpC,GAAOspC,MAAY;;AAC1E,IAAAtpC,EAAM,eAAA;AAEN,UAAMupC,IAA4B,EAAE,KAAK,UAAU,MAAM,UAAU,SAAS,IAAI,SAAS,GAAA,GACnFC,IAA8B,EAAE,KAAK,KAAK,MAAM,SAAS,SAAS,IAAI,SAAS,GAAA;AAErF,YAAQF,EAAQ,QAAA;AAAA,MACd,KAAK;AACH,QAAAb,GAAiBO,GAAgB,CAACO,CAAM,CAAC;AACzC;AAAA,MACF,KAAK;AACH,SAAAxzC,IAAAizC,EAAe,YAAf,QAAAjzC,EAAwB,SACxB0yC,GAAiBO,GAAgB,CAACO,GAAQC,CAAQ,CAAC;AACnD;AAAA,MACF,KAAK;AACH,SAAA1c,IAAAmc,EAAc,YAAd,QAAAnc,EAAuB,SACvB2b,GAAiBQ,GAAe,CAACM,GAAQC,CAAQ,CAAC;AAClD;AAAA,MACF,KAAK;AACH,SAAAzc,IAAAmc,EAAc,YAAd,QAAAnc,EAAuB,SACvB0b,GAAiBS,GAAe,CAACK,GAAQC,CAAQ,CAAC;AAClD;AAAA,MACF,KAAK;AACH,SAAAxc,IAAAmc,EAAY,YAAZ,QAAAnc,EAAqB,SACrByb,GAAiBU,GAAa,CAACI,GAAQC,CAAQ,CAAC;AAChD;AAAA,IAEA;AAAA,EAEN,CAAC,GAEDh6B,EAAU,MAAM;AACd,QAAI,CAACob,KAAgB,CAACme,EAAW,QAAS;AAE1C,UAAM9mB,IAAW,IAAI,iBAAiB,CAACwnB,MAAc;AACnD,MAAAA,EAAU,QAAQ,CAACC,MAAa;AAC9B,YAAIA,EAAS,kBAAkB,gBAAgBA,EAAS,kBAAkB,aAAa;AACrF,gBAAM7O,IAAQ6O,EAAS,OAAO,aAAa,YAAY;AAEvD,UACE9e,EADEiQ,MAAU,MACK;AAAA,QAIrB;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAKD,WAHuBkO,EAAW,QACS,iBAAiB,cAAc,EAEtD,QAAQ,CAACjpC,MAAY;AACvC,MAAAmiB,EAAS,QAAQniB,GAAS,EAAE,YAAY,IAAM;AAAA,IAChD,CAAC,GAEM,MAAMmiB,EAAS,WAAA;AAAA,EACxB,GAAG,CAAC2I,CAAY,CAAC,GAEb,EAACkb;AAEL,WACE,gBAAAjyC,EAACi0C,IAAA,EAAQ,KAAKiB,GAAY,WAAU,wCAAuC,SAAAlxC,GACxE,UAAA,OAAO,QAAQiuC,EAAS,OAAO,EAC7B,OAAO,CAAC,CAAA,EAAG1lB,CAAM,MAAM,OAAOA,KAAW,QAAQ,EACjD,KAAK,CAAC,CAAA,EAAGla,CAAC,GAAG,CAAA,EAAGtM,CAAC,MACZ,OAAOsM,KAAM,aAAa,OAAOtM,KAAM,YAAkB,IACtDsM,EAAE,QAAQtM,EAAE,KACpB,EACA,IAAI,CAAC,CAACqsC,GAAW7lB,CAAM,MACtB,gBAAAnsB,EAAC0zC,IAAA,EACC,UAAA;AAAA,MAAA,gBAAA9zC,EAACk0C,IAAA,EAAe,KAAKqB,EAAgBnD,CAAS,GAC3C,UAAA,OAAO7lB,KAAW,YAAY,WAAWA,KAAUA,EAAO,MAAA,CAC7D;AAAA,MACA,gBAAAvsB;AAAA,QAACq0C;AAAA,QAAA;AAAA,UACC,WAAU;AAAA,UAEV,UAAA,gBAAAr0C,EAAC2S,MACE,UAAAkiC,GAAkB5C,EAAS,QAAQA,EAAS,OAAOG,GAAWN,CAAgB,EAAA,CACjF;AAAA,QAAA;AAAA,MAAA;AAAA,IACF,KAVgBM,CAWlB,CACD,GACL;AAEJ;AC7LO,SAAS0D,GACdC,GACoB;AACpB,UAAQA,GAAA;AAAA,IACN,KAAK;AACH;AAAA,IACF,KAAK;AACH,aAAO;AAAA,IACT;AACE,aAAO;AAAA,EAAA;AAEb;AASO,SAASC,GAAQ;AAAA,EACtB,UAAA/D;AAAA,EACA,cAAAlb;AAAA,EACA,kBAAA+a;AAAA,EACA,WAAAjyC;AAAA,EACA,IAAAwF;AAAA,EACA,UAAAnF;AAAA,EACA,qBAAA+1C;AAAA,EACA,oBAAAC;AAAA,EACA,wBAAAC;AAAA,EACA,gBAAAC,IAAiB;AACnB,GAAiB;AAGf,QAAMC,IAAehzC,EAAuB,MAAU;AAEtD,SACE,gBAAArD;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWd,EAAG,wCAAwCW,CAAS;AAAA,MAC/D,KAAKw2C;AAAA,MACL,OAAO,EAAE,UAAU,WAAA;AAAA,MACnB,IAAAhxC;AAAA,MAEA,UAAA,gBAAAjF;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,WAAU;AAAA,UAEV,OAAO+1C,IAAyB,EAAE,iBAAiB,WAAW;AAAA,UAG9D,UAAA;AAAA,YAAA,gBAAAn2C,EAAC,OAAA,EAAI,WAAU,8BACb,UAAA,gBAAAI;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,WAAU;AAAA,gBAEV,OAAO+1C,IAAyB,EAAE,iBAAiB,cAAc;AAAA,gBAEhE,UAAA;AAAA,kBAAAF;AAAA,kBAEAhE,KACC,gBAAAjyC;AAAA,oBAACi1C;AAAA,oBAAA;AAAA,sBACC,UAAAhD;AAAA,sBACA,cAAAlb;AAAA,sBACA,kBAAA+a;AAAA,sBACA,SAASsE;AAAA,oBAAA;AAAA,kBAAA;AAAA,gBACX;AAAA,cAAA;AAAA,YAAA,GAGN;AAAA,YAGA,gBAAAp2C;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,WAAU;AAAA,gBAEV,OAAOm2C,IAAyB,EAAE,iBAAiB,cAAc;AAAA,gBAEhE,UAAAj2C;AAAA,cAAA;AAAA,YAAA;AAAA,YAIH,gBAAAF,EAAC,OAAA,EAAI,WAAU,wDACb,UAAA,gBAAAA;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,WAAU;AAAA,gBAEV,OAAOm2C,IAAyB,EAAE,iBAAiB,cAAc;AAAA,gBAEhE,UAAAD;AAAA,cAAA;AAAA,YAAA,EACH,CACF;AAAA,UAAA;AAAA,QAAA;AAAA,MAAA;AAAA,IACF;AAAA,EAAA;AAGN;AC5HA,MAAMnlC,KAAiB,CACrBC,GACAzK,MAEOyK,EAAQzK,CAAG,KAAKA;AA2DlB,SAAS+vC,GAAmB;AAAA,EACjC,kBAAAC;AAAA,EACA,iBAAAC,IAAkB;AAAA,EAClB,mBAAAC,IAAoB,CAAA;AAAA,EACpB,mBAAAC;AAAA,EACA,yBAAAC;AAAA,EACA,2BAAAC;AAAA,EACA,kBAAArtC;AAAA,EACA,WAAA1J;AAAA,EACA,IAAAwF;AACF,GAA4B;AAC1B,QAAMwxC,IAAwB9lC;AAAA,IAC5BxH;AAAA,IACA;AAAA,EAAA,GAEI,CAAChE,GAAQC,CAAS,IAAIC,EAAS,EAAK,GAEpCqxC,IAAuB,CAACvgB,MAAiB;AAC7C,IAAIogB,OAAiDpgB,CAAI,GAErDmgB,KACFA,EAAkB,CAACngB,GAAM,GAAGkgB,EAAkB,OAAO,CAACM,MAASA,MAASxgB,CAAI,CAAC,CAAC,GAC5EqgB,KAA6BH,EAAkB,KAAK,CAACtkC,MAAMA,MAAMokB,CAAI,KACvEqgB,EAA0B,CAAC,GAAGH,EAAkB,OAAO,CAACM,MAASA,MAASxgB,CAAI,CAAC,CAAC,GAClF/wB,EAAU,EAAK;AAAA,EACjB,GAaMwxC,IAAyB,CAACD,GAAcE,MAAmB;;AAC/D,UAAMC,IACJD,MAAWF,MACN9d,KAAA/2B,IAAAq0C,EAAiBQ,CAAI,MAArB,gBAAA70C,EAAwB,YAAxB,gBAAA+2B,EAAkCge,SAAW9d,KAAAD,IAAAqd,EAAiBQ,CAAI,MAArB,gBAAA7d,EAAwB,YAAxB,gBAAAC,EAAiC,MAC/E;AAEN,WAAO+d,IACH,IAAGxb,IAAA6a,EAAiBQ,CAAI,MAArB,gBAAArb,EAAwB,OAAO,KAAKwb,CAAO,OAC9CC,IAAAZ,EAAiBQ,CAAI,MAArB,gBAAAI,EAAwB;AAAA,EAC9B;AAEA,2BACG,OAAA,EAAI,IAAA9xC,GAAQ,WAAWnG,EAAG,sBAAsBW,CAAS,GAExD,UAAA;AAAA,IAAA,gBAAAO;AAAA,MAACosB;AAAA,MAAA;AAAA,QACC,MAAK;AAAA,QACL,OAAOgqB;AAAA,QACP,eAAeM;AAAA,QACf,MAAMvxC;AAAA,QACN,cAAc,CAACoK,MAASnK,EAAUmK,CAAI;AAAA,QAEtC,UAAA;AAAA,UAAA,gBAAA3P,EAAC6sB,IAAA,EACC,UAAA,gBAAA7sB,EAAC2sB,IAAA,CAAA,CAAY,GACf;AAAA,UACA,gBAAA3sB;AAAA,YAACgtB;AAAA,YAAA;AAAA,cACC,WAAU;AAAA,cAET,iBAAO,KAAKupB,CAAgB,EAAE,IAAI,CAAChwC,MAEhC,gBAAAvG,EAACmtB,MAAqB,OAAO5mB,GAC1B,YAAuBA,GAAKiwC,CAAe,KAD7BjwC,CAEjB,CAEH;AAAA,YAAA;AAAA,UAAA;AAAA,QACH;AAAA,MAAA;AAAA,IAAA;AAAA,IAIDiwC,MAAoB,QACnB,gBAAAx2C,EAAC,OAAA,EAAI,WAAU,WACb,UAAA,gBAAAA,EAACoO,IAAA,EAAM,WAAU,2CACd,UAAAwY,GAAwBiwB,GAAuB;AAAA,MAC9C,oBACEJ,KAAA,gBAAAA,EAAmB,UAAS,IACxBA,EACG,IAAI,CAACnkC,MAAM0kC,EAAuB1kC,GAAGkkC,CAAe,CAAC,EACrD,KAAK,IAAI,IACZD,EAAiB,GAAG;AAAA,IAAA,CAC3B,GACH,EAAA,CACF;AAAA,EAAA,GAEJ;AAEJ;AC5KA,SAASa,GAAW,EAAE,MAAAnyC,GAAM,aAAAoyC,GAAa,oBAAAC,KAAkD;AACzF,SAAID,IACK,gBAAAr3C,EAACoO,IAAA,EAAO,UAAAipC,EAAYpyC,CAAI,GAAE,IAE/BqyC,IACK,gBAAAt3C,EAACoO,IAAA,EAAO,UAAAkpC,EAAmBryC,CAAI,GAAE,IAEnC,gBAAAjF,EAACoO,MAAO,UAAAnJ,EAAA,CAAK;AACtB;ACuBO,SAASsyC,GAAU;AAAA,EACxB,IAAAlyC;AAAA,EACA,WAAAxF;AAAA,EACA,WAAA23C;AAAA,EACA,mBAAAC;AAAA,EACA,sBAAAC;AAAA,EACA,aAAAL;AAAA,EACA,oBAAAC;AACF,GAAmB;AACjB,SACE,gBAAAt3C,EAAC,OAAA,EAAI,IAAAqF,GAAQ,WAAAxF,GACV,UAAA23C,EAAU,IAAI,CAACvyC,MACd,gBAAA7E,EAAC,OAAA,EAAe,WAAU,kCACxB,UAAA;AAAA,IAAA,gBAAAJ;AAAA,MAACmgC;AAAA,MAAA;AAAA,QACC,WAAU;AAAA,QACV,SAASsX,EAAkB,SAASxyC,CAAI;AAAA,QACxC,iBAAiB,CAAC+J,MAAmB0oC,EAAqBzyC,GAAM+J,CAAK;AAAA,MAAA;AAAA,IAAA;AAAA,IAEvE,gBAAAhP;AAAA,MAACo3C;AAAA,MAAA;AAAA,QACC,MAAAnyC;AAAA,QACA,aAAAoyC;AAAA,QACA,oBAAAC;AAAA,MAAA;AAAA,IAAA;AAAA,EACF,KAVQryC,CAWV,CACD,GACH;AAEJ;ACjCO,SAAS0yC,GAAY;AAAA,EAC1B,SAAAC;AAAA,EACA,YAAA70C;AAAA,EACA,UAAAC;AAAA,EACA,UAAA60C;AAAA,EACA,UAAAC,IAAW;AAAA,EACX,WAAAj4C;AAAA,EACA,UAAAK;AAAA,EACA,iBAAAgnB;AAAA,EACA,2BAAA6wB;AAAA,EACA,aAAAC;AACF,GAAqB;AAQnB,SACE,gBAAA53C;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,QAAQ03C;AAAA,MAER,SAAS90C;AAAA,MACT,WAZkB,CAACmJ,MAA+B;AACpD,SAAIA,EAAM,QAAQ,WAAWA,EAAM,QAAQ,SACzCA,EAAM,eAAA,GACNnJ,EAAA;AAAA,MAEJ;AAAA,MAQI,MAAK;AAAA,MACL,UAAU;AAAA,MACV,gBAAcD;AAAA,MACd,WAAW7D;AAAA,QACT;AAAA,QACA,EAAE,sCAAsC24C,KAAY,CAAC90C,EAAA;AAAA,QACrD,EAAE,gBAAgBA,EAAA;AAAA,QAClB,EAAE,qBAAqB,CAACA,EAAA;AAAA,QACxBlD;AAAA,MAAA;AAAA,MAGF,UAAA;AAAA,QAAA,gBAAAO,EAAC,OAAA,EAAI,WAAU,uCACb,UAAA;AAAA,UAAA,gBAAAA,EAAC,OAAA,EAAI,WAAU,iDACb,UAAA;AAAA,YAAA,gBAAAJ,EAAC,OAAA,EAAI,WAAU,wBAAwB,UAAAE,EAAA,CAAS;AAAA,YAC/C6C,KAAcmkB,KACb,gBAAA9mB,EAAC0kB,IAAA,EACC,UAAA;AAAA,cAAA,gBAAA9kB,EAACwkB,MAAoB,WAAWtlB,EAAG84C,KAAe,SAAS,GAAG,SAAO,IACnE,UAAA,gBAAAh4C,EAAC+D,KAAO,WAAU,wBAAuB,SAAQ,SAAQ,MAAK,QAC5D,UAAA,gBAAA/D,EAACsnB,IAAA,EAAe,GAClB,EAAA,CACF;AAAA,cACA,gBAAAtnB,EAACklB,IAAA,EAAoB,OAAM,OAAO,UAAAgC,EAAA,CAAgB;AAAA,YAAA,EAAA,CACpD;AAAA,UAAA,GAEJ;AAAA,UACCnkB,KAAcg1C,KACb,gBAAA/3C,EAAC,OAAA,EAAI,WAAU,wDACZ,UAAA+3C,EAAA,CACH;AAAA,QAAA,GAEJ;AAAA,QACCC,KACC,gBAAAh4C;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAW,oEAAoEg4C,CAAW;AAAA,UAAA;AAAA,QAAA;AAAA,MAC5F;AAAA,IAAA;AAAA,IArCGJ;AAAA,EAAA;AAyCX;ACxFO,MAAMK,KAAUn1C,GAAwC,CAAC,EAAE,WAAAjD,GAAW,GAAGC,EAAA,GAASC,MAErF,gBAAAC,EAACk4C,IAAA,EAAa,MAAM,IAAI,WAAWh5C,EAAG,mBAAmBW,CAAS,GAAI,GAAGC,GAAO,KAAAC,EAAA,CAAU,CAE7F;AAEDk4C,GAAQ,cAAc;AC0Cf,SAASE,GAAU;AAAA,EACxB,IAAA9yC;AAAA,EACA,YAAAqK,IAAa;AAAA,EACb,UAAA0oC,IAAW;AAAA,EACX,aAAAhO,IAAc;AAAA,EACd,YAAAiO;AAAA,EACA,OAAA96B;AAAA,EACA,aAAAtD;AAAA,EACA,YAAAq+B,IAAa;AAAA,EACb,WAAAz4C;AAAA,EACA,cAAA04C;AAAA,EACA,OAAAvpC;AAAA,EACA,UAAAC;AAAA,EACA,SAAAupC;AAAA,EACA,QAAAC;AACF,GAAmB;AACjB,SACE,gBAAAr4C,EAAC,SAAI,WAAWlB,EAAG,6CAA6C,EAAE,aAAakrC,GAAa,GAC1F,UAAA;AAAA,IAAA,gBAAApqC;AAAA,MAAC04C;AAAAA,MAAA;AAAA,QACC,SAASrzC;AAAA,QACT,WAAWnG,EAAG;AAAA,UACZ,mBAAmBk5C;AAAA,UACnB,aAAa,CAAC76B;AAAA,QAAA,CACf;AAAA,QACD,UAAA,GAAGA,CAAK,GAAG+6B,IAAa,MAAM,EAAE;AAAA,MAAA;AAAA,IAAA;AAAA,IAClC,gBAAAt4C;AAAA,MAAC24C;AAAAA,MAAA;AAAA,QACC,IAAAtzC;AAAA,QACA,UAAUqK;AAAA,QACV,aAAAuK;AAAA,QACA,UAAUq+B;AAAA,QACV,WAAWp5C,EAAGW,GAAW,EAAE,qBAAqBu4C,GAAU;AAAA,QAC1D,cAAAG;AAAA,QACA,OAAAvpC;AAAA,QACA,UAAAC;AAAA,QACA,SAAAupC;AAAA,QACA,QAAAC;AAAA,MAAA;AAAA,IAAA;AAAA,IAEF,gBAAAz4C,EAAC,KAAA,EAAE,WAAWd,EAAG,EAAE,aAAa,CAACm5C,EAAA,CAAY,GAAI,UAAAA,EAAA,CAAW;AAAA,EAAA,GAC9D;AAEJ;AC7FA,MAAMO,KAAgB90C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMpB;AAAA,EACA;AAAA,IACE,UAAU;AAAA,MACR,SAAS;AAAA,QACP,SAAS;AAAA,QACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAME;AAAA;AAAA,MAAA;AAAA,IACJ;AAAA,IAEF,iBAAiB;AAAA,MACf,SAAS;AAAA,IAAA;AAAA,EACX;AAEJ,GAMM+0C,KAAQj5C,EAAM,WAGlB,CAAC,EAAE,WAAAC,GAAW,SAAAmE,GAAS,GAAGlE,KAASC,MACnC,gBAAAC;AAAA,EAAC;AAAA,EAAA;AAAA,IACC,KAAAD;AAAA,IACA,MAAK;AAAA,IACL,WAAWb;AAAA;AAAA,MAET;AAAA,MACA05C,GAAc,EAAE,SAAA50C,GAAS;AAAA,MACzBnE;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACD+4C,GAAM,cAAc;AAGpB,MAAMC,KAAal5C,EAAM;AAAA,EACvB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MACxB,gBAAAK;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,KAAAL;AAAA,MACA,WAAWb,EAAG,4DAA4DW,CAAS;AAAA,MAClF,GAAGC;AAAA,MAGH,UAAA;AAAA,QAAAA,EAAM;AAAA,QAAU;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGvB;AACAg5C,GAAW,cAAc;AAGzB,MAAMC,KAAmBn5C,EAAM,WAG7B,CAAC,EAAE,WAAAC,GAAW,GAAGC,KAASC,wBACzB,OAAA,EAAI,KAAAA,GAAU,WAAWb,EAAG,uCAAuCW,CAAS,GAAI,GAAGC,GAAO,CAC5F;AACDi5C,GAAiB,cAAc;AC9D/B,MAAMC,KAAcC,GAAqB,MAGnCC,KAAqBD,GAAqB,SAG1CE,KAAmBF,GAAqB,OAGxCG,KAAoBH,GAAqB,QAGzCI,KAAiBJ,GAAqB,KAGtCK,KAAwBL,GAAqB,YAG7CM,KAAwB35C,EAAM,WAKlC,CAAC,EAAE,WAAAC,GAAW,OAAAmlB,GAAO,UAAA9kB,GAAU,GAAGJ,KAASC,MAC3C,gBAAAK;AAAA,EAAC64C,GAAqB;AAAA,EAArB;AAAA,IACC,KAAAl5C;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACA8lB,KAAS;AAAA,MACTnlB;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,IAEH,UAAA;AAAA,MAAAI;AAAA,MACD,gBAAAF,EAAC8I,IAAA,EAAa,WAAU,2BAAA,CAA2B;AAAA,IAAA;AAAA,EAAA;AACrD,CACD;AACDywC,GAAsB,cAAcN,GAAqB,WAAW;AAGpE,MAAMO,KAAwB55C,EAAM,WAGlC,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACi5C,GAAqB;AAAA,EAArB;AAAA,IACC,KAAAl5C;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACD05C,GAAsB,cAAcP,GAAqB,WAAW;AAGpE,MAAMQ,KAAqB75C,EAAM,WAG/B,CAAC,EAAE,WAAAC,GAAW,GAAGC,KAASC,MAC1B,gBAAAC,EAACi5C,GAAqB,QAArB,EACC,UAAA,gBAAAj5C;AAAA,EAACi5C,GAAqB;AAAA,EAArB;AAAA,IACC,KAAAl5C;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,GACF,CACD;AACD25C,GAAmB,cAAcR,GAAqB,QAAQ;AAG9D,MAAMS,KAAkB95C,EAAM,WAK5B,CAAC,EAAE,WAAAC,GAAW,OAAAmlB,GAAO,GAAGllB,KAASC,MACjC,gBAAAC;AAAA,EAACi5C,GAAqB;AAAA,EAArB;AAAA,IACC,KAAAl5C;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACA8lB,KAAS;AAAA,MACTnlB;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACD45C,GAAgB,cAAcT,GAAqB,KAAK;AAGxD,MAAMU,KAA0B/5C,EAAM,WAGpC,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,SAAAmlB,GAAS,GAAGvlB,KAASC,MAC7C,gBAAAK;AAAA,EAAC64C,GAAqB;AAAA,EAArB;AAAA,IACC,KAAAl5C;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAEF,SAAAwlB;AAAA,IACC,GAAGvlB;AAAA,IAEJ,UAAA;AAAA,MAAA,gBAAAE,EAAC,QAAA,EAAK,WAAU,qFACd,UAAA,gBAAAA,EAACi5C,GAAqB,eAArB,EACC,UAAA,gBAAAj5C,EAAC4D,IAAA,EAAM,WAAU,gBAAA,CAAgB,EAAA,CACnC,GACF;AAAA,MACC1D;AAAA,IAAA;AAAA,EAAA;AACH,CACD;AACDy5C,GAAwB,cAAcV,GAAqB,aAAa;AAGxE,MAAMW,KAAuBh6C,EAAM,WAGjC,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,GAAGJ,KAASC,MACpC,gBAAAK;AAAA,EAAC64C,GAAqB;AAAA,EAArB;AAAA,IACC,KAAAl5C;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,IAEJ,UAAA;AAAA,MAAA,gBAAAE,EAAC,QAAA,EAAK,WAAU,qFACd,UAAA,gBAAAA,EAACi5C,GAAqB,eAArB,EACC,UAAA,gBAAAj5C,EAACyO,IAAA,EAAO,WAAU,gCAAA,CAAgC,EAAA,CACpD,GACF;AAAA,MACCvO;AAAA,IAAA;AAAA,EAAA;AACH,CACD;AACD05C,GAAqB,cAAcX,GAAqB,UAAU;AAGlE,MAAMY,KAAmBj6C,EAAM,WAK7B,CAAC,EAAE,WAAAC,GAAW,OAAAmlB,GAAO,GAAGllB,KAASC,MACjC,gBAAAC;AAAA,EAACi5C,GAAqB;AAAA,EAArB;AAAA,IACC,KAAAl5C;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACA8lB,KAAS;AAAA,MACTnlB;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACD+5C,GAAiB,cAAcZ,GAAqB,MAAM;AAG1D,MAAMa,KAAuBl6C,EAAM,WAGjC,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACi5C,GAAqB;AAAA,EAArB;AAAA,IACC,KAAAl5C;AAAA,IACA,WAAWb,EAAG,yCAAyCW,CAAS;AAAA,IAC/D,GAAGC;AAAA,EAAA;AACN,CACD;AACDg6C,GAAqB,cAAcb,GAAqB,UAAU;AAGlE,SAASc,GAAoB,EAAE,WAAAl6C,GAAW,GAAGC,KAAgD;AAC3F,SACE,gBAAAE;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWd,EAAG,qEAAqEW,CAAS;AAAA,MAC3F,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACAi6C,GAAoB,cAAc;AC3LlC,MAAMC,KAAgBp6C,EAAM,cAEzB;AAAA,EACD,WAAW;AACb,CAAC;AAOD,SAASq6C,GAAO;AAAA,EACd,uBAAAC,IAAwB;AAAA,EACxB,WAAAnyC,IAAY;AAAA,EACZ,GAAGjI;AACL,GAAsD;AAEpD,QAAM6a,IAAe/a,EAAM,QAAQ,OAAO,EAAE,WAAAmI,MAAc,CAACA,CAAS,CAAC;AACrE,SACE,gBAAA/H,EAACg6C,GAAc,UAAd,EAAuB,OAAOr/B,GAC7B,UAAA,gBAAA3a;AAAA,IAACm6C,GAAgB;AAAA,IAAhB;AAAA,MACC,uBAAAD;AAAA,MACA,WAAAnyC;AAAA,MACC,GAAGjI;AAAA,IAAA;AAAA,EAAA,GAER;AAEJ;AACAm6C,GAAO,cAAc;AAGrB,MAAMG,KAAgBD,GAAgB,SAGhCE,KAAeF,GAAgB,QAG/BG,KAAcH,GAAgB,OAG9BI,KAAgB36C,EAAM,WAG1B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACm6C,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAAp6C;AAAA,IACA,WAAWb,EAAG,8CAA8CW,CAAS;AAAA,IACpE,GAAGC;AAAA,EAAA;AACN,CACD;AACDy6C,GAAc,cAAcJ,GAAgB,QAAQ;AAUpD,MAAMK,KAAgB56C,EAAM,WAG1B,CAAC,EAAE,WAAAC,GAAW,UAAAK,GAAU,kBAAAu6C,IAAmB,IAAO,GAAG36C,EAAA,GAASC,MAAQ;AAEtE,QAAM,EAAE,WAAAgI,IAAY,SAAA,IAAanI,EAAM,WAAWo6C,EAAa,GAGzDU,IAAkB;AAAA,IACtB,QAAQ;AAAA,IACR,KAAK;AAAA,IACL,MAAM;AAAA,IACN,OAAO;AAAA,EAAA,GAIHC,IAAe;AAAA,IACnB,QAAQ;AAAA,IACR,KAAK;AAAA,IACL,MAAM;AAAA,IACN,OAAO;AAAA,EAAA;AAGT,2BACGN,IAAA,EACC,UAAA;AAAA,IAAA,gBAAAr6C,EAACu6C,IAAA,EAAc;AAAA,IACf,gBAAAn6C;AAAA,MAAC+5C,GAAgB;AAAA,MAAhB;AAAA,QACC,KAAAp6C;AAAA,QACA,WAAWb;AAAA;AAAA;AAAA,UAGT;AAAA,UACA6I,MAAc,YAAYA,MAAc,QAAQ,gBAAgB;AAAA,UAChE2yC,EAAgB3yC,CAAS;AAAA,UACzBlI;AAAA,QAAA;AAAA,QAED,GAAGC;AAAA,QAGH,UAAA;AAAA,UAAA,CAAC26C,MAAqB1yC,MAAc,YAAYA,MAAc,8BAC5D,OAAA,EAAI,WAAW4yC,EAAa5yC,CAAS,EAAA,CAAG;AAAA,UAE3C,gBAAA/H,EAAC,OAAA,EAAI,WAAU,uBAAuB,UAAAE,EAAA,CAAS;AAAA,UAC9C,CAACu6C,MAAqB1yC,MAAc,SAASA,MAAc,WAC1D,gBAAA/H,EAAC,OAAA,EAAI,WAAW26C,EAAa5yC,CAAS,EAAA,CAAG;AAAA,QAAA;AAAA,MAAA;AAAA,IAAA;AAAA,EAE7C,GACF;AAEJ,CAAC;AACDyyC,GAAc,cAAc;AAG5B,SAASI,GAAa,EAAE,WAAA/6C,GAAW,GAAGC,KAA+C;AACnF,SACE,gBAAAE;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWd,EAAG,4DAA4DW,CAAS;AAAA,MAClF,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AACA86C,GAAa,cAAc;AAG3B,SAASC,GAAa,EAAE,WAAAh7C,GAAW,GAAGC,KAA+C;AACnF,SACE,gBAAAE,EAAC,SAAI,WAAWd,EAAG,kDAAkDW,CAAS,GAAI,GAAGC,GAAO;AAEhG;AACA+6C,GAAa,cAAc;AAG3B,MAAMC,KAAcl7C,EAAM,WAGxB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACm6C,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAAp6C;AAAA,IACA,WAAWb,EAAG,iEAAiEW,CAAS;AAAA,IACvF,GAAGC;AAAA,EAAA;AACN,CACD;AACDg7C,GAAY,cAAcX,GAAgB,MAAM;AAGhD,MAAMY,KAAoBn7C,EAAM,WAG9B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACm6C,GAAgB;AAAA,EAAhB;AAAA,IACC,KAAAp6C;AAAA,IACA,WAAWb,EAAG,uCAAuCW,CAAS;AAAA,IAC7D,GAAGC;AAAA,EAAA;AACN,CACD;AACDi7C,GAAkB,cAAcZ,GAAgB,YAAY;ACtJ5D,MAAMa,KAAWp7C,EAAM,WAGrB,CAAC,EAAE,WAAAC,GAAW,OAAAmP,GAAO,GAAGlP,KAASC,MACjC,gBAAAC;AAAA,EAACi7C,GAAkB;AAAA,EAAlB;AAAA,IACC,KAAAl7C;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,IAEJ,UAAA,gBAAAE;AAAA,MAACi7C,GAAkB;AAAA,MAAlB;AAAA,QACC,WAAU;AAAA,QACV,OAAO,EAAE,WAAW,eAAe,OAAOjsC,KAAS,EAAE,KAAA;AAAA,MAAK;AAAA,IAAA;AAAA,EAC5D;AACF,CACD;AACDgsC,GAAS,cAAcC,GAAkB,KAAK;ACjB9C,SAASC,GAAoB;AAAA,EAC3B,WAAAr7C;AAAA,EACA,GAAGC;AACL,GAA+D;AAC7D,SACE,gBAAAE;AAAA,IAACm7C,GAAmB;AAAA,IAAnB;AAAA,MACC,WAAWj8C;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,IAAA;AAAA,EAAA;AAGV;AAGA,MAAMs7C,KAAiBD,GAAmB;AAG1C,SAASE,GAAgB;AAAA,EACvB,YAAAC;AAAA,EACA,WAAAz7C;AAAA,EACA,GAAGC;AACL,GAEG;AACD,SACE,gBAAAE;AAAA,IAACm7C,GAAmB;AAAA,IAAnB;AAAA,MACC,WAAWj8C;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,MAEH,UAAAw7C,uBACE,OAAA,EAAI,WAAU,wGACb,UAAA,gBAAAt7C,EAACu7C,IAAA,EAAa,WAAU,oBAAA,CAAoB,EAAA,CAC9C;AAAA,IAAA;AAAA,EAAA;AAIR;AClCA,SAASC,GAAO,EAAE,GAAG17C,KAAsB;AACzC,SACE,gBAAAE;AAAA,IAACy7C;AAAA,IAAA;AAAA,MACC,WAAU;AAAA,MACV,cAAc;AAAA,QACZ,YAAY;AAAA,UACV,OACE;AAAA,UACF,aAAa;AAAA,UACb,cAAc;AAAA,UACd,cAAc;AAAA,QAAA;AAAA,MAChB;AAAA,MAED,GAAG37C;AAAA,IAAA;AAAA,EAAA;AAGV;ACtBA,MAAM47C,KAAS97C,EAAM,WAGnB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAAQ;AAClC,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAc;AAAA,IAACu7C,GAAgB;AAAA,IAAhB;AAAA,MACC,KAAA57C;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,MACJ,KAAAK;AAAA,MAEA,UAAA;AAAA,QAAA,gBAAAH,EAAC27C,GAAgB,OAAhB,EAAsB,WAAU,2FAC/B,UAAA,gBAAA37C,EAAC27C,GAAgB,OAAhB,EAAsB,WAAU,sCAAA,CAAsC,EAAA,CACzE;AAAA,QACA,gBAAA37C,EAAC27C,GAAgB,OAAhB,EAAsB,WAAU,8SAAA,CAA8S;AAAA,MAAA;AAAA,IAAA;AAAA,EAAA;AAGrV,CAAC;AACDD,GAAO,cAAcC,GAAgB,KAAK;ACtB1C,MAAMC,KAASh8C,EAAM,WAGnB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAAQ;AAClC,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAU;AAAA,IAAC67C,GAAiB;AAAA,IAAjB;AAAA,MACC,WAAW38C;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,MACJ,KAAAC;AAAA,MAEA,UAAA,gBAAAC;AAAA,QAAC67C,GAAiB;AAAA,QAAjB;AAAA,UACC,WAAW38C;AAAA,YACT;AAAA,YACA;AAAA,cACE,iFACEiB,MAAQ;AAAA,YAAA;AAAA,YAEZ;AAAA,cACE,uFACEA,MAAQ;AAAA,YAAA;AAAA,UACZ;AAAA,QACF;AAAA,MAAA;AAAA,IACF;AAAA,EAAA;AAGN,CAAC;AACDy7C,GAAO,cAAcC,GAAiB,KAAK;AC/BpC,MAAMC,KAAO1I,GAAc,MAkBrB2I,KAAWn8C,EAAM,WAG5B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAAQ;AAClC,QAAMI,IAAiBb,GAAA;AACvB,SACE,gBAAAU;AAAA,IAACozC,GAAc;AAAA,IAAd;AAAA,MACC,KAAArzC;AAAA,MACA,WAAWb;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAED,GAAGC;AAAA,MACJ,KAAAK;AAAA,IAAA;AAAA,EAAA;AAGN,CAAC;AACD47C,GAAS,cAAc3I,GAAc,KAAK;AAGnC,MAAM4I,KAAcp8C,EAAM,WAG/B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACozC,GAAc;AAAA,EAAd;AAAA,IACC,KAAArzC;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDk8C,GAAY,cAAc5I,GAAc,QAAQ;AAGzC,MAAM6I,KAAcr8C,EAAM,WAG/B,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAC1B,gBAAAC;AAAA,EAACozC,GAAc;AAAA,EAAd;AAAA,IACC,KAAArzC;AAAA,IACA,WAAWb;AAAA,MACT;AAAA,MACAW;AAAA,IAAA;AAAA,IAED,GAAGC;AAAA,EAAA;AACN,CACD;AACDm8C,GAAY,cAAc7I,GAAc,QAAQ;ACvEhD,MAAM8I,KAAWt8C,EAAM;AAAA,EACrB,CAAC,EAAE,WAAAC,GAAW,GAAGC,EAAA,GAASC,MAEtB,gBAAAC;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAWd;AAAA,QACT;AAAA,QACAW;AAAA,MAAA;AAAA,MAEF,KAAAE;AAAA,MACC,GAAGD;AAAA,IAAA;AAAA,EAAA;AAIZ;AACAo8C,GAAS,cAAc;ACJhB,MAAMC,KAAW,CACtBhwC,GACAiwC,MACG;AACH,EAAAzgC,EAAU,MAAM;AAEd,QAAI,CAACxP,EAAO,QAAO,MAAM;AAAA,IAAC;AAE1B,UAAMkwC,IAAelwC,EAAMiwC,CAAY;AACvC,WAAO,MAAM;AACX,MAAAC,EAAA;AAAA,IACF;AAAA,EACF,GAAG,CAAClwC,GAAOiwC,CAAY,CAAC;AAC1B;ACpBA,SAASE,GAA6BztC,GAA+C;AACnF,SAAO;AAAA,IACL,eAAe;AAAA,IACf,GAAGA;AAAA,EAAA;AAEP;AA8BO,MAAM0tC,KAAa,CACxBC,GACAjE,GACA1pC,IAA6B,CAAA,MACM;AAEnC,QAAM4tC,IAAkBp5C,EAAOk1C,CAAY;AAC3C,EAAAkE,EAAgB,UAAUlE;AAE1B,QAAMmE,IAAsBr5C,EAAOwL,CAAO;AAC1C,EAAA6tC,EAAoB,UAAUJ,GAA6BI,EAAoB,OAAO;AAEtF,QAAM,CAAC1tC,GAAO2tC,CAAQ,IAAIl3C,EAAY,MAAMg3C,EAAgB,OAAO,GAC7D,CAACnsB,GAAWssB,CAAY,IAAIn3C,EAAkB,EAAI;AACxD,SAAAkW,EAAU,MAAM;AACd,QAAIkhC,IAAmB;AAEvB,WAAAD,EAAa,CAAC,CAACJ,CAAsB,IACpC,YAAY;AAEX,UAAIA,GAAwB;AAC1B,cAAMz1C,IAAS,MAAMy1C,EAAA;AAErB,QAAIK,MACFF,EAAS,MAAM51C,CAAM,GACrB61C,EAAa,EAAK;AAAA,MAEtB;AAAA,IACF,GAAA,GAEO,MAAM;AAEX,MAAAC,IAAmB,IACdH,EAAoB,QAAQ,iBAAeC,EAAS,MAAMF,EAAgB,OAAO;AAAA,IACxF;AAAA,EACF,GAAG,CAACD,CAAsB,CAAC,GAEpB,CAACxtC,GAAOshB,CAAS;AAC1B,GChFMwsB,KAAmB,MAAM,IAkBlBC,KAAgB,CAC3B5wC,GACAiwC,MACG;AAEH,QAAM,CAACY,CAAW,IAAIT;AAAA,IACpBr0C,EAAY,YAAY;AAEtB,UAAI,CAACiE,EAAO,QAAO2wC;AAGnB,YAAMG,IAAQ,MAAM,QAAQ,QAAQ9wC,EAAMiwC,CAAY,CAAC;AACvD,aAAO,YAAYa,EAAA;AAAA,IACrB,GAAG,CAACb,GAAcjwC,CAAK,CAAC;AAAA,IACxB2wC;AAAA;AAAA;AAAA,IAGA,EAAE,eAAe,GAAA;AAAA,EAAM;AAIzB,EAAAnhC,EAAU,MACD,MAAM;AACX,IAAIqhC,MAAgBF,MAClBE,EAAA;AAAA,EAEJ,GACC,CAACA,CAAW,CAAC;AAClB;ACzCO,SAASE,GAAcC,GAAgC;AAC5D,EAAAxhC,EAAU,MAAM;AACd,QAAIyhC;AAEJ,WAAID,MAEFC,IAAe,SAAS,cAAc,OAAO,GAC7CA,EAAa,YAAY,SAAS,eAAeD,CAAU,CAAC,GAC5D,SAAS,KAAK,YAAYC,CAAY,IAGjC,MAAM;AACX,MAAIA,KAEF,SAAS,KAAK,YAAYA,CAAY;AAAA,IAE1C;AAAA,EACF,GAAG,CAACD,CAAU,CAAC;AACjB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","x_google_ignoreList":[20,21,22,26,27,28,29,30,31,32,33,34,35,36,37,38,49]}